INFO:root:Namespace(model_name='TiSASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-03-19 19:12:44 ---------------------------------------------
INFO:root:
========================================
 Arguments       | Values               
========================================
 batch_size      | 256                 
 buffer          | 1                   
 dataset         | Grocery_and_Gourm...
 dropout         | 0                   
 early_stop      | 5                   
 emb_size        | 64                  
 epoch           | 200                 
 eval_batch_size | 256                 
 gpu             | 0                   
 history_max     | 20                  
 l2              | 1e-06               
 load            | 0                   
 lr              | 0.001               
 metric          | ["NDCG","HR"]       
 num_heads       | 4                   
 num_layers      | 5                   
 num_neg         | 1                   
 num_workers     | 5                   
 only_predict    | 0                   
 optimizer       | Adam                
 random_seed     | 2019                
 time_max        | 512                 
 topk            | [5,10,50]           
========================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food\BaseReader.pkl
INFO:root:#params: 714880
INFO:root:TiSASRec(
  (i_embeddings): Embedding(8457, 64)
  (p_k_embeddings): Embedding(21, 64)
  (p_v_embeddings): Embedding(21, 64)
  (t_k_embeddings): Embedding(513, 64)
  (t_v_embeddings): Embedding(513, 64)
  (transformer_block): ModuleList(
    (0): TimeIntervalTransformerLayer(
      (masked_attn_head): TimeIntervalMultiHeadAttention(
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TimeIntervalTransformerLayer(
      (masked_attn_head): TimeIntervalMultiHeadAttention(
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (2): TimeIntervalTransformerLayer(
      (masked_attn_head): TimeIntervalMultiHeadAttention(
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (3): TimeIntervalTransformerLayer(
      (masked_attn_head): TimeIntervalMultiHeadAttention(
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (4): TimeIntervalTransformerLayer(
      (masked_attn_head): TimeIntervalMultiHeadAttention(
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.1089,HR@5:0.0560,HR@50:0.5103,NDCG@10:0.0506,NDCG@5:0.0337,NDCG@50:0.1344)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.47868344]
INFO:root:Epoch 1     loss=0.4787 [114.4 s]	 dev=(HR@5:0.3421,NDCG@5:0.2346) test=(HR@5:0.2989,NDCG@5:0.1984) [23.6 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.37866786]
INFO:root:Epoch 2     loss=0.3787 [113.3 s]	 dev=(HR@5:0.3609,NDCG@5:0.2497) test=(HR@5:0.3190,NDCG@5:0.2130) [23.5 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.31934205]
INFO:root:Epoch 3     loss=0.3193 [113.3 s]	 dev=(HR@5:0.3789,NDCG@5:0.2683) test=(HR@5:0.3334,NDCG@5:0.2276) [23.6 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.24903862]
INFO:root:Epoch 4     loss=0.2490 [114.5 s]	 dev=(HR@5:0.3969,NDCG@5:0.2826) test=(HR@5:0.3536,NDCG@5:0.2442) [23.6 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.18881957]
INFO:root:Epoch 5     loss=0.1888 [113.2 s]	 dev=(HR@5:0.4046,NDCG@5:0.2952) test=(HR@5:0.3647,NDCG@5:0.2578) [23.6 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.14587466]
INFO:root:Epoch 6     loss=0.1459 [113.5 s]	 dev=(HR@5:0.4006,NDCG@5:0.2901) test=(HR@5:0.3600,NDCG@5:0.2523) [23.6 s] 
INFO:root:all_losses: [0.11799424]
INFO:root:Epoch 7     loss=0.1180 [113.5 s]	 dev=(HR@5:0.3961,NDCG@5:0.2904) test=(HR@5:0.3568,NDCG@5:0.2545) [23.6 s] 
INFO:root:all_losses: [0.09904208]
INFO:root:Epoch 8     loss=0.0990 [113.4 s]	 dev=(HR@5:0.4021,NDCG@5:0.2961) test=(HR@5:0.3613,NDCG@5:0.2590) [23.6 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.08569895]
INFO:root:Epoch 9     loss=0.0857 [113.6 s]	 dev=(HR@5:0.4015,NDCG@5:0.2962) test=(HR@5:0.3639,NDCG@5:0.2612) [23.6 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.07686966]
INFO:root:Epoch 10    loss=0.0769 [113.3 s]	 dev=(HR@5:0.4042,NDCG@5:0.2987) test=(HR@5:0.3563,NDCG@5:0.2567) [23.6 s] 
INFO:root:Save model to ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Foo...
INFO:root:all_losses: [0.07093109]
INFO:root:Epoch 11    loss=0.0709 [113.9 s]	 dev=(HR@5:0.3859,NDCG@5:0.2850) test=(HR@5:0.3413,NDCG@5:0.2445) [23.6 s] 
INFO:root:all_losses: [0.06625041]
INFO:root:Epoch 12    loss=0.0663 [113.3 s]	 dev=(HR@5:0.3941,NDCG@5:0.2922) test=(HR@5:0.3462,NDCG@5:0.2488) [23.5 s] 
INFO:root:all_losses: [0.06074866]
INFO:root:Epoch 13    loss=0.0607 [113.4 s]	 dev=(HR@5:0.3927,NDCG@5:0.2937) test=(HR@5:0.3542,NDCG@5:0.2565) [23.4 s] 
INFO:root:all_losses: [0.05867258]
INFO:root:Epoch 14    loss=0.0587 [113.7 s]	 dev=(HR@5:0.3966,NDCG@5:0.2964) test=(HR@5:0.3561,NDCG@5:0.2586) [23.7 s] 
INFO:root:all_losses: [0.05522072]
INFO:root:Epoch 15    loss=0.0552 [113.3 s]	 dev=(HR@5:0.3924,NDCG@5:0.2949) test=(HR@5:0.3562,NDCG@5:0.2586) [23.7 s] 
INFO:root:all_losses: [0.05348521]
INFO:root:Epoch 16    loss=0.0535 [113.8 s]	 dev=(HR@5:0.3824,NDCG@5:0.2844) test=(HR@5:0.3444,NDCG@5:0.2493) [23.8 s] 
INFO:root:all_losses: [0.05189857]
INFO:root:Epoch 17    loss=0.0519 [113.6 s]	 dev=(HR@5:0.3874,NDCG@5:0.2895) test=(HR@5:0.3459,NDCG@5:0.2518) [23.8 s] 
INFO:root:all_losses: [0.05019363]
INFO:root:Epoch 18    loss=0.0502 [113.8 s]	 dev=(HR@5:0.3865,NDCG@5:0.2884) test=(HR@5:0.3461,NDCG@5:0.2522) [23.7 s] 
INFO:root:all_losses: [0.04715615]
INFO:root:Epoch 19    loss=0.0472 [113.3 s]	 dev=(HR@5:0.3944,NDCG@5:0.2954) test=(HR@5:0.3543,NDCG@5:0.2586) [23.8 s] 
INFO:root:all_losses: [0.04371094]
INFO:root:Epoch 20    loss=0.0437 [113.3 s]	 dev=(HR@5:0.3770,NDCG@5:0.2839) test=(HR@5:0.3376,NDCG@5:0.2467) [23.8 s] 
INFO:root:all_losses: [0.04563414]
INFO:root:Epoch 21    loss=0.0456 [113.4 s]	 dev=(HR@5:0.3931,NDCG@5:0.2916) test=(HR@5:0.3534,NDCG@5:0.2572) [23.6 s] 
INFO:root:all_losses: [0.04312368]
INFO:root:Epoch 22    loss=0.0431 [113.3 s]	 dev=(HR@5:0.3824,NDCG@5:0.2891) test=(HR@5:0.3444,NDCG@5:0.2528) [23.7 s] 
INFO:root:all_losses: [0.04476857]
INFO:root:Epoch 23    loss=0.0448 [113.6 s]	 dev=(HR@5:0.3860,NDCG@5:0.2900) test=(HR@5:0.3450,NDCG@5:0.2537) [23.7 s] 
INFO:root:all_losses: [0.04361986]
INFO:root:Epoch 24    loss=0.0436 [113.3 s]	 dev=(HR@5:0.3813,NDCG@5:0.2857) test=(HR@5:0.3371,NDCG@5:0.2475) [23.6 s] 
INFO:root:all_losses: [0.04188091]
INFO:root:Epoch 25    loss=0.0419 [113.7 s]	 dev=(HR@5:0.3861,NDCG@5:0.2910) test=(HR@5:0.3493,NDCG@5:0.2570) [23.6 s] 
INFO:root:all_losses: [0.04079699]
INFO:root:Epoch 26    loss=0.0408 [113.3 s]	 dev=(HR@5:0.3877,NDCG@5:0.2908) test=(HR@5:0.3489,NDCG@5:0.2560) [23.7 s] 
INFO:root:all_losses: [0.04182085]
INFO:root:Epoch 27    loss=0.0418 [113.5 s]	 dev=(HR@5:0.3834,NDCG@5:0.2893) test=(HR@5:0.3395,NDCG@5:0.2492) [23.6 s] 
INFO:root:all_losses: [0.04058351]
INFO:root:Epoch 28    loss=0.0406 [113.6 s]	 dev=(HR@5:0.3898,NDCG@5:0.2941) test=(HR@5:0.3549,NDCG@5:0.2610) [23.7 s] 
INFO:root:all_losses: [0.03931357]
INFO:root:Epoch 29    loss=0.0393 [113.4 s]	 dev=(HR@5:0.3757,NDCG@5:0.2835) test=(HR@5:0.3414,NDCG@5:0.2523) [28.5 s] 
INFO:root:all_losses: [0.03787776]
INFO:root:Epoch 30    loss=0.0379 [500.4 s]	 dev=(HR@5:0.3804,NDCG@5:0.2835) test=(HR@5:0.3367,NDCG@5:0.2466) [65.3 s] 
INFO:root:Early stop at 30 based on dev result.
INFO:root:
Best Iter(dev)=   10	 dev=(HR@5:0.4042,NDCG@5:0.2987) test=(HR@5:0.3563,NDCG@5:0.2567) [4548.4 s] 
INFO:root:Load model from ../model/TiSASRec/TiSASRec_Grocery_and_Gourmet_Food_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.4547,HR@5:0.3563,HR@50:0.7858,NDCG@10:0.2886,NDCG@5:0.2567,NDCG@50:0.3606)
INFO:root:
--------------------------------------------- END: 2025-03-19 20:29:19 ---------------------------------------------
