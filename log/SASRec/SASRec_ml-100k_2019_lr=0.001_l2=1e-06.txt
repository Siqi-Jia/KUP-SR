INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-02-28 22:15:20 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 193024
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (2): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (3): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (4): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.1060,HR@5:0.0520,HR@50:0.5164,NDCG@10:0.0472,NDCG@5:0.0299,NDCG@50:0.1338)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.34665966]
INFO:root:Epoch 1     loss=0.3467 [43.0 s]	 dev=(HR@5:0.4761,NDCG@5:0.3241) test=(HR@5:0.4327,NDCG@5:0.2894) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.2080498]
INFO:root:Epoch 2     loss=0.2080 [43.6 s]	 dev=(HR@5:0.4931,NDCG@5:0.3348) test=(HR@5:0.4549,NDCG@5:0.3028) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18823445]
INFO:root:Epoch 3     loss=0.1882 [44.0 s]	 dev=(HR@5:0.5080,NDCG@5:0.3507) test=(HR@5:0.4634,NDCG@5:0.3159) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18039888]
INFO:root:Epoch 4     loss=0.1804 [43.6 s]	 dev=(HR@5:0.5133,NDCG@5:0.3538) test=(HR@5:0.4740,NDCG@5:0.3139) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1716648]
INFO:root:Epoch 5     loss=0.1717 [43.7 s]	 dev=(HR@5:0.5122,NDCG@5:0.3520) test=(HR@5:0.4783,NDCG@5:0.3307) [10.9 s] 
INFO:root:all_losses: [0.16723146]
INFO:root:Epoch 6     loss=0.1672 [43.5 s]	 dev=(HR@5:0.5408,NDCG@5:0.3749) test=(HR@5:0.4952,NDCG@5:0.3420) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16038181]
INFO:root:Epoch 7     loss=0.1604 [43.0 s]	 dev=(HR@5:0.5302,NDCG@5:0.3671) test=(HR@5:0.4751,NDCG@5:0.3292) [11.1 s] 
INFO:root:all_losses: [0.15260358]
INFO:root:Epoch 8     loss=0.1526 [42.4 s]	 dev=(HR@5:0.5429,NDCG@5:0.3803) test=(HR@5:0.4846,NDCG@5:0.3379) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14808469]
INFO:root:Epoch 9     loss=0.1481 [42.7 s]	 dev=(HR@5:0.5440,NDCG@5:0.3901) test=(HR@5:0.4910,NDCG@5:0.3278) [11.1 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14516933]
INFO:root:Epoch 10    loss=0.1452 [42.6 s]	 dev=(HR@5:0.5440,NDCG@5:0.3888) test=(HR@5:0.5037,NDCG@5:0.3464) [10.9 s] 
INFO:root:all_losses: [0.14035113]
INFO:root:Epoch 11    loss=0.1404 [42.8 s]	 dev=(HR@5:0.5536,NDCG@5:0.3892) test=(HR@5:0.5058,NDCG@5:0.3569) [11.0 s] 
INFO:root:all_losses: [0.1369123]
INFO:root:Epoch 12    loss=0.1369 [42.6 s]	 dev=(HR@5:0.5525,NDCG@5:0.3864) test=(HR@5:0.4920,NDCG@5:0.3400) [10.7 s] 
INFO:root:all_losses: [0.13237874]
INFO:root:Epoch 13    loss=0.1324 [42.7 s]	 dev=(HR@5:0.5429,NDCG@5:0.3776) test=(HR@5:0.5101,NDCG@5:0.3579) [10.7 s] 
INFO:root:all_losses: [0.13126118]
INFO:root:Epoch 14    loss=0.1313 [42.8 s]	 dev=(HR@5:0.5567,NDCG@5:0.3886) test=(HR@5:0.5249,NDCG@5:0.3592) [10.8 s] 
INFO:root:all_losses: [0.12809332]
INFO:root:Epoch 15    loss=0.1281 [43.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.3948) test=(HR@5:0.5080,NDCG@5:0.3595) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.12498136]
INFO:root:Epoch 16    loss=0.1250 [42.9 s]	 dev=(HR@5:0.5557,NDCG@5:0.3994) test=(HR@5:0.5260,NDCG@5:0.3612) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.12259203]
INFO:root:Epoch 17    loss=0.1226 [43.0 s]	 dev=(HR@5:0.5567,NDCG@5:0.3884) test=(HR@5:0.5249,NDCG@5:0.3601) [10.7 s] 
INFO:root:all_losses: [0.1168774]
INFO:root:Epoch 18    loss=0.1169 [42.7 s]	 dev=(HR@5:0.5684,NDCG@5:0.3962) test=(HR@5:0.5164,NDCG@5:0.3646) [10.7 s] 
INFO:root:all_losses: [0.11459123]
INFO:root:Epoch 19    loss=0.1146 [43.2 s]	 dev=(HR@5:0.5642,NDCG@5:0.3995) test=(HR@5:0.5302,NDCG@5:0.3713) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11561041]
INFO:root:Epoch 20    loss=0.1156 [43.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3934) test=(HR@5:0.5016,NDCG@5:0.3530) [10.7 s] 
INFO:root:all_losses: [0.11173208]
INFO:root:Epoch 21    loss=0.1117 [42.9 s]	 dev=(HR@5:0.5652,NDCG@5:0.3915) test=(HR@5:0.5249,NDCG@5:0.3691) [10.7 s] 
INFO:root:all_losses: [0.11160679]
INFO:root:Epoch 22    loss=0.1116 [43.0 s]	 dev=(HR@5:0.5663,NDCG@5:0.4000) test=(HR@5:0.5217,NDCG@5:0.3616) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11140871]
INFO:root:Epoch 23    loss=0.1114 [42.8 s]	 dev=(HR@5:0.5610,NDCG@5:0.3933) test=(HR@5:0.5408,NDCG@5:0.3776) [10.7 s] 
INFO:root:all_losses: [0.10932801]
INFO:root:Epoch 24    loss=0.1093 [43.6 s]	 dev=(HR@5:0.5663,NDCG@5:0.4030) test=(HR@5:0.5260,NDCG@5:0.3651) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10647675]
INFO:root:Epoch 25    loss=0.1065 [43.2 s]	 dev=(HR@5:0.5705,NDCG@5:0.3933) test=(HR@5:0.5101,NDCG@5:0.3614) [10.7 s] 
INFO:root:all_losses: [0.10608445]
INFO:root:Epoch 26    loss=0.1061 [43.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.3963) test=(HR@5:0.5345,NDCG@5:0.3851) [10.7 s] 
INFO:root:all_losses: [0.10498981]
INFO:root:Epoch 27    loss=0.1050 [43.2 s]	 dev=(HR@5:0.5642,NDCG@5:0.3963) test=(HR@5:0.5366,NDCG@5:0.3848) [10.6 s] 
INFO:root:all_losses: [0.1050771]
INFO:root:Epoch 28    loss=0.1051 [43.7 s]	 dev=(HR@5:0.5652,NDCG@5:0.3950) test=(HR@5:0.5323,NDCG@5:0.3781) [10.7 s] 
INFO:root:all_losses: [0.10255602]
INFO:root:Epoch 29    loss=0.1026 [43.4 s]	 dev=(HR@5:0.5758,NDCG@5:0.4088) test=(HR@5:0.5260,NDCG@5:0.3681) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.09977213]
INFO:root:Epoch 30    loss=0.0998 [43.3 s]	 dev=(HR@5:0.5854,NDCG@5:0.4065) test=(HR@5:0.5345,NDCG@5:0.3705) [10.8 s] 
INFO:root:all_losses: [0.09903029]
INFO:root:Epoch 31    loss=0.0990 [43.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4115) test=(HR@5:0.5366,NDCG@5:0.3776) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.09815425]
INFO:root:Epoch 32    loss=0.0982 [43.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.4011) test=(HR@5:0.5196,NDCG@5:0.3693) [10.8 s] 
INFO:root:all_losses: [0.09740517]
INFO:root:Epoch 33    loss=0.0974 [43.1 s]	 dev=(HR@5:0.5514,NDCG@5:0.3964) test=(HR@5:0.5217,NDCG@5:0.3644) [10.8 s] 
INFO:root:all_losses: [0.09513138]
INFO:root:Epoch 34    loss=0.0951 [43.1 s]	 dev=(HR@5:0.5620,NDCG@5:0.3981) test=(HR@5:0.5196,NDCG@5:0.3660) [10.9 s] 
INFO:root:all_losses: [0.09322061]
INFO:root:Epoch 35    loss=0.0932 [43.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.3979) test=(HR@5:0.5228,NDCG@5:0.3692) [10.7 s] 
INFO:root:all_losses: [0.09600084]
INFO:root:Epoch 36    loss=0.0960 [43.9 s]	 dev=(HR@5:0.5525,NDCG@5:0.3934) test=(HR@5:0.5429,NDCG@5:0.3851) [10.9 s] 
INFO:root:all_losses: [0.09314422]
INFO:root:Epoch 37    loss=0.0931 [43.1 s]	 dev=(HR@5:0.5589,NDCG@5:0.3855) test=(HR@5:0.5376,NDCG@5:0.3718) [10.9 s] 
INFO:root:all_losses: [0.09250349]
INFO:root:Epoch 38    loss=0.0925 [43.0 s]	 dev=(HR@5:0.5536,NDCG@5:0.3901) test=(HR@5:0.5451,NDCG@5:0.3844) [10.8 s] 
INFO:root:all_losses: [0.09094557]
INFO:root:Epoch 39    loss=0.0909 [43.4 s]	 dev=(HR@5:0.5652,NDCG@5:0.3969) test=(HR@5:0.5366,NDCG@5:0.3777) [10.9 s] 
INFO:root:all_losses: [0.09266801]
INFO:root:Epoch 40    loss=0.0927 [43.5 s]	 dev=(HR@5:0.5546,NDCG@5:0.3973) test=(HR@5:0.5249,NDCG@5:0.3695) [10.8 s] 
INFO:root:all_losses: [0.09179722]
INFO:root:Epoch 41    loss=0.0918 [43.3 s]	 dev=(HR@5:0.5610,NDCG@5:0.3978) test=(HR@5:0.5514,NDCG@5:0.3864) [10.7 s] 
INFO:root:all_losses: [0.09072799]
INFO:root:Epoch 42    loss=0.0907 [43.2 s]	 dev=(HR@5:0.5567,NDCG@5:0.3981) test=(HR@5:0.5292,NDCG@5:0.3722) [10.7 s] 
INFO:root:all_losses: [0.08936353]
INFO:root:Epoch 43    loss=0.0894 [43.6 s]	 dev=(HR@5:0.5610,NDCG@5:0.3902) test=(HR@5:0.5292,NDCG@5:0.3703) [10.7 s] 
INFO:root:all_losses: [0.08609284]
INFO:root:Epoch 44    loss=0.0861 [44.0 s]	 dev=(HR@5:0.5334,NDCG@5:0.3784) test=(HR@5:0.5260,NDCG@5:0.3667) [10.7 s] 
INFO:root:all_losses: [0.08593426]
INFO:root:Epoch 45    loss=0.0859 [43.9 s]	 dev=(HR@5:0.5567,NDCG@5:0.3922) test=(HR@5:0.5122,NDCG@5:0.3526) [10.7 s] 
INFO:root:all_losses: [0.08812648]
INFO:root:Epoch 46    loss=0.0881 [44.2 s]	 dev=(HR@5:0.5546,NDCG@5:0.3866) test=(HR@5:0.5249,NDCG@5:0.3618) [10.7 s] 
INFO:root:all_losses: [0.085798]
INFO:root:Epoch 47    loss=0.0858 [44.2 s]	 dev=(HR@5:0.5536,NDCG@5:0.3960) test=(HR@5:0.5323,NDCG@5:0.3738) [10.7 s] 
INFO:root:all_losses: [0.08417124]
INFO:root:Epoch 48    loss=0.0842 [44.5 s]	 dev=(HR@5:0.5451,NDCG@5:0.3812) test=(HR@5:0.5196,NDCG@5:0.3626) [10.7 s] 
INFO:root:all_losses: [0.08612699]
INFO:root:Epoch 49    loss=0.0861 [45.5 s]	 dev=(HR@5:0.5557,NDCG@5:0.3833) test=(HR@5:0.5249,NDCG@5:0.3630) [10.8 s] 
INFO:root:all_losses: [0.08617102]
INFO:root:Epoch 50    loss=0.0862 [45.6 s]	 dev=(HR@5:0.5599,NDCG@5:0.4025) test=(HR@5:0.5260,NDCG@5:0.3659) [10.8 s] 
INFO:root:all_losses: [0.08424611]
INFO:root:Epoch 51    loss=0.0842 [45.6 s]	 dev=(HR@5:0.5673,NDCG@5:0.3976) test=(HR@5:0.5239,NDCG@5:0.3636) [10.8 s] 
INFO:root:Early stop at 51 based on dev result.
INFO:root:
Best Iter(dev)=   31	 dev=(HR@5:0.5822,NDCG@5:0.4115) test=(HR@5:0.5366,NDCG@5:0.3776) [2764.6 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.7010,HR@5:0.5366,HR@50:0.9523,NDCG@10:0.4317,NDCG@5:0.3776,NDCG@50:0.4891)
INFO:root:
--------------------------------------------- END: 2025-02-28 23:01:36 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-09 16:28:50 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 6            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 214080
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (2): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (3): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (4): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (5): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.0954,HR@5:0.0403,HR@50:0.5016,NDCG@10:0.0420,NDCG@5:0.0245,NDCG@50:0.1264)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.35564777]
INFO:root:Epoch 1     loss=0.3556 [53.1 s]	 dev=(HR@5:0.4507,NDCG@5:0.3101) test=(HR@5:0.4136,NDCG@5:0.2787) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.21470016]
INFO:root:Epoch 2     loss=0.2147 [49.7 s]	 dev=(HR@5:0.4984,NDCG@5:0.3421) test=(HR@5:0.4581,NDCG@5:0.3036) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.19082007]
INFO:root:Epoch 3     loss=0.1908 [49.8 s]	 dev=(HR@5:0.4931,NDCG@5:0.3449) test=(HR@5:0.4634,NDCG@5:0.3108) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18285371]
INFO:root:Epoch 4     loss=0.1829 [49.6 s]	 dev=(HR@5:0.4963,NDCG@5:0.3476) test=(HR@5:0.4581,NDCG@5:0.3075) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1730145]
INFO:root:Epoch 5     loss=0.1730 [49.6 s]	 dev=(HR@5:0.5080,NDCG@5:0.3494) test=(HR@5:0.4666,NDCG@5:0.3202) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16878335]
INFO:root:Epoch 6     loss=0.1688 [49.7 s]	 dev=(HR@5:0.5292,NDCG@5:0.3656) test=(HR@5:0.4910,NDCG@5:0.3393) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16082953]
INFO:root:Epoch 7     loss=0.1608 [49.6 s]	 dev=(HR@5:0.5270,NDCG@5:0.3595) test=(HR@5:0.4783,NDCG@5:0.3262) [10.7 s] 
INFO:root:all_losses: [0.15256423]
INFO:root:Epoch 8     loss=0.1526 [49.6 s]	 dev=(HR@5:0.5440,NDCG@5:0.3790) test=(HR@5:0.4984,NDCG@5:0.3515) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14811853]
INFO:root:Epoch 9     loss=0.1481 [49.7 s]	 dev=(HR@5:0.5376,NDCG@5:0.3731) test=(HR@5:0.4899,NDCG@5:0.3389) [10.8 s] 
INFO:root:all_losses: [0.14432085]
INFO:root:Epoch 10    loss=0.1443 [49.7 s]	 dev=(HR@5:0.5493,NDCG@5:0.3827) test=(HR@5:0.5090,NDCG@5:0.3485) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14108694]
INFO:root:Epoch 11    loss=0.1411 [49.6 s]	 dev=(HR@5:0.5567,NDCG@5:0.3900) test=(HR@5:0.5037,NDCG@5:0.3505) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.13668929]
INFO:root:Epoch 12    loss=0.1367 [49.6 s]	 dev=(HR@5:0.5705,NDCG@5:0.3900) test=(HR@5:0.5143,NDCG@5:0.3575) [10.8 s] 
INFO:root:all_losses: [0.13332325]
INFO:root:Epoch 13    loss=0.1333 [49.6 s]	 dev=(HR@5:0.5366,NDCG@5:0.3758) test=(HR@5:0.5334,NDCG@5:0.3680) [10.8 s] 
INFO:root:all_losses: [0.13324465]
INFO:root:Epoch 14    loss=0.1332 [49.4 s]	 dev=(HR@5:0.5599,NDCG@5:0.3875) test=(HR@5:0.5260,NDCG@5:0.3644) [10.9 s] 
INFO:root:all_losses: [0.12844647]
INFO:root:Epoch 15    loss=0.1284 [49.6 s]	 dev=(HR@5:0.5726,NDCG@5:0.3968) test=(HR@5:0.5101,NDCG@5:0.3612) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.12658249]
INFO:root:Epoch 16    loss=0.1266 [49.6 s]	 dev=(HR@5:0.5419,NDCG@5:0.3861) test=(HR@5:0.5101,NDCG@5:0.3559) [10.9 s] 
INFO:root:all_losses: [0.12400553]
INFO:root:Epoch 17    loss=0.1240 [49.4 s]	 dev=(HR@5:0.5483,NDCG@5:0.3807) test=(HR@5:0.5069,NDCG@5:0.3593) [10.9 s] 
INFO:root:all_losses: [0.1199732]
INFO:root:Epoch 18    loss=0.1200 [49.5 s]	 dev=(HR@5:0.5461,NDCG@5:0.3803) test=(HR@5:0.5260,NDCG@5:0.3650) [10.8 s] 
INFO:root:all_losses: [0.11641896]
INFO:root:Epoch 19    loss=0.1164 [49.6 s]	 dev=(HR@5:0.5567,NDCG@5:0.3903) test=(HR@5:0.5281,NDCG@5:0.3652) [10.8 s] 
INFO:root:all_losses: [0.11844981]
INFO:root:Epoch 20    loss=0.1184 [49.6 s]	 dev=(HR@5:0.5504,NDCG@5:0.3934) test=(HR@5:0.5239,NDCG@5:0.3692) [10.8 s] 
INFO:root:all_losses: [0.11289265]
INFO:root:Epoch 21    loss=0.1129 [49.5 s]	 dev=(HR@5:0.5461,NDCG@5:0.3913) test=(HR@5:0.5249,NDCG@5:0.3683) [10.8 s] 
INFO:root:all_losses: [0.11453018]
INFO:root:Epoch 22    loss=0.1145 [49.5 s]	 dev=(HR@5:0.5652,NDCG@5:0.3917) test=(HR@5:0.5249,NDCG@5:0.3690) [10.9 s] 
INFO:root:all_losses: [0.11199187]
INFO:root:Epoch 23    loss=0.1120 [49.5 s]	 dev=(HR@5:0.5599,NDCG@5:0.3976) test=(HR@5:0.5196,NDCG@5:0.3641) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11229661]
INFO:root:Epoch 24    loss=0.1123 [49.7 s]	 dev=(HR@5:0.5536,NDCG@5:0.3997) test=(HR@5:0.5069,NDCG@5:0.3539) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11045382]
INFO:root:Epoch 25    loss=0.1105 [49.6 s]	 dev=(HR@5:0.5663,NDCG@5:0.4004) test=(HR@5:0.5101,NDCG@5:0.3552) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10805152]
INFO:root:Epoch 26    loss=0.1081 [49.5 s]	 dev=(HR@5:0.5705,NDCG@5:0.4022) test=(HR@5:0.5143,NDCG@5:0.3617) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10723616]
INFO:root:Epoch 27    loss=0.1072 [49.7 s]	 dev=(HR@5:0.5620,NDCG@5:0.4044) test=(HR@5:0.5207,NDCG@5:0.3686) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10649575]
INFO:root:Epoch 28    loss=0.1065 [49.6 s]	 dev=(HR@5:0.5642,NDCG@5:0.4053) test=(HR@5:0.5376,NDCG@5:0.3791) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10434248]
INFO:root:Epoch 29    loss=0.1043 [49.6 s]	 dev=(HR@5:0.5451,NDCG@5:0.3931) test=(HR@5:0.5345,NDCG@5:0.3789) [10.8 s] 
INFO:root:all_losses: [0.10223137]
INFO:root:Epoch 30    loss=0.1022 [49.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4097) test=(HR@5:0.5292,NDCG@5:0.3799) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10092761]
INFO:root:Epoch 31    loss=0.1009 [49.8 s]	 dev=(HR@5:0.5695,NDCG@5:0.4087) test=(HR@5:0.5398,NDCG@5:0.3797) [10.9 s] 
INFO:root:all_losses: [0.10160644]
INFO:root:Epoch 32    loss=0.1016 [49.8 s]	 dev=(HR@5:0.5546,NDCG@5:0.3877) test=(HR@5:0.5281,NDCG@5:0.3682) [10.8 s] 
INFO:root:all_losses: [0.10121322]
INFO:root:Epoch 33    loss=0.1012 [49.9 s]	 dev=(HR@5:0.5546,NDCG@5:0.4008) test=(HR@5:0.5281,NDCG@5:0.3630) [10.8 s] 
INFO:root:all_losses: [0.09851225]
INFO:root:Epoch 34    loss=0.0985 [49.8 s]	 dev=(HR@5:0.5599,NDCG@5:0.4019) test=(HR@5:0.5164,NDCG@5:0.3546) [10.8 s] 
INFO:root:all_losses: [0.09632587]
INFO:root:Epoch 35    loss=0.0963 [49.9 s]	 dev=(HR@5:0.5567,NDCG@5:0.3940) test=(HR@5:0.5323,NDCG@5:0.3670) [10.8 s] 
INFO:root:all_losses: [0.09753788]
INFO:root:Epoch 36    loss=0.0975 [50.0 s]	 dev=(HR@5:0.5408,NDCG@5:0.3903) test=(HR@5:0.5037,NDCG@5:0.3552) [10.8 s] 
INFO:root:all_losses: [0.09626255]
INFO:root:Epoch 37    loss=0.0963 [50.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3938) test=(HR@5:0.5419,NDCG@5:0.3747) [10.8 s] 
INFO:root:all_losses: [0.09499232]
INFO:root:Epoch 38    loss=0.0950 [50.4 s]	 dev=(HR@5:0.5536,NDCG@5:0.4070) test=(HR@5:0.5154,NDCG@5:0.3669) [10.8 s] 
INFO:root:all_losses: [0.0958365]
INFO:root:Epoch 39    loss=0.0958 [50.8 s]	 dev=(HR@5:0.5705,NDCG@5:0.4086) test=(HR@5:0.5302,NDCG@5:0.3715) [10.8 s] 
INFO:root:all_losses: [0.09341516]
INFO:root:Epoch 40    loss=0.0934 [51.2 s]	 dev=(HR@5:0.5536,NDCG@5:0.3916) test=(HR@5:0.5355,NDCG@5:0.3708) [10.8 s] 
INFO:root:all_losses: [0.09592172]
INFO:root:Epoch 41    loss=0.0959 [51.8 s]	 dev=(HR@5:0.5726,NDCG@5:0.4041) test=(HR@5:0.5345,NDCG@5:0.3730) [10.9 s] 
INFO:root:all_losses: [0.09221302]
INFO:root:Epoch 42    loss=0.0922 [52.3 s]	 dev=(HR@5:0.5663,NDCG@5:0.3994) test=(HR@5:0.5239,NDCG@5:0.3638) [10.9 s] 
INFO:root:all_losses: [0.09073438]
INFO:root:Epoch 43    loss=0.0907 [52.6 s]	 dev=(HR@5:0.5504,NDCG@5:0.3896) test=(HR@5:0.5005,NDCG@5:0.3587) [10.8 s] 
INFO:root:all_losses: [0.08912358]
INFO:root:Epoch 44    loss=0.0891 [52.7 s]	 dev=(HR@5:0.5684,NDCG@5:0.3980) test=(HR@5:0.5027,NDCG@5:0.3562) [10.8 s] 
INFO:root:all_losses: [0.08796506]
INFO:root:Epoch 45    loss=0.0880 [52.7 s]	 dev=(HR@5:0.5642,NDCG@5:0.3949) test=(HR@5:0.5429,NDCG@5:0.3740) [10.8 s] 
INFO:root:all_losses: [0.08956601]
INFO:root:Epoch 46    loss=0.0896 [53.1 s]	 dev=(HR@5:0.5631,NDCG@5:0.3957) test=(HR@5:0.5175,NDCG@5:0.3607) [10.8 s] 
INFO:root:all_losses: [0.08691002]
INFO:root:Epoch 47    loss=0.0869 [53.5 s]	 dev=(HR@5:0.5567,NDCG@5:0.3860) test=(HR@5:0.5207,NDCG@5:0.3657) [10.8 s] 
INFO:root:all_losses: [0.08804878]
INFO:root:Epoch 48    loss=0.0880 [53.8 s]	 dev=(HR@5:0.5620,NDCG@5:0.3989) test=(HR@5:0.5196,NDCG@5:0.3631) [10.9 s] 
INFO:root:all_losses: [0.08816486]
INFO:root:Epoch 49    loss=0.0882 [54.0 s]	 dev=(HR@5:0.5599,NDCG@5:0.4012) test=(HR@5:0.5090,NDCG@5:0.3615) [10.8 s] 
INFO:root:all_losses: [0.08744654]
INFO:root:Epoch 50    loss=0.0874 [54.1 s]	 dev=(HR@5:0.5589,NDCG@5:0.3948) test=(HR@5:0.5313,NDCG@5:0.3700) [10.8 s] 
INFO:root:Early stop at 50 based on dev result.
INFO:root:
Best Iter(dev)=   30	 dev=(HR@5:0.5779,NDCG@5:0.4097) test=(HR@5:0.5292,NDCG@5:0.3799) [3065.4 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.7010,HR@5:0.5292,HR@50:0.9406,NDCG@10:0.4354,NDCG@5:0.3799,NDCG@50:0.4909)
INFO:root:
--------------------------------------------- END: 2025-06-09 17:20:07 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-09 17:40:55 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 193024
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (2): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (3): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (4): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.1060,HR@5:0.0520,HR@50:0.5164,NDCG@10:0.0472,NDCG@5:0.0299,NDCG@50:0.1338)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.34665966]
INFO:root:Epoch 1     loss=0.3467 [45.4 s]	 dev=(HR@5:0.4761,NDCG@5:0.3241) test=(HR@5:0.4327,NDCG@5:0.2894) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.2080498]
INFO:root:Epoch 2     loss=0.2080 [42.5 s]	 dev=(HR@5:0.4931,NDCG@5:0.3348) test=(HR@5:0.4549,NDCG@5:0.3028) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18823445]
INFO:root:Epoch 3     loss=0.1882 [42.6 s]	 dev=(HR@5:0.5080,NDCG@5:0.3507) test=(HR@5:0.4634,NDCG@5:0.3159) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18039888]
INFO:root:Epoch 4     loss=0.1804 [42.6 s]	 dev=(HR@5:0.5133,NDCG@5:0.3538) test=(HR@5:0.4740,NDCG@5:0.3139) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1716648]
INFO:root:Epoch 5     loss=0.1717 [42.5 s]	 dev=(HR@5:0.5122,NDCG@5:0.3520) test=(HR@5:0.4783,NDCG@5:0.3307) [10.7 s] 
INFO:root:all_losses: [0.16723146]
INFO:root:Epoch 6     loss=0.1672 [42.5 s]	 dev=(HR@5:0.5408,NDCG@5:0.3749) test=(HR@5:0.4952,NDCG@5:0.3420) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16038181]
INFO:root:Epoch 7     loss=0.1604 [42.6 s]	 dev=(HR@5:0.5302,NDCG@5:0.3671) test=(HR@5:0.4751,NDCG@5:0.3292) [10.9 s] 
INFO:root:all_losses: [0.15260358]
INFO:root:Epoch 8     loss=0.1526 [42.4 s]	 dev=(HR@5:0.5429,NDCG@5:0.3803) test=(HR@5:0.4846,NDCG@5:0.3379) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14808469]
INFO:root:Epoch 9     loss=0.1481 [42.4 s]	 dev=(HR@5:0.5440,NDCG@5:0.3901) test=(HR@5:0.4910,NDCG@5:0.3278) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14516933]
INFO:root:Epoch 10    loss=0.1452 [42.2 s]	 dev=(HR@5:0.5440,NDCG@5:0.3888) test=(HR@5:0.5037,NDCG@5:0.3464) [10.8 s] 
INFO:root:all_losses: [0.14035113]
INFO:root:Epoch 11    loss=0.1404 [42.2 s]	 dev=(HR@5:0.5536,NDCG@5:0.3892) test=(HR@5:0.5058,NDCG@5:0.3569) [10.8 s] 
INFO:root:all_losses: [0.1369123]
INFO:root:Epoch 12    loss=0.1369 [42.3 s]	 dev=(HR@5:0.5525,NDCG@5:0.3864) test=(HR@5:0.4920,NDCG@5:0.3400) [10.7 s] 
INFO:root:all_losses: [0.13237874]
INFO:root:Epoch 13    loss=0.1324 [42.4 s]	 dev=(HR@5:0.5429,NDCG@5:0.3776) test=(HR@5:0.5101,NDCG@5:0.3579) [10.7 s] 
INFO:root:all_losses: [0.13126118]
INFO:root:Epoch 14    loss=0.1313 [42.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3886) test=(HR@5:0.5249,NDCG@5:0.3592) [10.8 s] 
INFO:root:all_losses: [0.12809332]
INFO:root:Epoch 15    loss=0.1281 [42.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.3948) test=(HR@5:0.5080,NDCG@5:0.3595) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.12498136]
INFO:root:Epoch 16    loss=0.1250 [42.3 s]	 dev=(HR@5:0.5557,NDCG@5:0.3994) test=(HR@5:0.5260,NDCG@5:0.3612) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.12259203]
INFO:root:Epoch 17    loss=0.1226 [42.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3884) test=(HR@5:0.5249,NDCG@5:0.3601) [10.8 s] 
INFO:root:all_losses: [0.1168774]
INFO:root:Epoch 18    loss=0.1169 [42.4 s]	 dev=(HR@5:0.5684,NDCG@5:0.3962) test=(HR@5:0.5164,NDCG@5:0.3646) [10.8 s] 
INFO:root:all_losses: [0.11459123]
INFO:root:Epoch 19    loss=0.1146 [42.3 s]	 dev=(HR@5:0.5642,NDCG@5:0.3995) test=(HR@5:0.5302,NDCG@5:0.3713) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11561041]
INFO:root:Epoch 20    loss=0.1156 [42.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.3934) test=(HR@5:0.5016,NDCG@5:0.3530) [10.7 s] 
INFO:root:all_losses: [0.11173208]
INFO:root:Epoch 21    loss=0.1117 [42.3 s]	 dev=(HR@5:0.5652,NDCG@5:0.3915) test=(HR@5:0.5249,NDCG@5:0.3691) [10.8 s] 
INFO:root:all_losses: [0.11160679]
INFO:root:Epoch 22    loss=0.1116 [42.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.4000) test=(HR@5:0.5217,NDCG@5:0.3616) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11140871]
INFO:root:Epoch 23    loss=0.1114 [42.5 s]	 dev=(HR@5:0.5610,NDCG@5:0.3933) test=(HR@5:0.5408,NDCG@5:0.3776) [10.8 s] 
INFO:root:all_losses: [0.10932801]
INFO:root:Epoch 24    loss=0.1093 [42.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.4030) test=(HR@5:0.5260,NDCG@5:0.3651) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10647675]
INFO:root:Epoch 25    loss=0.1065 [42.7 s]	 dev=(HR@5:0.5705,NDCG@5:0.3933) test=(HR@5:0.5101,NDCG@5:0.3614) [10.8 s] 
INFO:root:all_losses: [0.10608445]
INFO:root:Epoch 26    loss=0.1061 [42.8 s]	 dev=(HR@5:0.5663,NDCG@5:0.3963) test=(HR@5:0.5345,NDCG@5:0.3851) [10.8 s] 
INFO:root:all_losses: [0.10498981]
INFO:root:Epoch 27    loss=0.1050 [42.8 s]	 dev=(HR@5:0.5642,NDCG@5:0.3963) test=(HR@5:0.5366,NDCG@5:0.3848) [10.8 s] 
INFO:root:all_losses: [0.1050771]
INFO:root:Epoch 28    loss=0.1051 [42.8 s]	 dev=(HR@5:0.5652,NDCG@5:0.3950) test=(HR@5:0.5323,NDCG@5:0.3781) [10.8 s] 
INFO:root:all_losses: [0.10255602]
INFO:root:Epoch 29    loss=0.1026 [42.8 s]	 dev=(HR@5:0.5758,NDCG@5:0.4088) test=(HR@5:0.5260,NDCG@5:0.3681) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.09977213]
INFO:root:Epoch 30    loss=0.0998 [42.7 s]	 dev=(HR@5:0.5854,NDCG@5:0.4065) test=(HR@5:0.5345,NDCG@5:0.3705) [10.8 s] 
INFO:root:all_losses: [0.09903029]
INFO:root:Epoch 31    loss=0.0990 [42.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4115) test=(HR@5:0.5366,NDCG@5:0.3776) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.09815425]
INFO:root:Epoch 32    loss=0.0982 [42.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.4011) test=(HR@5:0.5196,NDCG@5:0.3693) [10.8 s] 
INFO:root:all_losses: [0.09740517]
INFO:root:Epoch 33    loss=0.0974 [42.8 s]	 dev=(HR@5:0.5514,NDCG@5:0.3964) test=(HR@5:0.5217,NDCG@5:0.3644) [10.8 s] 
INFO:root:all_losses: [0.09513138]
INFO:root:Epoch 34    loss=0.0951 [42.8 s]	 dev=(HR@5:0.5620,NDCG@5:0.3981) test=(HR@5:0.5196,NDCG@5:0.3660) [10.8 s] 
INFO:root:all_losses: [0.09322061]
INFO:root:Epoch 35    loss=0.0932 [42.8 s]	 dev=(HR@5:0.5695,NDCG@5:0.3979) test=(HR@5:0.5228,NDCG@5:0.3692) [10.8 s] 
INFO:root:all_losses: [0.09600084]
INFO:root:Epoch 36    loss=0.0960 [42.8 s]	 dev=(HR@5:0.5525,NDCG@5:0.3934) test=(HR@5:0.5429,NDCG@5:0.3851) [10.8 s] 
INFO:root:all_losses: [0.09314422]
INFO:root:Epoch 37    loss=0.0931 [42.9 s]	 dev=(HR@5:0.5589,NDCG@5:0.3855) test=(HR@5:0.5376,NDCG@5:0.3718) [10.8 s] 
INFO:root:all_losses: [0.09250349]
INFO:root:Epoch 38    loss=0.0925 [42.8 s]	 dev=(HR@5:0.5536,NDCG@5:0.3901) test=(HR@5:0.5451,NDCG@5:0.3844) [10.8 s] 
INFO:root:all_losses: [0.09094557]
INFO:root:Epoch 39    loss=0.0909 [42.9 s]	 dev=(HR@5:0.5652,NDCG@5:0.3969) test=(HR@5:0.5366,NDCG@5:0.3777) [10.8 s] 
INFO:root:all_losses: [0.09266801]
INFO:root:Epoch 40    loss=0.0927 [42.9 s]	 dev=(HR@5:0.5546,NDCG@5:0.3973) test=(HR@5:0.5249,NDCG@5:0.3695) [10.7 s] 
INFO:root:all_losses: [0.09179722]
INFO:root:Epoch 41    loss=0.0918 [43.0 s]	 dev=(HR@5:0.5610,NDCG@5:0.3978) test=(HR@5:0.5514,NDCG@5:0.3864) [10.9 s] 
INFO:root:all_losses: [0.09072799]
INFO:root:Epoch 42    loss=0.0907 [43.0 s]	 dev=(HR@5:0.5567,NDCG@5:0.3981) test=(HR@5:0.5292,NDCG@5:0.3722) [10.8 s] 
INFO:root:all_losses: [0.08936353]
INFO:root:Epoch 43    loss=0.0894 [43.4 s]	 dev=(HR@5:0.5610,NDCG@5:0.3902) test=(HR@5:0.5292,NDCG@5:0.3703) [10.7 s] 
INFO:root:all_losses: [0.08609284]
INFO:root:Epoch 44    loss=0.0861 [43.4 s]	 dev=(HR@5:0.5334,NDCG@5:0.3784) test=(HR@5:0.5260,NDCG@5:0.3667) [10.7 s] 
INFO:root:all_losses: [0.08593426]
INFO:root:Epoch 45    loss=0.0859 [43.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.3922) test=(HR@5:0.5122,NDCG@5:0.3526) [10.7 s] 
INFO:root:all_losses: [0.08812648]
INFO:root:Epoch 46    loss=0.0881 [43.7 s]	 dev=(HR@5:0.5546,NDCG@5:0.3866) test=(HR@5:0.5249,NDCG@5:0.3618) [10.8 s] 
INFO:root:all_losses: [0.085798]
INFO:root:Epoch 47    loss=0.0858 [43.8 s]	 dev=(HR@5:0.5536,NDCG@5:0.3960) test=(HR@5:0.5323,NDCG@5:0.3738) [10.7 s] 
INFO:root:all_losses: [0.08417124]
INFO:root:Epoch 48    loss=0.0842 [43.9 s]	 dev=(HR@5:0.5451,NDCG@5:0.3812) test=(HR@5:0.5196,NDCG@5:0.3626) [10.8 s] 
INFO:root:all_losses: [0.08612699]
INFO:root:Epoch 49    loss=0.0861 [44.7 s]	 dev=(HR@5:0.5557,NDCG@5:0.3833) test=(HR@5:0.5249,NDCG@5:0.3630) [10.7 s] 
INFO:root:all_losses: [0.08617102]
INFO:root:Epoch 50    loss=0.0862 [44.9 s]	 dev=(HR@5:0.5599,NDCG@5:0.4025) test=(HR@5:0.5260,NDCG@5:0.3659) [10.7 s] 
INFO:root:all_losses: [0.08424611]
INFO:root:Epoch 51    loss=0.0842 [45.3 s]	 dev=(HR@5:0.5673,NDCG@5:0.3976) test=(HR@5:0.5239,NDCG@5:0.3636) [10.8 s] 
INFO:root:Early stop at 51 based on dev result.
INFO:root:
Best Iter(dev)=   31	 dev=(HR@5:0.5822,NDCG@5:0.4115) test=(HR@5:0.5366,NDCG@5:0.3776) [2737.2 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.7010,HR@5:0.5366,HR@50:0.9523,NDCG@10:0.4317,NDCG@5:0.3776,NDCG@50:0.4891)
INFO:root:
--------------------------------------------- END: 2025-06-09 18:26:43 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-09 20:05:00 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 4            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 171968
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (2): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (3): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.1135,HR@5:0.0615,HR@50:0.4889,NDCG@10:0.0554,NDCG@5:0.0392,NDCG@50:0.1341)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.35473666]
INFO:root:Epoch 1     loss=0.3547 [36.1 s]	 dev=(HR@5:0.4666,NDCG@5:0.3215) test=(HR@5:0.4475,NDCG@5:0.3009) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.20889474]
INFO:root:Epoch 2     loss=0.2089 [35.2 s]	 dev=(HR@5:0.4783,NDCG@5:0.3294) test=(HR@5:0.4390,NDCG@5:0.2976) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18819275]
INFO:root:Epoch 3     loss=0.1882 [35.4 s]	 dev=(HR@5:0.5005,NDCG@5:0.3493) test=(HR@5:0.4740,NDCG@5:0.3203) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1809906]
INFO:root:Epoch 4     loss=0.1810 [35.3 s]	 dev=(HR@5:0.5133,NDCG@5:0.3536) test=(HR@5:0.4772,NDCG@5:0.3239) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.17112188]
INFO:root:Epoch 5     loss=0.1711 [35.3 s]	 dev=(HR@5:0.5186,NDCG@5:0.3533) test=(HR@5:0.4730,NDCG@5:0.3312) [10.8 s] 
INFO:root:all_losses: [0.16714996]
INFO:root:Epoch 6     loss=0.1671 [35.2 s]	 dev=(HR@5:0.5270,NDCG@5:0.3697) test=(HR@5:0.5048,NDCG@5:0.3444) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16018762]
INFO:root:Epoch 7     loss=0.1602 [35.3 s]	 dev=(HR@5:0.5599,NDCG@5:0.3862) test=(HR@5:0.5016,NDCG@5:0.3422) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.15015557]
INFO:root:Epoch 8     loss=0.1502 [35.3 s]	 dev=(HR@5:0.5493,NDCG@5:0.3830) test=(HR@5:0.5037,NDCG@5:0.3492) [10.8 s] 
INFO:root:all_losses: [0.14514492]
INFO:root:Epoch 9     loss=0.1451 [35.2 s]	 dev=(HR@5:0.5589,NDCG@5:0.3840) test=(HR@5:0.5048,NDCG@5:0.3563) [10.8 s] 
INFO:root:all_losses: [0.14287066]
INFO:root:Epoch 10    loss=0.1429 [35.3 s]	 dev=(HR@5:0.5684,NDCG@5:0.3926) test=(HR@5:0.5101,NDCG@5:0.3573) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.13856694]
INFO:root:Epoch 11    loss=0.1386 [35.3 s]	 dev=(HR@5:0.5748,NDCG@5:0.3965) test=(HR@5:0.5080,NDCG@5:0.3619) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.134955]
INFO:root:Epoch 12    loss=0.1350 [35.3 s]	 dev=(HR@5:0.5684,NDCG@5:0.3988) test=(HR@5:0.5111,NDCG@5:0.3624) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1311722]
INFO:root:Epoch 13    loss=0.1312 [35.1 s]	 dev=(HR@5:0.5376,NDCG@5:0.3852) test=(HR@5:0.5111,NDCG@5:0.3577) [10.7 s] 
INFO:root:all_losses: [0.13090505]
INFO:root:Epoch 14    loss=0.1309 [35.1 s]	 dev=(HR@5:0.5525,NDCG@5:0.3908) test=(HR@5:0.5292,NDCG@5:0.3732) [10.8 s] 
INFO:root:all_losses: [0.12627706]
INFO:root:Epoch 15    loss=0.1263 [35.1 s]	 dev=(HR@5:0.5620,NDCG@5:0.4036) test=(HR@5:0.5016,NDCG@5:0.3528) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.12430044]
INFO:root:Epoch 16    loss=0.1243 [35.1 s]	 dev=(HR@5:0.5726,NDCG@5:0.4005) test=(HR@5:0.5005,NDCG@5:0.3563) [10.7 s] 
INFO:root:all_losses: [0.12094215]
INFO:root:Epoch 17    loss=0.1209 [35.2 s]	 dev=(HR@5:0.5483,NDCG@5:0.3860) test=(HR@5:0.5154,NDCG@5:0.3654) [10.8 s] 
INFO:root:all_losses: [0.1162928]
INFO:root:Epoch 18    loss=0.1163 [35.2 s]	 dev=(HR@5:0.5620,NDCG@5:0.3950) test=(HR@5:0.5292,NDCG@5:0.3701) [10.8 s] 
INFO:root:all_losses: [0.11531372]
INFO:root:Epoch 19    loss=0.1153 [35.3 s]	 dev=(HR@5:0.5716,NDCG@5:0.4038) test=(HR@5:0.5239,NDCG@5:0.3659) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11565626]
INFO:root:Epoch 20    loss=0.1157 [35.3 s]	 dev=(HR@5:0.5599,NDCG@5:0.3983) test=(HR@5:0.5228,NDCG@5:0.3726) [10.6 s] 
INFO:root:all_losses: [0.11234827]
INFO:root:Epoch 21    loss=0.1123 [35.1 s]	 dev=(HR@5:0.5737,NDCG@5:0.4016) test=(HR@5:0.5366,NDCG@5:0.3786) [10.7 s] 
INFO:root:all_losses: [0.11241936]
INFO:root:Epoch 22    loss=0.1124 [35.1 s]	 dev=(HR@5:0.5578,NDCG@5:0.3913) test=(HR@5:0.5133,NDCG@5:0.3638) [10.8 s] 
INFO:root:all_losses: [0.11121379]
INFO:root:Epoch 23    loss=0.1112 [35.1 s]	 dev=(HR@5:0.5673,NDCG@5:0.3987) test=(HR@5:0.5249,NDCG@5:0.3744) [10.7 s] 
INFO:root:all_losses: [0.10864013]
INFO:root:Epoch 24    loss=0.1086 [35.1 s]	 dev=(HR@5:0.5440,NDCG@5:0.3870) test=(HR@5:0.5143,NDCG@5:0.3617) [10.7 s] 
INFO:root:all_losses: [0.10633621]
INFO:root:Epoch 25    loss=0.1063 [35.3 s]	 dev=(HR@5:0.5801,NDCG@5:0.4028) test=(HR@5:0.5334,NDCG@5:0.3766) [10.7 s] 
INFO:root:all_losses: [0.10543571]
INFO:root:Epoch 26    loss=0.1054 [35.1 s]	 dev=(HR@5:0.5631,NDCG@5:0.4039) test=(HR@5:0.5292,NDCG@5:0.3719) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10456131]
INFO:root:Epoch 27    loss=0.1046 [35.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.4144) test=(HR@5:0.5451,NDCG@5:0.3816) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10309312]
INFO:root:Epoch 28    loss=0.1031 [35.2 s]	 dev=(HR@5:0.5684,NDCG@5:0.4109) test=(HR@5:0.5217,NDCG@5:0.3671) [10.7 s] 
INFO:root:all_losses: [0.10106503]
INFO:root:Epoch 29    loss=0.1011 [35.1 s]	 dev=(HR@5:0.5536,NDCG@5:0.3980) test=(HR@5:0.5196,NDCG@5:0.3737) [10.6 s] 
INFO:root:all_losses: [0.09968374]
INFO:root:Epoch 30    loss=0.0997 [35.0 s]	 dev=(HR@5:0.5567,NDCG@5:0.3944) test=(HR@5:0.5366,NDCG@5:0.3757) [10.7 s] 
INFO:root:all_losses: [0.09929473]
INFO:root:Epoch 31    loss=0.0993 [35.2 s]	 dev=(HR@5:0.5642,NDCG@5:0.4005) test=(HR@5:0.5270,NDCG@5:0.3773) [10.7 s] 
INFO:root:all_losses: [0.09795436]
INFO:root:Epoch 32    loss=0.0980 [35.2 s]	 dev=(HR@5:0.5525,NDCG@5:0.3928) test=(HR@5:0.5249,NDCG@5:0.3702) [10.7 s] 
INFO:root:all_losses: [0.09848614]
INFO:root:Epoch 33    loss=0.0985 [35.2 s]	 dev=(HR@5:0.5726,NDCG@5:0.4090) test=(HR@5:0.5133,NDCG@5:0.3648) [10.8 s] 
INFO:root:all_losses: [0.09443153]
INFO:root:Epoch 34    loss=0.0944 [35.2 s]	 dev=(HR@5:0.5472,NDCG@5:0.3885) test=(HR@5:0.5207,NDCG@5:0.3729) [10.7 s] 
INFO:root:all_losses: [0.09378094]
INFO:root:Epoch 35    loss=0.0938 [35.3 s]	 dev=(HR@5:0.5514,NDCG@5:0.3906) test=(HR@5:0.5175,NDCG@5:0.3703) [10.8 s] 
INFO:root:all_losses: [0.09471633]
INFO:root:Epoch 36    loss=0.0947 [35.2 s]	 dev=(HR@5:0.5599,NDCG@5:0.3926) test=(HR@5:0.5483,NDCG@5:0.3782) [10.7 s] 
INFO:root:all_losses: [0.09276723]
INFO:root:Epoch 37    loss=0.0928 [35.2 s]	 dev=(HR@5:0.5599,NDCG@5:0.4017) test=(HR@5:0.5281,NDCG@5:0.3752) [10.6 s] 
INFO:root:all_losses: [0.0914794]
INFO:root:Epoch 38    loss=0.0915 [35.1 s]	 dev=(HR@5:0.5493,NDCG@5:0.3934) test=(HR@5:0.5270,NDCG@5:0.3714) [10.7 s] 
INFO:root:all_losses: [0.09152649]
INFO:root:Epoch 39    loss=0.0915 [35.2 s]	 dev=(HR@5:0.5599,NDCG@5:0.3971) test=(HR@5:0.5249,NDCG@5:0.3697) [10.7 s] 
INFO:root:all_losses: [0.09079203]
INFO:root:Epoch 40    loss=0.0908 [35.3 s]	 dev=(HR@5:0.5610,NDCG@5:0.3968) test=(HR@5:0.5239,NDCG@5:0.3751) [10.8 s] 
INFO:root:all_losses: [0.09129187]
INFO:root:Epoch 41    loss=0.0913 [35.5 s]	 dev=(HR@5:0.5557,NDCG@5:0.3957) test=(HR@5:0.5355,NDCG@5:0.3716) [10.7 s] 
INFO:root:all_losses: [0.08859091]
INFO:root:Epoch 42    loss=0.0886 [35.6 s]	 dev=(HR@5:0.5483,NDCG@5:0.3889) test=(HR@5:0.5143,NDCG@5:0.3603) [10.7 s] 
INFO:root:all_losses: [0.08872633]
INFO:root:Epoch 43    loss=0.0887 [35.6 s]	 dev=(HR@5:0.5557,NDCG@5:0.3828) test=(HR@5:0.5323,NDCG@5:0.3749) [10.6 s] 
INFO:root:Early stop at 43 based on dev result.
INFO:root:
Best Iter(dev)=   27	 dev=(HR@5:0.5737,NDCG@5:0.4144) test=(HR@5:0.5451,NDCG@5:0.3816) [1977.1 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.6988,HR@5:0.5451,HR@50:0.9438,NDCG@10:0.4311,NDCG@5:0.3816,NDCG@50:0.4877)
INFO:root:
--------------------------------------------- END: 2025-06-09 20:38:08 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-09 21:42:12 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 3            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 150912
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (2): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.0912,HR@5:0.0435,HR@50:0.4761,NDCG@10:0.0410,NDCG@5:0.0257,NDCG@50:0.1205)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.35507393]
INFO:root:Epoch 1     loss=0.3551 [28.6 s]	 dev=(HR@5:0.4422,NDCG@5:0.3087) test=(HR@5:0.4252,NDCG@5:0.2855) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.2093913]
INFO:root:Epoch 2     loss=0.2094 [27.9 s]	 dev=(HR@5:0.4910,NDCG@5:0.3335) test=(HR@5:0.4645,NDCG@5:0.3097) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18899006]
INFO:root:Epoch 3     loss=0.1890 [28.0 s]	 dev=(HR@5:0.5111,NDCG@5:0.3477) test=(HR@5:0.4602,NDCG@5:0.3136) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18085109]
INFO:root:Epoch 4     loss=0.1809 [28.1 s]	 dev=(HR@5:0.5196,NDCG@5:0.3590) test=(HR@5:0.4899,NDCG@5:0.3258) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16984907]
INFO:root:Epoch 5     loss=0.1698 [28.2 s]	 dev=(HR@5:0.5398,NDCG@5:0.3710) test=(HR@5:0.5037,NDCG@5:0.3412) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1629963]
INFO:root:Epoch 6     loss=0.1630 [28.3 s]	 dev=(HR@5:0.5313,NDCG@5:0.3706) test=(HR@5:0.4910,NDCG@5:0.3367) [10.6 s] 
INFO:root:all_losses: [0.15556015]
INFO:root:Epoch 7     loss=0.1556 [28.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.3834) test=(HR@5:0.4942,NDCG@5:0.3421) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14676122]
INFO:root:Epoch 8     loss=0.1468 [28.2 s]	 dev=(HR@5:0.5504,NDCG@5:0.3877) test=(HR@5:0.5175,NDCG@5:0.3531) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14363116]
INFO:root:Epoch 9     loss=0.1436 [28.1 s]	 dev=(HR@5:0.5631,NDCG@5:0.3973) test=(HR@5:0.5090,NDCG@5:0.3515) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14008658]
INFO:root:Epoch 10    loss=0.1401 [28.1 s]	 dev=(HR@5:0.5610,NDCG@5:0.3918) test=(HR@5:0.5154,NDCG@5:0.3593) [10.5 s] 
INFO:root:all_losses: [0.13581856]
INFO:root:Epoch 11    loss=0.1358 [28.3 s]	 dev=(HR@5:0.5536,NDCG@5:0.3882) test=(HR@5:0.5154,NDCG@5:0.3622) [10.6 s] 
INFO:root:all_losses: [0.13189854]
INFO:root:Epoch 12    loss=0.1319 [28.1 s]	 dev=(HR@5:0.5684,NDCG@5:0.3969) test=(HR@5:0.5281,NDCG@5:0.3621) [10.7 s] 
INFO:root:all_losses: [0.12841503]
INFO:root:Epoch 13    loss=0.1284 [28.2 s]	 dev=(HR@5:0.5663,NDCG@5:0.4003) test=(HR@5:0.5398,NDCG@5:0.3774) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.12715505]
INFO:root:Epoch 14    loss=0.1272 [28.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.3951) test=(HR@5:0.5366,NDCG@5:0.3689) [10.7 s] 
INFO:root:all_losses: [0.12347519]
INFO:root:Epoch 15    loss=0.1235 [28.2 s]	 dev=(HR@5:0.5790,NDCG@5:0.3979) test=(HR@5:0.5292,NDCG@5:0.3715) [10.7 s] 
INFO:root:all_losses: [0.12077215]
INFO:root:Epoch 16    loss=0.1208 [28.1 s]	 dev=(HR@5:0.5716,NDCG@5:0.4029) test=(HR@5:0.5175,NDCG@5:0.3648) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1190055]
INFO:root:Epoch 17    loss=0.1190 [28.3 s]	 dev=(HR@5:0.5546,NDCG@5:0.3919) test=(HR@5:0.5387,NDCG@5:0.3773) [10.7 s] 
INFO:root:all_losses: [0.11307415]
INFO:root:Epoch 18    loss=0.1131 [28.2 s]	 dev=(HR@5:0.5748,NDCG@5:0.4013) test=(HR@5:0.5239,NDCG@5:0.3690) [10.7 s] 
INFO:root:all_losses: [0.11150106]
INFO:root:Epoch 19    loss=0.1115 [28.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4137) test=(HR@5:0.5313,NDCG@5:0.3632) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11134388]
INFO:root:Epoch 20    loss=0.1113 [28.3 s]	 dev=(HR@5:0.5663,NDCG@5:0.4046) test=(HR@5:0.5048,NDCG@5:0.3553) [10.7 s] 
INFO:root:all_losses: [0.10705891]
INFO:root:Epoch 21    loss=0.1071 [28.3 s]	 dev=(HR@5:0.5663,NDCG@5:0.4017) test=(HR@5:0.5292,NDCG@5:0.3742) [10.5 s] 
INFO:root:all_losses: [0.10877816]
INFO:root:Epoch 22    loss=0.1088 [28.3 s]	 dev=(HR@5:0.5610,NDCG@5:0.3986) test=(HR@5:0.5101,NDCG@5:0.3614) [10.7 s] 
INFO:root:all_losses: [0.1077928]
INFO:root:Epoch 23    loss=0.1078 [28.3 s]	 dev=(HR@5:0.5673,NDCG@5:0.4054) test=(HR@5:0.5334,NDCG@5:0.3741) [10.5 s] 
INFO:root:all_losses: [0.10551026]
INFO:root:Epoch 24    loss=0.1055 [28.4 s]	 dev=(HR@5:0.5673,NDCG@5:0.4038) test=(HR@5:0.5334,NDCG@5:0.3748) [10.7 s] 
INFO:root:all_losses: [0.10315543]
INFO:root:Epoch 25    loss=0.1032 [28.4 s]	 dev=(HR@5:0.5695,NDCG@5:0.4035) test=(HR@5:0.5154,NDCG@5:0.3633) [10.7 s] 
INFO:root:all_losses: [0.10227543]
INFO:root:Epoch 26    loss=0.1023 [28.4 s]	 dev=(HR@5:0.5546,NDCG@5:0.3923) test=(HR@5:0.5090,NDCG@5:0.3738) [10.6 s] 
INFO:root:all_losses: [0.10137957]
INFO:root:Epoch 27    loss=0.1014 [28.3 s]	 dev=(HR@5:0.5663,NDCG@5:0.4005) test=(HR@5:0.5186,NDCG@5:0.3689) [10.6 s] 
INFO:root:all_losses: [0.10049994]
INFO:root:Epoch 28    loss=0.1005 [28.4 s]	 dev=(HR@5:0.5610,NDCG@5:0.3972) test=(HR@5:0.5175,NDCG@5:0.3659) [10.6 s] 
INFO:root:all_losses: [0.0980766]
INFO:root:Epoch 29    loss=0.0981 [28.4 s]	 dev=(HR@5:0.5673,NDCG@5:0.4071) test=(HR@5:0.5260,NDCG@5:0.3730) [10.7 s] 
INFO:root:all_losses: [0.09584175]
INFO:root:Epoch 30    loss=0.0958 [28.4 s]	 dev=(HR@5:0.5536,NDCG@5:0.3983) test=(HR@5:0.5366,NDCG@5:0.3798) [10.6 s] 
INFO:root:all_losses: [0.09506779]
INFO:root:Epoch 31    loss=0.0951 [28.4 s]	 dev=(HR@5:0.5578,NDCG@5:0.4026) test=(HR@5:0.5334,NDCG@5:0.3790) [10.6 s] 
INFO:root:all_losses: [0.0940074]
INFO:root:Epoch 32    loss=0.0940 [28.3 s]	 dev=(HR@5:0.5493,NDCG@5:0.3930) test=(HR@5:0.5111,NDCG@5:0.3653) [10.6 s] 
INFO:root:all_losses: [0.09520908]
INFO:root:Epoch 33    loss=0.0952 [28.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.3991) test=(HR@5:0.5175,NDCG@5:0.3636) [10.6 s] 
INFO:root:all_losses: [0.09158493]
INFO:root:Epoch 34    loss=0.0916 [28.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.3997) test=(HR@5:0.5175,NDCG@5:0.3681) [10.7 s] 
INFO:root:all_losses: [0.09146667]
INFO:root:Epoch 35    loss=0.0915 [28.4 s]	 dev=(HR@5:0.5578,NDCG@5:0.3971) test=(HR@5:0.5260,NDCG@5:0.3719) [10.6 s] 
INFO:root:all_losses: [0.09242257]
INFO:root:Epoch 36    loss=0.0924 [28.5 s]	 dev=(HR@5:0.5525,NDCG@5:0.3948) test=(HR@5:0.5228,NDCG@5:0.3676) [10.6 s] 
INFO:root:all_losses: [0.08922958]
INFO:root:Epoch 37    loss=0.0892 [28.4 s]	 dev=(HR@5:0.5663,NDCG@5:0.3936) test=(HR@5:0.5429,NDCG@5:0.3787) [10.6 s] 
INFO:root:all_losses: [0.08842742]
INFO:root:Epoch 38    loss=0.0884 [28.4 s]	 dev=(HR@5:0.5663,NDCG@5:0.4032) test=(HR@5:0.5186,NDCG@5:0.3710) [10.6 s] 
INFO:root:all_losses: [0.08747265]
INFO:root:Epoch 39    loss=0.0875 [28.4 s]	 dev=(HR@5:0.5663,NDCG@5:0.4048) test=(HR@5:0.5302,NDCG@5:0.3743) [10.7 s] 
INFO:root:Early stop at 39 based on dev result.
INFO:root:
Best Iter(dev)=   19	 dev=(HR@5:0.5769,NDCG@5:0.4137) test=(HR@5:0.5313,NDCG@5:0.3632) [1517.9 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.6903,HR@5:0.5313,HR@50:0.9438,NDCG@10:0.4149,NDCG@5:0.3632,NDCG@50:0.4734)
INFO:root:
--------------------------------------------- END: 2025-06-09 22:07:41 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-10 08:44:01 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 2            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 129856
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.0976,HR@5:0.0456,HR@50:0.5101,NDCG@10:0.0401,NDCG@5:0.0238,NDCG@50:0.1259)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.34552443]
INFO:root:Epoch 1     loss=0.3455 [22.4 s]	 dev=(HR@5:0.4814,NDCG@5:0.3268) test=(HR@5:0.4263,NDCG@5:0.2866) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.20742664]
INFO:root:Epoch 2     loss=0.2074 [21.3 s]	 dev=(HR@5:0.4942,NDCG@5:0.3370) test=(HR@5:0.4433,NDCG@5:0.3044) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18851171]
INFO:root:Epoch 3     loss=0.1885 [21.4 s]	 dev=(HR@5:0.5111,NDCG@5:0.3461) test=(HR@5:0.4836,NDCG@5:0.3315) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18015169]
INFO:root:Epoch 4     loss=0.1802 [21.5 s]	 dev=(HR@5:0.5164,NDCG@5:0.3535) test=(HR@5:0.4783,NDCG@5:0.3221) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.17051198]
INFO:root:Epoch 5     loss=0.1705 [21.4 s]	 dev=(HR@5:0.5313,NDCG@5:0.3696) test=(HR@5:0.5037,NDCG@5:0.3489) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16579078]
INFO:root:Epoch 6     loss=0.1658 [21.5 s]	 dev=(HR@5:0.5567,NDCG@5:0.3848) test=(HR@5:0.4984,NDCG@5:0.3555) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1559705]
INFO:root:Epoch 7     loss=0.1560 [21.4 s]	 dev=(HR@5:0.5440,NDCG@5:0.3797) test=(HR@5:0.4910,NDCG@5:0.3451) [10.6 s] 
INFO:root:all_losses: [0.14753613]
INFO:root:Epoch 8     loss=0.1475 [21.6 s]	 dev=(HR@5:0.5652,NDCG@5:0.3981) test=(HR@5:0.5292,NDCG@5:0.3715) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14327341]
INFO:root:Epoch 9     loss=0.1433 [21.3 s]	 dev=(HR@5:0.5557,NDCG@5:0.3888) test=(HR@5:0.5133,NDCG@5:0.3566) [10.6 s] 
INFO:root:all_losses: [0.13917857]
INFO:root:Epoch 10    loss=0.1392 [21.5 s]	 dev=(HR@5:0.5642,NDCG@5:0.3955) test=(HR@5:0.5143,NDCG@5:0.3575) [10.6 s] 
INFO:root:all_losses: [0.13571477]
INFO:root:Epoch 11    loss=0.1357 [21.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.3953) test=(HR@5:0.5111,NDCG@5:0.3652) [10.6 s] 
INFO:root:all_losses: [0.1308516]
INFO:root:Epoch 12    loss=0.1309 [21.4 s]	 dev=(HR@5:0.5695,NDCG@5:0.4030) test=(HR@5:0.5080,NDCG@5:0.3596) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1279025]
INFO:root:Epoch 13    loss=0.1279 [21.4 s]	 dev=(HR@5:0.5642,NDCG@5:0.4018) test=(HR@5:0.5090,NDCG@5:0.3653) [10.6 s] 
INFO:root:all_losses: [0.12712689]
INFO:root:Epoch 14    loss=0.1271 [21.3 s]	 dev=(HR@5:0.5748,NDCG@5:0.4012) test=(HR@5:0.5186,NDCG@5:0.3762) [10.6 s] 
INFO:root:all_losses: [0.12306365]
INFO:root:Epoch 15    loss=0.1231 [21.5 s]	 dev=(HR@5:0.5536,NDCG@5:0.3921) test=(HR@5:0.5175,NDCG@5:0.3705) [10.5 s] 
INFO:root:all_losses: [0.12176248]
INFO:root:Epoch 16    loss=0.1218 [21.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.4010) test=(HR@5:0.5143,NDCG@5:0.3677) [10.6 s] 
INFO:root:all_losses: [0.11585876]
INFO:root:Epoch 17    loss=0.1159 [21.4 s]	 dev=(HR@5:0.5546,NDCG@5:0.3963) test=(HR@5:0.5101,NDCG@5:0.3689) [10.7 s] 
INFO:root:all_losses: [0.11291775]
INFO:root:Epoch 18    loss=0.1129 [21.5 s]	 dev=(HR@5:0.5684,NDCG@5:0.4060) test=(HR@5:0.5408,NDCG@5:0.3795) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11019979]
INFO:root:Epoch 19    loss=0.1102 [21.4 s]	 dev=(HR@5:0.5705,NDCG@5:0.3998) test=(HR@5:0.5323,NDCG@5:0.3716) [10.6 s] 
INFO:root:all_losses: [0.11073221]
INFO:root:Epoch 20    loss=0.1107 [21.5 s]	 dev=(HR@5:0.5578,NDCG@5:0.4106) test=(HR@5:0.5090,NDCG@5:0.3639) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10628572]
INFO:root:Epoch 21    loss=0.1063 [21.5 s]	 dev=(HR@5:0.5567,NDCG@5:0.3984) test=(HR@5:0.5408,NDCG@5:0.3811) [10.6 s] 
INFO:root:all_losses: [0.10613006]
INFO:root:Epoch 22    loss=0.1061 [21.4 s]	 dev=(HR@5:0.5589,NDCG@5:0.3966) test=(HR@5:0.5334,NDCG@5:0.3759) [10.6 s] 
INFO:root:all_losses: [0.10520048]
INFO:root:Epoch 23    loss=0.1052 [21.5 s]	 dev=(HR@5:0.5631,NDCG@5:0.4022) test=(HR@5:0.5260,NDCG@5:0.3790) [10.6 s] 
INFO:root:all_losses: [0.10454699]
INFO:root:Epoch 24    loss=0.1045 [21.4 s]	 dev=(HR@5:0.5663,NDCG@5:0.4123) test=(HR@5:0.5260,NDCG@5:0.3740) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10040787]
INFO:root:Epoch 25    loss=0.1004 [21.5 s]	 dev=(HR@5:0.5408,NDCG@5:0.3912) test=(HR@5:0.5281,NDCG@5:0.3752) [10.6 s] 
INFO:root:all_losses: [0.09911522]
INFO:root:Epoch 26    loss=0.0991 [21.4 s]	 dev=(HR@5:0.5525,NDCG@5:0.3948) test=(HR@5:0.5175,NDCG@5:0.3737) [10.6 s] 
INFO:root:all_losses: [0.09982332]
INFO:root:Epoch 27    loss=0.0998 [21.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.4028) test=(HR@5:0.5419,NDCG@5:0.3802) [10.7 s] 
INFO:root:all_losses: [0.09864357]
INFO:root:Epoch 28    loss=0.0986 [21.5 s]	 dev=(HR@5:0.5461,NDCG@5:0.3896) test=(HR@5:0.5101,NDCG@5:0.3687) [10.6 s] 
INFO:root:all_losses: [0.09644078]
INFO:root:Epoch 29    loss=0.0964 [21.5 s]	 dev=(HR@5:0.5376,NDCG@5:0.3860) test=(HR@5:0.5154,NDCG@5:0.3732) [10.6 s] 
INFO:root:all_losses: [0.09432716]
INFO:root:Epoch 30    loss=0.0943 [21.4 s]	 dev=(HR@5:0.5398,NDCG@5:0.3876) test=(HR@5:0.5302,NDCG@5:0.3772) [10.5 s] 
INFO:root:all_losses: [0.09337172]
INFO:root:Epoch 31    loss=0.0934 [21.4 s]	 dev=(HR@5:0.5610,NDCG@5:0.4040) test=(HR@5:0.5313,NDCG@5:0.3744) [10.6 s] 
INFO:root:all_losses: [0.09190001]
INFO:root:Epoch 32    loss=0.0919 [21.5 s]	 dev=(HR@5:0.5620,NDCG@5:0.3961) test=(HR@5:0.5387,NDCG@5:0.3824) [10.6 s] 
INFO:root:all_losses: [0.09340962]
INFO:root:Epoch 33    loss=0.0934 [21.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.3943) test=(HR@5:0.5111,NDCG@5:0.3629) [10.6 s] 
INFO:root:all_losses: [0.08928475]
INFO:root:Epoch 34    loss=0.0893 [21.5 s]	 dev=(HR@5:0.5525,NDCG@5:0.3984) test=(HR@5:0.5069,NDCG@5:0.3626) [10.5 s] 
INFO:root:all_losses: [0.08829092]
INFO:root:Epoch 35    loss=0.0883 [21.5 s]	 dev=(HR@5:0.5483,NDCG@5:0.3948) test=(HR@5:0.5143,NDCG@5:0.3638) [10.6 s] 
INFO:root:all_losses: [0.09161304]
INFO:root:Epoch 36    loss=0.0916 [21.3 s]	 dev=(HR@5:0.5536,NDCG@5:0.4048) test=(HR@5:0.5175,NDCG@5:0.3694) [10.6 s] 
INFO:root:all_losses: [0.0866623]
INFO:root:Epoch 37    loss=0.0867 [21.4 s]	 dev=(HR@5:0.5631,NDCG@5:0.3994) test=(HR@5:0.5111,NDCG@5:0.3730) [10.6 s] 
INFO:root:all_losses: [0.0856455]
INFO:root:Epoch 38    loss=0.0856 [21.5 s]	 dev=(HR@5:0.5779,NDCG@5:0.4072) test=(HR@5:0.5175,NDCG@5:0.3669) [10.5 s] 
INFO:root:all_losses: [0.08614052]
INFO:root:Epoch 39    loss=0.0861 [21.5 s]	 dev=(HR@5:0.5620,NDCG@5:0.3968) test=(HR@5:0.5090,NDCG@5:0.3661) [10.6 s] 
INFO:root:all_losses: [0.08719268]
INFO:root:Epoch 40    loss=0.0872 [21.5 s]	 dev=(HR@5:0.5684,NDCG@5:0.4009) test=(HR@5:0.5217,NDCG@5:0.3630) [10.5 s] 
INFO:root:all_losses: [0.08540486]
INFO:root:Epoch 41    loss=0.0854 [21.5 s]	 dev=(HR@5:0.5472,NDCG@5:0.3886) test=(HR@5:0.5133,NDCG@5:0.3697) [10.6 s] 
INFO:root:all_losses: [0.08417715]
INFO:root:Epoch 42    loss=0.0842 [21.4 s]	 dev=(HR@5:0.5599,NDCG@5:0.3996) test=(HR@5:0.5048,NDCG@5:0.3600) [10.6 s] 
INFO:root:all_losses: [0.08366366]
INFO:root:Epoch 43    loss=0.0837 [21.5 s]	 dev=(HR@5:0.5483,NDCG@5:0.3892) test=(HR@5:0.5037,NDCG@5:0.3583) [10.6 s] 
INFO:root:all_losses: [0.08116619]
INFO:root:Epoch 44    loss=0.0812 [21.4 s]	 dev=(HR@5:0.5440,NDCG@5:0.3865) test=(HR@5:0.5122,NDCG@5:0.3660) [10.6 s] 
INFO:root:Early stop at 44 based on dev result.
INFO:root:
Best Iter(dev)=   24	 dev=(HR@5:0.5663,NDCG@5:0.4123) test=(HR@5:0.5260,NDCG@5:0.3740) [1409.8 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.6946,HR@5:0.5260,HR@50:0.9449,NDCG@10:0.4290,NDCG@5:0.3740,NDCG@50:0.4870)
INFO:root:
--------------------------------------------- END: 2025-06-10 09:07:42 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-10 12:01:15 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 1            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 108800
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.0933,HR@5:0.0467,HR@50:0.4899,NDCG@10:0.0444,NDCG@5:0.0297,NDCG@50:0.1281)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.3652756]
INFO:root:Epoch 1     loss=0.3653 [13.7 s]	 dev=(HR@5:0.4857,NDCG@5:0.3351) test=(HR@5:0.4486,NDCG@5:0.2949) [10.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.21578477]
INFO:root:Epoch 2     loss=0.2158 [13.9 s]	 dev=(HR@5:0.4772,NDCG@5:0.3340) test=(HR@5:0.4401,NDCG@5:0.3002) [10.6 s] 
INFO:root:all_losses: [0.19266096]
INFO:root:Epoch 3     loss=0.1927 [13.8 s]	 dev=(HR@5:0.4920,NDCG@5:0.3455) test=(HR@5:0.4740,NDCG@5:0.3232) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1829209]
INFO:root:Epoch 4     loss=0.1829 [14.0 s]	 dev=(HR@5:0.5292,NDCG@5:0.3663) test=(HR@5:0.4793,NDCG@5:0.3320) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.17048708]
INFO:root:Epoch 5     loss=0.1705 [15.0 s]	 dev=(HR@5:0.5260,NDCG@5:0.3652) test=(HR@5:0.4857,NDCG@5:0.3389) [10.4 s] 
INFO:root:all_losses: [0.16385081]
INFO:root:Epoch 6     loss=0.1639 [15.0 s]	 dev=(HR@5:0.5483,NDCG@5:0.3795) test=(HR@5:0.4942,NDCG@5:0.3522) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.15380833]
INFO:root:Epoch 7     loss=0.1538 [15.2 s]	 dev=(HR@5:0.5493,NDCG@5:0.3803) test=(HR@5:0.4920,NDCG@5:0.3414) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1451542]
INFO:root:Epoch 8     loss=0.1452 [15.0 s]	 dev=(HR@5:0.5631,NDCG@5:0.3923) test=(HR@5:0.5122,NDCG@5:0.3554) [10.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1403782]
INFO:root:Epoch 9     loss=0.1404 [15.2 s]	 dev=(HR@5:0.5589,NDCG@5:0.3926) test=(HR@5:0.5101,NDCG@5:0.3626) [10.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.13452712]
INFO:root:Epoch 10    loss=0.1345 [15.1 s]	 dev=(HR@5:0.5684,NDCG@5:0.3917) test=(HR@5:0.5217,NDCG@5:0.3670) [10.6 s] 
INFO:root:all_losses: [0.12858753]
INFO:root:Epoch 11    loss=0.1286 [15.1 s]	 dev=(HR@5:0.5525,NDCG@5:0.3894) test=(HR@5:0.5037,NDCG@5:0.3590) [10.5 s] 
INFO:root:all_losses: [0.1246948]
INFO:root:Epoch 12    loss=0.1247 [15.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.3901) test=(HR@5:0.5249,NDCG@5:0.3730) [10.6 s] 
INFO:root:all_losses: [0.12029722]
INFO:root:Epoch 13    loss=0.1203 [15.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3906) test=(HR@5:0.5196,NDCG@5:0.3617) [10.4 s] 
INFO:root:all_losses: [0.11953982]
INFO:root:Epoch 14    loss=0.1195 [15.1 s]	 dev=(HR@5:0.5620,NDCG@5:0.4031) test=(HR@5:0.5196,NDCG@5:0.3689) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11483645]
INFO:root:Epoch 15    loss=0.1148 [15.0 s]	 dev=(HR@5:0.5546,NDCG@5:0.3927) test=(HR@5:0.5376,NDCG@5:0.3782) [10.5 s] 
INFO:root:all_losses: [0.11240472]
INFO:root:Epoch 16    loss=0.1124 [15.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3937) test=(HR@5:0.5175,NDCG@5:0.3693) [10.6 s] 
INFO:root:all_losses: [0.10931198]
INFO:root:Epoch 17    loss=0.1093 [15.1 s]	 dev=(HR@5:0.5514,NDCG@5:0.3847) test=(HR@5:0.5313,NDCG@5:0.3785) [10.5 s] 
INFO:root:all_losses: [0.10508838]
INFO:root:Epoch 18    loss=0.1051 [15.2 s]	 dev=(HR@5:0.5472,NDCG@5:0.3823) test=(HR@5:0.5228,NDCG@5:0.3614) [10.5 s] 
INFO:root:all_losses: [0.10311133]
INFO:root:Epoch 19    loss=0.1031 [15.2 s]	 dev=(HR@5:0.5705,NDCG@5:0.3931) test=(HR@5:0.5260,NDCG@5:0.3671) [10.6 s] 
INFO:root:all_losses: [0.10404234]
INFO:root:Epoch 20    loss=0.1040 [15.1 s]	 dev=(HR@5:0.5429,NDCG@5:0.3910) test=(HR@5:0.5196,NDCG@5:0.3668) [10.4 s] 
INFO:root:all_losses: [0.09981311]
INFO:root:Epoch 21    loss=0.0998 [15.1 s]	 dev=(HR@5:0.5217,NDCG@5:0.3734) test=(HR@5:0.5154,NDCG@5:0.3611) [10.5 s] 
INFO:root:all_losses: [0.09981294]
INFO:root:Epoch 22    loss=0.0998 [15.1 s]	 dev=(HR@5:0.5239,NDCG@5:0.3703) test=(HR@5:0.5270,NDCG@5:0.3646) [10.5 s] 
INFO:root:all_losses: [0.09835213]
INFO:root:Epoch 23    loss=0.0984 [15.1 s]	 dev=(HR@5:0.5461,NDCG@5:0.3847) test=(HR@5:0.5239,NDCG@5:0.3666) [10.5 s] 
INFO:root:all_losses: [0.09762645]
INFO:root:Epoch 24    loss=0.0976 [15.1 s]	 dev=(HR@5:0.5228,NDCG@5:0.3745) test=(HR@5:0.5133,NDCG@5:0.3558) [10.5 s] 
INFO:root:all_losses: [0.09594591]
INFO:root:Epoch 25    loss=0.0959 [15.1 s]	 dev=(HR@5:0.5334,NDCG@5:0.3837) test=(HR@5:0.5398,NDCG@5:0.3753) [10.5 s] 
INFO:root:all_losses: [0.09430762]
INFO:root:Epoch 26    loss=0.0943 [15.0 s]	 dev=(HR@5:0.5398,NDCG@5:0.3827) test=(HR@5:0.5419,NDCG@5:0.3784) [10.5 s] 
INFO:root:all_losses: [0.09497384]
INFO:root:Epoch 27    loss=0.0950 [15.0 s]	 dev=(HR@5:0.5122,NDCG@5:0.3684) test=(HR@5:0.5217,NDCG@5:0.3671) [10.4 s] 
INFO:root:all_losses: [0.09281895]
INFO:root:Epoch 28    loss=0.0928 [15.3 s]	 dev=(HR@5:0.5398,NDCG@5:0.3870) test=(HR@5:0.5281,NDCG@5:0.3758) [10.5 s] 
INFO:root:all_losses: [0.09361576]
INFO:root:Epoch 29    loss=0.0936 [15.1 s]	 dev=(HR@5:0.5398,NDCG@5:0.3890) test=(HR@5:0.5376,NDCG@5:0.3738) [10.5 s] 
INFO:root:all_losses: [0.09076706]
INFO:root:Epoch 30    loss=0.0908 [15.2 s]	 dev=(HR@5:0.5281,NDCG@5:0.3753) test=(HR@5:0.5387,NDCG@5:0.3800) [10.6 s] 
INFO:root:all_losses: [0.08867002]
INFO:root:Epoch 31    loss=0.0887 [15.1 s]	 dev=(HR@5:0.5323,NDCG@5:0.3753) test=(HR@5:0.5345,NDCG@5:0.3755) [10.5 s] 
INFO:root:all_losses: [0.08952197]
INFO:root:Epoch 32    loss=0.0895 [15.1 s]	 dev=(HR@5:0.5175,NDCG@5:0.3745) test=(HR@5:0.5387,NDCG@5:0.3769) [10.5 s] 
INFO:root:all_losses: [0.0909579]
INFO:root:Epoch 33    loss=0.0910 [15.1 s]	 dev=(HR@5:0.5239,NDCG@5:0.3737) test=(HR@5:0.5313,NDCG@5:0.3610) [10.5 s] 
INFO:root:all_losses: [0.08642013]
INFO:root:Epoch 34    loss=0.0864 [15.1 s]	 dev=(HR@5:0.5249,NDCG@5:0.3811) test=(HR@5:0.5143,NDCG@5:0.3626) [10.5 s] 
INFO:root:Early stop at 34 based on dev result.
INFO:root:
Best Iter(dev)=   14	 dev=(HR@5:0.5620,NDCG@5:0.4031) test=(HR@5:0.5196,NDCG@5:0.3689) [866.0 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.6755,HR@5:0.5196,HR@50:0.9385,NDCG@10:0.4191,NDCG@5:0.3689,NDCG@50:0.4798)
INFO:root:
--------------------------------------------- END: 2025-06-10 12:15:52 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-10 16:56:06 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 0            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 87744
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList()
)
INFO:root:Test Before Training: (HR@10:0.0954,HR@5:0.0403,HR@50:0.4857,NDCG@10:0.0415,NDCG@5:0.0239,NDCG@50:0.1231)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.47170827]
INFO:root:Epoch 1     loss=0.4717 [6.8 s]	 dev=(HR@5:0.2259,NDCG@5:0.1479) test=(HR@5:0.2153,NDCG@5:0.1471) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.39721534]
INFO:root:Epoch 2     loss=0.3972 [7.6 s]	 dev=(HR@5:0.2312,NDCG@5:0.1445) test=(HR@5:0.2025,NDCG@5:0.1385) [10.9 s] 
INFO:root:all_losses: [0.38954797]
INFO:root:Epoch 3     loss=0.3895 [7.5 s]	 dev=(HR@5:0.2375,NDCG@5:0.1541) test=(HR@5:0.2312,NDCG@5:0.1542) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.37870145]
INFO:root:Epoch 4     loss=0.3787 [7.6 s]	 dev=(HR@5:0.2789,NDCG@5:0.1854) test=(HR@5:0.2503,NDCG@5:0.1673) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.35623753]
INFO:root:Epoch 5     loss=0.3562 [7.7 s]	 dev=(HR@5:0.3330,NDCG@5:0.2213) test=(HR@5:0.2948,NDCG@5:0.1998) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.32731384]
INFO:root:Epoch 6     loss=0.3273 [7.7 s]	 dev=(HR@5:0.3754,NDCG@5:0.2612) test=(HR@5:0.3330,NDCG@5:0.2261) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.30240378]
INFO:root:Epoch 7     loss=0.3024 [7.6 s]	 dev=(HR@5:0.4168,NDCG@5:0.2934) test=(HR@5:0.3722,NDCG@5:0.2586) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.27782908]
INFO:root:Epoch 8     loss=0.2778 [7.7 s]	 dev=(HR@5:0.4348,NDCG@5:0.3074) test=(HR@5:0.4072,NDCG@5:0.2753) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.2587221]
INFO:root:Epoch 9     loss=0.2587 [7.7 s]	 dev=(HR@5:0.4517,NDCG@5:0.3145) test=(HR@5:0.4284,NDCG@5:0.2884) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.24440862]
INFO:root:Epoch 10    loss=0.2444 [7.8 s]	 dev=(HR@5:0.4655,NDCG@5:0.3257) test=(HR@5:0.4464,NDCG@5:0.2978) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.23426959]
INFO:root:Epoch 11    loss=0.2343 [7.8 s]	 dev=(HR@5:0.4655,NDCG@5:0.3285) test=(HR@5:0.4507,NDCG@5:0.3017) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.2299745]
INFO:root:Epoch 12    loss=0.2300 [7.7 s]	 dev=(HR@5:0.4772,NDCG@5:0.3305) test=(HR@5:0.4464,NDCG@5:0.3013) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.22632027]
INFO:root:Epoch 13    loss=0.2263 [7.6 s]	 dev=(HR@5:0.4793,NDCG@5:0.3317) test=(HR@5:0.4486,NDCG@5:0.3013) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.2248069]
INFO:root:Epoch 14    loss=0.2248 [7.8 s]	 dev=(HR@5:0.4793,NDCG@5:0.3305) test=(HR@5:0.4486,NDCG@5:0.3031) [11.0 s] 
INFO:root:all_losses: [0.22295329]
INFO:root:Epoch 15    loss=0.2230 [7.7 s]	 dev=(HR@5:0.4899,NDCG@5:0.3380) test=(HR@5:0.4602,NDCG@5:0.3072) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.22052193]
INFO:root:Epoch 16    loss=0.2205 [7.6 s]	 dev=(HR@5:0.4952,NDCG@5:0.3426) test=(HR@5:0.4592,NDCG@5:0.3139) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.21766184]
INFO:root:Epoch 17    loss=0.2177 [7.7 s]	 dev=(HR@5:0.4963,NDCG@5:0.3431) test=(HR@5:0.4581,NDCG@5:0.3101) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.21468213]
INFO:root:Epoch 18    loss=0.2147 [7.7 s]	 dev=(HR@5:0.4942,NDCG@5:0.3433) test=(HR@5:0.4624,NDCG@5:0.3105) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.21507597]
INFO:root:Epoch 19    loss=0.2151 [7.7 s]	 dev=(HR@5:0.5005,NDCG@5:0.3513) test=(HR@5:0.4698,NDCG@5:0.3219) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.21197583]
INFO:root:Epoch 20    loss=0.2120 [7.8 s]	 dev=(HR@5:0.5143,NDCG@5:0.3568) test=(HR@5:0.4793,NDCG@5:0.3244) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.20866732]
INFO:root:Epoch 21    loss=0.2087 [7.7 s]	 dev=(HR@5:0.4963,NDCG@5:0.3539) test=(HR@5:0.4708,NDCG@5:0.3280) [10.9 s] 
INFO:root:all_losses: [0.21090095]
INFO:root:Epoch 22    loss=0.2109 [7.7 s]	 dev=(HR@5:0.4963,NDCG@5:0.3522) test=(HR@5:0.4783,NDCG@5:0.3296) [11.0 s] 
INFO:root:all_losses: [0.20959146]
INFO:root:Epoch 23    loss=0.2096 [7.7 s]	 dev=(HR@5:0.5069,NDCG@5:0.3585) test=(HR@5:0.4825,NDCG@5:0.3294) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.20592113]
INFO:root:Epoch 24    loss=0.2059 [7.7 s]	 dev=(HR@5:0.5164,NDCG@5:0.3654) test=(HR@5:0.4740,NDCG@5:0.3286) [10.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.20582783]
INFO:root:Epoch 25    loss=0.2058 [7.7 s]	 dev=(HR@5:0.5090,NDCG@5:0.3628) test=(HR@5:0.4825,NDCG@5:0.3324) [10.9 s] 
INFO:root:all_losses: [0.20540738]
INFO:root:Epoch 26    loss=0.2054 [7.7 s]	 dev=(HR@5:0.5122,NDCG@5:0.3645) test=(HR@5:0.4846,NDCG@5:0.3374) [10.9 s] 
INFO:root:all_losses: [0.20257027]
INFO:root:Epoch 27    loss=0.2026 [7.7 s]	 dev=(HR@5:0.5111,NDCG@5:0.3673) test=(HR@5:0.4836,NDCG@5:0.3349) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.20136482]
INFO:root:Epoch 28    loss=0.2014 [7.7 s]	 dev=(HR@5:0.5111,NDCG@5:0.3652) test=(HR@5:0.4666,NDCG@5:0.3278) [10.8 s] 
INFO:root:all_losses: [0.20049672]
INFO:root:Epoch 29    loss=0.2005 [7.7 s]	 dev=(HR@5:0.5122,NDCG@5:0.3640) test=(HR@5:0.4899,NDCG@5:0.3407) [10.9 s] 
INFO:root:all_losses: [0.19735384]
INFO:root:Epoch 30    loss=0.1974 [7.7 s]	 dev=(HR@5:0.5164,NDCG@5:0.3689) test=(HR@5:0.4857,NDCG@5:0.3401) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1948657]
INFO:root:Epoch 31    loss=0.1949 [7.7 s]	 dev=(HR@5:0.5228,NDCG@5:0.3682) test=(HR@5:0.4836,NDCG@5:0.3385) [11.0 s] 
INFO:root:all_losses: [0.19510508]
INFO:root:Epoch 32    loss=0.1951 [7.6 s]	 dev=(HR@5:0.5164,NDCG@5:0.3643) test=(HR@5:0.4920,NDCG@5:0.3429) [10.9 s] 
INFO:root:all_losses: [0.1944024]
INFO:root:Epoch 33    loss=0.1944 [7.7 s]	 dev=(HR@5:0.5228,NDCG@5:0.3720) test=(HR@5:0.4963,NDCG@5:0.3424) [11.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.19185922]
INFO:root:Epoch 34    loss=0.1919 [7.7 s]	 dev=(HR@5:0.5090,NDCG@5:0.3626) test=(HR@5:0.4889,NDCG@5:0.3394) [11.0 s] 
INFO:root:all_losses: [0.18926573]
INFO:root:Epoch 35    loss=0.1893 [7.7 s]	 dev=(HR@5:0.5111,NDCG@5:0.3614) test=(HR@5:0.4857,NDCG@5:0.3396) [10.9 s] 
INFO:root:all_losses: [0.1909053]
INFO:root:Epoch 36    loss=0.1909 [7.6 s]	 dev=(HR@5:0.5175,NDCG@5:0.3656) test=(HR@5:0.4825,NDCG@5:0.3345) [10.9 s] 
INFO:root:all_losses: [0.18694007]
INFO:root:Epoch 37    loss=0.1869 [7.7 s]	 dev=(HR@5:0.5186,NDCG@5:0.3709) test=(HR@5:0.4973,NDCG@5:0.3463) [11.0 s] 
INFO:root:all_losses: [0.18494219]
INFO:root:Epoch 38    loss=0.1849 [7.7 s]	 dev=(HR@5:0.5164,NDCG@5:0.3701) test=(HR@5:0.4963,NDCG@5:0.3464) [10.9 s] 
INFO:root:all_losses: [0.18399939]
INFO:root:Epoch 39    loss=0.1840 [7.7 s]	 dev=(HR@5:0.5207,NDCG@5:0.3731) test=(HR@5:0.4984,NDCG@5:0.3479) [10.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18606998]
INFO:root:Epoch 40    loss=0.1861 [7.7 s]	 dev=(HR@5:0.5207,NDCG@5:0.3723) test=(HR@5:0.4889,NDCG@5:0.3413) [10.8 s] 
INFO:root:all_losses: [0.18386072]
INFO:root:Epoch 41    loss=0.1839 [7.7 s]	 dev=(HR@5:0.5090,NDCG@5:0.3649) test=(HR@5:0.4973,NDCG@5:0.3487) [10.9 s] 
INFO:root:all_losses: [0.17932919]
INFO:root:Epoch 42    loss=0.1793 [7.7 s]	 dev=(HR@5:0.5111,NDCG@5:0.3612) test=(HR@5:0.4963,NDCG@5:0.3451) [10.9 s] 
INFO:root:all_losses: [0.17793134]
INFO:root:Epoch 43    loss=0.1779 [7.6 s]	 dev=(HR@5:0.5122,NDCG@5:0.3656) test=(HR@5:0.4814,NDCG@5:0.3391) [11.0 s] 
INFO:root:all_losses: [0.17757104]
INFO:root:Epoch 44    loss=0.1776 [7.7 s]	 dev=(HR@5:0.5037,NDCG@5:0.3638) test=(HR@5:0.4836,NDCG@5:0.3416) [10.9 s] 
INFO:root:all_losses: [0.17680931]
INFO:root:Epoch 45    loss=0.1768 [7.7 s]	 dev=(HR@5:0.5164,NDCG@5:0.3665) test=(HR@5:0.4867,NDCG@5:0.3440) [11.0 s] 
INFO:root:all_losses: [0.17665534]
INFO:root:Epoch 46    loss=0.1767 [7.7 s]	 dev=(HR@5:0.5058,NDCG@5:0.3607) test=(HR@5:0.4867,NDCG@5:0.3430) [11.0 s] 
INFO:root:all_losses: [0.17554018]
INFO:root:Epoch 47    loss=0.1755 [7.6 s]	 dev=(HR@5:0.5037,NDCG@5:0.3644) test=(HR@5:0.4899,NDCG@5:0.3443) [10.9 s] 
INFO:root:all_losses: [0.17023213]
INFO:root:Epoch 48    loss=0.1702 [7.7 s]	 dev=(HR@5:0.5069,NDCG@5:0.3609) test=(HR@5:0.4910,NDCG@5:0.3434) [11.0 s] 
INFO:root:all_losses: [0.17091848]
INFO:root:Epoch 49    loss=0.1709 [7.7 s]	 dev=(HR@5:0.5058,NDCG@5:0.3585) test=(HR@5:0.4836,NDCG@5:0.3404) [11.0 s] 
INFO:root:all_losses: [0.17057158]
INFO:root:Epoch 50    loss=0.1706 [7.7 s]	 dev=(HR@5:0.5058,NDCG@5:0.3634) test=(HR@5:0.4899,NDCG@5:0.3446) [10.9 s] 
INFO:root:all_losses: [0.16925144]
INFO:root:Epoch 51    loss=0.1693 [7.7 s]	 dev=(HR@5:0.5069,NDCG@5:0.3664) test=(HR@5:0.4920,NDCG@5:0.3429) [11.0 s] 
INFO:root:all_losses: [0.16648422]
INFO:root:Epoch 52    loss=0.1665 [7.7 s]	 dev=(HR@5:0.5122,NDCG@5:0.3632) test=(HR@5:0.4920,NDCG@5:0.3455) [11.0 s] 
INFO:root:all_losses: [0.16646941]
INFO:root:Epoch 53    loss=0.1665 [7.7 s]	 dev=(HR@5:0.5143,NDCG@5:0.3622) test=(HR@5:0.4867,NDCG@5:0.3376) [10.9 s] 
INFO:root:all_losses: [0.16455363]
INFO:root:Epoch 54    loss=0.1646 [7.7 s]	 dev=(HR@5:0.5101,NDCG@5:0.3611) test=(HR@5:0.4889,NDCG@5:0.3396) [10.9 s] 
INFO:root:all_losses: [0.16244452]
INFO:root:Epoch 55    loss=0.1624 [7.8 s]	 dev=(HR@5:0.5154,NDCG@5:0.3667) test=(HR@5:0.4899,NDCG@5:0.3453) [10.9 s] 
INFO:root:all_losses: [0.16017929]
INFO:root:Epoch 56    loss=0.1602 [7.7 s]	 dev=(HR@5:0.5122,NDCG@5:0.3630) test=(HR@5:0.4857,NDCG@5:0.3423) [10.9 s] 
INFO:root:all_losses: [0.15930192]
INFO:root:Epoch 57    loss=0.1593 [7.7 s]	 dev=(HR@5:0.5080,NDCG@5:0.3610) test=(HR@5:0.4910,NDCG@5:0.3457) [10.9 s] 
INFO:root:all_losses: [0.15941127]
INFO:root:Epoch 58    loss=0.1594 [7.7 s]	 dev=(HR@5:0.5080,NDCG@5:0.3623) test=(HR@5:0.4899,NDCG@5:0.3426) [11.0 s] 
INFO:root:all_losses: [0.15782665]
INFO:root:Epoch 59    loss=0.1578 [7.7 s]	 dev=(HR@5:0.5058,NDCG@5:0.3582) test=(HR@5:0.4804,NDCG@5:0.3394) [10.9 s] 
INFO:root:Early stop at 59 based on dev result.
INFO:root:
Best Iter(dev)=   39	 dev=(HR@5:0.5207,NDCG@5:0.3731) test=(HR@5:0.4984,NDCG@5:0.3479) [1097.2 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.6543,HR@5:0.4984,HR@50:0.9268,NDCG@10:0.3979,NDCG@5:0.3479,NDCG@50:0.4604)
INFO:root:
--------------------------------------------- END: 2025-06-10 17:14:35 ---------------------------------------------
INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2025-06-15 15:35:26 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 2            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 129856
INFO:root:SASRec(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.0976,HR@5:0.0456,HR@50:0.5101,NDCG@10:0.0401,NDCG@5:0.0238,NDCG@50:0.1259)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.34552443]
INFO:root:Epoch 1     loss=0.3455 [21.0 s]	 dev=(HR@5:0.4814,NDCG@5:0.3268) test=(HR@5:0.4263,NDCG@5:0.2866) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.20742664]
INFO:root:Epoch 2     loss=0.2074 [20.9 s]	 dev=(HR@5:0.4942,NDCG@5:0.3370) test=(HR@5:0.4433,NDCG@5:0.3044) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18851171]
INFO:root:Epoch 3     loss=0.1885 [21.0 s]	 dev=(HR@5:0.5111,NDCG@5:0.3461) test=(HR@5:0.4836,NDCG@5:0.3315) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.18015169]
INFO:root:Epoch 4     loss=0.1802 [20.9 s]	 dev=(HR@5:0.5164,NDCG@5:0.3535) test=(HR@5:0.4783,NDCG@5:0.3221) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.17051198]
INFO:root:Epoch 5     loss=0.1705 [21.1 s]	 dev=(HR@5:0.5313,NDCG@5:0.3696) test=(HR@5:0.5037,NDCG@5:0.3489) [10.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.16579078]
INFO:root:Epoch 6     loss=0.1658 [21.0 s]	 dev=(HR@5:0.5567,NDCG@5:0.3848) test=(HR@5:0.4984,NDCG@5:0.3555) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1559705]
INFO:root:Epoch 7     loss=0.1560 [21.1 s]	 dev=(HR@5:0.5440,NDCG@5:0.3797) test=(HR@5:0.4910,NDCG@5:0.3451) [10.5 s] 
INFO:root:all_losses: [0.14753613]
INFO:root:Epoch 8     loss=0.1475 [21.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.3981) test=(HR@5:0.5292,NDCG@5:0.3715) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.14327341]
INFO:root:Epoch 9     loss=0.1433 [21.0 s]	 dev=(HR@5:0.5557,NDCG@5:0.3888) test=(HR@5:0.5133,NDCG@5:0.3566) [10.7 s] 
INFO:root:all_losses: [0.13917857]
INFO:root:Epoch 10    loss=0.1392 [20.9 s]	 dev=(HR@5:0.5642,NDCG@5:0.3955) test=(HR@5:0.5143,NDCG@5:0.3575) [10.5 s] 
INFO:root:all_losses: [0.13571477]
INFO:root:Epoch 11    loss=0.1357 [21.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.3953) test=(HR@5:0.5111,NDCG@5:0.3652) [10.6 s] 
INFO:root:all_losses: [0.1308516]
INFO:root:Epoch 12    loss=0.1309 [21.0 s]	 dev=(HR@5:0.5695,NDCG@5:0.4030) test=(HR@5:0.5080,NDCG@5:0.3596) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.1279025]
INFO:root:Epoch 13    loss=0.1279 [20.8 s]	 dev=(HR@5:0.5642,NDCG@5:0.4018) test=(HR@5:0.5090,NDCG@5:0.3653) [10.5 s] 
INFO:root:all_losses: [0.12712689]
INFO:root:Epoch 14    loss=0.1271 [20.9 s]	 dev=(HR@5:0.5748,NDCG@5:0.4012) test=(HR@5:0.5186,NDCG@5:0.3762) [10.7 s] 
INFO:root:all_losses: [0.12306365]
INFO:root:Epoch 15    loss=0.1231 [20.9 s]	 dev=(HR@5:0.5536,NDCG@5:0.3921) test=(HR@5:0.5175,NDCG@5:0.3705) [10.5 s] 
INFO:root:all_losses: [0.12176248]
INFO:root:Epoch 16    loss=0.1218 [21.1 s]	 dev=(HR@5:0.5557,NDCG@5:0.4010) test=(HR@5:0.5143,NDCG@5:0.3677) [10.6 s] 
INFO:root:all_losses: [0.11585876]
INFO:root:Epoch 17    loss=0.1159 [21.0 s]	 dev=(HR@5:0.5546,NDCG@5:0.3963) test=(HR@5:0.5101,NDCG@5:0.3689) [10.5 s] 
INFO:root:all_losses: [0.11291775]
INFO:root:Epoch 18    loss=0.1129 [21.0 s]	 dev=(HR@5:0.5684,NDCG@5:0.4060) test=(HR@5:0.5408,NDCG@5:0.3795) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.11019979]
INFO:root:Epoch 19    loss=0.1102 [20.9 s]	 dev=(HR@5:0.5705,NDCG@5:0.3998) test=(HR@5:0.5323,NDCG@5:0.3716) [10.6 s] 
INFO:root:all_losses: [0.11073221]
INFO:root:Epoch 20    loss=0.1107 [20.9 s]	 dev=(HR@5:0.5578,NDCG@5:0.4106) test=(HR@5:0.5090,NDCG@5:0.3639) [10.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10628572]
INFO:root:Epoch 21    loss=0.1063 [20.8 s]	 dev=(HR@5:0.5567,NDCG@5:0.3984) test=(HR@5:0.5408,NDCG@5:0.3811) [10.6 s] 
INFO:root:all_losses: [0.10613006]
INFO:root:Epoch 22    loss=0.1061 [20.9 s]	 dev=(HR@5:0.5589,NDCG@5:0.3966) test=(HR@5:0.5334,NDCG@5:0.3759) [10.7 s] 
INFO:root:all_losses: [0.10520048]
INFO:root:Epoch 23    loss=0.1052 [20.9 s]	 dev=(HR@5:0.5631,NDCG@5:0.4022) test=(HR@5:0.5260,NDCG@5:0.3790) [10.6 s] 
INFO:root:all_losses: [0.10454699]
INFO:root:Epoch 24    loss=0.1045 [22.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.4123) test=(HR@5:0.5260,NDCG@5:0.3740) [10.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e...
INFO:root:all_losses: [0.10040787]
INFO:root:Epoch 25    loss=0.1004 [22.3 s]	 dev=(HR@5:0.5408,NDCG@5:0.3912) test=(HR@5:0.5281,NDCG@5:0.3752) [10.6 s] 
INFO:root:all_losses: [0.09911522]
INFO:root:Epoch 26    loss=0.0991 [22.1 s]	 dev=(HR@5:0.5525,NDCG@5:0.3948) test=(HR@5:0.5175,NDCG@5:0.3737) [10.8 s] 
INFO:root:all_losses: [0.09982332]
INFO:root:Epoch 27    loss=0.0998 [22.7 s]	 dev=(HR@5:0.5567,NDCG@5:0.4028) test=(HR@5:0.5419,NDCG@5:0.3802) [10.6 s] 
INFO:root:all_losses: [0.09864357]
INFO:root:Epoch 28    loss=0.0986 [22.7 s]	 dev=(HR@5:0.5461,NDCG@5:0.3896) test=(HR@5:0.5101,NDCG@5:0.3687) [10.6 s] 
INFO:root:all_losses: [0.09644078]
INFO:root:Epoch 29    loss=0.0964 [22.7 s]	 dev=(HR@5:0.5376,NDCG@5:0.3860) test=(HR@5:0.5154,NDCG@5:0.3732) [10.7 s] 
INFO:root:all_losses: [0.09432716]
INFO:root:Epoch 30    loss=0.0943 [22.8 s]	 dev=(HR@5:0.5398,NDCG@5:0.3876) test=(HR@5:0.5302,NDCG@5:0.3772) [10.6 s] 
INFO:root:all_losses: [0.09337172]
INFO:root:Epoch 31    loss=0.0934 [94.7 s]	 dev=(HR@5:0.5610,NDCG@5:0.4040) test=(HR@5:0.5313,NDCG@5:0.3744) [11.2 s] 
INFO:root:all_losses: [0.09190001]
INFO:root:Epoch 32    loss=0.0919 [140.4 s]	 dev=(HR@5:0.5620,NDCG@5:0.3961) test=(HR@5:0.5387,NDCG@5:0.3824) [11.2 s] 
INFO:root:all_losses: [0.09340962]
INFO:root:Epoch 33    loss=0.0934 [140.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.3943) test=(HR@5:0.5111,NDCG@5:0.3629) [11.2 s] 
INFO:root:all_losses: [0.08928475]
INFO:root:Epoch 34    loss=0.0893 [140.4 s]	 dev=(HR@5:0.5525,NDCG@5:0.3984) test=(HR@5:0.5069,NDCG@5:0.3626) [11.2 s] 
INFO:root:all_losses: [0.08829092]
INFO:root:Epoch 35    loss=0.0883 [140.9 s]	 dev=(HR@5:0.5483,NDCG@5:0.3948) test=(HR@5:0.5143,NDCG@5:0.3638) [11.1 s] 
INFO:root:all_losses: [0.09161304]
INFO:root:Epoch 36    loss=0.0916 [140.7 s]	 dev=(HR@5:0.5536,NDCG@5:0.4048) test=(HR@5:0.5175,NDCG@5:0.3694) [11.2 s] 
INFO:root:all_losses: [0.0866623]
INFO:root:Epoch 37    loss=0.0867 [106.9 s]	 dev=(HR@5:0.5631,NDCG@5:0.3994) test=(HR@5:0.5111,NDCG@5:0.3730) [10.8 s] 
INFO:root:all_losses: [0.0856455]
INFO:root:Epoch 38    loss=0.0856 [22.9 s]	 dev=(HR@5:0.5779,NDCG@5:0.4072) test=(HR@5:0.5175,NDCG@5:0.3669) [11.1 s] 
INFO:root:all_losses: [0.08614052]
INFO:root:Epoch 39    loss=0.0861 [21.8 s]	 dev=(HR@5:0.5620,NDCG@5:0.3968) test=(HR@5:0.5090,NDCG@5:0.3661) [10.6 s] 
INFO:root:all_losses: [0.08719268]
INFO:root:Epoch 40    loss=0.0872 [21.0 s]	 dev=(HR@5:0.5684,NDCG@5:0.4009) test=(HR@5:0.5217,NDCG@5:0.3630) [10.5 s] 
INFO:root:all_losses: [0.08540486]
INFO:root:Epoch 41    loss=0.0854 [21.0 s]	 dev=(HR@5:0.5472,NDCG@5:0.3886) test=(HR@5:0.5133,NDCG@5:0.3697) [10.6 s] 
INFO:root:all_losses: [0.08417715]
INFO:root:Epoch 42    loss=0.0842 [20.9 s]	 dev=(HR@5:0.5599,NDCG@5:0.3996) test=(HR@5:0.5048,NDCG@5:0.3600) [10.7 s] 
INFO:root:all_losses: [0.08366366]
INFO:root:Epoch 43    loss=0.0837 [21.0 s]	 dev=(HR@5:0.5483,NDCG@5:0.3892) test=(HR@5:0.5037,NDCG@5:0.3583) [10.5 s] 
INFO:root:all_losses: [0.08116619]
INFO:root:Epoch 44    loss=0.0812 [21.0 s]	 dev=(HR@5:0.5440,NDCG@5:0.3865) test=(HR@5:0.5122,NDCG@5:0.3660) [10.6 s] 
INFO:root:Early stop at 44 based on dev result.
INFO:root:
Best Iter(dev)=   24	 dev=(HR@5:0.5663,NDCG@5:0.4123) test=(HR@5:0.5260,NDCG@5:0.3740) [2164.6 s] 
INFO:root:Load model from ../model/SASRec/SASRec_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.6946,HR@5:0.5260,HR@50:0.9449,NDCG@10:0.4290,NDCG@5:0.3740,NDCG@50:0.4870)
INFO:root:
--------------------------------------------- END: 2025-06-15 16:11:42 ---------------------------------------------
