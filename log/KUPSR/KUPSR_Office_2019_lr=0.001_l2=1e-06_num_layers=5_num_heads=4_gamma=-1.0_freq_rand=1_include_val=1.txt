INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 20:41:55 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Reading data from "../data/", dataset = "Office" 
INFO:root:Counting dataset statistics...
INFO:root:"# user": 4906, "# item": 2421, "# entry": 53258
INFO:root:Appending history info...
INFO:root:Constructing relation triplets...
INFO:root:Item-item relations:['r_complement', 'r_substitute']
INFO:root:Attribute-based relations:['i_category', 'i_brand']
INFO:root:"# relation": 5, "# triplet": 60706
INFO:root:Save corpus to ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 20:46:07 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 20:47:40 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 20:51:14 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 20:59:14 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:04:56 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:07:35 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:11:15 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:13:23 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:27:02 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:28:11 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:32:20 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2996026 0.6931139]
INFO:root:Epoch 1     loss=1.2996 [21.2 s]	 dev=(HR@5:0.1121,NDCG@5:0.0655) test=(HR@5:0.0718,NDCG@5:0.0416) [40.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2427418 0.6929757]
INFO:root:Epoch 2     loss=1.2427 [20.0 s]	 dev=(HR@5:0.1142,NDCG@5:0.0681) test=(HR@5:0.0738,NDCG@5:0.0432) [40.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2389835 0.6926363]
INFO:root:Epoch 3     loss=1.2390 [20.3 s]	 dev=(HR@5:0.1129,NDCG@5:0.0659) test=(HR@5:0.0742,NDCG@5:0.0420) [40.9 s] 
INFO:root:all_losses: [1.2298429  0.69220537]
INFO:root:Epoch 4     loss=1.2298 [28.3 s]	 dev=(HR@5:0.1203,NDCG@5:0.0696) test=(HR@5:0.0820,NDCG@5:0.0473) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.179809  0.6910004]
INFO:root:Epoch 5     loss=1.1798 [20.0 s]	 dev=(HR@5:0.1751,NDCG@5:0.1070) test=(HR@5:0.1254,NDCG@5:0.0790) [40.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.148393   0.68673044]
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:53:56 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2997766 0.6931139]
INFO:root:Epoch 1     loss=1.2998 [14.7 s]	 dev=(HR@5:0.1123,NDCG@5:0.0655) test=(HR@5:0.0718,NDCG@5:0.0415) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2426369  0.69297606]
INFO:root:Epoch 2     loss=1.2426 [14.0 s]	 dev=(HR@5:0.1140,NDCG@5:0.0676) test=(HR@5:0.0732,NDCG@5:0.0429) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2380412  0.69263333]
INFO:root:Epoch 3     loss=1.2380 [14.1 s]	 dev=(HR@5:0.1140,NDCG@5:0.0677) test=(HR@5:0.0738,NDCG@5:0.0434) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2257574  0.69217896]
INFO:root:Epoch 4     loss=1.2258 [15.7 s]	 dev=(HR@5:0.1197,NDCG@5:0.0684) test=(HR@5:0.0801,NDCG@5:0.0455) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1779264  0.69088894]
INFO:root:Epoch 5     loss=1.1779 [13.8 s]	 dev=(HR@5:0.1788,NDCG@5:0.1085) test=(HR@5:0.1244,NDCG@5:0.0768) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.141806   0.68622786]
INFO:root:Epoch 6     loss=1.1418 [14.0 s]	 dev=(HR@5:0.1702,NDCG@5:0.1046) test=(HR@5:0.1339,NDCG@5:0.0822) [37.2 s] 
INFO:root:all_losses: [1.1072501  0.67499727]
INFO:root:Epoch 7     loss=1.1073 [13.7 s]	 dev=(HR@5:0.1929,NDCG@5:0.1145) test=(HR@5:0.1354,NDCG@5:0.0800) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0576718 0.6456639]
INFO:root:Epoch 8     loss=1.0577 [14.0 s]	 dev=(HR@5:0.2145,NDCG@5:0.1315) test=(HR@5:0.1566,NDCG@5:0.0968) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.96756893 0.5872648 ]
INFO:root:Epoch 9     loss=0.9676 [14.6 s]	 dev=(HR@5:0.2548,NDCG@5:0.1604) test=(HR@5:0.1857,NDCG@5:0.1188) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8503264  0.51260287]
INFO:root:Epoch 10    loss=0.8503 [17.3 s]	 dev=(HR@5:0.3150,NDCG@5:0.2063) test=(HR@5:0.2361,NDCG@5:0.1528) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.73222256 0.43407303]
INFO:root:Epoch 11    loss=0.7322 [17.8 s]	 dev=(HR@5:0.3368,NDCG@5:0.2205) test=(HR@5:0.2642,NDCG@5:0.1720) [43.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6283569  0.36405668]
INFO:root:Epoch 12    loss=0.6284 [17.9 s]	 dev=(HR@5:0.3945,NDCG@5:0.2630) test=(HR@5:0.3113,NDCG@5:0.2053) [44.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.540651  0.3039641]
INFO:root:Epoch 13    loss=0.5407 [17.8 s]	 dev=(HR@5:0.4086,NDCG@5:0.2726) test=(HR@5:0.3193,NDCG@5:0.2121) [44.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.47495395 0.26074046]
INFO:root:Epoch 14    loss=0.4750 [18.0 s]	 dev=(HR@5:0.4267,NDCG@5:0.2887) test=(HR@5:0.3382,NDCG@5:0.2245) [44.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4292447 0.2288303]
INFO:root:Epoch 15    loss=0.4292 [18.0 s]	 dev=(HR@5:0.4147,NDCG@5:0.2799) test=(HR@5:0.3235,NDCG@5:0.2187) [44.0 s] 
INFO:root:all_losses: [0.39244735 0.20235553]
INFO:root:Epoch 16    loss=0.3924 [17.8 s]	 dev=(HR@5:0.4349,NDCG@5:0.2947) test=(HR@5:0.3537,NDCG@5:0.2332) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35844097 0.18205516]
INFO:root:Epoch 17    loss=0.3584 [17.8 s]	 dev=(HR@5:0.4622,NDCG@5:0.3152) test=(HR@5:0.3827,NDCG@5:0.2552) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32070336 0.16220544]
INFO:root:Epoch 18    loss=0.3207 [17.9 s]	 dev=(HR@5:0.4532,NDCG@5:0.3136) test=(HR@5:0.3743,NDCG@5:0.2509) [43.8 s] 
INFO:root:all_losses: [0.30168623 0.1499187 ]
INFO:root:Epoch 19    loss=0.3017 [17.8 s]	 dev=(HR@5:0.4701,NDCG@5:0.3241) test=(HR@5:0.3898,NDCG@5:0.2632) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28481853 0.13882805]
INFO:root:Epoch 20    loss=0.2848 [17.9 s]	 dev=(HR@5:0.4877,NDCG@5:0.3355) test=(HR@5:0.4088,NDCG@5:0.2755) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26423335 0.12956788]
INFO:root:Epoch 21    loss=0.2642 [17.7 s]	 dev=(HR@5:0.4722,NDCG@5:0.3234) test=(HR@5:0.3992,NDCG@5:0.2695) [44.0 s] 
INFO:root:all_losses: [0.25196847 0.12063619]
INFO:root:Epoch 22    loss=0.2520 [17.8 s]	 dev=(HR@5:0.4799,NDCG@5:0.3326) test=(HR@5:0.4118,NDCG@5:0.2764) [43.6 s] 
INFO:root:all_losses: [0.24116825 0.11457653]
INFO:root:Epoch 23    loss=0.2412 [17.7 s]	 dev=(HR@5:0.4767,NDCG@5:0.3320) test=(HR@5:0.4096,NDCG@5:0.2781) [43.8 s] 
INFO:root:all_losses: [0.22522266 0.10830458]
INFO:root:Epoch 24    loss=0.2252 [17.7 s]	 dev=(HR@5:0.4716,NDCG@5:0.3288) test=(HR@5:0.3927,NDCG@5:0.2670) [43.6 s] 
INFO:root:all_losses: [0.21477057 0.10392269]
INFO:root:Epoch 25    loss=0.2148 [17.8 s]	 dev=(HR@5:0.4803,NDCG@5:0.3341) test=(HR@5:0.4018,NDCG@5:0.2761) [43.5 s] 
INFO:root:all_losses: [0.20967472 0.10046405]
INFO:root:Epoch 26    loss=0.2097 [17.7 s]	 dev=(HR@5:0.4805,NDCG@5:0.3365) test=(HR@5:0.4016,NDCG@5:0.2786) [43.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19795091 0.09359914]
INFO:root:Epoch 27    loss=0.1980 [17.8 s]	 dev=(HR@5:0.5040,NDCG@5:0.3528) test=(HR@5:0.4381,NDCG@5:0.3002) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19102171 0.0912117 ]
INFO:root:Epoch 28    loss=0.1910 [17.8 s]	 dev=(HR@5:0.4712,NDCG@5:0.3312) test=(HR@5:0.4018,NDCG@5:0.2752) [43.5 s] 
INFO:root:all_losses: [0.18305849 0.08927061]
INFO:root:Epoch 29    loss=0.1831 [17.7 s]	 dev=(HR@5:0.4722,NDCG@5:0.3342) test=(HR@5:0.4010,NDCG@5:0.2813) [43.6 s] 
INFO:root:all_losses: [0.1781531  0.08731432]
INFO:root:Epoch 30    loss=0.1782 [17.8 s]	 dev=(HR@5:0.4987,NDCG@5:0.3516) test=(HR@5:0.4230,NDCG@5:0.2925) [43.7 s] 
INFO:root:all_losses: [0.17549384 0.08293789]
INFO:root:Epoch 31    loss=0.1755 [18.2 s]	 dev=(HR@5:0.4813,NDCG@5:0.3425) test=(HR@5:0.4116,NDCG@5:0.2846) [43.8 s] 
INFO:root:all_losses: [0.17521837 0.08389506]
INFO:root:Epoch 32    loss=0.1752 [17.8 s]	 dev=(HR@5:0.4942,NDCG@5:0.3480) test=(HR@5:0.4473,NDCG@5:0.3072) [43.5 s] 
INFO:root:all_losses: [0.16374491 0.08033323]
INFO:root:Epoch 33    loss=0.1637 [17.7 s]	 dev=(HR@5:0.4815,NDCG@5:0.3436) test=(HR@5:0.4194,NDCG@5:0.2895) [43.6 s] 
INFO:root:all_losses: [0.15881708 0.07749044]
INFO:root:Epoch 34    loss=0.1588 [17.7 s]	 dev=(HR@5:0.4887,NDCG@5:0.3450) test=(HR@5:0.4045,NDCG@5:0.2827) [43.4 s] 
INFO:root:all_losses: [0.15602894 0.07746546]
INFO:root:Epoch 35    loss=0.1560 [17.8 s]	 dev=(HR@5:0.5083,NDCG@5:0.3590) test=(HR@5:0.4471,NDCG@5:0.3093) [43.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15099213 0.07284315]
INFO:root:Epoch 36    loss=0.1510 [17.8 s]	 dev=(HR@5:0.5013,NDCG@5:0.3532) test=(HR@5:0.4414,NDCG@5:0.3044) [43.4 s] 
INFO:root:all_losses: [0.14926274 0.07294018]
INFO:root:Epoch 37    loss=0.1493 [17.7 s]	 dev=(HR@5:0.5138,NDCG@5:0.3602) test=(HR@5:0.4659,NDCG@5:0.3230) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14589506 0.07252774]
INFO:root:Epoch 38    loss=0.1459 [18.1 s]	 dev=(HR@5:0.5109,NDCG@5:0.3626) test=(HR@5:0.4534,NDCG@5:0.3139) [43.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13958336 0.07066401]
INFO:root:Epoch 39    loss=0.1396 [17.7 s]	 dev=(HR@5:0.5142,NDCG@5:0.3647) test=(HR@5:0.4642,NDCG@5:0.3200) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14128481 0.06912506]
INFO:root:Epoch 40    loss=0.1413 [17.8 s]	 dev=(HR@5:0.5036,NDCG@5:0.3560) test=(HR@5:0.4510,NDCG@5:0.3130) [43.4 s] 
INFO:root:all_losses: [0.13799879 0.06739209]
INFO:root:Epoch 41    loss=0.1380 [17.8 s]	 dev=(HR@5:0.4608,NDCG@5:0.3266) test=(HR@5:0.3957,NDCG@5:0.2738) [43.3 s] 
INFO:root:all_losses: [0.1352478  0.06935804]
INFO:root:Epoch 42    loss=0.1352 [17.7 s]	 dev=(HR@5:0.4942,NDCG@5:0.3523) test=(HR@5:0.4234,NDCG@5:0.2920) [43.4 s] 
INFO:root:all_losses: [0.1324937  0.06419992]
INFO:root:Epoch 43    loss=0.1325 [18.7 s]	 dev=(HR@5:0.4742,NDCG@5:0.3355) test=(HR@5:0.4116,NDCG@5:0.2888) [43.2 s] 
INFO:root:all_losses: [0.13261025 0.06509049]
INFO:root:Epoch 44    loss=0.1326 [17.7 s]	 dev=(HR@5:0.5060,NDCG@5:0.3597) test=(HR@5:0.4402,NDCG@5:0.3072) [43.2 s] 
INFO:root:all_losses: [0.12747924 0.06321263]
INFO:root:Epoch 45    loss=0.1275 [17.8 s]	 dev=(HR@5:0.5011,NDCG@5:0.3524) test=(HR@5:0.4338,NDCG@5:0.3027) [43.3 s] 
INFO:root:all_losses: [0.1264784 0.0650277]
INFO:root:Epoch 46    loss=0.1265 [17.7 s]	 dev=(HR@5:0.5001,NDCG@5:0.3553) test=(HR@5:0.4385,NDCG@5:0.3043) [43.1 s] 
INFO:root:all_losses: [0.12073244 0.06018694]
INFO:root:Epoch 47    loss=0.1207 [17.7 s]	 dev=(HR@5:0.5068,NDCG@5:0.3531) test=(HR@5:0.4487,NDCG@5:0.3079) [43.2 s] 
INFO:root:all_losses: [0.12367081 0.06164265]
INFO:root:Epoch 48    loss=0.1237 [18.1 s]	 dev=(HR@5:0.5162,NDCG@5:0.3671) test=(HR@5:0.4473,NDCG@5:0.3163) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11988328 0.05931884]
INFO:root:Epoch 49    loss=0.1199 [17.8 s]	 dev=(HR@5:0.5034,NDCG@5:0.3557) test=(HR@5:0.4389,NDCG@5:0.3076) [43.2 s] 
INFO:root:all_losses: [0.1174966  0.05991771]
INFO:root:Epoch 50    loss=0.1175 [17.7 s]	 dev=(HR@5:0.5032,NDCG@5:0.3602) test=(HR@5:0.4504,NDCG@5:0.3152) [43.3 s] 
INFO:root:all_losses: [0.11729889 0.05849055]
INFO:root:Epoch 51    loss=0.1173 [17.2 s]	 dev=(HR@5:0.4762,NDCG@5:0.3395) test=(HR@5:0.4112,NDCG@5:0.2882) [43.3 s] 
INFO:root:all_losses: [0.11454535 0.05783579]
INFO:root:Epoch 52    loss=0.1145 [17.7 s]	 dev=(HR@5:0.5007,NDCG@5:0.3601) test=(HR@5:0.4420,NDCG@5:0.3060) [43.2 s] 
INFO:root:all_losses: [0.11203588 0.05658645]
INFO:root:Epoch 53    loss=0.1120 [17.7 s]	 dev=(HR@5:0.4938,NDCG@5:0.3503) test=(HR@5:0.4359,NDCG@5:0.3039) [43.4 s] 
INFO:root:all_losses: [0.11329491 0.05766583]
INFO:root:Epoch 54    loss=0.1133 [17.6 s]	 dev=(HR@5:0.5050,NDCG@5:0.3564) test=(HR@5:0.4522,NDCG@5:0.3117) [43.1 s] 
INFO:root:all_losses: [0.11127777 0.05657918]
INFO:root:Epoch 55    loss=0.1113 [17.7 s]	 dev=(HR@5:0.4864,NDCG@5:0.3468) test=(HR@5:0.4334,NDCG@5:0.3050) [43.3 s] 
INFO:root:all_losses: [0.11360968 0.0570516 ]
INFO:root:Epoch 56    loss=0.1136 [17.8 s]	 dev=(HR@5:0.4905,NDCG@5:0.3474) test=(HR@5:0.4359,NDCG@5:0.3039) [43.2 s] 
INFO:root:all_losses: [0.10648157 0.05424504]
INFO:root:Epoch 57    loss=0.1065 [17.8 s]	 dev=(HR@5:0.4999,NDCG@5:0.3541) test=(HR@5:0.4555,NDCG@5:0.3162) [43.1 s] 
INFO:root:all_losses: [0.10529157 0.05294987]
INFO:root:Epoch 58    loss=0.1053 [17.7 s]	 dev=(HR@5:0.4903,NDCG@5:0.3468) test=(HR@5:0.4396,NDCG@5:0.3077) [43.1 s] 
INFO:root:all_losses: [0.10755325 0.05587001]
INFO:root:Epoch 59    loss=0.1076 [17.7 s]	 dev=(HR@5:0.4866,NDCG@5:0.3438) test=(HR@5:0.4542,NDCG@5:0.3142) [42.9 s] 
INFO:root:all_losses: [0.10215282 0.05245838]
INFO:root:Epoch 60    loss=0.1022 [17.8 s]	 dev=(HR@5:0.4911,NDCG@5:0.3486) test=(HR@5:0.4275,NDCG@5:0.2986) [43.0 s] 
INFO:root:all_losses: [0.09828305 0.04935924]
INFO:root:Epoch 61    loss=0.0983 [17.9 s]	 dev=(HR@5:0.4970,NDCG@5:0.3537) test=(HR@5:0.4383,NDCG@5:0.3049) [43.1 s] 
INFO:root:all_losses: [0.1054232 0.0527775]
INFO:root:Epoch 62    loss=0.1054 [17.8 s]	 dev=(HR@5:0.5011,NDCG@5:0.3564) test=(HR@5:0.4440,NDCG@5:0.3052) [43.0 s] 
INFO:root:all_losses: [0.09727816 0.04949357]
INFO:root:Epoch 63    loss=0.0973 [17.8 s]	 dev=(HR@5:0.5009,NDCG@5:0.3573) test=(HR@5:0.4654,NDCG@5:0.3240) [43.0 s] 
INFO:root:all_losses: [0.09642196 0.04951315]
INFO:root:Epoch 64    loss=0.0964 [17.8 s]	 dev=(HR@5:0.5019,NDCG@5:0.3589) test=(HR@5:0.4518,NDCG@5:0.3145) [43.0 s] 
INFO:root:all_losses: [0.09370605 0.04797333]
INFO:root:Epoch 65    loss=0.0937 [17.8 s]	 dev=(HR@5:0.4881,NDCG@5:0.3512) test=(HR@5:0.4381,NDCG@5:0.3058) [42.8 s] 
INFO:root:all_losses: [0.09664255 0.04964411]
INFO:root:Epoch 66    loss=0.0966 [17.8 s]	 dev=(HR@5:0.5009,NDCG@5:0.3558) test=(HR@5:0.4485,NDCG@5:0.3126) [42.9 s] 
INFO:root:all_losses: [0.09896393 0.05074379]
INFO:root:Epoch 67    loss=0.0990 [17.9 s]	 dev=(HR@5:0.4991,NDCG@5:0.3562) test=(HR@5:0.4481,NDCG@5:0.3085) [42.9 s] 
INFO:root:all_losses: [0.09455861 0.04820597]
INFO:root:Epoch 68    loss=0.0946 [17.8 s]	 dev=(HR@5:0.5054,NDCG@5:0.3602) test=(HR@5:0.4491,NDCG@5:0.3107) [43.1 s] 
INFO:root:Early stop at 68 based on dev result.
INFO:root:
Best Iter(dev)=   48	 dev=(HR@5:0.5162,NDCG@5:0.3671) test=(HR@5:0.4473,NDCG@5:0.3163) [4073.9 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6098,HR@5:0.4473,HR@50:0.8838,NDCG@10:0.3689,NDCG@5:0.3163,NDCG@50:0.4304)
INFO:root:
--------------------------------------------- END: 2024-12-29 23:02:31 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 15:34:18 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2997332 0.6931139]
INFO:root:Epoch 1     loss=1.2997 [16.6 s]	 dev=(HR@5:0.1117,NDCG@5:0.0653) test=(HR@5:0.0716,NDCG@5:0.0415) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242992  0.6929765]
INFO:root:Epoch 2     loss=1.2430 [16.3 s]	 dev=(HR@5:0.1125,NDCG@5:0.0677) test=(HR@5:0.0730,NDCG@5:0.0434) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2395202 0.6926399]
INFO:root:Epoch 3     loss=1.2395 [16.3 s]	 dev=(HR@5:0.1131,NDCG@5:0.0671) test=(HR@5:0.0738,NDCG@5:0.0424) [36.6 s] 
INFO:root:all_losses: [1.2346845 0.6922344]
INFO:root:Epoch 4     loss=1.2347 [21.0 s]	 dev=(HR@5:0.1140,NDCG@5:0.0666) test=(HR@5:0.0738,NDCG@5:0.0428) [36.9 s] 
INFO:root:all_losses: [1.2041109 0.6916167]
INFO:root:Epoch 5     loss=1.2041 [18.8 s]	 dev=(HR@5:0.1668,NDCG@5:0.1006) test=(HR@5:0.1182,NDCG@5:0.0718) [38.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1595266 0.688318 ]
INFO:root:Epoch 6     loss=1.1595 [16.1 s]	 dev=(HR@5:0.1717,NDCG@5:0.1078) test=(HR@5:0.1368,NDCG@5:0.0857) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1207224  0.67906934]
INFO:root:Epoch 7     loss=1.1207 [15.8 s]	 dev=(HR@5:0.1939,NDCG@5:0.1165) test=(HR@5:0.1388,NDCG@5:0.0840) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0721763 0.6540234]
INFO:root:Epoch 8     loss=1.0722 [15.5 s]	 dev=(HR@5:0.2601,NDCG@5:0.1593) test=(HR@5:0.1863,NDCG@5:0.1158) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.98344696 0.60118186]
INFO:root:Epoch 9     loss=0.9834 [16.4 s]	 dev=(HR@5:0.3099,NDCG@5:0.2008) test=(HR@5:0.2453,NDCG@5:0.1568) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.869718   0.53175575]
INFO:root:Epoch 10    loss=0.8697 [18.8 s]	 dev=(HR@5:0.3519,NDCG@5:0.2281) test=(HR@5:0.2679,NDCG@5:0.1753) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.76090294 0.45900524]
INFO:root:Epoch 11    loss=0.7609 [19.6 s]	 dev=(HR@5:0.3831,NDCG@5:0.2493) test=(HR@5:0.2987,NDCG@5:0.1957) [44.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6552033  0.38625857]
INFO:root:Epoch 12    loss=0.6552 [19.8 s]	 dev=(HR@5:0.4084,NDCG@5:0.2709) test=(HR@5:0.3191,NDCG@5:0.2114) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.56221116 0.31881067]
INFO:root:Epoch 13    loss=0.5622 [19.6 s]	 dev=(HR@5:0.4133,NDCG@5:0.2747) test=(HR@5:0.3246,NDCG@5:0.2148) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.48844436 0.26915416]
INFO:root:Epoch 14    loss=0.4884 [20.6 s]	 dev=(HR@5:0.4328,NDCG@5:0.2922) test=(HR@5:0.3366,NDCG@5:0.2231) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.43748257 0.23227131]
INFO:root:Epoch 15    loss=0.4375 [24.8 s]	 dev=(HR@5:0.4479,NDCG@5:0.3022) test=(HR@5:0.3651,NDCG@5:0.2421) [44.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.39710462 0.20312485]
INFO:root:Epoch 16    loss=0.3971 [19.3 s]	 dev=(HR@5:0.4459,NDCG@5:0.3039) test=(HR@5:0.3586,NDCG@5:0.2383) [43.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.36557546 0.18176384]
INFO:root:Epoch 17    loss=0.3656 [19.4 s]	 dev=(HR@5:0.4728,NDCG@5:0.3187) test=(HR@5:0.3884,NDCG@5:0.2576) [43.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3272259  0.16058445]
INFO:root:Epoch 18    loss=0.3272 [19.8 s]	 dev=(HR@5:0.4632,NDCG@5:0.3175) test=(HR@5:0.3725,NDCG@5:0.2520) [43.5 s] 
INFO:root:all_losses: [0.31091866 0.14883061]
INFO:root:Epoch 19    loss=0.3109 [19.4 s]	 dev=(HR@5:0.4705,NDCG@5:0.3266) test=(HR@5:0.3886,NDCG@5:0.2678) [43.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29050186 0.1373463 ]
INFO:root:Epoch 20    loss=0.2905 [19.3 s]	 dev=(HR@5:0.4775,NDCG@5:0.3269) test=(HR@5:0.4008,NDCG@5:0.2721) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27215347 0.12866671]
INFO:root:Epoch 21    loss=0.2722 [19.7 s]	 dev=(HR@5:0.4919,NDCG@5:0.3374) test=(HR@5:0.4283,NDCG@5:0.2900) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26111695 0.11984331]
INFO:root:Epoch 22    loss=0.2611 [19.8 s]	 dev=(HR@5:0.4887,NDCG@5:0.3401) test=(HR@5:0.4157,NDCG@5:0.2837) [43.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24680085 0.11304873]
INFO:root:Epoch 23    loss=0.2468 [19.3 s]	 dev=(HR@5:0.4901,NDCG@5:0.3425) test=(HR@5:0.4285,NDCG@5:0.2897) [43.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23458579 0.10809962]
INFO:root:Epoch 24    loss=0.2346 [19.8 s]	 dev=(HR@5:0.4601,NDCG@5:0.3174) test=(HR@5:0.3796,NDCG@5:0.2611) [43.1 s] 
INFO:root:all_losses: [0.22503434 0.10334415]
INFO:root:Epoch 25    loss=0.2250 [19.6 s]	 dev=(HR@5:0.4793,NDCG@5:0.3348) test=(HR@5:0.4096,NDCG@5:0.2825) [43.1 s] 
INFO:root:all_losses: [0.21973324 0.1003724 ]
INFO:root:Epoch 26    loss=0.2197 [19.4 s]	 dev=(HR@5:0.4622,NDCG@5:0.3218) test=(HR@5:0.3855,NDCG@5:0.2669) [42.8 s] 
INFO:root:all_losses: [0.20885803 0.09412619]
INFO:root:Epoch 27    loss=0.2089 [19.3 s]	 dev=(HR@5:0.4917,NDCG@5:0.3414) test=(HR@5:0.4414,NDCG@5:0.3038) [42.7 s] 
INFO:root:all_losses: [0.20267083 0.09143999]
INFO:root:Epoch 28    loss=0.2027 [19.3 s]	 dev=(HR@5:0.4954,NDCG@5:0.3426) test=(HR@5:0.4255,NDCG@5:0.2937) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19308421 0.08902449]
INFO:root:Epoch 29    loss=0.1931 [19.5 s]	 dev=(HR@5:0.4844,NDCG@5:0.3392) test=(HR@5:0.4135,NDCG@5:0.2843) [43.5 s] 
INFO:root:all_losses: [0.19137305 0.08701973]
INFO:root:Epoch 30    loss=0.1914 [20.6 s]	 dev=(HR@5:0.5087,NDCG@5:0.3585) test=(HR@5:0.4489,NDCG@5:0.3097) [44.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18589936 0.08266433]
INFO:root:Epoch 31    loss=0.1859 [22.6 s]	 dev=(HR@5:0.4915,NDCG@5:0.3449) test=(HR@5:0.4239,NDCG@5:0.2940) [43.5 s] 
INFO:root:all_losses: [0.18585458 0.08492756]
INFO:root:Epoch 32    loss=0.1859 [20.6 s]	 dev=(HR@5:0.5034,NDCG@5:0.3541) test=(HR@5:0.4512,NDCG@5:0.3137) [43.3 s] 
INFO:root:all_losses: [0.17599072 0.08069082]
INFO:root:Epoch 33    loss=0.1760 [20.5 s]	 dev=(HR@5:0.4846,NDCG@5:0.3413) test=(HR@5:0.4145,NDCG@5:0.2877) [46.5 s] 
INFO:root:all_losses: [0.17052637 0.07775017]
INFO:root:Epoch 34    loss=0.1705 [20.8 s]	 dev=(HR@5:0.4856,NDCG@5:0.3423) test=(HR@5:0.4157,NDCG@5:0.2901) [46.3 s] 
INFO:root:all_losses: [0.1674813  0.07794689]
INFO:root:Epoch 35    loss=0.1675 [20.6 s]	 dev=(HR@5:0.5056,NDCG@5:0.3533) test=(HR@5:0.4597,NDCG@5:0.3170) [43.1 s] 
INFO:root:all_losses: [0.16287418 0.07393178]
INFO:root:Epoch 36    loss=0.1629 [20.6 s]	 dev=(HR@5:0.4707,NDCG@5:0.3272) test=(HR@5:0.4077,NDCG@5:0.2825) [46.3 s] 
INFO:root:all_losses: [0.16144794 0.07397322]
INFO:root:Epoch 37    loss=0.1614 [20.6 s]	 dev=(HR@5:0.5038,NDCG@5:0.3576) test=(HR@5:0.4516,NDCG@5:0.3141) [46.5 s] 
INFO:root:all_losses: [0.1571324  0.07360406]
INFO:root:Epoch 38    loss=0.1571 [21.4 s]	 dev=(HR@5:0.4977,NDCG@5:0.3501) test=(HR@5:0.4406,NDCG@5:0.3095) [43.1 s] 
INFO:root:all_losses: [0.1524511  0.07146549]
INFO:root:Epoch 39    loss=0.1525 [20.8 s]	 dev=(HR@5:0.5050,NDCG@5:0.3556) test=(HR@5:0.4573,NDCG@5:0.3156) [46.3 s] 
INFO:root:all_losses: [0.15405679 0.06941471]
INFO:root:Epoch 40    loss=0.1541 [20.7 s]	 dev=(HR@5:0.4954,NDCG@5:0.3518) test=(HR@5:0.4614,NDCG@5:0.3184) [46.5 s] 
INFO:root:all_losses: [0.14911596 0.06800088]
INFO:root:Epoch 41    loss=0.1491 [20.7 s]	 dev=(HR@5:0.4846,NDCG@5:0.3404) test=(HR@5:0.4361,NDCG@5:0.3027) [43.1 s] 
INFO:root:all_losses: [0.14686896 0.06989433]
INFO:root:Epoch 42    loss=0.1469 [20.7 s]	 dev=(HR@5:0.4652,NDCG@5:0.3233) test=(HR@5:0.4047,NDCG@5:0.2788) [46.0 s] 
INFO:root:all_losses: [0.14512691 0.06502593]
INFO:root:Epoch 43    loss=0.1451 [20.7 s]	 dev=(HR@5:0.4716,NDCG@5:0.3295) test=(HR@5:0.4220,NDCG@5:0.2931) [46.2 s] 
INFO:root:all_losses: [0.14268059 0.06631465]
INFO:root:Epoch 44    loss=0.1427 [21.0 s]	 dev=(HR@5:0.4599,NDCG@5:0.3254) test=(HR@5:0.4084,NDCG@5:0.2828) [43.0 s] 
INFO:root:all_losses: [0.13929686 0.064798  ]
INFO:root:Epoch 45    loss=0.1393 [20.6 s]	 dev=(HR@5:0.4787,NDCG@5:0.3365) test=(HR@5:0.4226,NDCG@5:0.2942) [46.6 s] 
INFO:root:all_losses: [0.13865949 0.06595312]
INFO:root:Epoch 46    loss=0.1387 [20.7 s]	 dev=(HR@5:0.4915,NDCG@5:0.3498) test=(HR@5:0.4310,NDCG@5:0.3029) [47.2 s] 
INFO:root:all_losses: [0.13383956 0.06123851]
INFO:root:Epoch 47    loss=0.1338 [21.2 s]	 dev=(HR@5:0.4907,NDCG@5:0.3449) test=(HR@5:0.4349,NDCG@5:0.3032) [42.9 s] 
INFO:root:all_losses: [0.13825786 0.0635101 ]
INFO:root:Epoch 48    loss=0.1383 [22.7 s]	 dev=(HR@5:0.4975,NDCG@5:0.3507) test=(HR@5:0.4424,NDCG@5:0.3093) [44.6 s] 
INFO:root:all_losses: [0.1328133  0.06067573]
INFO:root:Epoch 49    loss=0.1328 [21.2 s]	 dev=(HR@5:0.4722,NDCG@5:0.3371) test=(HR@5:0.4024,NDCG@5:0.2819) [45.4 s] 
INFO:root:all_losses: [0.134175   0.06222985]
INFO:root:Epoch 50    loss=0.1342 [20.7 s]	 dev=(HR@5:0.4858,NDCG@5:0.3466) test=(HR@5:0.4324,NDCG@5:0.3045) [42.8 s] 
INFO:root:Early stop at 50 based on dev result.
INFO:root:
Best Iter(dev)=   30	 dev=(HR@5:0.5087,NDCG@5:0.3585) test=(HR@5:0.4489,NDCG@5:0.3097) [3134.1 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6287,HR@5:0.4491,HR@50:0.9032,NDCG@10:0.3680,NDCG@5:0.3097,NDCG@50:0.4301)
INFO:root:
--------------------------------------------- END: 2024-12-30 16:27:16 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 17:08:45 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2996131 0.6931139]
INFO:root:Epoch 1     loss=1.2996 [18.7 s]	 dev=(HR@5:0.1117,NDCG@5:0.0653) test=(HR@5:0.0716,NDCG@5:0.0415) [39.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2428046 0.6929759]
INFO:root:Epoch 2     loss=1.2428 [18.1 s]	 dev=(HR@5:0.1134,NDCG@5:0.0676) test=(HR@5:0.0716,NDCG@5:0.0427) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2392559  0.69263566]
INFO:root:Epoch 3     loss=1.2393 [18.0 s]	 dev=(HR@5:0.1111,NDCG@5:0.0655) test=(HR@5:0.0742,NDCG@5:0.0422) [37.6 s] 
INFO:root:all_losses: [1.2332894 0.6922168]
INFO:root:Epoch 4     loss=1.2333 [23.3 s]	 dev=(HR@5:0.1142,NDCG@5:0.0679) test=(HR@5:0.0775,NDCG@5:0.0445) [39.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1892645 0.69121  ]
INFO:root:Epoch 5     loss=1.1893 [18.2 s]	 dev=(HR@5:0.1766,NDCG@5:0.1066) test=(HR@5:0.1233,NDCG@5:0.0765) [38.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1585437 0.6873559]
INFO:root:Epoch 6     loss=1.1585 [17.8 s]	 dev=(HR@5:0.1719,NDCG@5:0.1083) test=(HR@5:0.1350,NDCG@5:0.0854) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1226206  0.67768097]
INFO:root:Epoch 7     loss=1.1226 [17.8 s]	 dev=(HR@5:0.1861,NDCG@5:0.1121) test=(HR@5:0.1356,NDCG@5:0.0827) [37.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0831807 0.6519331]
INFO:root:Epoch 8     loss=1.0832 [19.2 s]	 dev=(HR@5:0.1835,NDCG@5:0.1138) test=(HR@5:0.1321,NDCG@5:0.0850) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0135995 0.5996887]
INFO:root:Epoch 9     loss=1.0136 [21.7 s]	 dev=(HR@5:0.2137,NDCG@5:0.1328) test=(HR@5:0.1562,NDCG@5:0.0998) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.91100025 0.5305884 ]
INFO:root:Epoch 10    loss=0.9110 [20.5 s]	 dev=(HR@5:0.2850,NDCG@5:0.1860) test=(HR@5:0.2139,NDCG@5:0.1402) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.79799306 0.45595464]
INFO:root:Epoch 11    loss=0.7980 [24.9 s]	 dev=(HR@5:0.3286,NDCG@5:0.2137) test=(HR@5:0.2530,NDCG@5:0.1642) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.690642   0.38423672]
INFO:root:Epoch 12    loss=0.6906 [24.6 s]	 dev=(HR@5:0.3639,NDCG@5:0.2367) test=(HR@5:0.2818,NDCG@5:0.1838) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5941031  0.31896764]
INFO:root:Epoch 13    loss=0.5941 [21.3 s]	 dev=(HR@5:0.3870,NDCG@5:0.2529) test=(HR@5:0.2993,NDCG@5:0.1973) [47.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5203003  0.27181587]
INFO:root:Epoch 14    loss=0.5203 [21.2 s]	 dev=(HR@5:0.3880,NDCG@5:0.2548) test=(HR@5:0.2970,NDCG@5:0.1954) [47.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4703548  0.23776212]
INFO:root:Epoch 15    loss=0.4704 [21.6 s]	 dev=(HR@5:0.4035,NDCG@5:0.2683) test=(HR@5:0.3203,NDCG@5:0.2094) [43.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4303217  0.20983058]
INFO:root:Epoch 16    loss=0.4303 [21.2 s]	 dev=(HR@5:0.4196,NDCG@5:0.2780) test=(HR@5:0.3394,NDCG@5:0.2261) [47.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.39636412 0.18877952]
INFO:root:Epoch 17    loss=0.3964 [21.2 s]	 dev=(HR@5:0.4420,NDCG@5:0.2948) test=(HR@5:0.3649,NDCG@5:0.2383) [47.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3598447  0.16793263]
INFO:root:Epoch 18    loss=0.3598 [21.2 s]	 dev=(HR@5:0.4375,NDCG@5:0.2981) test=(HR@5:0.3586,NDCG@5:0.2376) [43.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33996344 0.15570031]
INFO:root:Epoch 19    loss=0.3400 [23.9 s]	 dev=(HR@5:0.4508,NDCG@5:0.3039) test=(HR@5:0.3817,NDCG@5:0.2552) [45.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31944516 0.14430405]
INFO:root:Epoch 20    loss=0.3194 [24.1 s]	 dev=(HR@5:0.4593,NDCG@5:0.3092) test=(HR@5:0.3810,NDCG@5:0.2545) [44.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29912248 0.13498543]
INFO:root:Epoch 21    loss=0.2991 [21.4 s]	 dev=(HR@5:0.4557,NDCG@5:0.3094) test=(HR@5:0.3890,NDCG@5:0.2613) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28777492 0.1255401 ]
INFO:root:Epoch 22    loss=0.2878 [26.0 s]	 dev=(HR@5:0.4622,NDCG@5:0.3152) test=(HR@5:0.3896,NDCG@5:0.2637) [43.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27244446 0.11880095]
INFO:root:Epoch 23    loss=0.2724 [26.2 s]	 dev=(HR@5:0.4506,NDCG@5:0.3056) test=(HR@5:0.3851,NDCG@5:0.2600) [43.3 s] 
INFO:root:all_losses: [0.2563151 0.1128244]
INFO:root:Epoch 24    loss=0.2563 [21.1 s]	 dev=(HR@5:0.4612,NDCG@5:0.3152) test=(HR@5:0.3863,NDCG@5:0.2630) [46.2 s] 
INFO:root:all_losses: [0.24630366 0.10848806]
INFO:root:Epoch 25    loss=0.2463 [22.0 s]	 dev=(HR@5:0.4716,NDCG@5:0.3232) test=(HR@5:0.3982,NDCG@5:0.2712) [45.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24054061 0.10497269]
INFO:root:Epoch 26    loss=0.2405 [22.3 s]	 dev=(HR@5:0.4624,NDCG@5:0.3143) test=(HR@5:0.3794,NDCG@5:0.2606) [43.3 s] 
INFO:root:all_losses: [0.23022683 0.09846835]
INFO:root:Epoch 27    loss=0.2302 [21.2 s]	 dev=(HR@5:0.4958,NDCG@5:0.3393) test=(HR@5:0.4312,NDCG@5:0.2934) [46.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22109912 0.09565588]
INFO:root:Epoch 28    loss=0.2211 [21.2 s]	 dev=(HR@5:0.4732,NDCG@5:0.3263) test=(HR@5:0.3914,NDCG@5:0.2677) [46.9 s] 
INFO:root:all_losses: [0.21066546 0.0932804 ]
INFO:root:Epoch 29    loss=0.2107 [21.4 s]	 dev=(HR@5:0.4673,NDCG@5:0.3215) test=(HR@5:0.3894,NDCG@5:0.2690) [43.3 s] 
INFO:root:all_losses: [0.20745966 0.09133462]
INFO:root:Epoch 30    loss=0.2075 [21.2 s]	 dev=(HR@5:0.4767,NDCG@5:0.3326) test=(HR@5:0.3992,NDCG@5:0.2764) [46.5 s] 
INFO:root:all_losses: [0.2041432 0.0877739]
INFO:root:Epoch 31    loss=0.2041 [21.2 s]	 dev=(HR@5:0.4746,NDCG@5:0.3309) test=(HR@5:0.3947,NDCG@5:0.2741) [46.0 s] 
INFO:root:all_losses: [0.20330039 0.08835671]
INFO:root:Epoch 32    loss=0.2033 [21.1 s]	 dev=(HR@5:0.4875,NDCG@5:0.3373) test=(HR@5:0.4279,NDCG@5:0.2931) [43.1 s] 
INFO:root:all_losses: [0.190478   0.08387812]
INFO:root:Epoch 33    loss=0.1905 [21.3 s]	 dev=(HR@5:0.4960,NDCG@5:0.3468) test=(HR@5:0.4253,NDCG@5:0.2938) [47.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18590054 0.08133505]
INFO:root:Epoch 34    loss=0.1859 [21.7 s]	 dev=(HR@5:0.4824,NDCG@5:0.3356) test=(HR@5:0.3959,NDCG@5:0.2761) [47.7 s] 
INFO:root:all_losses: [0.18140766 0.08086119]
INFO:root:Epoch 35    loss=0.1814 [21.3 s]	 dev=(HR@5:0.5103,NDCG@5:0.3534) test=(HR@5:0.4434,NDCG@5:0.3077) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17584941 0.07622377]
INFO:root:Epoch 36    loss=0.1758 [21.6 s]	 dev=(HR@5:0.4787,NDCG@5:0.3312) test=(HR@5:0.4175,NDCG@5:0.2878) [46.0 s] 
INFO:root:all_losses: [0.17555219 0.07679991]
INFO:root:Epoch 37    loss=0.1756 [21.8 s]	 dev=(HR@5:0.4779,NDCG@5:0.3334) test=(HR@5:0.4039,NDCG@5:0.2816) [45.7 s] 
INFO:root:all_losses: [0.16901183 0.07587206]
INFO:root:Epoch 38    loss=0.1690 [21.1 s]	 dev=(HR@5:0.4966,NDCG@5:0.3498) test=(HR@5:0.4367,NDCG@5:0.3049) [43.2 s] 
INFO:root:all_losses: [0.16534537 0.0740331 ]
INFO:root:Epoch 39    loss=0.1653 [26.7 s]	 dev=(HR@5:0.5052,NDCG@5:0.3529) test=(HR@5:0.4408,NDCG@5:0.3040) [43.1 s] 
INFO:root:all_losses: [0.1654224  0.07167318]
INFO:root:Epoch 40    loss=0.1654 [26.3 s]	 dev=(HR@5:0.5125,NDCG@5:0.3565) test=(HR@5:0.4595,NDCG@5:0.3175) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16013622 0.07066685]
INFO:root:Epoch 41    loss=0.1601 [21.2 s]	 dev=(HR@5:0.4940,NDCG@5:0.3472) test=(HR@5:0.4326,NDCG@5:0.2992) [43.1 s] 
INFO:root:all_losses: [0.15603898 0.07277083]
INFO:root:Epoch 42    loss=0.1560 [25.5 s]	 dev=(HR@5:0.5015,NDCG@5:0.3559) test=(HR@5:0.4312,NDCG@5:0.3021) [43.1 s] 
INFO:root:all_losses: [0.1549102  0.06691833]
INFO:root:Epoch 43    loss=0.1549 [25.8 s]	 dev=(HR@5:0.4899,NDCG@5:0.3414) test=(HR@5:0.4161,NDCG@5:0.2902) [43.1 s] 
INFO:root:all_losses: [0.15175909 0.06789127]
INFO:root:Epoch 44    loss=0.1518 [21.2 s]	 dev=(HR@5:0.4948,NDCG@5:0.3487) test=(HR@5:0.4290,NDCG@5:0.2988) [46.7 s] 
INFO:root:all_losses: [0.14926143 0.06597321]
INFO:root:Epoch 45    loss=0.1493 [21.2 s]	 dev=(HR@5:0.4901,NDCG@5:0.3471) test=(HR@5:0.4157,NDCG@5:0.2903) [48.0 s] 
INFO:root:all_losses: [0.1476003 0.0682063]
INFO:root:Epoch 46    loss=0.1476 [22.0 s]	 dev=(HR@5:0.5089,NDCG@5:0.3586) test=(HR@5:0.4446,NDCG@5:0.3096) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14354892 0.06348158]
INFO:root:Epoch 47    loss=0.1435 [21.8 s]	 dev=(HR@5:0.4934,NDCG@5:0.3455) test=(HR@5:0.4228,NDCG@5:0.2942) [46.4 s] 
INFO:root:all_losses: [0.14422984 0.06462134]
INFO:root:Epoch 48    loss=0.1442 [21.8 s]	 dev=(HR@5:0.4999,NDCG@5:0.3592) test=(HR@5:0.4440,NDCG@5:0.3069) [46.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14178339 0.06271515]
INFO:root:Epoch 49    loss=0.1418 [21.9 s]	 dev=(HR@5:0.5017,NDCG@5:0.3578) test=(HR@5:0.4524,NDCG@5:0.3141) [43.4 s] 
INFO:root:all_losses: [0.14034599 0.06371198]
INFO:root:Epoch 50    loss=0.1403 [21.9 s]	 dev=(HR@5:0.4911,NDCG@5:0.3482) test=(HR@5:0.4196,NDCG@5:0.2926) [47.4 s] 
INFO:root:all_losses: [0.13832097 0.06314369]
INFO:root:Epoch 51    loss=0.1383 [21.9 s]	 dev=(HR@5:0.5034,NDCG@5:0.3574) test=(HR@5:0.4373,NDCG@5:0.3042) [47.2 s] 
INFO:root:all_losses: [0.13360795 0.06091838]
INFO:root:Epoch 52    loss=0.1336 [21.3 s]	 dev=(HR@5:0.5089,NDCG@5:0.3638) test=(HR@5:0.4438,NDCG@5:0.3085) [42.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13117403 0.0601111 ]
INFO:root:Epoch 53    loss=0.1312 [22.7 s]	 dev=(HR@5:0.4968,NDCG@5:0.3535) test=(HR@5:0.4465,NDCG@5:0.3073) [44.7 s] 
INFO:root:all_losses: [0.13168734 0.06042897]
INFO:root:Epoch 54    loss=0.1317 [22.5 s]	 dev=(HR@5:0.4862,NDCG@5:0.3416) test=(HR@5:0.4283,NDCG@5:0.2939) [44.9 s] 
INFO:root:all_losses: [0.12968306 0.05954034]
INFO:root:Epoch 55    loss=0.1297 [21.1 s]	 dev=(HR@5:0.4954,NDCG@5:0.3501) test=(HR@5:0.4261,NDCG@5:0.2977) [42.7 s] 
INFO:root:all_losses: [0.13229224 0.06018275]
INFO:root:Epoch 56    loss=0.1323 [26.2 s]	 dev=(HR@5:0.5056,NDCG@5:0.3560) test=(HR@5:0.4491,NDCG@5:0.3096) [43.1 s] 
INFO:root:all_losses: [0.12529297 0.0567167 ]
INFO:root:Epoch 57    loss=0.1253 [26.3 s]	 dev=(HR@5:0.5123,NDCG@5:0.3571) test=(HR@5:0.4695,NDCG@5:0.3214) [42.7 s] 
INFO:root:all_losses: [0.12438589 0.05699547]
INFO:root:Epoch 58    loss=0.1244 [21.1 s]	 dev=(HR@5:0.4966,NDCG@5:0.3499) test=(HR@5:0.4302,NDCG@5:0.2987) [43.9 s] 
INFO:root:all_losses: [0.12893482 0.05981565]
INFO:root:Epoch 59    loss=0.1289 [23.4 s]	 dev=(HR@5:0.4701,NDCG@5:0.3287) test=(HR@5:0.4084,NDCG@5:0.2874) [43.0 s] 
INFO:root:all_losses: [0.12080093 0.05521936]
INFO:root:Epoch 60    loss=0.1208 [24.0 s]	 dev=(HR@5:0.5032,NDCG@5:0.3568) test=(HR@5:0.4436,NDCG@5:0.3099) [42.9 s] 
INFO:root:all_losses: [0.11868446 0.05210252]
INFO:root:Epoch 61    loss=0.1187 [21.1 s]	 dev=(HR@5:0.4938,NDCG@5:0.3497) test=(HR@5:0.4234,NDCG@5:0.2974) [46.3 s] 
INFO:root:all_losses: [0.12402883 0.05613657]
INFO:root:Epoch 62    loss=0.1240 [21.2 s]	 dev=(HR@5:0.4960,NDCG@5:0.3521) test=(HR@5:0.4446,NDCG@5:0.3090) [46.5 s] 
INFO:root:all_losses: [0.11770515 0.05322144]
INFO:root:Epoch 63    loss=0.1177 [21.1 s]	 dev=(HR@5:0.4989,NDCG@5:0.3540) test=(HR@5:0.4520,NDCG@5:0.3167) [42.6 s] 
INFO:root:all_losses: [0.1136985  0.05220345]
INFO:root:Epoch 64    loss=0.1137 [21.2 s]	 dev=(HR@5:0.5032,NDCG@5:0.3556) test=(HR@5:0.4467,NDCG@5:0.3092) [45.9 s] 
INFO:root:all_losses: [0.11463084 0.05132065]
INFO:root:Epoch 65    loss=0.1146 [21.1 s]	 dev=(HR@5:0.5023,NDCG@5:0.3533) test=(HR@5:0.4402,NDCG@5:0.3051) [46.0 s] 
INFO:root:all_losses: [0.11587123 0.0536004 ]
INFO:root:Epoch 66    loss=0.1159 [21.3 s]	 dev=(HR@5:0.5015,NDCG@5:0.3529) test=(HR@5:0.4361,NDCG@5:0.3018) [42.9 s] 
INFO:root:all_losses: [0.11676479 0.05286359]
INFO:root:Epoch 67    loss=0.1168 [21.1 s]	 dev=(HR@5:0.4936,NDCG@5:0.3476) test=(HR@5:0.4408,NDCG@5:0.3058) [45.9 s] 
INFO:root:all_losses: [0.11554115 0.05196823]
INFO:root:Epoch 68    loss=0.1155 [21.1 s]	 dev=(HR@5:0.4985,NDCG@5:0.3522) test=(HR@5:0.4292,NDCG@5:0.3019) [45.8 s] 
INFO:root:all_losses: [0.11326335 0.05251621]
INFO:root:Epoch 69    loss=0.1133 [21.1 s]	 dev=(HR@5:0.4885,NDCG@5:0.3511) test=(HR@5:0.4228,NDCG@5:0.2986) [42.6 s] 
INFO:root:all_losses: [0.11576223 0.05326519]
INFO:root:Epoch 70    loss=0.1158 [26.5 s]	 dev=(HR@5:0.4869,NDCG@5:0.3472) test=(HR@5:0.4234,NDCG@5:0.2964) [42.5 s] 
INFO:root:all_losses: [0.11098086 0.05094413]
INFO:root:Epoch 71    loss=0.1110 [26.7 s]	 dev=(HR@5:0.4907,NDCG@5:0.3478) test=(HR@5:0.4135,NDCG@5:0.2870) [42.5 s] 
INFO:root:all_losses: [0.1085413  0.05122667]
INFO:root:Epoch 72    loss=0.1085 [21.2 s]	 dev=(HR@5:0.4903,NDCG@5:0.3471) test=(HR@5:0.4234,NDCG@5:0.2942) [44.5 s] 
INFO:root:Early stop at 72 based on dev result.
INFO:root:
Best Iter(dev)=   52	 dev=(HR@5:0.5089,NDCG@5:0.3638) test=(HR@5:0.4438,NDCG@5:0.3085) [4749.9 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6039,HR@5:0.4438,HR@50:0.8897,NDCG@10:0.3603,NDCG@5:0.3084,NDCG@50:0.4241)
INFO:root:
--------------------------------------------- END: 2024-12-30 18:28:37 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 20:10:15 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2996086 0.6931139]
INFO:root:Epoch 1     loss=1.2996 [17.7 s]	 dev=(HR@5:0.1119,NDCG@5:0.0654) test=(HR@5:0.0712,NDCG@5:0.0413) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242942   0.69297606]
INFO:root:Epoch 2     loss=1.2429 [17.7 s]	 dev=(HR@5:0.1142,NDCG@5:0.0685) test=(HR@5:0.0740,NDCG@5:0.0433) [37.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2393477 0.6926374]
INFO:root:Epoch 3     loss=1.2393 [17.4 s]	 dev=(HR@5:0.1115,NDCG@5:0.0660) test=(HR@5:0.0748,NDCG@5:0.0427) [37.5 s] 
INFO:root:all_losses: [1.2351588 0.6922426]
INFO:root:Epoch 4     loss=1.2352 [28.3 s]	 dev=(HR@5:0.1134,NDCG@5:0.0668) test=(HR@5:0.0722,NDCG@5:0.0421) [37.6 s] 
INFO:root:all_losses: [1.2231334  0.69182956]
INFO:root:Epoch 5     loss=1.2231 [23.9 s]	 dev=(HR@5:0.1170,NDCG@5:0.0690) test=(HR@5:0.0773,NDCG@5:0.0444) [39.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1762373 0.6896391]
INFO:root:Epoch 6     loss=1.1762 [17.1 s]	 dev=(HR@5:0.1702,NDCG@5:0.1043) test=(HR@5:0.1348,NDCG@5:0.0819) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.133974  0.6827183]
INFO:root:Epoch 7     loss=1.1340 [16.9 s]	 dev=(HR@5:0.1855,NDCG@5:0.1103) test=(HR@5:0.1335,NDCG@5:0.0807) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0948577 0.662558 ]
INFO:root:Epoch 8     loss=1.0949 [16.6 s]	 dev=(HR@5:0.1904,NDCG@5:0.1172) test=(HR@5:0.1380,NDCG@5:0.0850) [39.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0186439 0.6104717]
INFO:root:Epoch 9     loss=1.0186 [17.8 s]	 dev=(HR@5:0.2345,NDCG@5:0.1461) test=(HR@5:0.1729,NDCG@5:0.1110) [38.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9009479 0.5342747]
INFO:root:Epoch 10    loss=0.9009 [20.8 s]	 dev=(HR@5:0.2848,NDCG@5:0.1837) test=(HR@5:0.2177,NDCG@5:0.1411) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.78220505 0.45819658]
INFO:root:Epoch 11    loss=0.7822 [20.5 s]	 dev=(HR@5:0.3651,NDCG@5:0.2380) test=(HR@5:0.2854,NDCG@5:0.1872) [44.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.67410386 0.3895766 ]
INFO:root:Epoch 12    loss=0.6741 [23.2 s]	 dev=(HR@5:0.4053,NDCG@5:0.2662) test=(HR@5:0.3176,NDCG@5:0.2094) [45.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.57820535 0.32602137]
INFO:root:Epoch 13    loss=0.5782 [20.6 s]	 dev=(HR@5:0.4169,NDCG@5:0.2791) test=(HR@5:0.3252,NDCG@5:0.2136) [48.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.50541294 0.2784612 ]
INFO:root:Epoch 14    loss=0.5054 [20.7 s]	 dev=(HR@5:0.4261,NDCG@5:0.2875) test=(HR@5:0.3337,NDCG@5:0.2220) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.45359555 0.2427884 ]
INFO:root:Epoch 15    loss=0.4536 [20.8 s]	 dev=(HR@5:0.4420,NDCG@5:0.2987) test=(HR@5:0.3551,NDCG@5:0.2357) [47.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.41211072 0.2129746 ]
INFO:root:Epoch 16    loss=0.4121 [20.8 s]	 dev=(HR@5:0.4514,NDCG@5:0.3082) test=(HR@5:0.3643,NDCG@5:0.2442) [43.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.37666503 0.19095483]
INFO:root:Epoch 17    loss=0.3767 [26.2 s]	 dev=(HR@5:0.4634,NDCG@5:0.3144) test=(HR@5:0.3794,NDCG@5:0.2540) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33818132 0.1691982 ]
INFO:root:Epoch 18    loss=0.3382 [20.7 s]	 dev=(HR@5:0.4614,NDCG@5:0.3215) test=(HR@5:0.3802,NDCG@5:0.2603) [43.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32015494 0.15613198]
INFO:root:Epoch 19    loss=0.3202 [20.8 s]	 dev=(HR@5:0.4846,NDCG@5:0.3344) test=(HR@5:0.4039,NDCG@5:0.2750) [48.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29724073 0.14460072]
INFO:root:Epoch 20    loss=0.2972 [20.9 s]	 dev=(HR@5:0.4860,NDCG@5:0.3361) test=(HR@5:0.4259,NDCG@5:0.2876) [47.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27665117 0.13424405]
INFO:root:Epoch 21    loss=0.2767 [20.7 s]	 dev=(HR@5:0.4930,NDCG@5:0.3407) test=(HR@5:0.4251,NDCG@5:0.2896) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26598126 0.1252602 ]
INFO:root:Epoch 22    loss=0.2660 [20.7 s]	 dev=(HR@5:0.4834,NDCG@5:0.3366) test=(HR@5:0.4149,NDCG@5:0.2862) [43.9 s] 
INFO:root:all_losses: [0.25150004 0.1176201 ]
INFO:root:Epoch 23    loss=0.2515 [25.0 s]	 dev=(HR@5:0.4891,NDCG@5:0.3440) test=(HR@5:0.4326,NDCG@5:0.2963) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23849201 0.1118842 ]
INFO:root:Epoch 24    loss=0.2385 [22.7 s]	 dev=(HR@5:0.4799,NDCG@5:0.3362) test=(HR@5:0.4043,NDCG@5:0.2773) [45.9 s] 
INFO:root:all_losses: [0.22670531 0.10681827]
INFO:root:Epoch 25    loss=0.2267 [20.8 s]	 dev=(HR@5:0.4893,NDCG@5:0.3417) test=(HR@5:0.4202,NDCG@5:0.2897) [43.7 s] 
INFO:root:all_losses: [0.22263198 0.10287082]
INFO:root:Epoch 26    loss=0.2226 [20.8 s]	 dev=(HR@5:0.4771,NDCG@5:0.3315) test=(HR@5:0.3914,NDCG@5:0.2714) [46.9 s] 
INFO:root:all_losses: [0.20999406 0.09655275]
INFO:root:Epoch 27    loss=0.2100 [20.7 s]	 dev=(HR@5:0.5062,NDCG@5:0.3578) test=(HR@5:0.4520,NDCG@5:0.3152) [47.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.20301268 0.0942599 ]
INFO:root:Epoch 28    loss=0.2030 [20.9 s]	 dev=(HR@5:0.4968,NDCG@5:0.3453) test=(HR@5:0.4239,NDCG@5:0.2933) [43.6 s] 
INFO:root:all_losses: [0.19548751 0.0918426 ]
INFO:root:Epoch 29    loss=0.1955 [20.8 s]	 dev=(HR@5:0.4987,NDCG@5:0.3515) test=(HR@5:0.4316,NDCG@5:0.3003) [43.6 s] 
INFO:root:all_losses: [0.19150056 0.08950022]
INFO:root:Epoch 30    loss=0.1915 [25.4 s]	 dev=(HR@5:0.4962,NDCG@5:0.3483) test=(HR@5:0.4141,NDCG@5:0.2891) [44.3 s] 
INFO:root:all_losses: [0.18742993 0.08518536]
INFO:root:Epoch 31    loss=0.1874 [21.1 s]	 dev=(HR@5:0.4801,NDCG@5:0.3390) test=(HR@5:0.3994,NDCG@5:0.2811) [47.2 s] 
INFO:root:all_losses: [0.18646377 0.0860412 ]
INFO:root:Epoch 32    loss=0.1865 [20.7 s]	 dev=(HR@5:0.4846,NDCG@5:0.3429) test=(HR@5:0.4389,NDCG@5:0.3034) [43.5 s] 
INFO:root:all_losses: [0.17504522 0.08263634]
INFO:root:Epoch 33    loss=0.1750 [20.7 s]	 dev=(HR@5:0.4964,NDCG@5:0.3525) test=(HR@5:0.4446,NDCG@5:0.3034) [45.2 s] 
INFO:root:all_losses: [0.17027204 0.07993259]
INFO:root:Epoch 34    loss=0.1703 [19.6 s]	 dev=(HR@5:0.5064,NDCG@5:0.3557) test=(HR@5:0.4269,NDCG@5:0.2983) [43.8 s] 
INFO:root:all_losses: [0.1680099  0.07887979]
INFO:root:Epoch 35    loss=0.1680 [20.6 s]	 dev=(HR@5:0.5115,NDCG@5:0.3641) test=(HR@5:0.4601,NDCG@5:0.3195) [43.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16347443 0.07545135]
INFO:root:Epoch 36    loss=0.1635 [23.2 s]	 dev=(HR@5:0.4924,NDCG@5:0.3466) test=(HR@5:0.4259,NDCG@5:0.2966) [43.4 s] 
INFO:root:all_losses: [0.1596482  0.07424153]
INFO:root:Epoch 37    loss=0.1596 [20.7 s]	 dev=(HR@5:0.5040,NDCG@5:0.3558) test=(HR@5:0.4371,NDCG@5:0.3057) [43.4 s] 
INFO:root:all_losses: [0.15596575 0.07381292]
INFO:root:Epoch 38    loss=0.1560 [20.7 s]	 dev=(HR@5:0.5081,NDCG@5:0.3598) test=(HR@5:0.4442,NDCG@5:0.3123) [47.2 s] 
INFO:root:all_losses: [0.14981347 0.07265013]
INFO:root:Epoch 39    loss=0.1498 [20.8 s]	 dev=(HR@5:0.4972,NDCG@5:0.3527) test=(HR@5:0.4446,NDCG@5:0.3149) [47.4 s] 
INFO:root:all_losses: [0.15381938 0.07023479]
INFO:root:Epoch 40    loss=0.1538 [21.0 s]	 dev=(HR@5:0.5030,NDCG@5:0.3560) test=(HR@5:0.4467,NDCG@5:0.3165) [43.4 s] 
INFO:root:all_losses: [0.14874074 0.06900691]
INFO:root:Epoch 41    loss=0.1487 [20.6 s]	 dev=(HR@5:0.4864,NDCG@5:0.3446) test=(HR@5:0.4275,NDCG@5:0.3032) [46.8 s] 
INFO:root:all_losses: [0.14697501 0.07104506]
INFO:root:Epoch 42    loss=0.1470 [20.7 s]	 dev=(HR@5:0.4987,NDCG@5:0.3561) test=(HR@5:0.4402,NDCG@5:0.3098) [44.1 s] 
INFO:root:all_losses: [0.14361809 0.06521294]
INFO:root:Epoch 43    loss=0.1436 [22.8 s]	 dev=(HR@5:0.4981,NDCG@5:0.3551) test=(HR@5:0.4389,NDCG@5:0.3102) [43.2 s] 
INFO:root:all_losses: [0.14352252 0.0667107 ]
INFO:root:Epoch 44    loss=0.1435 [20.7 s]	 dev=(HR@5:0.4932,NDCG@5:0.3513) test=(HR@5:0.4251,NDCG@5:0.3000) [43.1 s] 
INFO:root:all_losses: [0.1402303 0.063908 ]
INFO:root:Epoch 45    loss=0.1402 [24.8 s]	 dev=(HR@5:0.5023,NDCG@5:0.3559) test=(HR@5:0.4391,NDCG@5:0.3104) [43.2 s] 
INFO:root:all_losses: [0.13723096 0.06690806]
INFO:root:Epoch 46    loss=0.1372 [25.9 s]	 dev=(HR@5:0.5103,NDCG@5:0.3651) test=(HR@5:0.4579,NDCG@5:0.3245) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13227999 0.0609394 ]
INFO:root:Epoch 47    loss=0.1323 [20.7 s]	 dev=(HR@5:0.5056,NDCG@5:0.3621) test=(HR@5:0.4510,NDCG@5:0.3165) [43.0 s] 
INFO:root:all_losses: [0.1339537  0.06324143]
INFO:root:Epoch 48    loss=0.1340 [25.9 s]	 dev=(HR@5:0.5154,NDCG@5:0.3678) test=(HR@5:0.4544,NDCG@5:0.3225) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13279943 0.06059176]
INFO:root:Epoch 49    loss=0.1328 [23.4 s]	 dev=(HR@5:0.4897,NDCG@5:0.3505) test=(HR@5:0.4216,NDCG@5:0.2987) [44.2 s] 
INFO:root:all_losses: [0.12894173 0.06150814]
INFO:root:Epoch 50    loss=0.1289 [20.7 s]	 dev=(HR@5:0.4979,NDCG@5:0.3577) test=(HR@5:0.4391,NDCG@5:0.3132) [43.3 s] 
INFO:root:all_losses: [0.12859222 0.06011776]
INFO:root:Epoch 51    loss=0.1286 [24.9 s]	 dev=(HR@5:0.4950,NDCG@5:0.3533) test=(HR@5:0.4324,NDCG@5:0.3094) [44.7 s] 
INFO:root:all_losses: [0.12375519 0.05878783]
INFO:root:Epoch 52    loss=0.1238 [20.7 s]	 dev=(HR@5:0.5052,NDCG@5:0.3621) test=(HR@5:0.4426,NDCG@5:0.3119) [46.3 s] 
INFO:root:all_losses: [0.12449978 0.05862011]
INFO:root:Epoch 53    loss=0.1245 [20.7 s]	 dev=(HR@5:0.5005,NDCG@5:0.3612) test=(HR@5:0.4493,NDCG@5:0.3182) [42.9 s] 
INFO:root:all_losses: [0.123188   0.05889615]
INFO:root:Epoch 54    loss=0.1232 [20.7 s]	 dev=(HR@5:0.5050,NDCG@5:0.3631) test=(HR@5:0.4512,NDCG@5:0.3164) [46.3 s] 
INFO:root:all_losses: [0.123031   0.05830541]
INFO:root:Epoch 55    loss=0.1230 [20.6 s]	 dev=(HR@5:0.4922,NDCG@5:0.3503) test=(HR@5:0.4206,NDCG@5:0.2973) [46.5 s] 
INFO:root:all_losses: [0.12305683 0.05827263]
INFO:root:Epoch 56    loss=0.1231 [20.6 s]	 dev=(HR@5:0.4972,NDCG@5:0.3515) test=(HR@5:0.4381,NDCG@5:0.3034) [43.0 s] 
INFO:root:all_losses: [0.1178946  0.05574251]
INFO:root:Epoch 57    loss=0.1179 [20.6 s]	 dev=(HR@5:0.5093,NDCG@5:0.3599) test=(HR@5:0.4610,NDCG@5:0.3236) [46.5 s] 
INFO:root:all_losses: [0.11946402 0.05588492]
INFO:root:Epoch 58    loss=0.1195 [20.7 s]	 dev=(HR@5:0.5048,NDCG@5:0.3574) test=(HR@5:0.4449,NDCG@5:0.3128) [45.7 s] 
INFO:root:all_losses: [0.11724487 0.05667777]
INFO:root:Epoch 59    loss=0.1172 [20.7 s]	 dev=(HR@5:0.4901,NDCG@5:0.3510) test=(HR@5:0.4343,NDCG@5:0.3079) [42.8 s] 
INFO:root:all_losses: [0.11377224 0.05440798]
INFO:root:Epoch 60    loss=0.1138 [20.8 s]	 dev=(HR@5:0.4962,NDCG@5:0.3529) test=(HR@5:0.4279,NDCG@5:0.3010) [45.6 s] 
INFO:root:all_losses: [0.11158621 0.0513531 ]
INFO:root:Epoch 61    loss=0.1116 [20.7 s]	 dev=(HR@5:0.5040,NDCG@5:0.3584) test=(HR@5:0.4324,NDCG@5:0.3051) [46.4 s] 
INFO:root:all_losses: [0.11608956 0.05450801]
INFO:root:Epoch 62    loss=0.1161 [20.7 s]	 dev=(HR@5:0.5038,NDCG@5:0.3607) test=(HR@5:0.4512,NDCG@5:0.3181) [42.8 s] 
INFO:root:all_losses: [0.11233989 0.05289398]
INFO:root:Epoch 63    loss=0.1123 [20.8 s]	 dev=(HR@5:0.5001,NDCG@5:0.3566) test=(HR@5:0.4493,NDCG@5:0.3171) [46.4 s] 
INFO:root:all_losses: [0.1080969  0.05143161]
INFO:root:Epoch 64    loss=0.1081 [20.8 s]	 dev=(HR@5:0.5093,NDCG@5:0.3663) test=(HR@5:0.4365,NDCG@5:0.3095) [46.9 s] 
INFO:root:all_losses: [0.10636266 0.05003667]
INFO:root:Epoch 65    loss=0.1064 [22.2 s]	 dev=(HR@5:0.5093,NDCG@5:0.3622) test=(HR@5:0.4512,NDCG@5:0.3156) [43.0 s] 
INFO:root:all_losses: [0.10742658 0.05064588]
INFO:root:Epoch 66    loss=0.1074 [20.9 s]	 dev=(HR@5:0.5103,NDCG@5:0.3654) test=(HR@5:0.4532,NDCG@5:0.3171) [46.3 s] 
INFO:root:all_losses: [0.11194205 0.05344079]
INFO:root:Epoch 67    loss=0.1119 [20.9 s]	 dev=(HR@5:0.4989,NDCG@5:0.3548) test=(HR@5:0.4493,NDCG@5:0.3153) [42.8 s] 
INFO:root:all_losses: [0.10598227 0.05013227]
INFO:root:Epoch 68    loss=0.1060 [25.3 s]	 dev=(HR@5:0.4991,NDCG@5:0.3570) test=(HR@5:0.4281,NDCG@5:0.3040) [43.3 s] 
INFO:root:Early stop at 68 based on dev result.
INFO:root:
Best Iter(dev)=   48	 dev=(HR@5:0.5154,NDCG@5:0.3678) test=(HR@5:0.4544,NDCG@5:0.3225) [4431.9 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6188,HR@5:0.4544,HR@50:0.8895,NDCG@10:0.3760,NDCG@5:0.3227,NDCG@50:0.4371)
INFO:root:
--------------------------------------------- END: 2024-12-30 21:24:48 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-31 09:54:07 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2996073 0.6931139]
INFO:root:Epoch 1     loss=1.2996 [18.8 s]	 dev=(HR@5:0.1119,NDCG@5:0.0654) test=(HR@5:0.0709,NDCG@5:0.0413) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2427292  0.69297594]
INFO:root:Epoch 2     loss=1.2427 [18.2 s]	 dev=(HR@5:0.1164,NDCG@5:0.0688) test=(HR@5:0.0728,NDCG@5:0.0426) [37.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.239692   0.69263685]
INFO:root:Epoch 3     loss=1.2397 [18.2 s]	 dev=(HR@5:0.1138,NDCG@5:0.0664) test=(HR@5:0.0740,NDCG@5:0.0426) [37.6 s] 
INFO:root:all_losses: [1.2354531  0.69223183]
INFO:root:Epoch 4     loss=1.2355 [24.1 s]	 dev=(HR@5:0.1164,NDCG@5:0.0679) test=(HR@5:0.0740,NDCG@5:0.0427) [37.9 s] 
INFO:root:all_losses: [1.2057974 0.691557 ]
INFO:root:Epoch 5     loss=1.2058 [20.4 s]	 dev=(HR@5:0.1696,NDCG@5:0.1030) test=(HR@5:0.1209,NDCG@5:0.0721) [37.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1706699 0.6884336]
INFO:root:Epoch 6     loss=1.1707 [17.9 s]	 dev=(HR@5:0.1664,NDCG@5:0.1020) test=(HR@5:0.1256,NDCG@5:0.0788) [37.7 s] 
INFO:root:all_losses: [1.1428206 0.6810125]
INFO:root:Epoch 7     loss=1.1428 [18.0 s]	 dev=(HR@5:0.1706,NDCG@5:0.1040) test=(HR@5:0.1286,NDCG@5:0.0792) [37.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1159903  0.66073513]
INFO:root:Epoch 8     loss=1.1160 [19.6 s]	 dev=(HR@5:0.1543,NDCG@5:0.0927) test=(HR@5:0.1168,NDCG@5:0.0742) [38.0 s] 
INFO:root:all_losses: [1.0610114  0.61353207]
INFO:root:Epoch 9     loss=1.0610 [20.9 s]	 dev=(HR@5:0.1684,NDCG@5:0.1028) test=(HR@5:0.1291,NDCG@5:0.0785) [37.9 s] 
INFO:root:all_losses: [0.9791179 0.5494008]
INFO:root:Epoch 10    loss=0.9791 [21.9 s]	 dev=(HR@5:0.1660,NDCG@5:0.1017) test=(HR@5:0.1233,NDCG@5:0.0749) [43.5 s] 
INFO:root:all_losses: [0.90966445 0.4897708 ]
INFO:root:Epoch 11    loss=0.9097 [22.2 s]	 dev=(HR@5:0.1657,NDCG@5:0.0999) test=(HR@5:0.1242,NDCG@5:0.0747) [43.3 s] 
INFO:root:all_losses: [0.85135716 0.43464464]
INFO:root:Epoch 12    loss=0.8514 [22.1 s]	 dev=(HR@5:0.1588,NDCG@5:0.0982) test=(HR@5:0.1178,NDCG@5:0.0741) [43.7 s] 
INFO:root:all_losses: [0.789957   0.37533692]
INFO:root:Epoch 13    loss=0.7900 [22.2 s]	 dev=(HR@5:0.1574,NDCG@5:0.0954) test=(HR@5:0.1185,NDCG@5:0.0735) [43.7 s] 
INFO:root:all_losses: [0.7304729  0.32644114]
INFO:root:Epoch 14    loss=0.7305 [22.0 s]	 dev=(HR@5:0.1692,NDCG@5:0.1014) test=(HR@5:0.1233,NDCG@5:0.0770) [43.4 s] 
INFO:root:all_losses: [0.6812962  0.28944665]
INFO:root:Epoch 15    loss=0.6813 [22.1 s]	 dev=(HR@5:0.1621,NDCG@5:0.1010) test=(HR@5:0.1231,NDCG@5:0.0776) [43.1 s] 
INFO:root:all_losses: [0.6481368  0.25677824]
INFO:root:Epoch 16    loss=0.6481 [22.0 s]	 dev=(HR@5:0.1725,NDCG@5:0.1061) test=(HR@5:0.1262,NDCG@5:0.0810) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6167958  0.23028634]
INFO:root:Epoch 17    loss=0.6168 [22.1 s]	 dev=(HR@5:0.1833,NDCG@5:0.1117) test=(HR@5:0.1333,NDCG@5:0.0852) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.58283335 0.2063478 ]
INFO:root:Epoch 18    loss=0.5828 [22.3 s]	 dev=(HR@5:0.1625,NDCG@5:0.1021) test=(HR@5:0.1235,NDCG@5:0.0778) [44.6 s] 
INFO:root:all_losses: [0.56977487 0.19074613]
INFO:root:Epoch 19    loss=0.5698 [22.2 s]	 dev=(HR@5:0.1761,NDCG@5:0.1093) test=(HR@5:0.1244,NDCG@5:0.0768) [43.3 s] 
INFO:root:all_losses: [0.54365456 0.17723535]
INFO:root:Epoch 20    loss=0.5437 [22.3 s]	 dev=(HR@5:0.1918,NDCG@5:0.1229) test=(HR@5:0.1358,NDCG@5:0.0872) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.51854193 0.16597258]
INFO:root:Epoch 21    loss=0.5185 [22.4 s]	 dev=(HR@5:0.2053,NDCG@5:0.1321) test=(HR@5:0.1501,NDCG@5:0.0967) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.49340856 0.15545508]
INFO:root:Epoch 22    loss=0.4934 [22.8 s]	 dev=(HR@5:0.2241,NDCG@5:0.1454) test=(HR@5:0.1604,NDCG@5:0.1063) [43.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.47919372 0.14704572]
INFO:root:Epoch 23    loss=0.4792 [22.4 s]	 dev=(HR@5:0.2224,NDCG@5:0.1432) test=(HR@5:0.1710,NDCG@5:0.1109) [43.4 s] 
INFO:root:all_losses: [0.45872638 0.14021371]
INFO:root:Epoch 24    loss=0.4587 [22.9 s]	 dev=(HR@5:0.2208,NDCG@5:0.1433) test=(HR@5:0.1678,NDCG@5:0.1096) [43.3 s] 
INFO:root:all_losses: [0.45053887 0.13481551]
INFO:root:Epoch 25    loss=0.4505 [22.2 s]	 dev=(HR@5:0.2210,NDCG@5:0.1413) test=(HR@5:0.1678,NDCG@5:0.1101) [43.4 s] 
INFO:root:all_losses: [0.4443485  0.13029376]
INFO:root:Epoch 26    loss=0.4443 [22.3 s]	 dev=(HR@5:0.2257,NDCG@5:0.1460) test=(HR@5:0.1666,NDCG@5:0.1096) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.43536422 0.12191157]
INFO:root:Epoch 27    loss=0.4354 [22.2 s]	 dev=(HR@5:0.2014,NDCG@5:0.1312) test=(HR@5:0.1615,NDCG@5:0.1092) [43.2 s] 
INFO:root:all_losses: [0.44410348 0.11808159]
INFO:root:Epoch 28    loss=0.4441 [22.0 s]	 dev=(HR@5:0.1984,NDCG@5:0.1289) test=(HR@5:0.1590,NDCG@5:0.1033) [43.3 s] 
INFO:root:all_losses: [0.43715775 0.11540323]
INFO:root:Epoch 29    loss=0.4372 [22.0 s]	 dev=(HR@5:0.2027,NDCG@5:0.1285) test=(HR@5:0.1498,NDCG@5:0.0987) [43.1 s] 
INFO:root:all_losses: [0.43292692 0.11418266]
INFO:root:Epoch 30    loss=0.4329 [22.9 s]	 dev=(HR@5:0.2096,NDCG@5:0.1359) test=(HR@5:0.1564,NDCG@5:0.1029) [44.8 s] 
INFO:root:all_losses: [0.4207865 0.1087677]
INFO:root:Epoch 31    loss=0.4208 [22.3 s]	 dev=(HR@5:0.2159,NDCG@5:0.1408) test=(HR@5:0.1604,NDCG@5:0.1082) [44.1 s] 
INFO:root:all_losses: [0.416913   0.10862972]
INFO:root:Epoch 32    loss=0.4169 [23.2 s]	 dev=(HR@5:0.2092,NDCG@5:0.1367) test=(HR@5:0.1568,NDCG@5:0.1062) [43.9 s] 
INFO:root:all_losses: [0.40394136 0.10346473]
INFO:root:Epoch 33    loss=0.4039 [22.2 s]	 dev=(HR@5:0.2165,NDCG@5:0.1410) test=(HR@5:0.1684,NDCG@5:0.1113) [43.4 s] 
INFO:root:all_losses: [0.398379   0.10009222]
INFO:root:Epoch 34    loss=0.3984 [22.1 s]	 dev=(HR@5:0.2167,NDCG@5:0.1418) test=(HR@5:0.1743,NDCG@5:0.1148) [43.3 s] 
INFO:root:all_losses: [0.39909604 0.10098106]
INFO:root:Epoch 35    loss=0.3991 [22.5 s]	 dev=(HR@5:0.2173,NDCG@5:0.1422) test=(HR@5:0.1647,NDCG@5:0.1109) [43.4 s] 
INFO:root:all_losses: [0.39046922 0.09570492]
INFO:root:Epoch 36    loss=0.3905 [22.3 s]	 dev=(HR@5:0.2145,NDCG@5:0.1407) test=(HR@5:0.1696,NDCG@5:0.1130) [43.0 s] 
INFO:root:all_losses: [0.38799015 0.09555904]
INFO:root:Epoch 37    loss=0.3880 [22.6 s]	 dev=(HR@5:0.2202,NDCG@5:0.1429) test=(HR@5:0.1702,NDCG@5:0.1148) [43.3 s] 
INFO:root:all_losses: [0.38104537 0.09439217]
INFO:root:Epoch 38    loss=0.3810 [22.4 s]	 dev=(HR@5:0.2141,NDCG@5:0.1404) test=(HR@5:0.1649,NDCG@5:0.1093) [43.5 s] 
INFO:root:all_losses: [0.38307124 0.09156436]
INFO:root:Epoch 39    loss=0.3831 [22.1 s]	 dev=(HR@5:0.2094,NDCG@5:0.1360) test=(HR@5:0.1584,NDCG@5:0.1044) [43.0 s] 
INFO:root:all_losses: [0.38422847 0.08844367]
INFO:root:Epoch 40    loss=0.3842 [22.2 s]	 dev=(HR@5:0.2122,NDCG@5:0.1361) test=(HR@5:0.1590,NDCG@5:0.1064) [43.2 s] 
INFO:root:all_losses: [0.37436104 0.08731114]
INFO:root:Epoch 41    loss=0.3744 [22.0 s]	 dev=(HR@5:0.2116,NDCG@5:0.1363) test=(HR@5:0.1639,NDCG@5:0.1093) [43.1 s] 
INFO:root:all_losses: [0.36934328 0.08834979]
INFO:root:Epoch 42    loss=0.3693 [22.3 s]	 dev=(HR@5:0.2098,NDCG@5:0.1372) test=(HR@5:0.1688,NDCG@5:0.1135) [43.6 s] 
INFO:root:all_losses: [0.3644259  0.08344267]
INFO:root:Epoch 43    loss=0.3644 [22.5 s]	 dev=(HR@5:0.2247,NDCG@5:0.1497) test=(HR@5:0.1841,NDCG@5:0.1243) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.36436805 0.08385932]
INFO:root:Epoch 44    loss=0.3644 [22.4 s]	 dev=(HR@5:0.2143,NDCG@5:0.1385) test=(HR@5:0.1698,NDCG@5:0.1132) [42.8 s] 
INFO:root:all_losses: [0.35192534 0.08181474]
INFO:root:Epoch 45    loss=0.3519 [22.4 s]	 dev=(HR@5:0.2234,NDCG@5:0.1475) test=(HR@5:0.1794,NDCG@5:0.1209) [42.9 s] 
INFO:root:all_losses: [0.3484552  0.08380612]
INFO:root:Epoch 46    loss=0.3485 [22.7 s]	 dev=(HR@5:0.2094,NDCG@5:0.1340) test=(HR@5:0.1741,NDCG@5:0.1141) [43.0 s] 
INFO:root:all_losses: [0.3421368  0.07775467]
INFO:root:Epoch 47    loss=0.3421 [22.1 s]	 dev=(HR@5:0.2285,NDCG@5:0.1491) test=(HR@5:0.1810,NDCG@5:0.1219) [43.1 s] 
INFO:root:all_losses: [0.34219614 0.08022439]
INFO:root:Epoch 48    loss=0.3422 [22.1 s]	 dev=(HR@5:0.2236,NDCG@5:0.1437) test=(HR@5:0.1747,NDCG@5:0.1189) [42.6 s] 
INFO:root:all_losses: [0.33594498 0.07779688]
INFO:root:Epoch 49    loss=0.3359 [22.2 s]	 dev=(HR@5:0.2310,NDCG@5:0.1504) test=(HR@5:0.1804,NDCG@5:0.1215) [42.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33099604 0.07786583]
INFO:root:Epoch 50    loss=0.3310 [22.0 s]	 dev=(HR@5:0.2243,NDCG@5:0.1492) test=(HR@5:0.1841,NDCG@5:0.1249) [42.8 s] 
INFO:root:all_losses: [0.33630028 0.07705346]
INFO:root:Epoch 51    loss=0.3363 [22.3 s]	 dev=(HR@5:0.2608,NDCG@5:0.1758) test=(HR@5:0.2059,NDCG@5:0.1386) [42.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.30746627 0.07393524]
INFO:root:Epoch 52    loss=0.3075 [22.6 s]	 dev=(HR@5:0.3001,NDCG@5:0.1986) test=(HR@5:0.2349,NDCG@5:0.1584) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28833723 0.07580262]
INFO:root:Epoch 53    loss=0.2883 [22.9 s]	 dev=(HR@5:0.3182,NDCG@5:0.2126) test=(HR@5:0.2534,NDCG@5:0.1714) [43.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27587652 0.07408219]
INFO:root:Epoch 54    loss=0.2759 [22.6 s]	 dev=(HR@5:0.3240,NDCG@5:0.2201) test=(HR@5:0.2685,NDCG@5:0.1805) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2607244 0.0718126]
INFO:root:Epoch 55    loss=0.2607 [22.5 s]	 dev=(HR@5:0.3374,NDCG@5:0.2255) test=(HR@5:0.2709,NDCG@5:0.1842) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.25482512 0.07232515]
INFO:root:Epoch 56    loss=0.2548 [22.5 s]	 dev=(HR@5:0.3354,NDCG@5:0.2246) test=(HR@5:0.2771,NDCG@5:0.1887) [43.0 s] 
INFO:root:all_losses: [0.23976615 0.0701083 ]
INFO:root:Epoch 57    loss=0.2398 [22.4 s]	 dev=(HR@5:0.3545,NDCG@5:0.2353) test=(HR@5:0.2885,NDCG@5:0.1975) [43.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23550692 0.06962562]
INFO:root:Epoch 58    loss=0.2355 [22.5 s]	 dev=(HR@5:0.3572,NDCG@5:0.2413) test=(HR@5:0.2922,NDCG@5:0.2024) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23388922 0.07107645]
INFO:root:Epoch 59    loss=0.2339 [22.2 s]	 dev=(HR@5:0.3708,NDCG@5:0.2514) test=(HR@5:0.2983,NDCG@5:0.2055) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21819143 0.067866  ]
INFO:root:Epoch 60    loss=0.2182 [22.7 s]	 dev=(HR@5:0.3776,NDCG@5:0.2547) test=(HR@5:0.3172,NDCG@5:0.2165) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21601391 0.06501701]
INFO:root:Epoch 61    loss=0.2160 [22.8 s]	 dev=(HR@5:0.3937,NDCG@5:0.2624) test=(HR@5:0.3174,NDCG@5:0.2159) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2160253  0.06886223]
INFO:root:Epoch 62    loss=0.2160 [22.7 s]	 dev=(HR@5:0.3692,NDCG@5:0.2496) test=(HR@5:0.3011,NDCG@5:0.2074) [42.9 s] 
INFO:root:all_losses: [0.20954761 0.06591932]
INFO:root:Epoch 63    loss=0.2095 [22.6 s]	 dev=(HR@5:0.3947,NDCG@5:0.2675) test=(HR@5:0.3348,NDCG@5:0.2298) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.20191254 0.06472845]
INFO:root:Epoch 64    loss=0.2019 [22.6 s]	 dev=(HR@5:0.3898,NDCG@5:0.2644) test=(HR@5:0.3213,NDCG@5:0.2189) [43.3 s] 
INFO:root:all_losses: [0.1993083  0.06313366]
INFO:root:Epoch 65    loss=0.1993 [22.5 s]	 dev=(HR@5:0.3982,NDCG@5:0.2726) test=(HR@5:0.3227,NDCG@5:0.2203) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19547452 0.06450889]
INFO:root:Epoch 66    loss=0.1955 [22.5 s]	 dev=(HR@5:0.4073,NDCG@5:0.2735) test=(HR@5:0.3450,NDCG@5:0.2307) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19407003 0.06440353]
INFO:root:Epoch 67    loss=0.1941 [22.6 s]	 dev=(HR@5:0.3961,NDCG@5:0.2696) test=(HR@5:0.3339,NDCG@5:0.2295) [43.1 s] 
INFO:root:all_losses: [0.19182768 0.06278784]
INFO:root:Epoch 68    loss=0.1918 [22.5 s]	 dev=(HR@5:0.3843,NDCG@5:0.2624) test=(HR@5:0.3187,NDCG@5:0.2185) [43.2 s] 
INFO:root:all_losses: [0.1889346 0.0650143]
INFO:root:Epoch 69    loss=0.1889 [22.7 s]	 dev=(HR@5:0.4010,NDCG@5:0.2733) test=(HR@5:0.3372,NDCG@5:0.2310) [43.1 s] 
INFO:root:all_losses: [0.1905013  0.06589366]
INFO:root:Epoch 70    loss=0.1905 [22.8 s]	 dev=(HR@5:0.4069,NDCG@5:0.2774) test=(HR@5:0.3421,NDCG@5:0.2339) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18585068 0.06131629]
INFO:root:Epoch 71    loss=0.1859 [22.9 s]	 dev=(HR@5:0.4016,NDCG@5:0.2728) test=(HR@5:0.3348,NDCG@5:0.2285) [43.1 s] 
INFO:root:all_losses: [0.18006249 0.06160998]
INFO:root:Epoch 72    loss=0.1801 [22.8 s]	 dev=(HR@5:0.3998,NDCG@5:0.2744) test=(HR@5:0.3415,NDCG@5:0.2356) [43.1 s] 
INFO:root:all_losses: [0.17992982 0.05961115]
INFO:root:Epoch 73    loss=0.1799 [22.6 s]	 dev=(HR@5:0.4120,NDCG@5:0.2831) test=(HR@5:0.3425,NDCG@5:0.2348) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1735698  0.06110441]
INFO:root:Epoch 74    loss=0.1736 [22.9 s]	 dev=(HR@5:0.4053,NDCG@5:0.2773) test=(HR@5:0.3394,NDCG@5:0.2360) [43.1 s] 
INFO:root:all_losses: [0.1727393 0.0590276]
INFO:root:Epoch 75    loss=0.1727 [22.5 s]	 dev=(HR@5:0.4088,NDCG@5:0.2797) test=(HR@5:0.3574,NDCG@5:0.2429) [43.2 s] 
INFO:root:all_losses: [0.17319694 0.05916557]
INFO:root:Epoch 76    loss=0.1732 [22.8 s]	 dev=(HR@5:0.4047,NDCG@5:0.2788) test=(HR@5:0.3417,NDCG@5:0.2380) [43.2 s] 
INFO:root:all_losses: [0.16744946 0.05708099]
INFO:root:Epoch 77    loss=0.1674 [22.6 s]	 dev=(HR@5:0.4106,NDCG@5:0.2811) test=(HR@5:0.3513,NDCG@5:0.2407) [43.2 s] 
INFO:root:all_losses: [0.17100199 0.05851445]
INFO:root:Epoch 78    loss=0.1710 [22.5 s]	 dev=(HR@5:0.4271,NDCG@5:0.2922) test=(HR@5:0.3670,NDCG@5:0.2495) [43.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16209167 0.05681732]
INFO:root:Epoch 79    loss=0.1621 [22.6 s]	 dev=(HR@5:0.4077,NDCG@5:0.2805) test=(HR@5:0.3437,NDCG@5:0.2354) [43.0 s] 
INFO:root:all_losses: [0.16404964 0.05737898]
INFO:root:Epoch 80    loss=0.1640 [22.9 s]	 dev=(HR@5:0.4175,NDCG@5:0.2875) test=(HR@5:0.3586,NDCG@5:0.2446) [43.1 s] 
INFO:root:all_losses: [0.16979012 0.05994594]
INFO:root:Epoch 81    loss=0.1698 [22.5 s]	 dev=(HR@5:0.4226,NDCG@5:0.2912) test=(HR@5:0.3584,NDCG@5:0.2495) [43.3 s] 
INFO:root:all_losses: [0.16046092 0.05825523]
INFO:root:Epoch 82    loss=0.1605 [22.6 s]	 dev=(HR@5:0.4149,NDCG@5:0.2863) test=(HR@5:0.3523,NDCG@5:0.2447) [43.1 s] 
INFO:root:all_losses: [0.15948676 0.0559418 ]
INFO:root:Epoch 83    loss=0.1595 [22.5 s]	 dev=(HR@5:0.4100,NDCG@5:0.2830) test=(HR@5:0.3386,NDCG@5:0.2385) [43.4 s] 
INFO:root:all_losses: [0.1580553  0.05754868]
INFO:root:Epoch 84    loss=0.1581 [22.9 s]	 dev=(HR@5:0.4196,NDCG@5:0.2905) test=(HR@5:0.3590,NDCG@5:0.2497) [43.0 s] 
INFO:root:all_losses: [0.1577436  0.05736957]
INFO:root:Epoch 85    loss=0.1577 [22.9 s]	 dev=(HR@5:0.4114,NDCG@5:0.2874) test=(HR@5:0.3492,NDCG@5:0.2458) [43.3 s] 
INFO:root:all_losses: [0.154606   0.05590027]
INFO:root:Epoch 86    loss=0.1546 [22.5 s]	 dev=(HR@5:0.4053,NDCG@5:0.2838) test=(HR@5:0.3443,NDCG@5:0.2420) [43.2 s] 
INFO:root:all_losses: [0.15383966 0.05531619]
INFO:root:Epoch 87    loss=0.1538 [22.5 s]	 dev=(HR@5:0.4161,NDCG@5:0.2881) test=(HR@5:0.3519,NDCG@5:0.2453) [43.2 s] 
INFO:root:all_losses: [0.15378302 0.05631741]
INFO:root:Epoch 88    loss=0.1538 [22.5 s]	 dev=(HR@5:0.4279,NDCG@5:0.2923) test=(HR@5:0.3588,NDCG@5:0.2501) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14994322 0.05573626]
INFO:root:Epoch 89    loss=0.1499 [22.5 s]	 dev=(HR@5:0.4045,NDCG@5:0.2827) test=(HR@5:0.3454,NDCG@5:0.2401) [43.2 s] 
INFO:root:all_losses: [0.14324668 0.05278308]
INFO:root:Epoch 90    loss=0.1432 [22.9 s]	 dev=(HR@5:0.4206,NDCG@5:0.2929) test=(HR@5:0.3735,NDCG@5:0.2600) [43.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14762087 0.05371261]
INFO:root:Epoch 91    loss=0.1476 [22.6 s]	 dev=(HR@5:0.4159,NDCG@5:0.2917) test=(HR@5:0.3513,NDCG@5:0.2452) [43.3 s] 
INFO:root:all_losses: [0.14505921 0.05375952]
INFO:root:Epoch 92    loss=0.1451 [22.5 s]	 dev=(HR@5:0.4118,NDCG@5:0.2894) test=(HR@5:0.3488,NDCG@5:0.2451) [43.4 s] 
INFO:root:all_losses: [0.14423747 0.05204743]
INFO:root:Epoch 93    loss=0.1442 [22.6 s]	 dev=(HR@5:0.4128,NDCG@5:0.2869) test=(HR@5:0.3360,NDCG@5:0.2385) [43.4 s] 
INFO:root:all_losses: [0.14526726 0.05400812]
INFO:root:Epoch 94    loss=0.1453 [22.5 s]	 dev=(HR@5:0.4175,NDCG@5:0.2899) test=(HR@5:0.3531,NDCG@5:0.2445) [43.0 s] 
INFO:root:all_losses: [0.13899021 0.05283324]
INFO:root:Epoch 95    loss=0.1390 [22.8 s]	 dev=(HR@5:0.4269,NDCG@5:0.2965) test=(HR@5:0.3674,NDCG@5:0.2549) [43.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1395055  0.05218302]
INFO:root:Epoch 96    loss=0.1395 [22.6 s]	 dev=(HR@5:0.4147,NDCG@5:0.2915) test=(HR@5:0.3588,NDCG@5:0.2506) [43.2 s] 
INFO:root:all_losses: [0.14128847 0.05287751]
INFO:root:Epoch 97    loss=0.1413 [22.5 s]	 dev=(HR@5:0.4247,NDCG@5:0.2964) test=(HR@5:0.3584,NDCG@5:0.2520) [42.9 s] 
INFO:root:all_losses: [0.13939656 0.05332857]
INFO:root:Epoch 98    loss=0.1394 [22.5 s]	 dev=(HR@5:0.4239,NDCG@5:0.2931) test=(HR@5:0.3541,NDCG@5:0.2482) [43.9 s] 
INFO:root:all_losses: [0.13798678 0.05070343]
INFO:root:Epoch 99    loss=0.1380 [22.5 s]	 dev=(HR@5:0.4124,NDCG@5:0.2856) test=(HR@5:0.3486,NDCG@5:0.2434) [43.1 s] 
INFO:root:all_losses: [0.13213494 0.04884486]
INFO:root:Epoch 100   loss=0.1321 [22.6 s]	 dev=(HR@5:0.4275,NDCG@5:0.2977) test=(HR@5:0.3657,NDCG@5:0.2573) [43.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13281757 0.05005763]
INFO:root:Epoch 101   loss=0.1328 [22.5 s]	 dev=(HR@5:0.4157,NDCG@5:0.2877) test=(HR@5:0.3488,NDCG@5:0.2444) [43.2 s] 
INFO:root:all_losses: [0.12925585 0.04772287]
INFO:root:Epoch 102   loss=0.1293 [22.5 s]	 dev=(HR@5:0.4318,NDCG@5:0.3029) test=(HR@5:0.3790,NDCG@5:0.2591) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1300331  0.05078808]
INFO:root:Epoch 103   loss=0.1300 [22.6 s]	 dev=(HR@5:0.4328,NDCG@5:0.3009) test=(HR@5:0.3776,NDCG@5:0.2617) [43.6 s] 
INFO:root:all_losses: [0.1262976  0.05039756]
INFO:root:Epoch 104   loss=0.1263 [22.7 s]	 dev=(HR@5:0.4379,NDCG@5:0.3037) test=(HR@5:0.3751,NDCG@5:0.2619) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12725653 0.04837237]
INFO:root:Epoch 105   loss=0.1273 [22.6 s]	 dev=(HR@5:0.4418,NDCG@5:0.3100) test=(HR@5:0.3768,NDCG@5:0.2672) [43.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12706761 0.04885035]
INFO:root:Epoch 106   loss=0.1271 [22.5 s]	 dev=(HR@5:0.4369,NDCG@5:0.3061) test=(HR@5:0.3766,NDCG@5:0.2630) [43.3 s] 
INFO:root:all_losses: [0.12660486 0.04840121]
INFO:root:Epoch 107   loss=0.1266 [22.5 s]	 dev=(HR@5:0.4188,NDCG@5:0.2950) test=(HR@5:0.3694,NDCG@5:0.2600) [43.4 s] 
INFO:root:all_losses: [0.127828   0.04753956]
INFO:root:Epoch 108   loss=0.1278 [22.9 s]	 dev=(HR@5:0.4177,NDCG@5:0.2914) test=(HR@5:0.3672,NDCG@5:0.2569) [43.2 s] 
INFO:root:all_losses: [0.12576294 0.04762701]
INFO:root:Epoch 109   loss=0.1258 [22.5 s]	 dev=(HR@5:0.4418,NDCG@5:0.3088) test=(HR@5:0.3872,NDCG@5:0.2692) [43.3 s] 
INFO:root:all_losses: [0.12392275 0.04530886]
INFO:root:Epoch 110   loss=0.1239 [22.5 s]	 dev=(HR@5:0.4357,NDCG@5:0.3063) test=(HR@5:0.3772,NDCG@5:0.2639) [43.3 s] 
INFO:root:all_losses: [0.12094364 0.04771541]
INFO:root:Epoch 111   loss=0.1209 [22.5 s]	 dev=(HR@5:0.4473,NDCG@5:0.3156) test=(HR@5:0.3906,NDCG@5:0.2731) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12052441 0.04732192]
INFO:root:Epoch 112   loss=0.1205 [22.5 s]	 dev=(HR@5:0.4491,NDCG@5:0.3163) test=(HR@5:0.3953,NDCG@5:0.2741) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12117894 0.04611497]
INFO:root:Epoch 113   loss=0.1212 [22.9 s]	 dev=(HR@5:0.4449,NDCG@5:0.3142) test=(HR@5:0.3861,NDCG@5:0.2684) [43.2 s] 
INFO:root:all_losses: [0.12218632 0.04679232]
INFO:root:Epoch 114   loss=0.1222 [22.5 s]	 dev=(HR@5:0.4320,NDCG@5:0.3061) test=(HR@5:0.3715,NDCG@5:0.2630) [43.3 s] 
INFO:root:all_losses: [0.11335317 0.04421034]
INFO:root:Epoch 115   loss=0.1134 [22.5 s]	 dev=(HR@5:0.4263,NDCG@5:0.3020) test=(HR@5:0.3666,NDCG@5:0.2560) [43.2 s] 
INFO:root:all_losses: [0.11590546 0.04684113]
INFO:root:Epoch 116   loss=0.1159 [22.5 s]	 dev=(HR@5:0.4279,NDCG@5:0.2995) test=(HR@5:0.3719,NDCG@5:0.2617) [43.1 s] 
INFO:root:Early stop at 116 based on dev result.
INFO:root:
Best Iter(dev)=  112	 dev=(HR@5:0.4491,NDCG@5:0.3163) test=(HR@5:0.3953,NDCG@5:0.2741) [7552.3 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.5462,HR@5:0.3953,HR@50:0.8638,NDCG@10:0.3230,NDCG@5:0.2741,NDCG@50:0.3942)
INFO:root:
--------------------------------------------- END: 2024-12-31 12:00:41 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-31 12:45:13 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2996527 0.6931139]
INFO:root:Epoch 1     loss=1.2997 [19.1 s]	 dev=(HR@5:0.1119,NDCG@5:0.0653) test=(HR@5:0.0716,NDCG@5:0.0415) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2431611  0.69297653]
INFO:root:Epoch 2     loss=1.2432 [18.6 s]	 dev=(HR@5:0.1140,NDCG@5:0.0678) test=(HR@5:0.0744,NDCG@5:0.0436) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2391381  0.69264084]
INFO:root:Epoch 3     loss=1.2391 [18.7 s]	 dev=(HR@5:0.1097,NDCG@5:0.0654) test=(HR@5:0.0734,NDCG@5:0.0419) [37.9 s] 
INFO:root:all_losses: [1.2296968 0.6922149]
INFO:root:Epoch 4     loss=1.2297 [22.3 s]	 dev=(HR@5:0.1191,NDCG@5:0.0703) test=(HR@5:0.0834,NDCG@5:0.0471) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1798989  0.69089353]
INFO:root:Epoch 5     loss=1.1799 [18.6 s]	 dev=(HR@5:0.1778,NDCG@5:0.1089) test=(HR@5:0.1301,NDCG@5:0.0815) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1429164  0.68612015]
INFO:root:Epoch 6     loss=1.1429 [18.4 s]	 dev=(HR@5:0.1770,NDCG@5:0.1098) test=(HR@5:0.1370,NDCG@5:0.0866) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1053857 0.6742808]
INFO:root:Epoch 7     loss=1.1054 [18.5 s]	 dev=(HR@5:0.2006,NDCG@5:0.1192) test=(HR@5:0.1360,NDCG@5:0.0820) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0582992 0.6441576]
INFO:root:Epoch 8     loss=1.0583 [18.7 s]	 dev=(HR@5:0.2271,NDCG@5:0.1399) test=(HR@5:0.1680,NDCG@5:0.1042) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9761097 0.5898366]
INFO:root:Epoch 9     loss=0.9761 [20.0 s]	 dev=(HR@5:0.2583,NDCG@5:0.1595) test=(HR@5:0.1931,NDCG@5:0.1227) [37.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8701467  0.52337956]
INFO:root:Epoch 10    loss=0.8701 [21.7 s]	 dev=(HR@5:0.3268,NDCG@5:0.2113) test=(HR@5:0.2432,NDCG@5:0.1573) [44.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7654989 0.4519125]
INFO:root:Epoch 11    loss=0.7655 [23.0 s]	 dev=(HR@5:0.3496,NDCG@5:0.2245) test=(HR@5:0.2646,NDCG@5:0.1731) [45.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6637084  0.38165763]
INFO:root:Epoch 12    loss=0.6637 [22.5 s]	 dev=(HR@5:0.3849,NDCG@5:0.2526) test=(HR@5:0.2966,NDCG@5:0.1953) [45.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5753411  0.31795728]
INFO:root:Epoch 13    loss=0.5753 [22.6 s]	 dev=(HR@5:0.3878,NDCG@5:0.2584) test=(HR@5:0.2995,NDCG@5:0.2000) [45.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5056456 0.2715697]
INFO:root:Epoch 14    loss=0.5056 [23.0 s]	 dev=(HR@5:0.4045,NDCG@5:0.2720) test=(HR@5:0.3131,NDCG@5:0.2087) [45.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.45575967 0.2366762 ]
INFO:root:Epoch 15    loss=0.4558 [22.5 s]	 dev=(HR@5:0.4267,NDCG@5:0.2855) test=(HR@5:0.3390,NDCG@5:0.2252) [45.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.41474435 0.20807846]
INFO:root:Epoch 16    loss=0.4147 [22.7 s]	 dev=(HR@5:0.4175,NDCG@5:0.2799) test=(HR@5:0.3286,NDCG@5:0.2182) [45.2 s] 
INFO:root:all_losses: [0.38084796 0.18639304]
INFO:root:Epoch 17    loss=0.3808 [22.5 s]	 dev=(HR@5:0.4526,NDCG@5:0.3074) test=(HR@5:0.3737,NDCG@5:0.2447) [45.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.34112528 0.16520573]
INFO:root:Epoch 18    loss=0.3411 [22.8 s]	 dev=(HR@5:0.4638,NDCG@5:0.3185) test=(HR@5:0.3770,NDCG@5:0.2515) [45.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3231813  0.15284589]
INFO:root:Epoch 19    loss=0.3232 [22.6 s]	 dev=(HR@5:0.4593,NDCG@5:0.3111) test=(HR@5:0.3747,NDCG@5:0.2517) [45.0 s] 
INFO:root:all_losses: [0.3035596  0.14152555]
INFO:root:Epoch 20    loss=0.3036 [22.8 s]	 dev=(HR@5:0.4654,NDCG@5:0.3187) test=(HR@5:0.3957,NDCG@5:0.2656) [45.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28262112 0.13169076]
INFO:root:Epoch 21    loss=0.2826 [22.8 s]	 dev=(HR@5:0.4732,NDCG@5:0.3236) test=(HR@5:0.3982,NDCG@5:0.2697) [44.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27237332 0.12234408]
INFO:root:Epoch 22    loss=0.2724 [22.7 s]	 dev=(HR@5:0.4616,NDCG@5:0.3158) test=(HR@5:0.4004,NDCG@5:0.2674) [44.8 s] 
INFO:root:all_losses: [0.25982392 0.11652858]
INFO:root:Epoch 23    loss=0.2598 [22.5 s]	 dev=(HR@5:0.4669,NDCG@5:0.3246) test=(HR@5:0.3955,NDCG@5:0.2694) [44.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24477445 0.11020357]
INFO:root:Epoch 24    loss=0.2448 [22.6 s]	 dev=(HR@5:0.4693,NDCG@5:0.3255) test=(HR@5:0.3957,NDCG@5:0.2662) [44.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23348244 0.10522896]
INFO:root:Epoch 25    loss=0.2335 [22.8 s]	 dev=(HR@5:0.4762,NDCG@5:0.3286) test=(HR@5:0.3990,NDCG@5:0.2687) [44.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22763385 0.10107758]
INFO:root:Epoch 26    loss=0.2276 [22.4 s]	 dev=(HR@5:0.4681,NDCG@5:0.3233) test=(HR@5:0.3863,NDCG@5:0.2680) [44.7 s] 
INFO:root:all_losses: [0.21722303 0.09530637]
INFO:root:Epoch 27    loss=0.2172 [22.5 s]	 dev=(HR@5:0.4932,NDCG@5:0.3437) test=(HR@5:0.4328,NDCG@5:0.2951) [44.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21062513 0.09271228]
INFO:root:Epoch 28    loss=0.2106 [22.9 s]	 dev=(HR@5:0.4854,NDCG@5:0.3369) test=(HR@5:0.4098,NDCG@5:0.2769) [44.4 s] 
INFO:root:all_losses: [0.19984373 0.09031255]
INFO:root:Epoch 29    loss=0.1998 [22.8 s]	 dev=(HR@5:0.4693,NDCG@5:0.3293) test=(HR@5:0.3955,NDCG@5:0.2694) [44.7 s] 
INFO:root:all_losses: [0.19853301 0.08886184]
INFO:root:Epoch 30    loss=0.1985 [22.6 s]	 dev=(HR@5:0.4842,NDCG@5:0.3417) test=(HR@5:0.4120,NDCG@5:0.2843) [44.4 s] 
INFO:root:all_losses: [0.19534163 0.0841656 ]
INFO:root:Epoch 31    loss=0.1953 [22.5 s]	 dev=(HR@5:0.4718,NDCG@5:0.3296) test=(HR@5:0.3961,NDCG@5:0.2707) [44.4 s] 
INFO:root:all_losses: [0.19267799 0.08586449]
INFO:root:Epoch 32    loss=0.1927 [22.4 s]	 dev=(HR@5:0.4850,NDCG@5:0.3422) test=(HR@5:0.4257,NDCG@5:0.2926) [44.5 s] 
INFO:root:all_losses: [0.18468703 0.0818183 ]
INFO:root:Epoch 33    loss=0.1847 [22.2 s]	 dev=(HR@5:0.4924,NDCG@5:0.3455) test=(HR@5:0.4292,NDCG@5:0.2924) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17861505 0.07891078]
INFO:root:Epoch 34    loss=0.1786 [22.4 s]	 dev=(HR@5:0.4909,NDCG@5:0.3445) test=(HR@5:0.4292,NDCG@5:0.2924) [44.6 s] 
INFO:root:all_losses: [0.17530368 0.07872243]
INFO:root:Epoch 35    loss=0.1753 [22.6 s]	 dev=(HR@5:0.5060,NDCG@5:0.3513) test=(HR@5:0.4599,NDCG@5:0.3131) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16943486 0.07402381]
INFO:root:Epoch 36    loss=0.1694 [22.6 s]	 dev=(HR@5:0.4809,NDCG@5:0.3349) test=(HR@5:0.4039,NDCG@5:0.2818) [44.3 s] 
INFO:root:all_losses: [0.16978803 0.07458685]
INFO:root:Epoch 37    loss=0.1698 [22.5 s]	 dev=(HR@5:0.4907,NDCG@5:0.3456) test=(HR@5:0.4336,NDCG@5:0.2987) [44.3 s] 
INFO:root:all_losses: [0.16461056 0.07415292]
INFO:root:Epoch 38    loss=0.1646 [22.6 s]	 dev=(HR@5:0.4989,NDCG@5:0.3530) test=(HR@5:0.4345,NDCG@5:0.2978) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15728246 0.07182393]
INFO:root:Epoch 39    loss=0.1573 [22.9 s]	 dev=(HR@5:0.4993,NDCG@5:0.3545) test=(HR@5:0.4434,NDCG@5:0.3046) [44.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16011658 0.07000822]
INFO:root:Epoch 40    loss=0.1601 [22.5 s]	 dev=(HR@5:0.4997,NDCG@5:0.3543) test=(HR@5:0.4546,NDCG@5:0.3128) [44.1 s] 
INFO:root:all_losses: [0.15686077 0.06824972]
INFO:root:Epoch 41    loss=0.1569 [22.6 s]	 dev=(HR@5:0.4783,NDCG@5:0.3381) test=(HR@5:0.4010,NDCG@5:0.2827) [44.2 s] 
INFO:root:all_losses: [0.1523517  0.07064867]
INFO:root:Epoch 42    loss=0.1524 [22.8 s]	 dev=(HR@5:0.4922,NDCG@5:0.3496) test=(HR@5:0.4334,NDCG@5:0.2977) [44.1 s] 
INFO:root:all_losses: [0.15159984 0.06545777]
INFO:root:Epoch 43    loss=0.1516 [22.8 s]	 dev=(HR@5:0.4805,NDCG@5:0.3394) test=(HR@5:0.4251,NDCG@5:0.2957) [44.4 s] 
INFO:root:all_losses: [0.15020785 0.06693471]
INFO:root:Epoch 44    loss=0.1502 [22.6 s]	 dev=(HR@5:0.4913,NDCG@5:0.3478) test=(HR@5:0.4259,NDCG@5:0.2975) [44.1 s] 
INFO:root:all_losses: [0.14632994 0.06430223]
INFO:root:Epoch 45    loss=0.1463 [22.6 s]	 dev=(HR@5:0.4903,NDCG@5:0.3468) test=(HR@5:0.4236,NDCG@5:0.2945) [44.3 s] 
INFO:root:all_losses: [0.14545079 0.06619564]
INFO:root:Epoch 46    loss=0.1455 [22.6 s]	 dev=(HR@5:0.4875,NDCG@5:0.3456) test=(HR@5:0.4210,NDCG@5:0.2907) [44.1 s] 
INFO:root:all_losses: [0.14088662 0.06186003]
INFO:root:Epoch 47    loss=0.1409 [22.5 s]	 dev=(HR@5:0.4930,NDCG@5:0.3436) test=(HR@5:0.4253,NDCG@5:0.2950) [44.0 s] 
INFO:root:all_losses: [0.14147986 0.06316545]
INFO:root:Epoch 48    loss=0.1415 [22.5 s]	 dev=(HR@5:0.5070,NDCG@5:0.3580) test=(HR@5:0.4410,NDCG@5:0.3081) [44.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14155848 0.06129374]
INFO:root:Epoch 49    loss=0.1416 [22.6 s]	 dev=(HR@5:0.4932,NDCG@5:0.3476) test=(HR@5:0.4330,NDCG@5:0.3003) [44.1 s] 
INFO:root:all_losses: [0.13415618 0.06102771]
INFO:root:Epoch 50    loss=0.1342 [22.9 s]	 dev=(HR@5:0.4966,NDCG@5:0.3508) test=(HR@5:0.4361,NDCG@5:0.2999) [44.0 s] 
INFO:root:all_losses: [0.13509274 0.06058726]
INFO:root:Epoch 51    loss=0.1351 [24.3 s]	 dev=(HR@5:0.4924,NDCG@5:0.3497) test=(HR@5:0.4336,NDCG@5:0.3031) [44.5 s] 
INFO:root:all_losses: [0.13271095 0.05992121]
INFO:root:Epoch 52    loss=0.1327 [23.4 s]	 dev=(HR@5:0.5015,NDCG@5:0.3547) test=(HR@5:0.4371,NDCG@5:0.3051) [44.4 s] 
INFO:root:all_losses: [0.12999009 0.05864873]
INFO:root:Epoch 53    loss=0.1300 [23.6 s]	 dev=(HR@5:0.4889,NDCG@5:0.3474) test=(HR@5:0.4249,NDCG@5:0.2971) [44.5 s] 
INFO:root:all_losses: [0.13249923 0.05932437]
INFO:root:Epoch 54    loss=0.1325 [23.5 s]	 dev=(HR@5:0.5042,NDCG@5:0.3541) test=(HR@5:0.4479,NDCG@5:0.3104) [44.4 s] 
INFO:root:all_losses: [0.12749816 0.0578174 ]
INFO:root:Epoch 55    loss=0.1275 [23.4 s]	 dev=(HR@5:0.4826,NDCG@5:0.3373) test=(HR@5:0.4071,NDCG@5:0.2859) [44.4 s] 
INFO:root:all_losses: [0.12996584 0.05856388]
INFO:root:Epoch 56    loss=0.1300 [23.8 s]	 dev=(HR@5:0.5058,NDCG@5:0.3555) test=(HR@5:0.4479,NDCG@5:0.3134) [44.2 s] 
INFO:root:all_losses: [0.12329526 0.05497497]
INFO:root:Epoch 57    loss=0.1233 [22.5 s]	 dev=(HR@5:0.5013,NDCG@5:0.3539) test=(HR@5:0.4375,NDCG@5:0.3032) [44.0 s] 
INFO:root:all_losses: [0.12171322 0.0549989 ]
INFO:root:Epoch 58    loss=0.1217 [22.6 s]	 dev=(HR@5:0.4968,NDCG@5:0.3518) test=(HR@5:0.4371,NDCG@5:0.3055) [44.0 s] 
INFO:root:all_losses: [0.12546717 0.05786264]
INFO:root:Epoch 59    loss=0.1255 [22.9 s]	 dev=(HR@5:0.4858,NDCG@5:0.3394) test=(HR@5:0.4304,NDCG@5:0.2970) [44.0 s] 
INFO:root:all_losses: [0.11839493 0.05421496]
INFO:root:Epoch 60    loss=0.1184 [22.7 s]	 dev=(HR@5:0.4915,NDCG@5:0.3489) test=(HR@5:0.4294,NDCG@5:0.3002) [43.9 s] 
INFO:root:all_losses: [0.11740297 0.05174134]
INFO:root:Epoch 61    loss=0.1174 [23.0 s]	 dev=(HR@5:0.4972,NDCG@5:0.3509) test=(HR@5:0.4316,NDCG@5:0.3012) [43.9 s] 
INFO:root:all_losses: [0.12136755 0.05414504]
INFO:root:Epoch 62    loss=0.1214 [22.6 s]	 dev=(HR@5:0.4960,NDCG@5:0.3498) test=(HR@5:0.4314,NDCG@5:0.3006) [44.0 s] 
INFO:root:all_losses: [0.1153466  0.05227725]
INFO:root:Epoch 63    loss=0.1153 [22.6 s]	 dev=(HR@5:0.4917,NDCG@5:0.3501) test=(HR@5:0.4373,NDCG@5:0.3056) [43.9 s] 
INFO:root:all_losses: [0.11240721 0.05141794]
INFO:root:Epoch 64    loss=0.1124 [22.6 s]	 dev=(HR@5:0.4891,NDCG@5:0.3467) test=(HR@5:0.4361,NDCG@5:0.3020) [43.9 s] 
INFO:root:all_losses: [0.11086944 0.04876571]
INFO:root:Epoch 65    loss=0.1109 [22.6 s]	 dev=(HR@5:0.4930,NDCG@5:0.3508) test=(HR@5:0.4340,NDCG@5:0.3019) [43.9 s] 
INFO:root:all_losses: [0.11357693 0.05109707]
INFO:root:Epoch 66    loss=0.1136 [22.5 s]	 dev=(HR@5:0.4905,NDCG@5:0.3465) test=(HR@5:0.4326,NDCG@5:0.2963) [43.9 s] 
INFO:root:all_losses: [0.11691909 0.05228064]
INFO:root:Epoch 67    loss=0.1169 [22.5 s]	 dev=(HR@5:0.4907,NDCG@5:0.3474) test=(HR@5:0.4377,NDCG@5:0.3052) [43.9 s] 
INFO:root:all_losses: [0.11389264 0.05042165]
INFO:root:Epoch 68    loss=0.1139 [22.5 s]	 dev=(HR@5:0.4901,NDCG@5:0.3510) test=(HR@5:0.4365,NDCG@5:0.3065) [44.1 s] 
INFO:root:Early stop at 68 based on dev result.
INFO:root:
Best Iter(dev)=   48	 dev=(HR@5:0.5070,NDCG@5:0.3580) test=(HR@5:0.4410,NDCG@5:0.3081) [4478.0 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6071,HR@5:0.4412,HR@50:0.8858,NDCG@10:0.3620,NDCG@5:0.3081,NDCG@50:0.4246)
INFO:root:
--------------------------------------------- END: 2024-12-31 14:00:33 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-31 14:07:02 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.299604  0.6931139]
INFO:root:Epoch 1     loss=1.2996 [19.1 s]	 dev=(HR@5:0.1119,NDCG@5:0.0654) test=(HR@5:0.0718,NDCG@5:0.0416) [37.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2426323  0.69297564]
INFO:root:Epoch 2     loss=1.2426 [17.9 s]	 dev=(HR@5:0.1140,NDCG@5:0.0679) test=(HR@5:0.0746,NDCG@5:0.0434) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2390735 0.6926374]
INFO:root:Epoch 3     loss=1.2391 [17.9 s]	 dev=(HR@5:0.1123,NDCG@5:0.0650) test=(HR@5:0.0714,NDCG@5:0.0409) [37.5 s] 
INFO:root:all_losses: [1.2352403 0.6922459]
INFO:root:Epoch 4     loss=1.2352 [23.8 s]	 dev=(HR@5:0.1156,NDCG@5:0.0680) test=(HR@5:0.0734,NDCG@5:0.0427) [37.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1979313  0.69144964]
INFO:root:Epoch 5     loss=1.1979 [19.6 s]	 dev=(HR@5:0.1564,NDCG@5:0.0944) test=(HR@5:0.1140,NDCG@5:0.0695) [37.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1639972  0.68801665]
INFO:root:Epoch 6     loss=1.1640 [17.9 s]	 dev=(HR@5:0.1657,NDCG@5:0.1038) test=(HR@5:0.1225,NDCG@5:0.0788) [37.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1326402 0.6788236]
INFO:root:Epoch 7     loss=1.1326 [18.0 s]	 dev=(HR@5:0.1800,NDCG@5:0.1102) test=(HR@5:0.1335,NDCG@5:0.0841) [37.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0963026  0.65300745]
INFO:root:Epoch 8     loss=1.0963 [18.1 s]	 dev=(HR@5:0.1704,NDCG@5:0.1051) test=(HR@5:0.1240,NDCG@5:0.0791) [37.8 s] 
INFO:root:all_losses: [1.0285075  0.59875005]
INFO:root:Epoch 9     loss=1.0285 [19.8 s]	 dev=(HR@5:0.1821,NDCG@5:0.1123) test=(HR@5:0.1348,NDCG@5:0.0839) [37.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9357422 0.5323395]
INFO:root:Epoch 10    loss=0.9357 [21.8 s]	 dev=(HR@5:0.2031,NDCG@5:0.1274) test=(HR@5:0.1452,NDCG@5:0.0922) [45.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.83655167 0.4632189 ]
INFO:root:Epoch 11    loss=0.8366 [22.4 s]	 dev=(HR@5:0.2583,NDCG@5:0.1601) test=(HR@5:0.1841,NDCG@5:0.1169) [45.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.73848367 0.3939637 ]
INFO:root:Epoch 12    loss=0.7385 [22.9 s]	 dev=(HR@5:0.2820,NDCG@5:0.1775) test=(HR@5:0.2073,NDCG@5:0.1300) [45.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6443752  0.32887203]
INFO:root:Epoch 13    loss=0.6444 [22.8 s]	 dev=(HR@5:0.3009,NDCG@5:0.1890) test=(HR@5:0.2234,NDCG@5:0.1419) [45.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.56661    0.28225362]
INFO:root:Epoch 14    loss=0.5666 [22.5 s]	 dev=(HR@5:0.3303,NDCG@5:0.2136) test=(HR@5:0.2375,NDCG@5:0.1538) [45.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5088649  0.24747089]
INFO:root:Epoch 15    loss=0.5089 [22.9 s]	 dev=(HR@5:0.3684,NDCG@5:0.2387) test=(HR@5:0.2732,NDCG@5:0.1765) [45.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4652918  0.21981898]
INFO:root:Epoch 16    loss=0.4653 [22.6 s]	 dev=(HR@5:0.3923,NDCG@5:0.2563) test=(HR@5:0.3085,NDCG@5:0.1989) [44.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4232415  0.19639915]
INFO:root:Epoch 17    loss=0.4232 [22.5 s]	 dev=(HR@5:0.4137,NDCG@5:0.2709) test=(HR@5:0.3258,NDCG@5:0.2107) [44.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.38183534 0.17466445]
INFO:root:Epoch 18    loss=0.3818 [22.8 s]	 dev=(HR@5:0.4239,NDCG@5:0.2840) test=(HR@5:0.3274,NDCG@5:0.2140) [44.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.36164042 0.160963  ]
INFO:root:Epoch 19    loss=0.3616 [22.4 s]	 dev=(HR@5:0.4396,NDCG@5:0.2940) test=(HR@5:0.3482,NDCG@5:0.2314) [45.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33897233 0.14829218]
INFO:root:Epoch 20    loss=0.3390 [22.5 s]	 dev=(HR@5:0.4491,NDCG@5:0.3033) test=(HR@5:0.3725,NDCG@5:0.2465) [45.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31834653 0.13831714]
INFO:root:Epoch 21    loss=0.3183 [22.7 s]	 dev=(HR@5:0.4485,NDCG@5:0.3056) test=(HR@5:0.3676,NDCG@5:0.2460) [44.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.30442643 0.12811115]
INFO:root:Epoch 22    loss=0.3044 [22.4 s]	 dev=(HR@5:0.4528,NDCG@5:0.3106) test=(HR@5:0.3706,NDCG@5:0.2493) [44.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29020467 0.12198465]
INFO:root:Epoch 23    loss=0.2902 [22.7 s]	 dev=(HR@5:0.4540,NDCG@5:0.3126) test=(HR@5:0.3841,NDCG@5:0.2556) [44.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27104574 0.11438165]
INFO:root:Epoch 24    loss=0.2710 [22.7 s]	 dev=(HR@5:0.4393,NDCG@5:0.3009) test=(HR@5:0.3543,NDCG@5:0.2355) [44.7 s] 
INFO:root:all_losses: [0.26031217 0.11081828]
INFO:root:Epoch 25    loss=0.2603 [22.5 s]	 dev=(HR@5:0.4624,NDCG@5:0.3162) test=(HR@5:0.3986,NDCG@5:0.2654) [44.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2545976  0.10570122]
INFO:root:Epoch 26    loss=0.2546 [22.4 s]	 dev=(HR@5:0.4302,NDCG@5:0.2921) test=(HR@5:0.3384,NDCG@5:0.2303) [44.5 s] 
INFO:root:all_losses: [0.24347639 0.09987427]
INFO:root:Epoch 27    loss=0.2435 [22.8 s]	 dev=(HR@5:0.4842,NDCG@5:0.3298) test=(HR@5:0.4143,NDCG@5:0.2794) [44.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23329209 0.09677595]
INFO:root:Epoch 28    loss=0.2333 [22.5 s]	 dev=(HR@5:0.4734,NDCG@5:0.3247) test=(HR@5:0.3882,NDCG@5:0.2631) [44.4 s] 
INFO:root:all_losses: [0.22468716 0.09448086]
INFO:root:Epoch 29    loss=0.2247 [22.4 s]	 dev=(HR@5:0.4599,NDCG@5:0.3167) test=(HR@5:0.3814,NDCG@5:0.2584) [44.4 s] 
INFO:root:all_losses: [0.21962957 0.09271567]
INFO:root:Epoch 30    loss=0.2196 [22.4 s]	 dev=(HR@5:0.4679,NDCG@5:0.3220) test=(HR@5:0.3837,NDCG@5:0.2649) [44.3 s] 
INFO:root:all_losses: [0.21392968 0.08881382]
INFO:root:Epoch 31    loss=0.2139 [22.5 s]	 dev=(HR@5:0.4640,NDCG@5:0.3215) test=(HR@5:0.3910,NDCG@5:0.2648) [44.3 s] 
INFO:root:all_losses: [0.21380761 0.09027313]
INFO:root:Epoch 32    loss=0.2138 [22.3 s]	 dev=(HR@5:0.4840,NDCG@5:0.3366) test=(HR@5:0.4188,NDCG@5:0.2863) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19915536 0.08496568]
INFO:root:Epoch 33    loss=0.1992 [22.7 s]	 dev=(HR@5:0.5028,NDCG@5:0.3495) test=(HR@5:0.4285,NDCG@5:0.2941) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19320206 0.08152705]
INFO:root:Epoch 34    loss=0.1932 [22.4 s]	 dev=(HR@5:0.4742,NDCG@5:0.3305) test=(HR@5:0.3878,NDCG@5:0.2647) [44.2 s] 
INFO:root:all_losses: [0.19193754 0.08249555]
INFO:root:Epoch 35    loss=0.1919 [22.4 s]	 dev=(HR@5:0.5099,NDCG@5:0.3547) test=(HR@5:0.4544,NDCG@5:0.3101) [44.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18573205 0.07764123]
INFO:root:Epoch 36    loss=0.1857 [22.4 s]	 dev=(HR@5:0.4809,NDCG@5:0.3317) test=(HR@5:0.4126,NDCG@5:0.2805) [44.4 s] 
INFO:root:all_losses: [0.18428151 0.07750746]
INFO:root:Epoch 37    loss=0.1843 [22.5 s]	 dev=(HR@5:0.4866,NDCG@5:0.3407) test=(HR@5:0.4059,NDCG@5:0.2807) [44.1 s] 
INFO:root:all_losses: [0.1802082  0.07697866]
INFO:root:Epoch 38    loss=0.1802 [22.6 s]	 dev=(HR@5:0.5005,NDCG@5:0.3493) test=(HR@5:0.4308,NDCG@5:0.2957) [44.2 s] 
INFO:root:all_losses: [0.1724581  0.07494387]
INFO:root:Epoch 39    loss=0.1725 [22.3 s]	 dev=(HR@5:0.4966,NDCG@5:0.3478) test=(HR@5:0.4214,NDCG@5:0.2900) [44.2 s] 
INFO:root:all_losses: [0.17416452 0.0726409 ]
INFO:root:Epoch 40    loss=0.1742 [22.4 s]	 dev=(HR@5:0.5015,NDCG@5:0.3504) test=(HR@5:0.4502,NDCG@5:0.3061) [44.1 s] 
INFO:root:all_losses: [0.16890976 0.07137439]
INFO:root:Epoch 41    loss=0.1689 [22.7 s]	 dev=(HR@5:0.4871,NDCG@5:0.3411) test=(HR@5:0.4155,NDCG@5:0.2854) [44.1 s] 
INFO:root:all_losses: [0.16570976 0.07407267]
INFO:root:Epoch 42    loss=0.1657 [22.3 s]	 dev=(HR@5:0.4907,NDCG@5:0.3453) test=(HR@5:0.4171,NDCG@5:0.2873) [44.1 s] 
INFO:root:all_losses: [0.1641739  0.06781205]
INFO:root:Epoch 43    loss=0.1642 [22.5 s]	 dev=(HR@5:0.4760,NDCG@5:0.3337) test=(HR@5:0.4094,NDCG@5:0.2836) [44.2 s] 
INFO:root:all_losses: [0.16117996 0.0694387 ]
INFO:root:Epoch 44    loss=0.1612 [22.7 s]	 dev=(HR@5:0.4801,NDCG@5:0.3375) test=(HR@5:0.4169,NDCG@5:0.2863) [44.0 s] 
INFO:root:all_losses: [0.15745024 0.0671896 ]
INFO:root:Epoch 45    loss=0.1575 [22.4 s]	 dev=(HR@5:0.4701,NDCG@5:0.3319) test=(HR@5:0.4090,NDCG@5:0.2806) [44.1 s] 
INFO:root:all_losses: [0.15537763 0.06917197]
INFO:root:Epoch 46    loss=0.1554 [22.6 s]	 dev=(HR@5:0.5070,NDCG@5:0.3556) test=(HR@5:0.4512,NDCG@5:0.3101) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15081784 0.06415525]
INFO:root:Epoch 47    loss=0.1508 [22.8 s]	 dev=(HR@5:0.4877,NDCG@5:0.3397) test=(HR@5:0.4171,NDCG@5:0.2848) [44.1 s] 
INFO:root:all_losses: [0.15270148 0.06532908]
INFO:root:Epoch 48    loss=0.1527 [22.4 s]	 dev=(HR@5:0.5044,NDCG@5:0.3534) test=(HR@5:0.4430,NDCG@5:0.3059) [44.0 s] 
INFO:root:all_losses: [0.14871441 0.06368037]
INFO:root:Epoch 49    loss=0.1487 [22.4 s]	 dev=(HR@5:0.4740,NDCG@5:0.3311) test=(HR@5:0.4108,NDCG@5:0.2811) [43.8 s] 
INFO:root:all_losses: [0.1463791  0.06370849]
INFO:root:Epoch 50    loss=0.1464 [22.7 s]	 dev=(HR@5:0.4977,NDCG@5:0.3510) test=(HR@5:0.4332,NDCG@5:0.2972) [43.8 s] 
INFO:root:all_losses: [0.1449671  0.06317796]
INFO:root:Epoch 51    loss=0.1450 [22.3 s]	 dev=(HR@5:0.4934,NDCG@5:0.3488) test=(HR@5:0.4330,NDCG@5:0.3002) [43.9 s] 
INFO:root:all_losses: [0.14043729 0.06114823]
INFO:root:Epoch 52    loss=0.1404 [22.4 s]	 dev=(HR@5:0.5028,NDCG@5:0.3539) test=(HR@5:0.4387,NDCG@5:0.3039) [43.9 s] 
INFO:root:all_losses: [0.13993861 0.06175883]
INFO:root:Epoch 53    loss=0.1399 [22.8 s]	 dev=(HR@5:0.4848,NDCG@5:0.3409) test=(HR@5:0.4257,NDCG@5:0.2917) [43.9 s] 
INFO:root:all_losses: [0.14129595 0.06184928]
INFO:root:Epoch 54    loss=0.1413 [22.4 s]	 dev=(HR@5:0.4960,NDCG@5:0.3501) test=(HR@5:0.4328,NDCG@5:0.2986) [44.1 s] 
INFO:root:all_losses: [0.13595414 0.06036336]
INFO:root:Epoch 55    loss=0.1360 [24.1 s]	 dev=(HR@5:0.4803,NDCG@5:0.3367) test=(HR@5:0.4263,NDCG@5:0.2924) [44.4 s] 
INFO:root:all_losses: [0.13957357 0.06108495]
INFO:root:Epoch 56    loss=0.1396 [23.3 s]	 dev=(HR@5:0.4915,NDCG@5:0.3470) test=(HR@5:0.4328,NDCG@5:0.2983) [44.5 s] 
INFO:root:all_losses: [0.12977211 0.05681533]
INFO:root:Epoch 57    loss=0.1298 [23.3 s]	 dev=(HR@5:0.5115,NDCG@5:0.3578) test=(HR@5:0.4591,NDCG@5:0.3130) [44.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13004899 0.05680263]
INFO:root:Epoch 58    loss=0.1300 [23.1 s]	 dev=(HR@5:0.5050,NDCG@5:0.3556) test=(HR@5:0.4442,NDCG@5:0.3063) [44.4 s] 
INFO:root:all_losses: [0.13176575 0.05856906]
INFO:root:Epoch 59    loss=0.1318 [23.5 s]	 dev=(HR@5:0.4928,NDCG@5:0.3437) test=(HR@5:0.4334,NDCG@5:0.2998) [44.3 s] 
INFO:root:all_losses: [0.12567542 0.05707375]
INFO:root:Epoch 60    loss=0.1257 [23.5 s]	 dev=(HR@5:0.4946,NDCG@5:0.3456) test=(HR@5:0.4251,NDCG@5:0.2934) [44.6 s] 
INFO:root:all_losses: [0.13326114 0.05347475]
INFO:root:Epoch 61    loss=0.1333 [23.4 s]	 dev=(HR@5:0.5048,NDCG@5:0.3546) test=(HR@5:0.4473,NDCG@5:0.3062) [44.4 s] 
INFO:root:all_losses: [0.1335797  0.05750093]
INFO:root:Epoch 62    loss=0.1336 [22.9 s]	 dev=(HR@5:0.5021,NDCG@5:0.3524) test=(HR@5:0.4510,NDCG@5:0.3120) [44.4 s] 
INFO:root:all_losses: [0.12455257 0.05440862]
INFO:root:Epoch 63    loss=0.1246 [26.0 s]	 dev=(HR@5:0.4907,NDCG@5:0.3456) test=(HR@5:0.4393,NDCG@5:0.3056) [45.7 s] 
INFO:root:all_losses: [0.1213816  0.05337116]
INFO:root:Epoch 64    loss=0.1214 [25.3 s]	 dev=(HR@5:0.5001,NDCG@5:0.3520) test=(HR@5:0.4369,NDCG@5:0.2985) [44.1 s] 
INFO:root:all_losses: [0.11895585 0.05124449]
INFO:root:Epoch 65    loss=0.1190 [22.4 s]	 dev=(HR@5:0.5066,NDCG@5:0.3570) test=(HR@5:0.4626,NDCG@5:0.3149) [44.1 s] 
INFO:root:all_losses: [0.11940451 0.05357007]
INFO:root:Epoch 66    loss=0.1194 [22.7 s]	 dev=(HR@5:0.5103,NDCG@5:0.3575) test=(HR@5:0.4457,NDCG@5:0.3049) [44.1 s] 
INFO:root:all_losses: [0.12042888 0.05376394]
INFO:root:Epoch 67    loss=0.1204 [22.6 s]	 dev=(HR@5:0.4997,NDCG@5:0.3506) test=(HR@5:0.4391,NDCG@5:0.3019) [43.9 s] 
INFO:root:all_losses: [0.11912257 0.0529266 ]
INFO:root:Epoch 68    loss=0.1191 [22.7 s]	 dev=(HR@5:0.4932,NDCG@5:0.3473) test=(HR@5:0.4226,NDCG@5:0.2957) [44.8 s] 
INFO:root:all_losses: [0.11722057 0.05330855]
INFO:root:Epoch 69    loss=0.1172 [23.4 s]	 dev=(HR@5:0.4989,NDCG@5:0.3522) test=(HR@5:0.4393,NDCG@5:0.3047) [44.8 s] 
INFO:root:all_losses: [0.12192188 0.05513945]
INFO:root:Epoch 70    loss=0.1219 [23.8 s]	 dev=(HR@5:0.5070,NDCG@5:0.3560) test=(HR@5:0.4400,NDCG@5:0.3043) [44.9 s] 
INFO:root:all_losses: [0.11502887 0.05205559]
INFO:root:Epoch 71    loss=0.1150 [23.4 s]	 dev=(HR@5:0.5072,NDCG@5:0.3551) test=(HR@5:0.4436,NDCG@5:0.3058) [44.7 s] 
INFO:root:all_losses: [0.11788175 0.05257039]
INFO:root:Epoch 72    loss=0.1179 [23.6 s]	 dev=(HR@5:0.4964,NDCG@5:0.3468) test=(HR@5:0.4332,NDCG@5:0.3011) [45.1 s] 
INFO:root:all_losses: [0.11251638 0.05006496]
INFO:root:Epoch 73    loss=0.1125 [24.0 s]	 dev=(HR@5:0.4964,NDCG@5:0.3524) test=(HR@5:0.4269,NDCG@5:0.2946) [44.7 s] 
INFO:root:all_losses: [0.11380769 0.05069827]
INFO:root:Epoch 74    loss=0.1138 [23.9 s]	 dev=(HR@5:0.4883,NDCG@5:0.3440) test=(HR@5:0.4263,NDCG@5:0.2954) [43.1 s] 
INFO:root:all_losses: [0.1102327  0.04911245]
INFO:root:Epoch 75    loss=0.1102 [20.5 s]	 dev=(HR@5:0.5070,NDCG@5:0.3589) test=(HR@5:0.4499,NDCG@5:0.3097) [42.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11309731 0.05058434]
INFO:root:Epoch 76    loss=0.1131 [20.2 s]	 dev=(HR@5:0.5064,NDCG@5:0.3568) test=(HR@5:0.4559,NDCG@5:0.3127) [41.6 s] 
INFO:root:all_losses: [0.10911468 0.04938734]
INFO:root:Epoch 77    loss=0.1091 [20.6 s]	 dev=(HR@5:0.5134,NDCG@5:0.3641) test=(HR@5:0.4669,NDCG@5:0.3203) [41.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11014562 0.04960134]
INFO:root:Epoch 78    loss=0.1101 [20.2 s]	 dev=(HR@5:0.4942,NDCG@5:0.3540) test=(HR@5:0.4487,NDCG@5:0.3114) [42.1 s] 
INFO:root:all_losses: [0.10700026 0.04803725]
INFO:root:Epoch 79    loss=0.1070 [20.2 s]	 dev=(HR@5:0.4981,NDCG@5:0.3526) test=(HR@5:0.4393,NDCG@5:0.3046) [41.6 s] 
INFO:root:all_losses: [0.10641056 0.04843877]
INFO:root:Epoch 80    loss=0.1064 [20.5 s]	 dev=(HR@5:0.4966,NDCG@5:0.3522) test=(HR@5:0.4310,NDCG@5:0.2994) [41.8 s] 
INFO:root:all_losses: [0.11479015 0.05149083]
INFO:root:Epoch 81    loss=0.1148 [20.0 s]	 dev=(HR@5:0.5005,NDCG@5:0.3520) test=(HR@5:0.4322,NDCG@5:0.2989) [41.8 s] 
INFO:root:Early stop at 81 based on dev result.
INFO:root:
Best Iter(dev)=   77	 dev=(HR@5:0.5134,NDCG@5:0.3641) test=(HR@5:0.4669,NDCG@5:0.3203) [5320.8 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6218,HR@5:0.4669,HR@50:0.8842,NDCG@10:0.3706,NDCG@5:0.3203,NDCG@50:0.4291)
INFO:root:
--------------------------------------------- END: 2024-12-31 15:36:24 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-31 16:38:33 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2996254 0.6931138]
INFO:root:Epoch 1     loss=1.2996 [19.5 s]	 dev=(HR@5:0.1125,NDCG@5:0.0656) test=(HR@5:0.0714,NDCG@5:0.0414) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242534   0.69297606]
INFO:root:Epoch 2     loss=1.2425 [18.6 s]	 dev=(HR@5:0.1187,NDCG@5:0.0690) test=(HR@5:0.0744,NDCG@5:0.0432) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2136701  0.69250304]
INFO:root:Epoch 3     loss=1.2137 [18.5 s]	 dev=(HR@5:0.1572,NDCG@5:0.0973) test=(HR@5:0.1197,NDCG@5:0.0747) [29.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1697632 0.6906773]
INFO:root:Epoch 4     loss=1.1698 [18.1 s]	 dev=(HR@5:0.1647,NDCG@5:0.1019) test=(HR@5:0.1219,NDCG@5:0.0759) [30.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1374482  0.68585753]
INFO:root:Epoch 5     loss=1.1374 [18.1 s]	 dev=(HR@5:0.1829,NDCG@5:0.1098) test=(HR@5:0.1346,NDCG@5:0.0831) [30.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1111805 0.6728974]
INFO:root:Epoch 6     loss=1.1112 [18.4 s]	 dev=(HR@5:0.1757,NDCG@5:0.1088) test=(HR@5:0.1386,NDCG@5:0.0871) [30.0 s] 
INFO:root:all_losses: [1.054887  0.6365959]
INFO:root:Epoch 7     loss=1.0549 [18.5 s]	 dev=(HR@5:0.1996,NDCG@5:0.1208) test=(HR@5:0.1421,NDCG@5:0.0839) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.97830534 0.5767303 ]
INFO:root:Epoch 8     loss=0.9783 [18.3 s]	 dev=(HR@5:0.2047,NDCG@5:0.1246) test=(HR@5:0.1462,NDCG@5:0.0908) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8951454 0.5167113]
INFO:root:Epoch 9     loss=0.8951 [20.0 s]	 dev=(HR@5:0.2516,NDCG@5:0.1561) test=(HR@5:0.1910,NDCG@5:0.1184) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8067561  0.45851368]
INFO:root:Epoch 10    loss=0.8068 [22.8 s]	 dev=(HR@5:0.3032,NDCG@5:0.1948) test=(HR@5:0.2230,NDCG@5:0.1436) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7146324  0.39975184]
INFO:root:Epoch 11    loss=0.7146 [23.7 s]	 dev=(HR@5:0.3246,NDCG@5:0.2088) test=(HR@5:0.2449,NDCG@5:0.1557) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.63267255 0.34415457]
INFO:root:Epoch 12    loss=0.6327 [23.7 s]	 dev=(HR@5:0.3476,NDCG@5:0.2241) test=(HR@5:0.2714,NDCG@5:0.1735) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5603748  0.29334286]
INFO:root:Epoch 13    loss=0.5604 [22.8 s]	 dev=(HR@5:0.3698,NDCG@5:0.2382) test=(HR@5:0.2805,NDCG@5:0.1825) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.50314796 0.2561364 ]
INFO:root:Epoch 14    loss=0.5031 [22.5 s]	 dev=(HR@5:0.3688,NDCG@5:0.2417) test=(HR@5:0.2793,NDCG@5:0.1819) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.46081463 0.22828819]
INFO:root:Epoch 15    loss=0.4608 [24.0 s]	 dev=(HR@5:0.4053,NDCG@5:0.2693) test=(HR@5:0.3199,NDCG@5:0.2078) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.42686513 0.20357443]
INFO:root:Epoch 16    loss=0.4269 [23.4 s]	 dev=(HR@5:0.4096,NDCG@5:0.2727) test=(HR@5:0.3284,NDCG@5:0.2175) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.39573345 0.18321276]
INFO:root:Epoch 17    loss=0.3957 [23.5 s]	 dev=(HR@5:0.4222,NDCG@5:0.2812) test=(HR@5:0.3392,NDCG@5:0.2219) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.36058956 0.16429971]
INFO:root:Epoch 18    loss=0.3606 [23.3 s]	 dev=(HR@5:0.4259,NDCG@5:0.2891) test=(HR@5:0.3392,NDCG@5:0.2265) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3441324  0.15279162]
INFO:root:Epoch 19    loss=0.3441 [25.2 s]	 dev=(HR@5:0.4449,NDCG@5:0.3013) test=(HR@5:0.3649,NDCG@5:0.2444) [38.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32469717 0.14160842]
INFO:root:Epoch 20    loss=0.3247 [25.1 s]	 dev=(HR@5:0.4412,NDCG@5:0.2992) test=(HR@5:0.3590,NDCG@5:0.2417) [38.8 s] 
INFO:root:all_losses: [0.30680946 0.13357438]
INFO:root:Epoch 21    loss=0.3068 [23.8 s]	 dev=(HR@5:0.4659,NDCG@5:0.3171) test=(HR@5:0.3788,NDCG@5:0.2564) [37.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2942794  0.12421108]
INFO:root:Epoch 22    loss=0.2943 [22.9 s]	 dev=(HR@5:0.4626,NDCG@5:0.3157) test=(HR@5:0.3839,NDCG@5:0.2574) [38.0 s] 
INFO:root:all_losses: [0.2810392  0.11766063]
INFO:root:Epoch 23    loss=0.2810 [25.5 s]	 dev=(HR@5:0.4714,NDCG@5:0.3247) test=(HR@5:0.3955,NDCG@5:0.2662) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26555842 0.11126048]
INFO:root:Epoch 24    loss=0.2656 [22.4 s]	 dev=(HR@5:0.4591,NDCG@5:0.3181) test=(HR@5:0.3772,NDCG@5:0.2545) [37.2 s] 
INFO:root:all_losses: [0.25733864 0.10779906]
INFO:root:Epoch 25    loss=0.2573 [22.5 s]	 dev=(HR@5:0.4628,NDCG@5:0.3176) test=(HR@5:0.3817,NDCG@5:0.2581) [36.6 s] 
INFO:root:all_losses: [0.251345   0.10336117]
INFO:root:Epoch 26    loss=0.2513 [22.3 s]	 dev=(HR@5:0.4420,NDCG@5:0.3016) test=(HR@5:0.3572,NDCG@5:0.2413) [36.5 s] 
INFO:root:all_losses: [0.23928346 0.09723748]
INFO:root:Epoch 27    loss=0.2393 [22.2 s]	 dev=(HR@5:0.4813,NDCG@5:0.3321) test=(HR@5:0.4118,NDCG@5:0.2793) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23000179 0.09444384]
INFO:root:Epoch 28    loss=0.2300 [22.3 s]	 dev=(HR@5:0.4809,NDCG@5:0.3334) test=(HR@5:0.3959,NDCG@5:0.2723) [36.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22135551 0.0925595 ]
INFO:root:Epoch 29    loss=0.2214 [22.2 s]	 dev=(HR@5:0.4742,NDCG@5:0.3317) test=(HR@5:0.3992,NDCG@5:0.2742) [36.9 s] 
INFO:root:all_losses: [0.21752934 0.09049854]
INFO:root:Epoch 30    loss=0.2175 [22.3 s]	 dev=(HR@5:0.4718,NDCG@5:0.3263) test=(HR@5:0.3892,NDCG@5:0.2686) [36.7 s] 
INFO:root:all_losses: [0.21559568 0.08708696]
INFO:root:Epoch 31    loss=0.2156 [22.1 s]	 dev=(HR@5:0.4681,NDCG@5:0.3266) test=(HR@5:0.3886,NDCG@5:0.2663) [36.5 s] 
INFO:root:all_losses: [0.21360248 0.08797754]
INFO:root:Epoch 32    loss=0.2136 [23.5 s]	 dev=(HR@5:0.4779,NDCG@5:0.3343) test=(HR@5:0.4147,NDCG@5:0.2830) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.20063807 0.0834919 ]
INFO:root:Epoch 33    loss=0.2006 [22.3 s]	 dev=(HR@5:0.4775,NDCG@5:0.3326) test=(HR@5:0.4006,NDCG@5:0.2773) [36.6 s] 
INFO:root:all_losses: [0.19409086 0.07990114]
INFO:root:Epoch 34    loss=0.1941 [22.1 s]	 dev=(HR@5:0.4750,NDCG@5:0.3325) test=(HR@5:0.3992,NDCG@5:0.2759) [36.5 s] 
INFO:root:all_losses: [0.19464204 0.08082367]
INFO:root:Epoch 35    loss=0.1946 [22.2 s]	 dev=(HR@5:0.4871,NDCG@5:0.3384) test=(HR@5:0.4179,NDCG@5:0.2886) [36.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1866774  0.07687268]
INFO:root:Epoch 36    loss=0.1867 [22.4 s]	 dev=(HR@5:0.4659,NDCG@5:0.3222) test=(HR@5:0.3880,NDCG@5:0.2692) [36.6 s] 
INFO:root:all_losses: [0.18456909 0.07605726]
INFO:root:Epoch 37    loss=0.1846 [22.5 s]	 dev=(HR@5:0.4699,NDCG@5:0.3292) test=(HR@5:0.3943,NDCG@5:0.2757) [37.6 s] 
INFO:root:all_losses: [0.179308   0.07555501]
INFO:root:Epoch 38    loss=0.1793 [23.1 s]	 dev=(HR@5:0.4871,NDCG@5:0.3452) test=(HR@5:0.4257,NDCG@5:0.2968) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17438461 0.07413433]
INFO:root:Epoch 39    loss=0.1744 [22.4 s]	 dev=(HR@5:0.4832,NDCG@5:0.3385) test=(HR@5:0.4212,NDCG@5:0.2929) [36.4 s] 
INFO:root:all_losses: [0.17540298 0.07159032]
INFO:root:Epoch 40    loss=0.1754 [22.4 s]	 dev=(HR@5:0.4911,NDCG@5:0.3440) test=(HR@5:0.4304,NDCG@5:0.3003) [36.3 s] 
INFO:root:all_losses: [0.16854306 0.06922469]
INFO:root:Epoch 41    loss=0.1685 [22.1 s]	 dev=(HR@5:0.4754,NDCG@5:0.3342) test=(HR@5:0.4124,NDCG@5:0.2868) [36.3 s] 
INFO:root:all_losses: [0.16572613 0.07149809]
INFO:root:Epoch 42    loss=0.1657 [22.1 s]	 dev=(HR@5:0.4852,NDCG@5:0.3396) test=(HR@5:0.4159,NDCG@5:0.2904) [36.1 s] 
INFO:root:all_losses: [0.16290155 0.06701597]
INFO:root:Epoch 43    loss=0.1629 [22.9 s]	 dev=(HR@5:0.4622,NDCG@5:0.3265) test=(HR@5:0.4014,NDCG@5:0.2835) [36.9 s] 
INFO:root:all_losses: [0.15971865 0.06779433]
INFO:root:Epoch 44    loss=0.1597 [22.6 s]	 dev=(HR@5:0.4740,NDCG@5:0.3360) test=(HR@5:0.4120,NDCG@5:0.2868) [36.9 s] 
INFO:root:all_losses: [0.15763678 0.06596244]
INFO:root:Epoch 45    loss=0.1576 [23.1 s]	 dev=(HR@5:0.4873,NDCG@5:0.3431) test=(HR@5:0.4318,NDCG@5:0.2992) [37.3 s] 
INFO:root:all_losses: [0.1554882 0.0674886]
INFO:root:Epoch 46    loss=0.1555 [22.7 s]	 dev=(HR@5:0.4942,NDCG@5:0.3503) test=(HR@5:0.4365,NDCG@5:0.3041) [36.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14878972 0.06228689]
INFO:root:Epoch 47    loss=0.1488 [22.6 s]	 dev=(HR@5:0.4954,NDCG@5:0.3475) test=(HR@5:0.4436,NDCG@5:0.3068) [36.2 s] 
INFO:root:all_losses: [0.15138207 0.06399576]
INFO:root:Epoch 48    loss=0.1514 [22.1 s]	 dev=(HR@5:0.5054,NDCG@5:0.3571) test=(HR@5:0.4451,NDCG@5:0.3092) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14833549 0.06208709]
INFO:root:Epoch 49    loss=0.1483 [22.5 s]	 dev=(HR@5:0.4783,NDCG@5:0.3389) test=(HR@5:0.4194,NDCG@5:0.2937) [36.2 s] 
INFO:root:all_losses: [0.14832401 0.06292275]
INFO:root:Epoch 50    loss=0.1483 [22.2 s]	 dev=(HR@5:0.4824,NDCG@5:0.3406) test=(HR@5:0.4294,NDCG@5:0.2998) [36.0 s] 
INFO:root:all_losses: [0.14435685 0.06253387]
INFO:root:Epoch 51    loss=0.1444 [22.1 s]	 dev=(HR@5:0.4862,NDCG@5:0.3473) test=(HR@5:0.4318,NDCG@5:0.3032) [36.7 s] 
INFO:root:all_losses: [0.14098985 0.06060645]
INFO:root:Epoch 52    loss=0.1410 [22.6 s]	 dev=(HR@5:0.4877,NDCG@5:0.3465) test=(HR@5:0.4269,NDCG@5:0.2998) [36.6 s] 
INFO:root:all_losses: [0.13833536 0.0601363 ]
INFO:root:Epoch 53    loss=0.1383 [22.6 s]	 dev=(HR@5:0.4873,NDCG@5:0.3450) test=(HR@5:0.4228,NDCG@5:0.3004) [36.5 s] 
INFO:root:all_losses: [0.13659924 0.06028446]
INFO:root:Epoch 54    loss=0.1366 [22.5 s]	 dev=(HR@5:0.4875,NDCG@5:0.3463) test=(HR@5:0.4312,NDCG@5:0.3016) [45.7 s] 
INFO:root:all_losses: [0.13546674 0.0602599 ]
INFO:root:Epoch 55    loss=0.1355 [150.3 s]	 dev=(HR@5:0.4771,NDCG@5:0.3421) test=(HR@5:0.4167,NDCG@5:0.2937) [76.7 s] 
INFO:root:all_losses: [0.13873267 0.06064168]
INFO:root:Epoch 56    loss=0.1387 [150.1 s]	 dev=(HR@5:0.4693,NDCG@5:0.3345) test=(HR@5:0.4096,NDCG@5:0.2878) [76.6 s] 
INFO:root:all_losses: [0.12946913 0.05640564]
INFO:root:Epoch 57    loss=0.1295 [149.8 s]	 dev=(HR@5:0.4930,NDCG@5:0.3468) test=(HR@5:0.4400,NDCG@5:0.3092) [76.3 s] 
INFO:root:all_losses: [0.12861447 0.05570779]
INFO:root:Epoch 58    loss=0.1286 [151.4 s]	 dev=(HR@5:0.4968,NDCG@5:0.3504) test=(HR@5:0.4438,NDCG@5:0.3107) [76.3 s] 
INFO:root:all_losses: [0.13101149 0.05795162]
INFO:root:Epoch 59    loss=0.1310 [149.4 s]	 dev=(HR@5:0.4956,NDCG@5:0.3466) test=(HR@5:0.4440,NDCG@5:0.3078) [76.1 s] 
INFO:root:all_losses: [0.12452696 0.0551457 ]
INFO:root:Epoch 60    loss=0.1245 [149.0 s]	 dev=(HR@5:0.4799,NDCG@5:0.3420) test=(HR@5:0.4355,NDCG@5:0.3048) [76.3 s] 
INFO:root:all_losses: [0.12260751 0.05222505]
INFO:root:Epoch 61    loss=0.1226 [149.0 s]	 dev=(HR@5:0.4956,NDCG@5:0.3539) test=(HR@5:0.4396,NDCG@5:0.3085) [76.4 s] 
INFO:root:all_losses: [0.12812817 0.05617196]
INFO:root:Epoch 62    loss=0.1281 [148.8 s]	 dev=(HR@5:0.4667,NDCG@5:0.3305) test=(HR@5:0.4045,NDCG@5:0.2831) [76.5 s] 
INFO:root:all_losses: [0.1213966  0.05243184]
INFO:root:Epoch 63    loss=0.1214 [146.2 s]	 dev=(HR@5:0.5003,NDCG@5:0.3563) test=(HR@5:0.4371,NDCG@5:0.3099) [76.7 s] 
INFO:root:all_losses: [0.11729517 0.05124757]
INFO:root:Epoch 64    loss=0.1173 [149.4 s]	 dev=(HR@5:0.4897,NDCG@5:0.3491) test=(HR@5:0.4402,NDCG@5:0.3088) [76.4 s] 
INFO:root:all_losses: [0.11756685 0.05065195]
INFO:root:Epoch 65    loss=0.1176 [150.5 s]	 dev=(HR@5:0.4799,NDCG@5:0.3410) test=(HR@5:0.4212,NDCG@5:0.2977) [76.2 s] 
INFO:root:all_losses: [0.11796878 0.05289362]
INFO:root:Epoch 66    loss=0.1180 [150.3 s]	 dev=(HR@5:0.4873,NDCG@5:0.3472) test=(HR@5:0.4471,NDCG@5:0.3094) [76.3 s] 
INFO:root:all_losses: [0.12002137 0.05266601]
INFO:root:Epoch 67    loss=0.1200 [149.8 s]	 dev=(HR@5:0.4832,NDCG@5:0.3435) test=(HR@5:0.4273,NDCG@5:0.3016) [75.7 s] 
INFO:root:all_losses: [0.11610702 0.05158442]
INFO:root:Epoch 68    loss=0.1161 [150.1 s]	 dev=(HR@5:0.4787,NDCG@5:0.3429) test=(HR@5:0.4241,NDCG@5:0.2998) [76.3 s] 
INFO:root:Early stop at 68 based on dev result.
INFO:root:
Best Iter(dev)=   48	 dev=(HR@5:0.5054,NDCG@5:0.3571) test=(HR@5:0.4451,NDCG@5:0.3092) [6308.0 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6055,HR@5:0.4449,HR@50:0.8875,NDCG@10:0.3612,NDCG@5:0.3090,NDCG@50:0.4243)
INFO:root:
--------------------------------------------- END: 2024-12-31 18:24:36 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-31 18:43:18 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2996012 0.6931139]
INFO:root:Epoch 1     loss=1.2996 [18.4 s]	 dev=(HR@5:0.1113,NDCG@5:0.0650) test=(HR@5:0.0709,NDCG@5:0.0412) [29.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2422163 0.6929754]
INFO:root:Epoch 2     loss=1.2422 [17.7 s]	 dev=(HR@5:0.1144,NDCG@5:0.0679) test=(HR@5:0.0712,NDCG@5:0.0420) [30.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2385212 0.6926328]
INFO:root:Epoch 3     loss=1.2385 [17.9 s]	 dev=(HR@5:0.1131,NDCG@5:0.0669) test=(HR@5:0.0744,NDCG@5:0.0423) [30.0 s] 
INFO:root:all_losses: [1.2332577 0.6922178]
INFO:root:Epoch 4     loss=1.2333 [23.2 s]	 dev=(HR@5:0.1154,NDCG@5:0.0679) test=(HR@5:0.0738,NDCG@5:0.0427) [30.2 s] 
INFO:root:all_losses: [1.1943243  0.69137686]
INFO:root:Epoch 5     loss=1.1943 [18.0 s]	 dev=(HR@5:0.1672,NDCG@5:0.1008) test=(HR@5:0.1231,NDCG@5:0.0742) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1538624 0.6876379]
INFO:root:Epoch 6     loss=1.1539 [17.7 s]	 dev=(HR@5:0.1672,NDCG@5:0.1041) test=(HR@5:0.1333,NDCG@5:0.0824) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1212671 0.6772826]
INFO:root:Epoch 7     loss=1.1213 [18.0 s]	 dev=(HR@5:0.1902,NDCG@5:0.1147) test=(HR@5:0.1331,NDCG@5:0.0820) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.076911  0.6468516]
INFO:root:Epoch 8     loss=1.0769 [18.1 s]	 dev=(HR@5:0.1800,NDCG@5:0.1103) test=(HR@5:0.1307,NDCG@5:0.0809) [30.2 s] 
INFO:root:all_losses: [0.99494874 0.58546394]
INFO:root:Epoch 9     loss=0.9949 [19.1 s]	 dev=(HR@5:0.2116,NDCG@5:0.1297) test=(HR@5:0.1539,NDCG@5:0.0989) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8864942 0.5124001]
INFO:root:Epoch 10    loss=0.8865 [21.5 s]	 dev=(HR@5:0.2481,NDCG@5:0.1593) test=(HR@5:0.1812,NDCG@5:0.1148) [37.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7775932  0.43846357]
INFO:root:Epoch 11    loss=0.7776 [22.4 s]	 dev=(HR@5:0.3140,NDCG@5:0.1997) test=(HR@5:0.2353,NDCG@5:0.1520) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6734955  0.36909318]
INFO:root:Epoch 12    loss=0.6735 [22.2 s]	 dev=(HR@5:0.3498,NDCG@5:0.2267) test=(HR@5:0.2693,NDCG@5:0.1770) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5841503  0.30864504]
INFO:root:Epoch 13    loss=0.5842 [22.2 s]	 dev=(HR@5:0.3607,NDCG@5:0.2370) test=(HR@5:0.2813,NDCG@5:0.1842) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.51383376 0.26549056]
INFO:root:Epoch 14    loss=0.5138 [22.3 s]	 dev=(HR@5:0.3855,NDCG@5:0.2551) test=(HR@5:0.2940,NDCG@5:0.1943) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.46610725 0.23402172]
INFO:root:Epoch 15    loss=0.4661 [22.5 s]	 dev=(HR@5:0.3837,NDCG@5:0.2564) test=(HR@5:0.2989,NDCG@5:0.1969) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.42745167 0.20783418]
INFO:root:Epoch 16    loss=0.4275 [22.4 s]	 dev=(HR@5:0.4096,NDCG@5:0.2736) test=(HR@5:0.3235,NDCG@5:0.2139) [36.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.39505053 0.18772283]
INFO:root:Epoch 17    loss=0.3951 [22.1 s]	 dev=(HR@5:0.4145,NDCG@5:0.2763) test=(HR@5:0.3189,NDCG@5:0.2093) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3572818  0.16779488]
INFO:root:Epoch 18    loss=0.3573 [22.2 s]	 dev=(HR@5:0.4412,NDCG@5:0.2983) test=(HR@5:0.3574,NDCG@5:0.2383) [37.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33881   0.1567314]
INFO:root:Epoch 19    loss=0.3388 [22.5 s]	 dev=(HR@5:0.4455,NDCG@5:0.2993) test=(HR@5:0.3657,NDCG@5:0.2433) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31917006 0.14567935]
INFO:root:Epoch 20    loss=0.3192 [22.4 s]	 dev=(HR@5:0.4516,NDCG@5:0.3052) test=(HR@5:0.3715,NDCG@5:0.2471) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29931152 0.1364341 ]
INFO:root:Epoch 21    loss=0.2993 [22.1 s]	 dev=(HR@5:0.4550,NDCG@5:0.3107) test=(HR@5:0.3808,NDCG@5:0.2561) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28747416 0.12747495]
INFO:root:Epoch 22    loss=0.2875 [22.0 s]	 dev=(HR@5:0.4601,NDCG@5:0.3146) test=(HR@5:0.3886,NDCG@5:0.2602) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27381548 0.12112147]
INFO:root:Epoch 23    loss=0.2738 [22.3 s]	 dev=(HR@5:0.4618,NDCG@5:0.3167) test=(HR@5:0.3945,NDCG@5:0.2618) [36.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.25820985 0.11405569]
INFO:root:Epoch 24    loss=0.2582 [22.0 s]	 dev=(HR@5:0.4398,NDCG@5:0.2986) test=(HR@5:0.3621,NDCG@5:0.2403) [36.7 s] 
INFO:root:all_losses: [0.24653074 0.10978552]
INFO:root:Epoch 25    loss=0.2465 [22.1 s]	 dev=(HR@5:0.4575,NDCG@5:0.3131) test=(HR@5:0.3963,NDCG@5:0.2675) [36.5 s] 
INFO:root:all_losses: [0.24496634 0.10591037]
INFO:root:Epoch 26    loss=0.2450 [22.1 s]	 dev=(HR@5:0.4697,NDCG@5:0.3183) test=(HR@5:0.3788,NDCG@5:0.2608) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23061621 0.10003208]
INFO:root:Epoch 27    loss=0.2306 [22.0 s]	 dev=(HR@5:0.4875,NDCG@5:0.3338) test=(HR@5:0.4245,NDCG@5:0.2892) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22195871 0.09644587]
INFO:root:Epoch 28    loss=0.2220 [22.2 s]	 dev=(HR@5:0.4809,NDCG@5:0.3311) test=(HR@5:0.3988,NDCG@5:0.2704) [36.4 s] 
INFO:root:all_losses: [0.21033116 0.09403682]
INFO:root:Epoch 29    loss=0.2103 [22.0 s]	 dev=(HR@5:0.4665,NDCG@5:0.3239) test=(HR@5:0.3874,NDCG@5:0.2680) [36.6 s] 
INFO:root:all_losses: [0.20826897 0.0924855 ]
INFO:root:Epoch 30    loss=0.2083 [22.1 s]	 dev=(HR@5:0.4726,NDCG@5:0.3306) test=(HR@5:0.4018,NDCG@5:0.2776) [36.8 s] 
INFO:root:all_losses: [0.20449422 0.08813322]
INFO:root:Epoch 31    loss=0.2045 [22.2 s]	 dev=(HR@5:0.4561,NDCG@5:0.3157) test=(HR@5:0.3776,NDCG@5:0.2598) [36.5 s] 
INFO:root:all_losses: [0.20269985 0.08940003]
INFO:root:Epoch 32    loss=0.2027 [22.5 s]	 dev=(HR@5:0.4750,NDCG@5:0.3310) test=(HR@5:0.4179,NDCG@5:0.2845) [36.3 s] 
INFO:root:all_losses: [0.19344355 0.08499355]
INFO:root:Epoch 33    loss=0.1934 [22.3 s]	 dev=(HR@5:0.5023,NDCG@5:0.3470) test=(HR@5:0.4287,NDCG@5:0.2929) [36.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18488912 0.08133326]
INFO:root:Epoch 34    loss=0.1849 [22.3 s]	 dev=(HR@5:0.4742,NDCG@5:0.3294) test=(HR@5:0.3963,NDCG@5:0.2724) [36.4 s] 
INFO:root:all_losses: [0.183261  0.0815082]
INFO:root:Epoch 35    loss=0.1833 [22.2 s]	 dev=(HR@5:0.4977,NDCG@5:0.3450) test=(HR@5:0.4308,NDCG@5:0.2936) [36.2 s] 
INFO:root:all_losses: [0.17815733 0.07741915]
INFO:root:Epoch 36    loss=0.1782 [22.1 s]	 dev=(HR@5:0.4783,NDCG@5:0.3306) test=(HR@5:0.4075,NDCG@5:0.2812) [36.6 s] 
INFO:root:all_losses: [0.17559488 0.07712854]
INFO:root:Epoch 37    loss=0.1756 [22.0 s]	 dev=(HR@5:0.4822,NDCG@5:0.3361) test=(HR@5:0.4173,NDCG@5:0.2874) [36.3 s] 
INFO:root:all_losses: [0.1702342  0.07638833]
INFO:root:Epoch 38    loss=0.1702 [22.1 s]	 dev=(HR@5:0.4795,NDCG@5:0.3378) test=(HR@5:0.4133,NDCG@5:0.2865) [36.5 s] 
INFO:root:all_losses: [0.16643097 0.07517596]
INFO:root:Epoch 39    loss=0.1664 [22.2 s]	 dev=(HR@5:0.4944,NDCG@5:0.3498) test=(HR@5:0.4204,NDCG@5:0.2900) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16628821 0.07193325]
INFO:root:Epoch 40    loss=0.1663 [22.1 s]	 dev=(HR@5:0.4960,NDCG@5:0.3501) test=(HR@5:0.4426,NDCG@5:0.3037) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16195644 0.07036427]
INFO:root:Epoch 41    loss=0.1620 [22.4 s]	 dev=(HR@5:0.4787,NDCG@5:0.3357) test=(HR@5:0.4165,NDCG@5:0.2883) [36.2 s] 
INFO:root:all_losses: [0.15713331 0.07284276]
INFO:root:Epoch 42    loss=0.1571 [22.1 s]	 dev=(HR@5:0.4930,NDCG@5:0.3450) test=(HR@5:0.4296,NDCG@5:0.2959) [36.1 s] 
INFO:root:all_losses: [0.15629503 0.06748165]
INFO:root:Epoch 43    loss=0.1563 [22.1 s]	 dev=(HR@5:0.4873,NDCG@5:0.3408) test=(HR@5:0.4336,NDCG@5:0.2999) [36.4 s] 
INFO:root:all_losses: [0.15511864 0.06878738]
INFO:root:Epoch 44    loss=0.1551 [22.1 s]	 dev=(HR@5:0.4677,NDCG@5:0.3258) test=(HR@5:0.4010,NDCG@5:0.2732) [36.2 s] 
INFO:root:all_losses: [0.15122269 0.06669161]
INFO:root:Epoch 45    loss=0.1512 [22.1 s]	 dev=(HR@5:0.4836,NDCG@5:0.3390) test=(HR@5:0.4167,NDCG@5:0.2850) [36.4 s] 
INFO:root:all_losses: [0.15027942 0.06817044]
INFO:root:Epoch 46    loss=0.1503 [22.1 s]	 dev=(HR@5:0.5003,NDCG@5:0.3533) test=(HR@5:0.4406,NDCG@5:0.3017) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14441194 0.06422404]
INFO:root:Epoch 47    loss=0.1444 [22.1 s]	 dev=(HR@5:0.4846,NDCG@5:0.3373) test=(HR@5:0.4224,NDCG@5:0.2890) [36.2 s] 
INFO:root:all_losses: [0.14785083 0.0653169 ]
INFO:root:Epoch 48    loss=0.1479 [22.1 s]	 dev=(HR@5:0.5064,NDCG@5:0.3584) test=(HR@5:0.4412,NDCG@5:0.3032) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1449505  0.06307019]
INFO:root:Epoch 49    loss=0.1450 [22.2 s]	 dev=(HR@5:0.4964,NDCG@5:0.3489) test=(HR@5:0.4367,NDCG@5:0.2998) [36.4 s] 
INFO:root:all_losses: [0.14088029 0.06313483]
INFO:root:Epoch 50    loss=0.1409 [22.0 s]	 dev=(HR@5:0.4811,NDCG@5:0.3378) test=(HR@5:0.4112,NDCG@5:0.2828) [36.0 s] 
INFO:root:all_losses: [0.1403539  0.06306225]
INFO:root:Epoch 51    loss=0.1404 [22.1 s]	 dev=(HR@5:0.4858,NDCG@5:0.3445) test=(HR@5:0.4196,NDCG@5:0.2935) [35.9 s] 
INFO:root:all_losses: [0.13676867 0.06089132]
INFO:root:Epoch 52    loss=0.1368 [22.2 s]	 dev=(HR@5:0.4909,NDCG@5:0.3471) test=(HR@5:0.4285,NDCG@5:0.2948) [35.8 s] 
INFO:root:all_losses: [0.13565181 0.06097945]
INFO:root:Epoch 53    loss=0.1357 [22.3 s]	 dev=(HR@5:0.4924,NDCG@5:0.3445) test=(HR@5:0.4194,NDCG@5:0.2909) [36.1 s] 
INFO:root:all_losses: [0.13509136 0.06104408]
INFO:root:Epoch 54    loss=0.1351 [22.3 s]	 dev=(HR@5:0.4881,NDCG@5:0.3428) test=(HR@5:0.4287,NDCG@5:0.2971) [36.1 s] 
INFO:root:all_losses: [0.13054149 0.05938805]
INFO:root:Epoch 55    loss=0.1305 [22.3 s]	 dev=(HR@5:0.4893,NDCG@5:0.3430) test=(HR@5:0.4122,NDCG@5:0.2849) [36.0 s] 
INFO:root:all_losses: [0.13399875 0.06025789]
INFO:root:Epoch 56    loss=0.1340 [22.3 s]	 dev=(HR@5:0.4612,NDCG@5:0.3252) test=(HR@5:0.4029,NDCG@5:0.2815) [36.0 s] 
INFO:root:all_losses: [0.12960802 0.05732369]
INFO:root:Epoch 57    loss=0.1296 [22.4 s]	 dev=(HR@5:0.4970,NDCG@5:0.3459) test=(HR@5:0.4526,NDCG@5:0.3073) [35.8 s] 
INFO:root:all_losses: [0.12626873 0.05657261]
INFO:root:Epoch 58    loss=0.1263 [22.3 s]	 dev=(HR@5:0.4785,NDCG@5:0.3365) test=(HR@5:0.4124,NDCG@5:0.2877) [35.8 s] 
INFO:root:all_losses: [0.1297476  0.05859866]
INFO:root:Epoch 59    loss=0.1297 [22.1 s]	 dev=(HR@5:0.4736,NDCG@5:0.3326) test=(HR@5:0.4247,NDCG@5:0.2930) [35.7 s] 
INFO:root:all_losses: [0.12186194 0.05550119]
INFO:root:Epoch 60    loss=0.1219 [22.1 s]	 dev=(HR@5:0.4895,NDCG@5:0.3456) test=(HR@5:0.4226,NDCG@5:0.2950) [36.0 s] 
INFO:root:all_losses: [0.12114745 0.05235028]
INFO:root:Epoch 61    loss=0.1211 [22.1 s]	 dev=(HR@5:0.4811,NDCG@5:0.3419) test=(HR@5:0.4037,NDCG@5:0.2830) [35.9 s] 
INFO:root:all_losses: [0.12802352 0.05709339]
INFO:root:Epoch 62    loss=0.1280 [22.3 s]	 dev=(HR@5:0.5066,NDCG@5:0.3571) test=(HR@5:0.4489,NDCG@5:0.3088) [36.0 s] 
INFO:root:all_losses: [0.11871992 0.05287895]
INFO:root:Epoch 63    loss=0.1187 [22.1 s]	 dev=(HR@5:0.4848,NDCG@5:0.3441) test=(HR@5:0.4251,NDCG@5:0.2974) [36.3 s] 
INFO:root:all_losses: [0.11614639 0.05288432]
INFO:root:Epoch 64    loss=0.1161 [22.0 s]	 dev=(HR@5:0.4954,NDCG@5:0.3514) test=(HR@5:0.4338,NDCG@5:0.2981) [35.7 s] 
INFO:root:all_losses: [0.11640748 0.05104755]
INFO:root:Epoch 65    loss=0.1164 [22.0 s]	 dev=(HR@5:0.4926,NDCG@5:0.3485) test=(HR@5:0.4369,NDCG@5:0.3004) [35.9 s] 
INFO:root:all_losses: [0.11765302 0.05207746]
INFO:root:Epoch 66    loss=0.1177 [22.3 s]	 dev=(HR@5:0.4970,NDCG@5:0.3514) test=(HR@5:0.4455,NDCG@5:0.3052) [35.5 s] 
INFO:root:all_losses: [0.12063815 0.05425991]
INFO:root:Epoch 67    loss=0.1206 [22.1 s]	 dev=(HR@5:0.4822,NDCG@5:0.3440) test=(HR@5:0.4200,NDCG@5:0.2905) [35.9 s] 
INFO:root:all_losses: [0.11739971 0.05156425]
INFO:root:Epoch 68    loss=0.1174 [22.0 s]	 dev=(HR@5:0.4911,NDCG@5:0.3480) test=(HR@5:0.4396,NDCG@5:0.3018) [36.9 s] 
INFO:root:Early stop at 68 based on dev result.
INFO:root:
Best Iter(dev)=   48	 dev=(HR@5:0.5064,NDCG@5:0.3584) test=(HR@5:0.4412,NDCG@5:0.3032) [3891.8 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6147,HR@5:0.4416,HR@50:0.8991,NDCG@10:0.3594,NDCG@5:0.3034,NDCG@50:0.4228)
INFO:root:
--------------------------------------------- END: 2024-12-31 19:48:44 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2024-12-31 20:29:59 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2995955 0.6931139]
INFO:root:Epoch 1     loss=1.2996 [18.8 s]	 dev=(HR@5:0.1119,NDCG@5:0.0654) test=(HR@5:0.0712,NDCG@5:0.0413) [30.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2425102 0.692976 ]
INFO:root:Epoch 2     loss=1.2425 [17.8 s]	 dev=(HR@5:0.1156,NDCG@5:0.0677) test=(HR@5:0.0744,NDCG@5:0.0430) [29.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2089156 0.6924465]
INFO:root:Epoch 3     loss=1.2089 [17.8 s]	 dev=(HR@5:0.1643,NDCG@5:0.1022) test=(HR@5:0.1209,NDCG@5:0.0790) [29.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1687416 0.6906731]
INFO:root:Epoch 4     loss=1.1687 [17.7 s]	 dev=(HR@5:0.1639,NDCG@5:0.1004) test=(HR@5:0.1182,NDCG@5:0.0730) [30.0 s] 
INFO:root:all_losses: [1.1378534  0.68636405]
INFO:root:Epoch 5     loss=1.1379 [17.9 s]	 dev=(HR@5:0.1790,NDCG@5:0.1074) test=(HR@5:0.1286,NDCG@5:0.0805) [30.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1143572 0.6754103]
INFO:root:Epoch 6     loss=1.1144 [17.8 s]	 dev=(HR@5:0.1747,NDCG@5:0.1065) test=(HR@5:0.1405,NDCG@5:0.0884) [30.0 s] 
INFO:root:all_losses: [1.0643877 0.6429993]
INFO:root:Epoch 7     loss=1.0644 [17.6 s]	 dev=(HR@5:0.2043,NDCG@5:0.1216) test=(HR@5:0.1496,NDCG@5:0.0882) [30.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9849047 0.5812495]
INFO:root:Epoch 8     loss=0.9849 [18.3 s]	 dev=(HR@5:0.2279,NDCG@5:0.1390) test=(HR@5:0.1702,NDCG@5:0.1043) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.88581544 0.51641494]
INFO:root:Epoch 9     loss=0.8858 [19.3 s]	 dev=(HR@5:0.3129,NDCG@5:0.1994) test=(HR@5:0.2381,NDCG@5:0.1516) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.78517616 0.45656863]
INFO:root:Epoch 10    loss=0.7852 [21.7 s]	 dev=(HR@5:0.3309,NDCG@5:0.2147) test=(HR@5:0.2493,NDCG@5:0.1601) [37.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.70220053 0.4011389 ]
INFO:root:Epoch 11    loss=0.7022 [22.6 s]	 dev=(HR@5:0.3454,NDCG@5:0.2245) test=(HR@5:0.2612,NDCG@5:0.1713) [37.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.62675565 0.34776297]
INFO:root:Epoch 12    loss=0.6268 [23.0 s]	 dev=(HR@5:0.3713,NDCG@5:0.2405) test=(HR@5:0.2897,NDCG@5:0.1877) [37.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.55639994 0.29606944]
INFO:root:Epoch 13    loss=0.5564 [23.1 s]	 dev=(HR@5:0.3782,NDCG@5:0.2463) test=(HR@5:0.2981,NDCG@5:0.1937) [37.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.49854353 0.25541976]
INFO:root:Epoch 14    loss=0.4985 [23.9 s]	 dev=(HR@5:0.3859,NDCG@5:0.2503) test=(HR@5:0.2917,NDCG@5:0.1916) [39.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.45569342 0.22447914]
INFO:root:Epoch 15    loss=0.4557 [24.3 s]	 dev=(HR@5:0.4041,NDCG@5:0.2653) test=(HR@5:0.3136,NDCG@5:0.2027) [58.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.42129627 0.19903784]
INFO:root:Early stop manually
INFO:root:
--------------------------------------------- END: 2024-12-31 20:44:58 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-02-25 11:19:11 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2998332 0.6931139]
INFO:root:Epoch 1     loss=1.2998 [17.8 s]	 dev=(HR@5:0.1119,NDCG@5:0.0654) test=(HR@5:0.0716,NDCG@5:0.0415) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2429957 0.6929762]
INFO:root:Epoch 2     loss=1.2430 [33.1 s]	 dev=(HR@5:0.1134,NDCG@5:0.0676) test=(HR@5:0.0714,NDCG@5:0.0423) [40.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2398134  0.69264036]
INFO:root:Epoch 3     loss=1.2398 [132.8 s]	 dev=(HR@5:0.1127,NDCG@5:0.0661) test=(HR@5:0.0728,NDCG@5:0.0420) [40.6 s] 
INFO:root:all_losses: [1.2345766 0.6922377]
INFO:root:Epoch 4     loss=1.2346 [142.0 s]	 dev=(HR@5:0.1150,NDCG@5:0.0680) test=(HR@5:0.0726,NDCG@5:0.0423) [41.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.207332  0.6916585]
INFO:root:Epoch 5     loss=1.2073 [141.7 s]	 dev=(HR@5:0.1533,NDCG@5:0.0913) test=(HR@5:0.1078,NDCG@5:0.0653) [40.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1619719 0.6885862]
INFO:root:Epoch 6     loss=1.1620 [132.3 s]	 dev=(HR@5:0.1719,NDCG@5:0.1049) test=(HR@5:0.1323,NDCG@5:0.0802) [40.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1391269  0.68041533]
INFO:root:Epoch 7     loss=1.1391 [133.3 s]	 dev=(HR@5:0.1733,NDCG@5:0.1067) test=(HR@5:0.1250,NDCG@5:0.0774) [40.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1229789 0.6579633]
INFO:root:Epoch 8     loss=1.1230 [131.4 s]	 dev=(HR@5:0.1692,NDCG@5:0.1044) test=(HR@5:0.1246,NDCG@5:0.0790) [40.7 s] 
INFO:root:all_losses: [1.0667605  0.61415666]
INFO:root:Epoch 9     loss=1.0668 [130.9 s]	 dev=(HR@5:0.1700,NDCG@5:0.1052) test=(HR@5:0.1270,NDCG@5:0.0788) [40.8 s] 
INFO:root:all_losses: [0.9889545  0.55807406]
INFO:root:Epoch 10    loss=0.9890 [139.9 s]	 dev=(HR@5:0.1694,NDCG@5:0.1033) test=(HR@5:0.1248,NDCG@5:0.0751) [80.1 s] 
INFO:root:all_losses: [0.92638576 0.50494105]
INFO:root:Epoch 11    loss=0.9264 [143.6 s]	 dev=(HR@5:0.1723,NDCG@5:0.1046) test=(HR@5:0.1329,NDCG@5:0.0805) [80.3 s] 
INFO:root:all_losses: [0.8661829  0.45173645]
INFO:root:Epoch 12    loss=0.8662 [144.4 s]	 dev=(HR@5:0.1751,NDCG@5:0.1078) test=(HR@5:0.1360,NDCG@5:0.0836) [80.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.78677833 0.3924608 ]
INFO:root:Epoch 13    loss=0.7868 [143.9 s]	 dev=(HR@5:0.1768,NDCG@5:0.1092) test=(HR@5:0.1278,NDCG@5:0.0816) [81.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7258153  0.34317175]
INFO:root:Epoch 14    loss=0.7258 [144.9 s]	 dev=(HR@5:0.1872,NDCG@5:0.1170) test=(HR@5:0.1386,NDCG@5:0.0872) [80.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.66906464 0.30366278]
INFO:root:Epoch 15    loss=0.6691 [143.7 s]	 dev=(HR@5:0.1835,NDCG@5:0.1130) test=(HR@5:0.1348,NDCG@5:0.0849) [81.7 s] 
INFO:root:all_losses: [0.6308954  0.26936233]
INFO:root:Epoch 16    loss=0.6309 [145.3 s]	 dev=(HR@5:0.1951,NDCG@5:0.1188) test=(HR@5:0.1384,NDCG@5:0.0853) [81.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5925276 0.2427354]
INFO:root:Epoch 17    loss=0.5925 [144.2 s]	 dev=(HR@5:0.2016,NDCG@5:0.1211) test=(HR@5:0.1403,NDCG@5:0.0858) [82.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5525447  0.21817587]
INFO:root:Epoch 18    loss=0.5525 [143.2 s]	 dev=(HR@5:0.2043,NDCG@5:0.1260) test=(HR@5:0.1346,NDCG@5:0.0827) [82.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5294998  0.20021352]
INFO:root:Epoch 19    loss=0.5295 [145.7 s]	 dev=(HR@5:0.2241,NDCG@5:0.1359) test=(HR@5:0.1490,NDCG@5:0.0916) [81.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.50104177 0.18498933]
INFO:root:Epoch 20    loss=0.5010 [145.6 s]	 dev=(HR@5:0.2377,NDCG@5:0.1465) test=(HR@5:0.1731,NDCG@5:0.1053) [82.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.47221723 0.17027037]
INFO:root:Epoch 21    loss=0.4722 [143.3 s]	 dev=(HR@5:0.2357,NDCG@5:0.1471) test=(HR@5:0.1655,NDCG@5:0.1035) [82.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.45296454 0.15925197]
INFO:root:Epoch 22    loss=0.4530 [142.2 s]	 dev=(HR@5:0.2483,NDCG@5:0.1579) test=(HR@5:0.1764,NDCG@5:0.1112) [82.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4327931  0.14832391]
INFO:root:Epoch 23    loss=0.4328 [143.5 s]	 dev=(HR@5:0.2754,NDCG@5:0.1737) test=(HR@5:0.2004,NDCG@5:0.1279) [56.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.40568823 0.13951646]
INFO:root:Epoch 24    loss=0.4057 [20.8 s]	 dev=(HR@5:0.2815,NDCG@5:0.1807) test=(HR@5:0.2082,NDCG@5:0.1319) [36.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.39281058 0.1333458 ]
INFO:root:Epoch 25    loss=0.3928 [21.0 s]	 dev=(HR@5:0.3038,NDCG@5:0.1946) test=(HR@5:0.2308,NDCG@5:0.1503) [36.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.37679517 0.12665606]
INFO:root:Epoch 26    loss=0.3768 [20.9 s]	 dev=(HR@5:0.3093,NDCG@5:0.1986) test=(HR@5:0.2251,NDCG@5:0.1447) [37.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35571557 0.11789327]
INFO:root:Epoch 27    loss=0.3557 [20.8 s]	 dev=(HR@5:0.3317,NDCG@5:0.2157) test=(HR@5:0.2524,NDCG@5:0.1662) [37.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.34197628 0.11509238]
INFO:root:Epoch 28    loss=0.3420 [21.0 s]	 dev=(HR@5:0.3331,NDCG@5:0.2185) test=(HR@5:0.2542,NDCG@5:0.1669) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32971528 0.1097421 ]
INFO:root:Epoch 29    loss=0.3297 [21.1 s]	 dev=(HR@5:0.3472,NDCG@5:0.2227) test=(HR@5:0.2606,NDCG@5:0.1705) [37.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3172175  0.10740669]
INFO:root:Epoch 30    loss=0.3172 [20.8 s]	 dev=(HR@5:0.3651,NDCG@5:0.2415) test=(HR@5:0.2885,NDCG@5:0.1913) [37.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.30886537 0.10345928]
INFO:root:Epoch 31    loss=0.3089 [20.8 s]	 dev=(HR@5:0.3764,NDCG@5:0.2507) test=(HR@5:0.2917,NDCG@5:0.1932) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3064604  0.10291122]
INFO:root:Epoch 32    loss=0.3065 [20.9 s]	 dev=(HR@5:0.3686,NDCG@5:0.2453) test=(HR@5:0.2877,NDCG@5:0.1900) [38.1 s] 
INFO:root:all_losses: [0.28943354 0.09776201]
INFO:root:Epoch 33    loss=0.2894 [20.9 s]	 dev=(HR@5:0.3598,NDCG@5:0.2395) test=(HR@5:0.2785,NDCG@5:0.1857) [38.2 s] 
INFO:root:all_losses: [0.27997383 0.09278632]
INFO:root:Epoch 34    loss=0.2800 [21.0 s]	 dev=(HR@5:0.3918,NDCG@5:0.2607) test=(HR@5:0.3123,NDCG@5:0.2098) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2766428 0.0943727]
INFO:root:Epoch 35    loss=0.2766 [21.1 s]	 dev=(HR@5:0.3988,NDCG@5:0.2665) test=(HR@5:0.3286,NDCG@5:0.2182) [38.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26265743 0.0890637 ]
INFO:root:Epoch 36    loss=0.2627 [21.4 s]	 dev=(HR@5:0.3780,NDCG@5:0.2503) test=(HR@5:0.3019,NDCG@5:0.2017) [38.1 s] 
INFO:root:all_losses: [0.26010835 0.08737475]
INFO:root:Epoch 37    loss=0.2601 [21.2 s]	 dev=(HR@5:0.4055,NDCG@5:0.2719) test=(HR@5:0.3295,NDCG@5:0.2208) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24984378 0.08604998]
INFO:root:Epoch 38    loss=0.2498 [21.4 s]	 dev=(HR@5:0.4192,NDCG@5:0.2815) test=(HR@5:0.3417,NDCG@5:0.2330) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24590766 0.08428661]
INFO:root:Epoch 39    loss=0.2459 [21.4 s]	 dev=(HR@5:0.3961,NDCG@5:0.2694) test=(HR@5:0.3201,NDCG@5:0.2173) [38.3 s] 
INFO:root:all_losses: [0.24390934 0.08161102]
INFO:root:Epoch 40    loss=0.2439 [21.0 s]	 dev=(HR@5:0.4069,NDCG@5:0.2727) test=(HR@5:0.3407,NDCG@5:0.2256) [38.3 s] 
INFO:root:all_losses: [0.23090471 0.07946291]
INFO:root:Epoch 41    loss=0.2309 [21.3 s]	 dev=(HR@5:0.4128,NDCG@5:0.2794) test=(HR@5:0.3470,NDCG@5:0.2345) [38.2 s] 
INFO:root:all_losses: [0.22849986 0.08144249]
INFO:root:Epoch 42    loss=0.2285 [21.1 s]	 dev=(HR@5:0.3923,NDCG@5:0.2627) test=(HR@5:0.3087,NDCG@5:0.2084) [38.2 s] 
INFO:root:all_losses: [0.2242457  0.07564728]
INFO:root:Epoch 43    loss=0.2242 [21.2 s]	 dev=(HR@5:0.4216,NDCG@5:0.2840) test=(HR@5:0.3462,NDCG@5:0.2358) [38.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21785994 0.07586842]
INFO:root:Epoch 44    loss=0.2179 [21.3 s]	 dev=(HR@5:0.4055,NDCG@5:0.2743) test=(HR@5:0.3344,NDCG@5:0.2248) [38.2 s] 
INFO:root:all_losses: [0.2123469  0.07248272]
INFO:root:Epoch 45    loss=0.2123 [21.1 s]	 dev=(HR@5:0.3906,NDCG@5:0.2663) test=(HR@5:0.3099,NDCG@5:0.2113) [38.3 s] 
INFO:root:all_losses: [0.2091055 0.0757867]
INFO:root:Epoch 46    loss=0.2091 [21.0 s]	 dev=(HR@5:0.4249,NDCG@5:0.2882) test=(HR@5:0.3474,NDCG@5:0.2384) [38.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19952154 0.06931228]
INFO:root:Epoch 47    loss=0.1995 [20.9 s]	 dev=(HR@5:0.4249,NDCG@5:0.2879) test=(HR@5:0.3392,NDCG@5:0.2309) [38.1 s] 
INFO:root:all_losses: [0.20181413 0.07227295]
INFO:root:Epoch 48    loss=0.2018 [21.3 s]	 dev=(HR@5:0.4287,NDCG@5:0.2881) test=(HR@5:0.3498,NDCG@5:0.2381) [38.3 s] 
INFO:root:all_losses: [0.19653092 0.06929626]
INFO:root:Epoch 49    loss=0.1965 [21.3 s]	 dev=(HR@5:0.4232,NDCG@5:0.2922) test=(HR@5:0.3484,NDCG@5:0.2389) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1917489  0.06911601]
INFO:root:Epoch 50    loss=0.1917 [21.1 s]	 dev=(HR@5:0.4340,NDCG@5:0.2952) test=(HR@5:0.3607,NDCG@5:0.2453) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18911101 0.06816604]
INFO:root:Epoch 51    loss=0.1891 [21.2 s]	 dev=(HR@5:0.4324,NDCG@5:0.2964) test=(HR@5:0.3476,NDCG@5:0.2380) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18188384 0.06573553]
INFO:root:Epoch 52    loss=0.1819 [21.1 s]	 dev=(HR@5:0.4206,NDCG@5:0.2888) test=(HR@5:0.3401,NDCG@5:0.2301) [37.8 s] 
INFO:root:all_losses: [0.17966932 0.06578036]
INFO:root:Epoch 53    loss=0.1797 [21.2 s]	 dev=(HR@5:0.4318,NDCG@5:0.2959) test=(HR@5:0.3533,NDCG@5:0.2419) [37.6 s] 
INFO:root:all_losses: [0.18007322 0.06561615]
INFO:root:Epoch 54    loss=0.1801 [21.1 s]	 dev=(HR@5:0.4442,NDCG@5:0.3013) test=(HR@5:0.3678,NDCG@5:0.2520) [37.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17514466 0.06452908]
INFO:root:Epoch 55    loss=0.1751 [21.2 s]	 dev=(HR@5:0.4326,NDCG@5:0.2972) test=(HR@5:0.3517,NDCG@5:0.2413) [37.5 s] 
INFO:root:all_losses: [0.1751615  0.06471143]
INFO:root:Epoch 56    loss=0.1752 [21.5 s]	 dev=(HR@5:0.4271,NDCG@5:0.2934) test=(HR@5:0.3572,NDCG@5:0.2445) [38.0 s] 
INFO:root:all_losses: [0.16968457 0.06221384]
INFO:root:Epoch 57    loss=0.1697 [21.2 s]	 dev=(HR@5:0.4414,NDCG@5:0.3041) test=(HR@5:0.3706,NDCG@5:0.2564) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16659454 0.06116613]
INFO:root:Epoch 58    loss=0.1666 [21.2 s]	 dev=(HR@5:0.4465,NDCG@5:0.3052) test=(HR@5:0.3849,NDCG@5:0.2625) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16788176 0.06206669]
INFO:root:Epoch 59    loss=0.1679 [21.0 s]	 dev=(HR@5:0.4412,NDCG@5:0.3030) test=(HR@5:0.3759,NDCG@5:0.2566) [37.8 s] 
INFO:root:all_losses: [0.15925014 0.05972936]
INFO:root:Epoch 60    loss=0.1593 [20.9 s]	 dev=(HR@5:0.4449,NDCG@5:0.3069) test=(HR@5:0.3702,NDCG@5:0.2524) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15653907 0.05606029]
INFO:root:Epoch 61    loss=0.1565 [21.3 s]	 dev=(HR@5:0.4444,NDCG@5:0.3068) test=(HR@5:0.3666,NDCG@5:0.2489) [37.5 s] 
INFO:root:all_losses: [0.15913345 0.0595994 ]
INFO:root:Epoch 62    loss=0.1591 [21.1 s]	 dev=(HR@5:0.4557,NDCG@5:0.3142) test=(HR@5:0.3790,NDCG@5:0.2623) [37.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1525787 0.0579097]
INFO:root:Epoch 63    loss=0.1526 [21.4 s]	 dev=(HR@5:0.4495,NDCG@5:0.3096) test=(HR@5:0.3737,NDCG@5:0.2574) [37.4 s] 
INFO:root:all_losses: [0.14976048 0.05574327]
INFO:root:Epoch 64    loss=0.1498 [21.2 s]	 dev=(HR@5:0.4398,NDCG@5:0.3022) test=(HR@5:0.3684,NDCG@5:0.2517) [37.6 s] 
INFO:root:all_losses: [0.14929006 0.05459045]
INFO:root:Epoch 65    loss=0.1493 [21.2 s]	 dev=(HR@5:0.4404,NDCG@5:0.3049) test=(HR@5:0.3692,NDCG@5:0.2506) [37.5 s] 
INFO:root:all_losses: [0.1474808  0.05651034]
INFO:root:Epoch 66    loss=0.1475 [21.2 s]	 dev=(HR@5:0.4550,NDCG@5:0.3120) test=(HR@5:0.3792,NDCG@5:0.2575) [37.3 s] 
INFO:root:all_losses: [0.1490903  0.05552641]
INFO:root:Epoch 67    loss=0.1491 [21.3 s]	 dev=(HR@5:0.4389,NDCG@5:0.3058) test=(HR@5:0.3823,NDCG@5:0.2586) [37.2 s] 
INFO:root:all_losses: [0.14702843 0.05475033]
INFO:root:Epoch 68    loss=0.1470 [21.2 s]	 dev=(HR@5:0.4455,NDCG@5:0.3109) test=(HR@5:0.3810,NDCG@5:0.2599) [37.2 s] 
INFO:root:all_losses: [0.14456794 0.05586157]
INFO:root:Epoch 69    loss=0.1446 [21.3 s]	 dev=(HR@5:0.4524,NDCG@5:0.3170) test=(HR@5:0.3743,NDCG@5:0.2588) [37.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14615329 0.05601817]
INFO:root:Epoch 70    loss=0.1462 [21.1 s]	 dev=(HR@5:0.4506,NDCG@5:0.3103) test=(HR@5:0.3749,NDCG@5:0.2572) [37.4 s] 
INFO:root:all_losses: [0.14111342 0.05377056]
INFO:root:Epoch 71    loss=0.1411 [21.4 s]	 dev=(HR@5:0.4493,NDCG@5:0.3117) test=(HR@5:0.3731,NDCG@5:0.2554) [37.5 s] 
INFO:root:all_losses: [0.1393028  0.05454874]
INFO:root:Epoch 72    loss=0.1393 [20.9 s]	 dev=(HR@5:0.4483,NDCG@5:0.3150) test=(HR@5:0.3831,NDCG@5:0.2632) [37.3 s] 
INFO:root:all_losses: [0.1351529  0.05221131]
INFO:root:Epoch 73    loss=0.1352 [21.1 s]	 dev=(HR@5:0.4453,NDCG@5:0.3127) test=(HR@5:0.3731,NDCG@5:0.2580) [37.5 s] 
INFO:root:all_losses: [0.13238561 0.05196051]
INFO:root:Epoch 74    loss=0.1324 [21.2 s]	 dev=(HR@5:0.4379,NDCG@5:0.3041) test=(HR@5:0.3623,NDCG@5:0.2494) [37.5 s] 
INFO:root:all_losses: [0.13301052 0.05092625]
INFO:root:Epoch 75    loss=0.1330 [21.0 s]	 dev=(HR@5:0.4593,NDCG@5:0.3199) test=(HR@5:0.3923,NDCG@5:0.2689) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13234533 0.05153709]
INFO:root:Epoch 76    loss=0.1323 [22.2 s]	 dev=(HR@5:0.4565,NDCG@5:0.3190) test=(HR@5:0.3806,NDCG@5:0.2624) [37.0 s] 
INFO:root:all_losses: [0.12907879 0.05043917]
INFO:root:Epoch 77    loss=0.1291 [21.0 s]	 dev=(HR@5:0.4495,NDCG@5:0.3141) test=(HR@5:0.3725,NDCG@5:0.2594) [37.8 s] 
INFO:root:all_losses: [0.13272785 0.05181365]
INFO:root:Epoch 78    loss=0.1327 [21.9 s]	 dev=(HR@5:0.4612,NDCG@5:0.3255) test=(HR@5:0.4018,NDCG@5:0.2776) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1261976  0.04894854]
INFO:root:Epoch 79    loss=0.1262 [20.7 s]	 dev=(HR@5:0.4502,NDCG@5:0.3191) test=(HR@5:0.3892,NDCG@5:0.2692) [36.9 s] 
INFO:root:all_losses: [0.12489446 0.04896107]
INFO:root:Epoch 80    loss=0.1249 [20.7 s]	 dev=(HR@5:0.4626,NDCG@5:0.3252) test=(HR@5:0.3994,NDCG@5:0.2767) [36.7 s] 
INFO:root:all_losses: [0.13318183 0.05237233]
INFO:root:Epoch 81    loss=0.1332 [20.8 s]	 dev=(HR@5:0.4581,NDCG@5:0.3258) test=(HR@5:0.3804,NDCG@5:0.2656) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12614393 0.05131986]
INFO:root:Epoch 82    loss=0.1261 [20.8 s]	 dev=(HR@5:0.4620,NDCG@5:0.3214) test=(HR@5:0.3902,NDCG@5:0.2709) [36.6 s] 
INFO:root:all_losses: [0.1248731  0.04942843]
INFO:root:Epoch 83    loss=0.1249 [20.7 s]	 dev=(HR@5:0.4540,NDCG@5:0.3208) test=(HR@5:0.3855,NDCG@5:0.2691) [36.5 s] 
INFO:root:all_losses: [0.12564544 0.05056934]
INFO:root:Epoch 84    loss=0.1256 [20.7 s]	 dev=(HR@5:0.4579,NDCG@5:0.3239) test=(HR@5:0.3831,NDCG@5:0.2690) [36.5 s] 
INFO:root:all_losses: [0.12278768 0.04952594]
INFO:root:Epoch 85    loss=0.1228 [20.7 s]	 dev=(HR@5:0.4434,NDCG@5:0.3105) test=(HR@5:0.3715,NDCG@5:0.2595) [36.5 s] 
INFO:root:all_losses: [0.11948391 0.04781237]
INFO:root:Epoch 86    loss=0.1195 [20.8 s]	 dev=(HR@5:0.4455,NDCG@5:0.3160) test=(HR@5:0.3739,NDCG@5:0.2606) [36.6 s] 
INFO:root:all_losses: [0.12095622 0.04929169]
INFO:root:Epoch 87    loss=0.1210 [20.8 s]	 dev=(HR@5:0.4257,NDCG@5:0.3005) test=(HR@5:0.3541,NDCG@5:0.2429) [36.3 s] 
INFO:root:all_losses: [0.11938905 0.04862209]
INFO:root:Epoch 88    loss=0.1194 [20.6 s]	 dev=(HR@5:0.4522,NDCG@5:0.3211) test=(HR@5:0.3867,NDCG@5:0.2676) [36.3 s] 
INFO:root:all_losses: [0.11819435 0.04813034]
INFO:root:Epoch 89    loss=0.1182 [20.7 s]	 dev=(HR@5:0.4316,NDCG@5:0.3031) test=(HR@5:0.3694,NDCG@5:0.2542) [36.5 s] 
INFO:root:all_losses: [0.11398672 0.04549912]
INFO:root:Epoch 90    loss=0.1140 [20.7 s]	 dev=(HR@5:0.4575,NDCG@5:0.3218) test=(HR@5:0.3925,NDCG@5:0.2721) [36.5 s] 
INFO:root:all_losses: [0.11534755 0.04711906]
INFO:root:Epoch 91    loss=0.1153 [20.6 s]	 dev=(HR@5:0.4579,NDCG@5:0.3219) test=(HR@5:0.3947,NDCG@5:0.2734) [36.5 s] 
INFO:root:all_losses: [0.11549112 0.04742849]
INFO:root:Epoch 92    loss=0.1155 [20.7 s]	 dev=(HR@5:0.4475,NDCG@5:0.3169) test=(HR@5:0.3847,NDCG@5:0.2679) [36.4 s] 
INFO:root:all_losses: [0.11212812 0.04588702]
INFO:root:Epoch 93    loss=0.1121 [20.7 s]	 dev=(HR@5:0.4294,NDCG@5:0.3007) test=(HR@5:0.3582,NDCG@5:0.2498) [36.3 s] 
INFO:root:all_losses: [0.1143982  0.04757052]
INFO:root:Epoch 94    loss=0.1144 [20.8 s]	 dev=(HR@5:0.4571,NDCG@5:0.3228) test=(HR@5:0.3865,NDCG@5:0.2692) [36.3 s] 
INFO:root:all_losses: [0.11173733 0.04625442]
INFO:root:Epoch 95    loss=0.1117 [20.7 s]	 dev=(HR@5:0.4573,NDCG@5:0.3187) test=(HR@5:0.4022,NDCG@5:0.2773) [36.3 s] 
INFO:root:all_losses: [0.11307306 0.04644884]
INFO:root:Epoch 96    loss=0.1131 [20.7 s]	 dev=(HR@5:0.4642,NDCG@5:0.3222) test=(HR@5:0.4086,NDCG@5:0.2812) [36.3 s] 
INFO:root:all_losses: [0.11194431 0.0488082 ]
INFO:root:Epoch 97    loss=0.1119 [20.7 s]	 dev=(HR@5:0.4522,NDCG@5:0.3193) test=(HR@5:0.3912,NDCG@5:0.2712) [36.3 s] 
INFO:root:all_losses: [0.11208908 0.04714316]
INFO:root:Epoch 98    loss=0.1121 [20.8 s]	 dev=(HR@5:0.4595,NDCG@5:0.3251) test=(HR@5:0.3935,NDCG@5:0.2737) [36.4 s] 
INFO:root:all_losses: [0.11050364 0.04461745]
INFO:root:Epoch 99    loss=0.1105 [20.8 s]	 dev=(HR@5:0.4361,NDCG@5:0.3099) test=(HR@5:0.3657,NDCG@5:0.2559) [36.1 s] 
INFO:root:all_losses: [0.10833499 0.04366477]
INFO:root:Epoch 100   loss=0.1083 [20.7 s]	 dev=(HR@5:0.4575,NDCG@5:0.3231) test=(HR@5:0.3925,NDCG@5:0.2733) [36.3 s] 
INFO:root:all_losses: [0.10579409 0.04537303]
INFO:root:Epoch 101   loss=0.1058 [20.7 s]	 dev=(HR@5:0.4620,NDCG@5:0.3239) test=(HR@5:0.4059,NDCG@5:0.2777) [36.3 s] 
INFO:root:Early stop at 101 based on dev result.
INFO:root:
Best Iter(dev)=   81	 dev=(HR@5:0.4581,NDCG@5:0.3258) test=(HR@5:0.3804,NDCG@5:0.2656) [9035.6 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.5221,HR@5:0.3804,HR@50:0.8444,NDCG@10:0.3115,NDCG@5:0.2657,NDCG@50:0.3827)
INFO:root:
--------------------------------------------- END: 2025-02-25 13:50:22 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-02-26 17:28:17 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 550464
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (lstm): LSTM(64, 64, batch_first=True)
)
INFO:root:Test Before Training: (HR@10:0.0822,HR@5:0.0414,HR@50:0.4911,NDCG@10:0.0383,NDCG@5:0.0254,NDCG@50:0.1233)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2994635 0.6931223]
INFO:root:Epoch 1     loss=1.2995 [41.6 s]	 dev=(HR@5:0.1156,NDCG@5:0.0689) test=(HR@5:0.0818,NDCG@5:0.0470) [35.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2445763  0.69297165]
INFO:root:Epoch 2     loss=1.2446 [40.9 s]	 dev=(HR@5:0.1158,NDCG@5:0.0693) test=(HR@5:0.0781,NDCG@5:0.0454) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2425536 0.6926737]
INFO:root:Epoch 3     loss=1.2426 [41.5 s]	 dev=(HR@5:0.1164,NDCG@5:0.0683) test=(HR@5:0.0720,NDCG@5:0.0423) [35.0 s] 
INFO:root:all_losses: [1.2394254 0.6923754]
INFO:root:Epoch 4     loss=1.2394 [46.7 s]	 dev=(HR@5:0.1113,NDCG@5:0.0651) test=(HR@5:0.0742,NDCG@5:0.0423) [35.0 s] 
INFO:root:all_losses: [1.2093288 0.6917968]
INFO:root:Epoch 5     loss=1.2093 [42.8 s]	 dev=(HR@5:0.1511,NDCG@5:0.0906) test=(HR@5:0.1081,NDCG@5:0.0653) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1667385 0.6889035]
INFO:root:Epoch 6     loss=1.1667 [41.1 s]	 dev=(HR@5:0.1588,NDCG@5:0.0960) test=(HR@5:0.1225,NDCG@5:0.0751) [35.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.134668  0.6819322]
INFO:root:Epoch 7     loss=1.1347 [40.7 s]	 dev=(HR@5:0.1819,NDCG@5:0.1119) test=(HR@5:0.1325,NDCG@5:0.0842) [35.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1014202 0.6619039]
INFO:root:Epoch 8     loss=1.1014 [41.0 s]	 dev=(HR@5:0.1819,NDCG@5:0.1146) test=(HR@5:0.1256,NDCG@5:0.0803) [35.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.037336  0.6154747]
INFO:root:Epoch 9     loss=1.0373 [42.0 s]	 dev=(HR@5:0.2045,NDCG@5:0.1286) test=(HR@5:0.1529,NDCG@5:0.0967) [35.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.94590265 0.5511107 ]
INFO:root:Epoch 10    loss=0.9459 [43.3 s]	 dev=(HR@5:0.2271,NDCG@5:0.1432) test=(HR@5:0.1629,NDCG@5:0.1051) [41.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8529375  0.48610374]
INFO:root:Epoch 11    loss=0.8529 [44.0 s]	 dev=(HR@5:0.2773,NDCG@5:0.1746) test=(HR@5:0.1992,NDCG@5:0.1257) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7552014  0.41943032]
INFO:root:Epoch 12    loss=0.7552 [43.9 s]	 dev=(HR@5:0.3009,NDCG@5:0.1915) test=(HR@5:0.2224,NDCG@5:0.1386) [41.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.66072035 0.35207722]
INFO:root:Epoch 13    loss=0.6607 [44.5 s]	 dev=(HR@5:0.3513,NDCG@5:0.2252) test=(HR@5:0.2787,NDCG@5:0.1782) [41.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5814854 0.2999597]
INFO:root:Epoch 14    loss=0.5815 [43.8 s]	 dev=(HR@5:0.3588,NDCG@5:0.2342) test=(HR@5:0.2738,NDCG@5:0.1789) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5240334 0.2603218]
INFO:root:Epoch 15    loss=0.5240 [44.6 s]	 dev=(HR@5:0.3607,NDCG@5:0.2373) test=(HR@5:0.2752,NDCG@5:0.1784) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.47562453 0.22746499]
INFO:root:Epoch 16    loss=0.4756 [44.3 s]	 dev=(HR@5:0.4055,NDCG@5:0.2663) test=(HR@5:0.3154,NDCG@5:0.2082) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.43758   0.2016525]
INFO:root:Epoch 17    loss=0.4376 [44.5 s]	 dev=(HR@5:0.4234,NDCG@5:0.2808) test=(HR@5:0.3282,NDCG@5:0.2166) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.38953036 0.1776772 ]
INFO:root:Epoch 18    loss=0.3895 [44.6 s]	 dev=(HR@5:0.4271,NDCG@5:0.2846) test=(HR@5:0.3250,NDCG@5:0.2164) [41.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.36748138 0.16310994]
INFO:root:Epoch 19    loss=0.3675 [44.4 s]	 dev=(HR@5:0.4575,NDCG@5:0.3124) test=(HR@5:0.3700,NDCG@5:0.2466) [41.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.34049734 0.15000169]
INFO:root:Epoch 20    loss=0.3405 [44.1 s]	 dev=(HR@5:0.4546,NDCG@5:0.3042) test=(HR@5:0.3668,NDCG@5:0.2418) [41.1 s] 
INFO:root:all_losses: [0.31903476 0.13882102]
INFO:root:Epoch 21    loss=0.3190 [43.8 s]	 dev=(HR@5:0.4461,NDCG@5:0.3005) test=(HR@5:0.3633,NDCG@5:0.2432) [40.9 s] 
INFO:root:all_losses: [0.30375266 0.12807815]
INFO:root:Epoch 22    loss=0.3038 [44.4 s]	 dev=(HR@5:0.4646,NDCG@5:0.3171) test=(HR@5:0.3733,NDCG@5:0.2499) [41.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2896629 0.1207858]
INFO:root:Epoch 23    loss=0.2897 [44.4 s]	 dev=(HR@5:0.4740,NDCG@5:0.3275) test=(HR@5:0.3920,NDCG@5:0.2637) [40.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27005747 0.11372076]
INFO:root:Epoch 24    loss=0.2701 [44.1 s]	 dev=(HR@5:0.4724,NDCG@5:0.3238) test=(HR@5:0.3941,NDCG@5:0.2645) [41.0 s] 
INFO:root:all_losses: [0.25914365 0.10905464]
INFO:root:Epoch 25    loss=0.2591 [44.1 s]	 dev=(HR@5:0.4756,NDCG@5:0.3237) test=(HR@5:0.3892,NDCG@5:0.2647) [40.9 s] 
INFO:root:all_losses: [0.2518466  0.10380672]
INFO:root:Epoch 26    loss=0.2518 [44.4 s]	 dev=(HR@5:0.4697,NDCG@5:0.3195) test=(HR@5:0.3843,NDCG@5:0.2581) [40.9 s] 
INFO:root:all_losses: [0.23803246 0.09837075]
INFO:root:Epoch 27    loss=0.2380 [44.6 s]	 dev=(HR@5:0.4779,NDCG@5:0.3290) test=(HR@5:0.3978,NDCG@5:0.2701) [40.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22877836 0.09437285]
INFO:root:Epoch 28    loss=0.2288 [44.3 s]	 dev=(HR@5:0.4771,NDCG@5:0.3305) test=(HR@5:0.3945,NDCG@5:0.2669) [40.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22149862 0.09290826]
INFO:root:Epoch 29    loss=0.2215 [44.3 s]	 dev=(HR@5:0.4940,NDCG@5:0.3390) test=(HR@5:0.4104,NDCG@5:0.2797) [40.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2145502  0.09124347]
INFO:root:Epoch 30    loss=0.2146 [44.1 s]	 dev=(HR@5:0.4864,NDCG@5:0.3365) test=(HR@5:0.4094,NDCG@5:0.2804) [40.6 s] 
INFO:root:all_losses: [0.2124875  0.08619016]
INFO:root:Epoch 31    loss=0.2125 [44.5 s]	 dev=(HR@5:0.5001,NDCG@5:0.3462) test=(HR@5:0.4373,NDCG@5:0.2962) [40.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21068826 0.08874828]
INFO:root:Epoch 32    loss=0.2107 [44.1 s]	 dev=(HR@5:0.5001,NDCG@5:0.3483) test=(HR@5:0.4312,NDCG@5:0.2934) [40.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19646865 0.08342915]
INFO:root:Epoch 33    loss=0.1965 [43.9 s]	 dev=(HR@5:0.4960,NDCG@5:0.3446) test=(HR@5:0.4175,NDCG@5:0.2843) [40.7 s] 
INFO:root:all_losses: [0.1926532  0.08037285]
INFO:root:Epoch 34    loss=0.1927 [43.9 s]	 dev=(HR@5:0.5089,NDCG@5:0.3504) test=(HR@5:0.4332,NDCG@5:0.2959) [40.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18892972 0.08026143]
INFO:root:Epoch 35    loss=0.1889 [43.7 s]	 dev=(HR@5:0.4977,NDCG@5:0.3420) test=(HR@5:0.4326,NDCG@5:0.2926) [40.3 s] 
INFO:root:all_losses: [0.183927   0.07681897]
INFO:root:Epoch 36    loss=0.1839 [43.9 s]	 dev=(HR@5:0.4936,NDCG@5:0.3433) test=(HR@5:0.4292,NDCG@5:0.2938) [40.3 s] 
INFO:root:all_losses: [0.1805194  0.07685872]
INFO:root:Epoch 37    loss=0.1805 [44.3 s]	 dev=(HR@5:0.4826,NDCG@5:0.3341) test=(HR@5:0.4077,NDCG@5:0.2803) [40.2 s] 
INFO:root:all_losses: [0.17394091 0.07532854]
INFO:root:Epoch 38    loss=0.1739 [44.3 s]	 dev=(HR@5:0.4917,NDCG@5:0.3398) test=(HR@5:0.4173,NDCG@5:0.2867) [40.4 s] 
INFO:root:all_losses: [0.1728428  0.07400896]
INFO:root:Epoch 39    loss=0.1728 [43.8 s]	 dev=(HR@5:0.4989,NDCG@5:0.3466) test=(HR@5:0.4267,NDCG@5:0.2922) [40.3 s] 
INFO:root:all_losses: [0.17183618 0.0721427 ]
INFO:root:Epoch 40    loss=0.1718 [43.7 s]	 dev=(HR@5:0.4840,NDCG@5:0.3357) test=(HR@5:0.4200,NDCG@5:0.2873) [40.5 s] 
INFO:root:all_losses: [0.16634479 0.0702306 ]
INFO:root:Epoch 41    loss=0.1663 [44.3 s]	 dev=(HR@5:0.5009,NDCG@5:0.3473) test=(HR@5:0.4418,NDCG@5:0.3037) [40.0 s] 
INFO:root:all_losses: [0.1634157  0.07274135]
INFO:root:Epoch 42    loss=0.1634 [44.1 s]	 dev=(HR@5:0.5081,NDCG@5:0.3542) test=(HR@5:0.4577,NDCG@5:0.3106) [40.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16298835 0.06746346]
INFO:root:Epoch 43    loss=0.1630 [43.6 s]	 dev=(HR@5:0.4773,NDCG@5:0.3305) test=(HR@5:0.4022,NDCG@5:0.2756) [40.3 s] 
INFO:root:all_losses: [0.15894173 0.06770705]
INFO:root:Epoch 44    loss=0.1589 [44.2 s]	 dev=(HR@5:0.5034,NDCG@5:0.3511) test=(HR@5:0.4398,NDCG@5:0.2996) [40.1 s] 
INFO:root:all_losses: [0.15507914 0.0661862 ]
INFO:root:Epoch 45    loss=0.1551 [43.9 s]	 dev=(HR@5:0.4948,NDCG@5:0.3459) test=(HR@5:0.4279,NDCG@5:0.2913) [40.3 s] 
INFO:root:all_losses: [0.15300599 0.06766661]
INFO:root:Epoch 46    loss=0.1530 [44.2 s]	 dev=(HR@5:0.4815,NDCG@5:0.3385) test=(HR@5:0.4110,NDCG@5:0.2832) [40.0 s] 
INFO:root:all_losses: [0.15093367 0.06339397]
INFO:root:Epoch 47    loss=0.1509 [44.2 s]	 dev=(HR@5:0.4942,NDCG@5:0.3471) test=(HR@5:0.4285,NDCG@5:0.2942) [40.2 s] 
INFO:root:all_losses: [0.14988984 0.06501547]
INFO:root:Epoch 48    loss=0.1499 [44.7 s]	 dev=(HR@5:0.5062,NDCG@5:0.3537) test=(HR@5:0.4391,NDCG@5:0.3001) [40.0 s] 
INFO:root:all_losses: [0.14771642 0.06226173]
INFO:root:Epoch 49    loss=0.1477 [44.2 s]	 dev=(HR@5:0.4869,NDCG@5:0.3439) test=(HR@5:0.4212,NDCG@5:0.2922) [40.1 s] 
INFO:root:all_losses: [0.14605884 0.06338818]
INFO:root:Epoch 50    loss=0.1461 [44.1 s]	 dev=(HR@5:0.4799,NDCG@5:0.3377) test=(HR@5:0.4094,NDCG@5:0.2828) [40.1 s] 
INFO:root:all_losses: [0.14285746 0.06163298]
INFO:root:Epoch 51    loss=0.1429 [44.4 s]	 dev=(HR@5:0.4889,NDCG@5:0.3422) test=(HR@5:0.4414,NDCG@5:0.3045) [40.1 s] 
INFO:root:all_losses: [0.1411605  0.06211346]
INFO:root:Epoch 52    loss=0.1412 [44.1 s]	 dev=(HR@5:0.5030,NDCG@5:0.3554) test=(HR@5:0.4402,NDCG@5:0.3056) [40.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13769262 0.06121961]
INFO:root:Epoch 53    loss=0.1377 [44.4 s]	 dev=(HR@5:0.4975,NDCG@5:0.3499) test=(HR@5:0.4377,NDCG@5:0.3008) [40.0 s] 
INFO:root:all_losses: [0.13748865 0.06057648]
INFO:root:Epoch 54    loss=0.1375 [44.0 s]	 dev=(HR@5:0.4966,NDCG@5:0.3462) test=(HR@5:0.4351,NDCG@5:0.2985) [40.2 s] 
INFO:root:all_losses: [0.13314933 0.05818213]
INFO:root:Epoch 55    loss=0.1331 [44.3 s]	 dev=(HR@5:0.4962,NDCG@5:0.3469) test=(HR@5:0.4340,NDCG@5:0.2992) [39.9 s] 
INFO:root:all_losses: [0.13619997 0.05931094]
INFO:root:Epoch 56    loss=0.1362 [44.4 s]	 dev=(HR@5:0.5050,NDCG@5:0.3546) test=(HR@5:0.4363,NDCG@5:0.3025) [40.0 s] 
INFO:root:all_losses: [0.13281561 0.05768492]
INFO:root:Epoch 57    loss=0.1328 [44.5 s]	 dev=(HR@5:0.4952,NDCG@5:0.3447) test=(HR@5:0.4402,NDCG@5:0.3055) [40.1 s] 
INFO:root:all_losses: [0.13096456 0.05776135]
INFO:root:Epoch 58    loss=0.1310 [44.1 s]	 dev=(HR@5:0.4993,NDCG@5:0.3475) test=(HR@5:0.4355,NDCG@5:0.3014) [40.2 s] 
INFO:root:all_losses: [0.131604   0.05814333]
INFO:root:Epoch 59    loss=0.1316 [44.4 s]	 dev=(HR@5:0.4887,NDCG@5:0.3431) test=(HR@5:0.4239,NDCG@5:0.2922) [39.9 s] 
INFO:root:all_losses: [0.12653118 0.05613153]
INFO:root:Epoch 60    loss=0.1265 [44.6 s]	 dev=(HR@5:0.4930,NDCG@5:0.3476) test=(HR@5:0.4365,NDCG@5:0.3021) [40.1 s] 
INFO:root:all_losses: [0.12204491 0.0521922 ]
INFO:root:Epoch 61    loss=0.1220 [44.5 s]	 dev=(HR@5:0.4897,NDCG@5:0.3439) test=(HR@5:0.4316,NDCG@5:0.2956) [40.0 s] 
INFO:root:all_losses: [0.13021448 0.05720113]
INFO:root:Epoch 62    loss=0.1302 [44.8 s]	 dev=(HR@5:0.4840,NDCG@5:0.3416) test=(HR@5:0.4290,NDCG@5:0.2957) [39.8 s] 
INFO:root:all_losses: [0.12224387 0.05358078]
INFO:root:Epoch 63    loss=0.1222 [43.8 s]	 dev=(HR@5:0.5074,NDCG@5:0.3567) test=(HR@5:0.4469,NDCG@5:0.3122) [40.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11846802 0.05193452]
INFO:root:Epoch 64    loss=0.1185 [44.2 s]	 dev=(HR@5:0.4850,NDCG@5:0.3443) test=(HR@5:0.4285,NDCG@5:0.2941) [40.0 s] 
INFO:root:all_losses: [0.11728235 0.05097397]
INFO:root:Epoch 65    loss=0.1173 [44.3 s]	 dev=(HR@5:0.4993,NDCG@5:0.3471) test=(HR@5:0.4502,NDCG@5:0.3063) [39.8 s] 
INFO:root:all_losses: [0.11727455 0.0522581 ]
INFO:root:Epoch 66    loss=0.1173 [43.8 s]	 dev=(HR@5:0.4771,NDCG@5:0.3343) test=(HR@5:0.4200,NDCG@5:0.2899) [40.0 s] 
INFO:root:all_losses: [0.12170127 0.05316138]
INFO:root:Epoch 67    loss=0.1217 [44.1 s]	 dev=(HR@5:0.4862,NDCG@5:0.3412) test=(HR@5:0.4318,NDCG@5:0.2970) [39.7 s] 
INFO:root:all_losses: [0.11679958 0.05160573]
INFO:root:Epoch 68    loss=0.1168 [43.9 s]	 dev=(HR@5:0.4950,NDCG@5:0.3488) test=(HR@5:0.4385,NDCG@5:0.3030) [39.9 s] 
INFO:root:all_losses: [0.11742698 0.05276274]
INFO:root:Epoch 69    loss=0.1174 [43.8 s]	 dev=(HR@5:0.4926,NDCG@5:0.3494) test=(HR@5:0.4404,NDCG@5:0.3024) [39.8 s] 
INFO:root:all_losses: [0.12195682 0.05426272]
INFO:root:Epoch 70    loss=0.1220 [44.3 s]	 dev=(HR@5:0.4954,NDCG@5:0.3475) test=(HR@5:0.4436,NDCG@5:0.3078) [39.9 s] 
INFO:root:all_losses: [0.11684524 0.05247741]
INFO:root:Epoch 71    loss=0.1168 [44.7 s]	 dev=(HR@5:0.4818,NDCG@5:0.3370) test=(HR@5:0.4281,NDCG@5:0.2960) [39.8 s] 
INFO:root:all_losses: [0.114885   0.05220474]
INFO:root:Epoch 72    loss=0.1149 [44.3 s]	 dev=(HR@5:0.5052,NDCG@5:0.3535) test=(HR@5:0.4569,NDCG@5:0.3159) [40.0 s] 
INFO:root:all_losses: [0.11238514 0.04891883]
INFO:root:Epoch 73    loss=0.1124 [44.5 s]	 dev=(HR@5:0.4903,NDCG@5:0.3458) test=(HR@5:0.4334,NDCG@5:0.3003) [39.7 s] 
INFO:root:all_losses: [0.11091124 0.05058903]
INFO:root:Epoch 74    loss=0.1109 [44.5 s]	 dev=(HR@5:0.4905,NDCG@5:0.3453) test=(HR@5:0.4430,NDCG@5:0.3054) [39.8 s] 
INFO:root:all_losses: [0.11149427 0.04891309]
INFO:root:Epoch 75    loss=0.1115 [44.3 s]	 dev=(HR@5:0.4842,NDCG@5:0.3402) test=(HR@5:0.4353,NDCG@5:0.3058) [40.0 s] 
INFO:root:all_losses: [0.11220244 0.05017528]
INFO:root:Epoch 76    loss=0.1122 [44.4 s]	 dev=(HR@5:0.4836,NDCG@5:0.3416) test=(HR@5:0.4188,NDCG@5:0.2949) [39.8 s] 
INFO:root:all_losses: [0.11023242 0.04952303]
INFO:root:Epoch 77    loss=0.1102 [44.7 s]	 dev=(HR@5:0.4858,NDCG@5:0.3392) test=(HR@5:0.4298,NDCG@5:0.2950) [39.7 s] 
INFO:root:all_losses: [0.10974576 0.04971201]
INFO:root:Epoch 78    loss=0.1097 [44.8 s]	 dev=(HR@5:0.4917,NDCG@5:0.3472) test=(HR@5:0.4343,NDCG@5:0.3024) [39.6 s] 
INFO:root:all_losses: [0.10614301 0.04706782]
INFO:root:Epoch 79    loss=0.1061 [44.5 s]	 dev=(HR@5:0.4773,NDCG@5:0.3337) test=(HR@5:0.4263,NDCG@5:0.2926) [39.6 s] 
INFO:root:all_losses: [0.10667779 0.04711096]
INFO:root:Epoch 80    loss=0.1067 [44.6 s]	 dev=(HR@5:0.4938,NDCG@5:0.3467) test=(HR@5:0.4304,NDCG@5:0.2970) [39.6 s] 
INFO:root:all_losses: [0.11301542 0.05094129]
INFO:root:Epoch 81    loss=0.1130 [44.1 s]	 dev=(HR@5:0.5011,NDCG@5:0.3558) test=(HR@5:0.4420,NDCG@5:0.3050) [39.7 s] 
INFO:root:all_losses: [0.10814404 0.04954578]
INFO:root:Epoch 82    loss=0.1081 [44.3 s]	 dev=(HR@5:0.4869,NDCG@5:0.3439) test=(HR@5:0.4159,NDCG@5:0.2911) [39.8 s] 
INFO:root:all_losses: [0.10436437 0.04696121]
INFO:root:Epoch 83    loss=0.1044 [45.0 s]	 dev=(HR@5:0.4968,NDCG@5:0.3492) test=(HR@5:0.4355,NDCG@5:0.3060) [39.7 s] 
INFO:root:Early stop at 83 based on dev result.
INFO:root:
Best Iter(dev)=   63	 dev=(HR@5:0.5074,NDCG@5:0.3567) test=(HR@5:0.4469,NDCG@5:0.3122) [6954.5 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6067,HR@5:0.4469,HR@50:0.8811,NDCG@10:0.3643,NDCG@5:0.3123,NDCG@50:0.4253)
INFO:root:
--------------------------------------------- END: 2025-02-26 19:24:50 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-02-26 19:43:11 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 550464
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (lstm): LSTM(64, 64, batch_first=True)
)
INFO:root:Test Before Training: (HR@10:0.0822,HR@5:0.0414,HR@50:0.4911,NDCG@10:0.0383,NDCG@5:0.0254,NDCG@50:0.1233)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.299468  0.6931223]
INFO:root:Epoch 1     loss=1.2995 [37.2 s]	 dev=(HR@5:0.1160,NDCG@5:0.0690) test=(HR@5:0.0820,NDCG@5:0.0472) [33.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2446083  0.69297165]
INFO:root:Epoch 2     loss=1.2446 [36.6 s]	 dev=(HR@5:0.1152,NDCG@5:0.0691) test=(HR@5:0.0789,NDCG@5:0.0459) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2422781  0.69266814]
INFO:root:Epoch 3     loss=1.2423 [36.7 s]	 dev=(HR@5:0.1172,NDCG@5:0.0686) test=(HR@5:0.0736,NDCG@5:0.0431) [33.7 s] 
INFO:root:all_losses: [1.2232062  0.69227856]
INFO:root:Epoch 4     loss=1.2232 [37.3 s]	 dev=(HR@5:0.1176,NDCG@5:0.0697) test=(HR@5:0.0779,NDCG@5:0.0446) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1771011 0.6907696]
INFO:root:Epoch 5     loss=1.1771 [36.6 s]	 dev=(HR@5:0.1698,NDCG@5:0.1045) test=(HR@5:0.1229,NDCG@5:0.0800) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1406386  0.68601805]
INFO:root:Epoch 6     loss=1.1406 [36.6 s]	 dev=(HR@5:0.1755,NDCG@5:0.1075) test=(HR@5:0.1325,NDCG@5:0.0844) [33.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1036891  0.67470115]
INFO:root:Epoch 7     loss=1.1037 [36.6 s]	 dev=(HR@5:0.2153,NDCG@5:0.1340) test=(HR@5:0.1513,NDCG@5:0.0936) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0504723 0.6442096]
INFO:root:Epoch 8     loss=1.0505 [36.6 s]	 dev=(HR@5:0.2489,NDCG@5:0.1575) test=(HR@5:0.1876,NDCG@5:0.1153) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9588027 0.5845025]
INFO:root:Epoch 9     loss=0.9588 [37.4 s]	 dev=(HR@5:0.2873,NDCG@5:0.1783) test=(HR@5:0.2133,NDCG@5:0.1319) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8493417 0.5134414]
INFO:root:Epoch 10    loss=0.8493 [39.6 s]	 dev=(HR@5:0.3329,NDCG@5:0.2146) test=(HR@5:0.2595,NDCG@5:0.1649) [40.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7455074  0.44487223]
INFO:root:Epoch 11    loss=0.7455 [40.3 s]	 dev=(HR@5:0.3641,NDCG@5:0.2375) test=(HR@5:0.2913,NDCG@5:0.1898) [40.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6490849  0.37997723]
INFO:root:Epoch 12    loss=0.6491 [40.2 s]	 dev=(HR@5:0.3821,NDCG@5:0.2511) test=(HR@5:0.2883,NDCG@5:0.1910) [40.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.56574166 0.3193713 ]
INFO:root:Epoch 13    loss=0.5657 [40.1 s]	 dev=(HR@5:0.4137,NDCG@5:0.2757) test=(HR@5:0.3185,NDCG@5:0.2129) [40.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.49958482 0.2748915 ]
INFO:root:Epoch 14    loss=0.4996 [40.5 s]	 dev=(HR@5:0.4183,NDCG@5:0.2862) test=(HR@5:0.3307,NDCG@5:0.2212) [39.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.45265046 0.24176636]
INFO:root:Epoch 15    loss=0.4527 [40.3 s]	 dev=(HR@5:0.4027,NDCG@5:0.2734) test=(HR@5:0.3148,NDCG@5:0.2101) [39.8 s] 
INFO:root:all_losses: [0.41318697 0.21384528]
INFO:root:Epoch 16    loss=0.4132 [40.2 s]	 dev=(HR@5:0.4432,NDCG@5:0.3013) test=(HR@5:0.3582,NDCG@5:0.2390) [39.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.38158354 0.19220978]
INFO:root:Epoch 17    loss=0.3816 [40.5 s]	 dev=(HR@5:0.4410,NDCG@5:0.2962) test=(HR@5:0.3554,NDCG@5:0.2369) [39.8 s] 
INFO:root:all_losses: [0.34433174 0.17153378]
INFO:root:Epoch 18    loss=0.3443 [40.2 s]	 dev=(HR@5:0.4695,NDCG@5:0.3238) test=(HR@5:0.3910,NDCG@5:0.2624) [39.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32616758 0.15880555]
INFO:root:Epoch 19    loss=0.3262 [40.1 s]	 dev=(HR@5:0.4730,NDCG@5:0.3281) test=(HR@5:0.4114,NDCG@5:0.2806) [39.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3050299  0.14755085]
INFO:root:Epoch 20    loss=0.3050 [40.0 s]	 dev=(HR@5:0.4811,NDCG@5:0.3311) test=(HR@5:0.4082,NDCG@5:0.2759) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28560928 0.13692217]
INFO:root:Epoch 21    loss=0.2856 [40.0 s]	 dev=(HR@5:0.4734,NDCG@5:0.3263) test=(HR@5:0.4067,NDCG@5:0.2774) [39.5 s] 
INFO:root:all_losses: [0.27392885 0.1270418 ]
INFO:root:Epoch 22    loss=0.2739 [40.0 s]	 dev=(HR@5:0.4746,NDCG@5:0.3268) test=(HR@5:0.4045,NDCG@5:0.2747) [39.5 s] 
INFO:root:all_losses: [0.26110193 0.12066633]
INFO:root:Epoch 23    loss=0.2611 [40.0 s]	 dev=(HR@5:0.4877,NDCG@5:0.3388) test=(HR@5:0.4214,NDCG@5:0.2854) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24425204 0.11303555]
INFO:root:Epoch 24    loss=0.2443 [40.1 s]	 dev=(HR@5:0.4746,NDCG@5:0.3283) test=(HR@5:0.4163,NDCG@5:0.2818) [39.4 s] 
INFO:root:all_losses: [0.23499748 0.10839206]
INFO:root:Epoch 25    loss=0.2350 [40.1 s]	 dev=(HR@5:0.4677,NDCG@5:0.3228) test=(HR@5:0.4080,NDCG@5:0.2793) [39.3 s] 
INFO:root:all_losses: [0.2272159  0.10371067]
INFO:root:Epoch 26    loss=0.2272 [40.0 s]	 dev=(HR@5:0.4795,NDCG@5:0.3341) test=(HR@5:0.4194,NDCG@5:0.2860) [39.3 s] 
INFO:root:all_losses: [0.21740955 0.0980984 ]
INFO:root:Epoch 27    loss=0.2174 [39.9 s]	 dev=(HR@5:0.4742,NDCG@5:0.3287) test=(HR@5:0.3996,NDCG@5:0.2766) [39.1 s] 
INFO:root:all_losses: [0.20827627 0.09506579]
INFO:root:Epoch 28    loss=0.2083 [40.1 s]	 dev=(HR@5:0.4842,NDCG@5:0.3369) test=(HR@5:0.4267,NDCG@5:0.2921) [39.3 s] 
INFO:root:all_losses: [0.20012698 0.09260149]
INFO:root:Epoch 29    loss=0.2001 [40.2 s]	 dev=(HR@5:0.4917,NDCG@5:0.3435) test=(HR@5:0.4332,NDCG@5:0.2981) [39.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19742472 0.09115565]
INFO:root:Epoch 30    loss=0.1974 [40.2 s]	 dev=(HR@5:0.4805,NDCG@5:0.3359) test=(HR@5:0.4159,NDCG@5:0.2880) [39.3 s] 
INFO:root:all_losses: [0.19485731 0.08619717]
INFO:root:Epoch 31    loss=0.1949 [39.9 s]	 dev=(HR@5:0.4903,NDCG@5:0.3424) test=(HR@5:0.4261,NDCG@5:0.2972) [39.3 s] 
INFO:root:all_losses: [0.19306485 0.0883675 ]
INFO:root:Epoch 32    loss=0.1931 [40.1 s]	 dev=(HR@5:0.4950,NDCG@5:0.3462) test=(HR@5:0.4373,NDCG@5:0.3047) [39.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18037617 0.08230789]
INFO:root:Epoch 33    loss=0.1804 [40.1 s]	 dev=(HR@5:0.4966,NDCG@5:0.3473) test=(HR@5:0.4377,NDCG@5:0.3066) [39.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17501344 0.08016141]
INFO:root:Epoch 34    loss=0.1750 [40.1 s]	 dev=(HR@5:0.5028,NDCG@5:0.3526) test=(HR@5:0.4557,NDCG@5:0.3135) [39.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17547068 0.07994743]
INFO:root:Epoch 35    loss=0.1755 [39.9 s]	 dev=(HR@5:0.4954,NDCG@5:0.3443) test=(HR@5:0.4473,NDCG@5:0.3088) [39.0 s] 
INFO:root:all_losses: [0.16774997 0.07578777]
INFO:root:Epoch 36    loss=0.1677 [40.3 s]	 dev=(HR@5:0.5019,NDCG@5:0.3487) test=(HR@5:0.4430,NDCG@5:0.3064) [39.1 s] 
INFO:root:all_losses: [0.1668936  0.07549536]
INFO:root:Epoch 37    loss=0.1669 [40.2 s]	 dev=(HR@5:0.4871,NDCG@5:0.3428) test=(HR@5:0.4265,NDCG@5:0.2981) [38.9 s] 
INFO:root:all_losses: [0.15848184 0.07494704]
INFO:root:Epoch 38    loss=0.1585 [40.1 s]	 dev=(HR@5:0.4869,NDCG@5:0.3465) test=(HR@5:0.4273,NDCG@5:0.2989) [39.1 s] 
INFO:root:all_losses: [0.15866104 0.07404163]
INFO:root:Epoch 39    loss=0.1587 [39.9 s]	 dev=(HR@5:0.4915,NDCG@5:0.3450) test=(HR@5:0.4345,NDCG@5:0.3016) [39.0 s] 
INFO:root:all_losses: [0.15936378 0.07140332]
INFO:root:Epoch 40    loss=0.1594 [40.5 s]	 dev=(HR@5:0.4787,NDCG@5:0.3370) test=(HR@5:0.4298,NDCG@5:0.2989) [39.0 s] 
INFO:root:all_losses: [0.15048356 0.06879945]
INFO:root:Epoch 41    loss=0.1505 [40.1 s]	 dev=(HR@5:0.5013,NDCG@5:0.3514) test=(HR@5:0.4516,NDCG@5:0.3123) [38.8 s] 
INFO:root:all_losses: [0.15085092 0.07207058]
INFO:root:Epoch 42    loss=0.1509 [40.0 s]	 dev=(HR@5:0.4972,NDCG@5:0.3510) test=(HR@5:0.4544,NDCG@5:0.3159) [38.8 s] 
INFO:root:all_losses: [0.14945577 0.06644403]
INFO:root:Epoch 43    loss=0.1495 [40.3 s]	 dev=(HR@5:0.4970,NDCG@5:0.3522) test=(HR@5:0.4347,NDCG@5:0.3034) [39.0 s] 
INFO:root:all_losses: [0.14601454 0.06683742]
INFO:root:Epoch 44    loss=0.1460 [40.1 s]	 dev=(HR@5:0.4993,NDCG@5:0.3562) test=(HR@5:0.4465,NDCG@5:0.3110) [38.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14143866 0.06481521]
INFO:root:Epoch 45    loss=0.1414 [40.4 s]	 dev=(HR@5:0.4958,NDCG@5:0.3524) test=(HR@5:0.4369,NDCG@5:0.3061) [38.8 s] 
INFO:root:all_losses: [0.14030713 0.06616404]
INFO:root:Epoch 46    loss=0.1403 [40.4 s]	 dev=(HR@5:0.4765,NDCG@5:0.3375) test=(HR@5:0.4122,NDCG@5:0.2887) [38.9 s] 
INFO:root:all_losses: [0.13668218 0.06250854]
INFO:root:Epoch 47    loss=0.1367 [40.1 s]	 dev=(HR@5:0.4948,NDCG@5:0.3498) test=(HR@5:0.4326,NDCG@5:0.3051) [38.9 s] 
INFO:root:all_losses: [0.1396407  0.06377089]
INFO:root:Epoch 48    loss=0.1396 [40.4 s]	 dev=(HR@5:0.5044,NDCG@5:0.3554) test=(HR@5:0.4483,NDCG@5:0.3139) [38.9 s] 
INFO:root:all_losses: [0.13669884 0.06155817]
INFO:root:Epoch 49    loss=0.1367 [40.3 s]	 dev=(HR@5:0.4950,NDCG@5:0.3536) test=(HR@5:0.4389,NDCG@5:0.3084) [38.9 s] 
INFO:root:all_losses: [0.13537453 0.06348937]
INFO:root:Epoch 50    loss=0.1354 [40.2 s]	 dev=(HR@5:0.4972,NDCG@5:0.3528) test=(HR@5:0.4359,NDCG@5:0.3059) [38.6 s] 
INFO:root:all_losses: [0.13075131 0.06097756]
INFO:root:Epoch 51    loss=0.1308 [40.2 s]	 dev=(HR@5:0.5028,NDCG@5:0.3577) test=(HR@5:0.4640,NDCG@5:0.3241) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13004935 0.06034768]
INFO:root:Epoch 52    loss=0.1300 [40.5 s]	 dev=(HR@5:0.5062,NDCG@5:0.3557) test=(HR@5:0.4479,NDCG@5:0.3151) [38.6 s] 
INFO:root:all_losses: [0.12791862 0.06003747]
INFO:root:Epoch 53    loss=0.1279 [39.2 s]	 dev=(HR@5:0.4862,NDCG@5:0.3435) test=(HR@5:0.4294,NDCG@5:0.3003) [38.8 s] 
INFO:root:all_losses: [0.12739956 0.0592552 ]
INFO:root:Epoch 54    loss=0.1274 [40.3 s]	 dev=(HR@5:0.5060,NDCG@5:0.3556) test=(HR@5:0.4514,NDCG@5:0.3157) [38.6 s] 
INFO:root:all_losses: [0.12465397 0.05834026]
INFO:root:Epoch 55    loss=0.1247 [40.0 s]	 dev=(HR@5:0.4913,NDCG@5:0.3477) test=(HR@5:0.4385,NDCG@5:0.3055) [38.7 s] 
INFO:root:all_losses: [0.12903674 0.05943035]
INFO:root:Epoch 56    loss=0.1290 [40.2 s]	 dev=(HR@5:0.5007,NDCG@5:0.3535) test=(HR@5:0.4471,NDCG@5:0.3093) [38.6 s] 
INFO:root:all_losses: [0.12252624 0.05699556]
INFO:root:Epoch 57    loss=0.1225 [40.6 s]	 dev=(HR@5:0.4512,NDCG@5:0.3169) test=(HR@5:0.3853,NDCG@5:0.2659) [38.7 s] 
INFO:root:all_losses: [0.12110253 0.05537915]
INFO:root:Epoch 58    loss=0.1211 [40.2 s]	 dev=(HR@5:0.4795,NDCG@5:0.3374) test=(HR@5:0.4236,NDCG@5:0.2968) [38.6 s] 
INFO:root:all_losses: [0.12335817 0.0568654 ]
INFO:root:Epoch 59    loss=0.1234 [40.3 s]	 dev=(HR@5:0.4805,NDCG@5:0.3424) test=(HR@5:0.4159,NDCG@5:0.2942) [38.6 s] 
INFO:root:all_losses: [0.116285   0.05480258]
INFO:root:Epoch 60    loss=0.1163 [40.2 s]	 dev=(HR@5:0.5066,NDCG@5:0.3603) test=(HR@5:0.4552,NDCG@5:0.3154) [38.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11423843 0.05139668]
INFO:root:Epoch 61    loss=0.1142 [40.4 s]	 dev=(HR@5:0.4901,NDCG@5:0.3480) test=(HR@5:0.4241,NDCG@5:0.2928) [38.9 s] 
INFO:root:all_losses: [0.11949832 0.05517868]
INFO:root:Epoch 62    loss=0.1195 [40.3 s]	 dev=(HR@5:0.4858,NDCG@5:0.3475) test=(HR@5:0.4232,NDCG@5:0.2964) [38.6 s] 
INFO:root:all_losses: [0.11243317 0.05188542]
INFO:root:Epoch 63    loss=0.1124 [40.1 s]	 dev=(HR@5:0.4964,NDCG@5:0.3560) test=(HR@5:0.4489,NDCG@5:0.3134) [38.6 s] 
INFO:root:all_losses: [0.11278854 0.05262146]
INFO:root:Epoch 64    loss=0.1128 [40.7 s]	 dev=(HR@5:0.4881,NDCG@5:0.3478) test=(HR@5:0.4281,NDCG@5:0.2980) [38.5 s] 
INFO:root:all_losses: [0.10972134 0.04962108]
INFO:root:Epoch 65    loss=0.1097 [40.4 s]	 dev=(HR@5:0.4893,NDCG@5:0.3484) test=(HR@5:0.4269,NDCG@5:0.2958) [38.6 s] 
INFO:root:all_losses: [0.11170961 0.05159068]
INFO:root:Epoch 66    loss=0.1117 [40.3 s]	 dev=(HR@5:0.4932,NDCG@5:0.3515) test=(HR@5:0.4430,NDCG@5:0.3068) [38.6 s] 
INFO:root:all_losses: [0.11194799 0.05193187]
INFO:root:Epoch 67    loss=0.1119 [40.2 s]	 dev=(HR@5:0.4852,NDCG@5:0.3490) test=(HR@5:0.4328,NDCG@5:0.3007) [38.5 s] 
INFO:root:all_losses: [0.10833587 0.05052615]
INFO:root:Epoch 68    loss=0.1083 [40.4 s]	 dev=(HR@5:0.5005,NDCG@5:0.3584) test=(HR@5:0.4540,NDCG@5:0.3141) [38.6 s] 
INFO:root:all_losses: [0.10817279 0.05148106]
INFO:root:Epoch 69    loss=0.1082 [40.5 s]	 dev=(HR@5:0.4628,NDCG@5:0.3280) test=(HR@5:0.4171,NDCG@5:0.2905) [38.5 s] 
INFO:root:all_losses: [0.1095845  0.05281505]
INFO:root:Epoch 70    loss=0.1096 [40.6 s]	 dev=(HR@5:0.4854,NDCG@5:0.3455) test=(HR@5:0.4446,NDCG@5:0.3063) [38.5 s] 
INFO:root:all_losses: [0.10814329 0.04988876]
INFO:root:Epoch 71    loss=0.1081 [40.5 s]	 dev=(HR@5:0.4801,NDCG@5:0.3410) test=(HR@5:0.4239,NDCG@5:0.2981) [38.5 s] 
INFO:root:all_losses: [0.10730939 0.04991406]
INFO:root:Epoch 72    loss=0.1073 [40.8 s]	 dev=(HR@5:0.5021,NDCG@5:0.3567) test=(HR@5:0.4550,NDCG@5:0.3194) [38.5 s] 
INFO:root:all_losses: [0.10550337 0.04824218]
INFO:root:Epoch 73    loss=0.1055 [40.5 s]	 dev=(HR@5:0.5013,NDCG@5:0.3537) test=(HR@5:0.4481,NDCG@5:0.3109) [38.3 s] 
INFO:root:all_losses: [0.10465109 0.04949721]
INFO:root:Epoch 74    loss=0.1047 [40.2 s]	 dev=(HR@5:0.4626,NDCG@5:0.3291) test=(HR@5:0.4106,NDCG@5:0.2875) [38.4 s] 
INFO:root:all_losses: [0.10346832 0.04835752]
INFO:root:Epoch 75    loss=0.1035 [40.5 s]	 dev=(HR@5:0.4936,NDCG@5:0.3502) test=(HR@5:0.4363,NDCG@5:0.3087) [38.3 s] 
INFO:root:all_losses: [0.10451785 0.04898211]
INFO:root:Epoch 76    loss=0.1045 [40.4 s]	 dev=(HR@5:0.4724,NDCG@5:0.3346) test=(HR@5:0.4218,NDCG@5:0.2937) [38.3 s] 
INFO:root:all_losses: [0.10387679 0.04816908]
INFO:root:Epoch 77    loss=0.1039 [40.3 s]	 dev=(HR@5:0.4661,NDCG@5:0.3315) test=(HR@5:0.4063,NDCG@5:0.2846) [38.4 s] 
INFO:root:all_losses: [0.10722211 0.05000261]
INFO:root:Epoch 78    loss=0.1072 [40.5 s]	 dev=(HR@5:0.4756,NDCG@5:0.3403) test=(HR@5:0.4120,NDCG@5:0.2900) [38.3 s] 
INFO:root:all_losses: [0.09883045 0.04624408]
INFO:root:Epoch 79    loss=0.0988 [40.4 s]	 dev=(HR@5:0.4997,NDCG@5:0.3560) test=(HR@5:0.4577,NDCG@5:0.3196) [38.3 s] 
INFO:root:all_losses: [0.09951477 0.04713544]
INFO:root:Epoch 80    loss=0.0995 [40.4 s]	 dev=(HR@5:0.4899,NDCG@5:0.3489) test=(HR@5:0.4314,NDCG@5:0.3008) [38.2 s] 
INFO:root:Early stop at 80 based on dev result.
INFO:root:
Best Iter(dev)=   60	 dev=(HR@5:0.5066,NDCG@5:0.3603) test=(HR@5:0.4552,NDCG@5:0.3154) [6258.4 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6124,HR@5:0.4552,HR@50:0.8897,NDCG@10:0.3664,NDCG@5:0.3154,NDCG@50:0.4283)
INFO:root:
--------------------------------------------- END: 2025-02-26 21:28:06 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-02-26 21:51:04 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 550464
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (lstm): LSTM(64, 64, batch_first=True)
)
INFO:root:Test Before Training: (HR@10:0.0822,HR@5:0.0414,HR@50:0.4911,NDCG@10:0.0383,NDCG@5:0.0254,NDCG@50:0.1233)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.299471  0.6931223]
INFO:root:Epoch 1     loss=1.2995 [35.6 s]	 dev=(HR@5:0.1158,NDCG@5:0.0690) test=(HR@5:0.0818,NDCG@5:0.0471) [33.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.244696   0.69297177]
INFO:root:Epoch 2     loss=1.2447 [35.1 s]	 dev=(HR@5:0.1170,NDCG@5:0.0699) test=(HR@5:0.0779,NDCG@5:0.0453) [33.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2277881 0.6926235]
INFO:root:Epoch 3     loss=1.2278 [34.8 s]	 dev=(HR@5:0.1119,NDCG@5:0.0691) test=(HR@5:0.0856,NDCG@5:0.0531) [33.3 s] 
INFO:root:all_losses: [1.1787665  0.69136804]
INFO:root:Epoch 4     loss=1.1788 [35.2 s]	 dev=(HR@5:0.1686,NDCG@5:0.1036) test=(HR@5:0.1240,NDCG@5:0.0780) [33.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1421571  0.68808717]
INFO:root:Epoch 5     loss=1.1422 [35.0 s]	 dev=(HR@5:0.1870,NDCG@5:0.1146) test=(HR@5:0.1366,NDCG@5:0.0830) [33.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1155192  0.68040884]
INFO:root:Epoch 6     loss=1.1155 [34.9 s]	 dev=(HR@5:0.1604,NDCG@5:0.0956) test=(HR@5:0.1174,NDCG@5:0.0718) [33.3 s] 
INFO:root:all_losses: [1.0691798 0.6611353]
INFO:root:Epoch 7     loss=1.0692 [34.8 s]	 dev=(HR@5:0.2903,NDCG@5:0.1835) test=(HR@5:0.2145,NDCG@5:0.1333) [33.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.99466467 0.6152924 ]
INFO:root:Epoch 8     loss=0.9947 [35.0 s]	 dev=(HR@5:0.3117,NDCG@5:0.1988) test=(HR@5:0.2345,NDCG@5:0.1487) [33.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.90222937 0.5523209 ]
INFO:root:Epoch 9     loss=0.9022 [36.1 s]	 dev=(HR@5:0.3144,NDCG@5:0.2020) test=(HR@5:0.2449,NDCG@5:0.1549) [33.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8084855  0.48585722]
INFO:root:Epoch 10    loss=0.8085 [36.9 s]	 dev=(HR@5:0.3641,NDCG@5:0.2353) test=(HR@5:0.2811,NDCG@5:0.1828) [39.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.71784717 0.4221001 ]
INFO:root:Epoch 11    loss=0.7178 [37.5 s]	 dev=(HR@5:0.3655,NDCG@5:0.2388) test=(HR@5:0.2846,NDCG@5:0.1865) [39.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.62710917 0.35759398]
INFO:root:Epoch 12    loss=0.6271 [37.6 s]	 dev=(HR@5:0.3912,NDCG@5:0.2591) test=(HR@5:0.3052,NDCG@5:0.2029) [39.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5424068  0.29589444]
INFO:root:Epoch 13    loss=0.5424 [37.2 s]	 dev=(HR@5:0.3814,NDCG@5:0.2541) test=(HR@5:0.2960,NDCG@5:0.1973) [39.5 s] 
INFO:root:all_losses: [0.47623473 0.24990557]
INFO:root:Epoch 14    loss=0.4762 [37.6 s]	 dev=(HR@5:0.4259,NDCG@5:0.2875) test=(HR@5:0.3305,NDCG@5:0.2252) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4305193  0.21700378]
INFO:root:Epoch 15    loss=0.4305 [37.3 s]	 dev=(HR@5:0.4406,NDCG@5:0.2969) test=(HR@5:0.3537,NDCG@5:0.2372) [39.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3926361  0.19062194]
INFO:root:Epoch 16    loss=0.3926 [37.3 s]	 dev=(HR@5:0.4426,NDCG@5:0.3006) test=(HR@5:0.3551,NDCG@5:0.2388) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.36491257 0.17058614]
INFO:root:Epoch 17    loss=0.3649 [37.5 s]	 dev=(HR@5:0.4630,NDCG@5:0.3129) test=(HR@5:0.3876,NDCG@5:0.2563) [39.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3290256  0.15147261]
INFO:root:Epoch 18    loss=0.3290 [37.4 s]	 dev=(HR@5:0.4738,NDCG@5:0.3240) test=(HR@5:0.3894,NDCG@5:0.2620) [39.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31272763 0.14201905]
INFO:root:Epoch 19    loss=0.3127 [37.4 s]	 dev=(HR@5:0.4773,NDCG@5:0.3276) test=(HR@5:0.4002,NDCG@5:0.2747) [39.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29622626 0.13199249]
INFO:root:Epoch 20    loss=0.2962 [37.3 s]	 dev=(HR@5:0.4610,NDCG@5:0.3152) test=(HR@5:0.3843,NDCG@5:0.2601) [38.8 s] 
INFO:root:all_losses: [0.27851784 0.12305198]
INFO:root:Epoch 21    loss=0.2785 [37.5 s]	 dev=(HR@5:0.4626,NDCG@5:0.3160) test=(HR@5:0.3823,NDCG@5:0.2608) [38.9 s] 
INFO:root:all_losses: [0.26850232 0.11442345]
INFO:root:Epoch 22    loss=0.2685 [37.3 s]	 dev=(HR@5:0.4693,NDCG@5:0.3229) test=(HR@5:0.3870,NDCG@5:0.2639) [38.9 s] 
INFO:root:all_losses: [0.25602743 0.10994503]
INFO:root:Epoch 23    loss=0.2560 [37.6 s]	 dev=(HR@5:0.4801,NDCG@5:0.3318) test=(HR@5:0.4047,NDCG@5:0.2746) [38.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24202874 0.10391143]
INFO:root:Epoch 24    loss=0.2420 [37.4 s]	 dev=(HR@5:0.4805,NDCG@5:0.3324) test=(HR@5:0.4059,NDCG@5:0.2771) [38.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23152314 0.1000561 ]
INFO:root:Epoch 25    loss=0.2315 [37.2 s]	 dev=(HR@5:0.4777,NDCG@5:0.3300) test=(HR@5:0.4037,NDCG@5:0.2766) [38.8 s] 
INFO:root:all_losses: [0.22771093 0.09639677]
INFO:root:Epoch 26    loss=0.2277 [37.4 s]	 dev=(HR@5:0.4909,NDCG@5:0.3374) test=(HR@5:0.4108,NDCG@5:0.2812) [38.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21560374 0.09100378]
INFO:root:Epoch 27    loss=0.2156 [37.5 s]	 dev=(HR@5:0.4862,NDCG@5:0.3372) test=(HR@5:0.3982,NDCG@5:0.2777) [38.9 s] 
INFO:root:all_losses: [0.20831186 0.08882064]
INFO:root:Epoch 28    loss=0.2083 [37.4 s]	 dev=(HR@5:0.4852,NDCG@5:0.3393) test=(HR@5:0.4181,NDCG@5:0.2860) [38.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19953036 0.08623013]
INFO:root:Epoch 29    loss=0.1995 [37.3 s]	 dev=(HR@5:0.4862,NDCG@5:0.3390) test=(HR@5:0.4069,NDCG@5:0.2809) [38.7 s] 
INFO:root:all_losses: [0.19636267 0.08507701]
INFO:root:Epoch 30    loss=0.1964 [37.4 s]	 dev=(HR@5:0.4716,NDCG@5:0.3316) test=(HR@5:0.4031,NDCG@5:0.2795) [38.6 s] 
INFO:root:all_losses: [0.19542243 0.0821035 ]
INFO:root:Epoch 31    loss=0.1954 [37.3 s]	 dev=(HR@5:0.4952,NDCG@5:0.3466) test=(HR@5:0.4396,NDCG@5:0.3002) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19307733 0.08354234]
INFO:root:Epoch 32    loss=0.1931 [37.3 s]	 dev=(HR@5:0.4977,NDCG@5:0.3444) test=(HR@5:0.4292,NDCG@5:0.2972) [38.7 s] 
INFO:root:all_losses: [0.18167299 0.07927736]
INFO:root:Epoch 33    loss=0.1817 [37.5 s]	 dev=(HR@5:0.4852,NDCG@5:0.3394) test=(HR@5:0.4157,NDCG@5:0.2864) [38.6 s] 
INFO:root:all_losses: [0.17746189 0.07703141]
INFO:root:Epoch 34    loss=0.1775 [37.4 s]	 dev=(HR@5:0.4981,NDCG@5:0.3482) test=(HR@5:0.4353,NDCG@5:0.2993) [38.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17492762 0.07572465]
INFO:root:Epoch 35    loss=0.1749 [37.3 s]	 dev=(HR@5:0.4981,NDCG@5:0.3466) test=(HR@5:0.4457,NDCG@5:0.3087) [38.5 s] 
INFO:root:all_losses: [0.16988158 0.07262461]
INFO:root:Epoch 36    loss=0.1699 [37.4 s]	 dev=(HR@5:0.5015,NDCG@5:0.3481) test=(HR@5:0.4426,NDCG@5:0.3052) [38.6 s] 
INFO:root:all_losses: [0.16936103 0.07294623]
INFO:root:Epoch 37    loss=0.1694 [37.4 s]	 dev=(HR@5:0.4852,NDCG@5:0.3411) test=(HR@5:0.4163,NDCG@5:0.2899) [38.5 s] 
INFO:root:all_losses: [0.16187985 0.07280347]
INFO:root:Epoch 38    loss=0.1619 [37.5 s]	 dev=(HR@5:0.4875,NDCG@5:0.3444) test=(HR@5:0.4257,NDCG@5:0.2952) [38.7 s] 
INFO:root:all_losses: [0.15996696 0.07117635]
INFO:root:Epoch 39    loss=0.1600 [37.4 s]	 dev=(HR@5:0.4944,NDCG@5:0.3462) test=(HR@5:0.4322,NDCG@5:0.3003) [38.5 s] 
INFO:root:all_losses: [0.16108693 0.06914987]
INFO:root:Epoch 40    loss=0.1611 [37.2 s]	 dev=(HR@5:0.5011,NDCG@5:0.3525) test=(HR@5:0.4424,NDCG@5:0.3092) [38.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15542756 0.0675    ]
INFO:root:Epoch 41    loss=0.1554 [37.3 s]	 dev=(HR@5:0.5025,NDCG@5:0.3560) test=(HR@5:0.4491,NDCG@5:0.3113) [38.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15212272 0.0688408 ]
INFO:root:Epoch 42    loss=0.1521 [37.3 s]	 dev=(HR@5:0.4952,NDCG@5:0.3518) test=(HR@5:0.4381,NDCG@5:0.3054) [38.4 s] 
INFO:root:all_losses: [0.15210511 0.0647305 ]
INFO:root:Epoch 43    loss=0.1521 [37.3 s]	 dev=(HR@5:0.4901,NDCG@5:0.3448) test=(HR@5:0.4283,NDCG@5:0.2994) [38.4 s] 
INFO:root:all_losses: [0.1483547  0.06561893]
INFO:root:Epoch 44    loss=0.1484 [37.3 s]	 dev=(HR@5:0.5138,NDCG@5:0.3592) test=(HR@5:0.4644,NDCG@5:0.3205) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14471443 0.06273638]
INFO:root:Epoch 45    loss=0.1447 [37.4 s]	 dev=(HR@5:0.5054,NDCG@5:0.3532) test=(HR@5:0.4406,NDCG@5:0.3053) [38.4 s] 
INFO:root:all_losses: [0.14557785 0.06534713]
INFO:root:Epoch 46    loss=0.1456 [37.3 s]	 dev=(HR@5:0.4797,NDCG@5:0.3356) test=(HR@5:0.4106,NDCG@5:0.2849) [38.2 s] 
INFO:root:all_losses: [0.13937747 0.06091582]
INFO:root:Epoch 47    loss=0.1394 [37.4 s]	 dev=(HR@5:0.5072,NDCG@5:0.3546) test=(HR@5:0.4440,NDCG@5:0.3040) [38.4 s] 
INFO:root:all_losses: [0.14412718 0.06301618]
INFO:root:Epoch 48    loss=0.1441 [37.3 s]	 dev=(HR@5:0.5021,NDCG@5:0.3521) test=(HR@5:0.4457,NDCG@5:0.3118) [38.3 s] 
INFO:root:all_losses: [0.13830628 0.06038661]
INFO:root:Epoch 49    loss=0.1383 [37.3 s]	 dev=(HR@5:0.4993,NDCG@5:0.3513) test=(HR@5:0.4426,NDCG@5:0.3091) [38.5 s] 
INFO:root:all_losses: [0.13637282 0.0610829 ]
INFO:root:Epoch 50    loss=0.1364 [37.3 s]	 dev=(HR@5:0.4697,NDCG@5:0.3303) test=(HR@5:0.4108,NDCG@5:0.2899) [38.4 s] 
INFO:root:all_losses: [0.1351374  0.05942985]
INFO:root:Epoch 51    loss=0.1351 [37.2 s]	 dev=(HR@5:0.4897,NDCG@5:0.3452) test=(HR@5:0.4424,NDCG@5:0.3107) [38.2 s] 
INFO:root:all_losses: [0.13418984 0.05994864]
INFO:root:Epoch 52    loss=0.1342 [37.3 s]	 dev=(HR@5:0.5050,NDCG@5:0.3596) test=(HR@5:0.4477,NDCG@5:0.3119) [38.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13043031 0.05857313]
INFO:root:Epoch 53    loss=0.1304 [37.4 s]	 dev=(HR@5:0.5038,NDCG@5:0.3561) test=(HR@5:0.4320,NDCG@5:0.3041) [38.3 s] 
INFO:root:all_losses: [0.13015807 0.05895202]
INFO:root:Epoch 54    loss=0.1302 [37.2 s]	 dev=(HR@5:0.4962,NDCG@5:0.3463) test=(HR@5:0.4369,NDCG@5:0.3028) [38.1 s] 
INFO:root:all_losses: [0.12845495 0.05807805]
INFO:root:Epoch 55    loss=0.1285 [37.4 s]	 dev=(HR@5:0.4940,NDCG@5:0.3479) test=(HR@5:0.4428,NDCG@5:0.3077) [38.1 s] 
INFO:root:all_losses: [0.13194801 0.05823852]
INFO:root:Epoch 56    loss=0.1319 [37.3 s]	 dev=(HR@5:0.4777,NDCG@5:0.3377) test=(HR@5:0.4241,NDCG@5:0.2947) [38.3 s] 
INFO:root:all_losses: [0.12503052 0.05515912]
INFO:root:Epoch 57    loss=0.1250 [37.3 s]	 dev=(HR@5:0.4612,NDCG@5:0.3246) test=(HR@5:0.3982,NDCG@5:0.2782) [38.1 s] 
INFO:root:all_losses: [0.12468674 0.05549989]
INFO:root:Epoch 58    loss=0.1247 [37.2 s]	 dev=(HR@5:0.4856,NDCG@5:0.3433) test=(HR@5:0.4216,NDCG@5:0.2977) [38.3 s] 
INFO:root:all_losses: [0.1266825  0.05686295]
INFO:root:Epoch 59    loss=0.1267 [37.3 s]	 dev=(HR@5:0.4779,NDCG@5:0.3375) test=(HR@5:0.4143,NDCG@5:0.2903) [38.4 s] 
INFO:root:all_losses: [0.1187441 0.0541041]
INFO:root:Epoch 60    loss=0.1187 [37.3 s]	 dev=(HR@5:0.5056,NDCG@5:0.3549) test=(HR@5:0.4589,NDCG@5:0.3205) [38.3 s] 
INFO:root:all_losses: [0.11712398 0.05152059]
INFO:root:Epoch 61    loss=0.1171 [37.3 s]	 dev=(HR@5:0.4995,NDCG@5:0.3529) test=(HR@5:0.4312,NDCG@5:0.3014) [38.4 s] 
INFO:root:all_losses: [0.12162099 0.05469868]
INFO:root:Epoch 62    loss=0.1216 [37.4 s]	 dev=(HR@5:0.4714,NDCG@5:0.3379) test=(HR@5:0.4124,NDCG@5:0.2901) [38.1 s] 
INFO:root:all_losses: [0.11620776 0.05243717]
INFO:root:Epoch 63    loss=0.1162 [37.4 s]	 dev=(HR@5:0.5064,NDCG@5:0.3569) test=(HR@5:0.4563,NDCG@5:0.3228) [38.4 s] 
INFO:root:all_losses: [0.11257066 0.05058169]
INFO:root:Epoch 64    loss=0.1126 [37.4 s]	 dev=(HR@5:0.4907,NDCG@5:0.3470) test=(HR@5:0.4294,NDCG@5:0.3028) [38.3 s] 
INFO:root:all_losses: [0.11307687 0.04942727]
INFO:root:Epoch 65    loss=0.1131 [37.3 s]	 dev=(HR@5:0.4836,NDCG@5:0.3405) test=(HR@5:0.4198,NDCG@5:0.2935) [38.2 s] 
INFO:root:all_losses: [0.11100942 0.0510491 ]
INFO:root:Epoch 66    loss=0.1110 [37.4 s]	 dev=(HR@5:0.4779,NDCG@5:0.3400) test=(HR@5:0.4157,NDCG@5:0.2909) [38.1 s] 
INFO:root:all_losses: [0.11588545 0.05206746]
INFO:root:Epoch 67    loss=0.1159 [37.3 s]	 dev=(HR@5:0.5017,NDCG@5:0.3530) test=(HR@5:0.4396,NDCG@5:0.3075) [38.2 s] 
INFO:root:all_losses: [0.11295618 0.05011194]
INFO:root:Epoch 68    loss=0.1130 [37.4 s]	 dev=(HR@5:0.5005,NDCG@5:0.3549) test=(HR@5:0.4408,NDCG@5:0.3113) [38.1 s] 
INFO:root:all_losses: [0.1129134 0.0518614]
INFO:root:Epoch 69    loss=0.1129 [37.4 s]	 dev=(HR@5:0.4644,NDCG@5:0.3297) test=(HR@5:0.4047,NDCG@5:0.2850) [38.1 s] 
INFO:root:all_losses: [0.11490878 0.05344842]
INFO:root:Epoch 70    loss=0.1149 [37.4 s]	 dev=(HR@5:0.4848,NDCG@5:0.3422) test=(HR@5:0.4353,NDCG@5:0.3029) [38.0 s] 
INFO:root:all_losses: [0.11142418 0.04998847]
INFO:root:Epoch 71    loss=0.1114 [37.4 s]	 dev=(HR@5:0.4614,NDCG@5:0.3278) test=(HR@5:0.4037,NDCG@5:0.2847) [38.0 s] 
INFO:root:all_losses: [0.10888852 0.05030813]
INFO:root:Epoch 72    loss=0.1089 [37.4 s]	 dev=(HR@5:0.4919,NDCG@5:0.3506) test=(HR@5:0.4467,NDCG@5:0.3127) [38.1 s] 
INFO:root:Early stop at 72 based on dev result.
INFO:root:
Best Iter(dev)=   52	 dev=(HR@5:0.5050,NDCG@5:0.3596) test=(HR@5:0.4477,NDCG@5:0.3119) [5398.8 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6043,HR@5:0.4477,HR@50:0.8928,NDCG@10:0.3628,NDCG@5:0.3121,NDCG@50:0.4273)
INFO:root:
--------------------------------------------- END: 2025-02-26 23:21:39 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-19 09:39:08 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005366 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [23.0 s]	 dev=(HR@5:0.1058,NDCG@5:0.0623) test=(HR@5:0.0709,NDCG@5:0.0409) [30.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2450248 0.6929538]
INFO:root:Epoch 2     loss=1.2450 [23.3 s]	 dev=(HR@5:0.1170,NDCG@5:0.0703) test=(HR@5:0.0734,NDCG@5:0.0432) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242438   0.69262415]
INFO:root:Epoch 3     loss=1.2424 [23.3 s]	 dev=(HR@5:0.1111,NDCG@5:0.0629) test=(HR@5:0.0760,NDCG@5:0.0427) [30.5 s] 
INFO:root:all_losses: [1.2254064 0.692259 ]
INFO:root:Epoch 4     loss=1.2254 [24.5 s]	 dev=(HR@5:0.1450,NDCG@5:0.0875) test=(HR@5:0.1040,NDCG@5:0.0635) [30.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1719065 0.6904993]
INFO:root:Epoch 5     loss=1.1719 [22.9 s]	 dev=(HR@5:0.1660,NDCG@5:0.1029) test=(HR@5:0.1244,NDCG@5:0.0782) [29.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1420462  0.68476284]
INFO:root:Epoch 6     loss=1.1420 [22.4 s]	 dev=(HR@5:0.1761,NDCG@5:0.1083) test=(HR@5:0.1344,NDCG@5:0.0815) [29.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1071645 0.6709338]
INFO:root:Epoch 7     loss=1.1072 [22.5 s]	 dev=(HR@5:0.1939,NDCG@5:0.1211) test=(HR@5:0.1443,NDCG@5:0.0889) [30.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0585675 0.6361616]
INFO:root:Epoch 8     loss=1.0586 [23.1 s]	 dev=(HR@5:0.2008,NDCG@5:0.1253) test=(HR@5:0.1445,NDCG@5:0.0896) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.98347557 0.5801406 ]
INFO:root:Epoch 9     loss=0.9835 [24.0 s]	 dev=(HR@5:0.2628,NDCG@5:0.1669) test=(HR@5:0.2018,NDCG@5:0.1261) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8817682 0.5185204]
INFO:root:Epoch 10    loss=0.8818 [26.1 s]	 dev=(HR@5:0.3119,NDCG@5:0.1993) test=(HR@5:0.2338,NDCG@5:0.1495) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.78202736 0.4589452 ]
INFO:root:Epoch 11    loss=0.7820 [26.1 s]	 dev=(HR@5:0.3851,NDCG@5:0.2515) test=(HR@5:0.3068,NDCG@5:0.2000) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6916906 0.4005349]
INFO:root:Epoch 12    loss=0.6917 [26.1 s]	 dev=(HR@5:0.4022,NDCG@5:0.2596) test=(HR@5:0.3235,NDCG@5:0.2097) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6060649  0.33994693]
INFO:root:Epoch 13    loss=0.6061 [26.1 s]	 dev=(HR@5:0.4029,NDCG@5:0.2603) test=(HR@5:0.3156,NDCG@5:0.2034) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.53651804 0.2933225 ]
INFO:root:Epoch 14    loss=0.5365 [26.1 s]	 dev=(HR@5:0.4100,NDCG@5:0.2686) test=(HR@5:0.3193,NDCG@5:0.2100) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.48781782 0.25759184]
INFO:root:Epoch 15    loss=0.4878 [26.3 s]	 dev=(HR@5:0.4232,NDCG@5:0.2806) test=(HR@5:0.3258,NDCG@5:0.2156) [36.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4460914  0.22763756]
INFO:root:Epoch 16    loss=0.4461 [26.9 s]	 dev=(HR@5:0.4367,NDCG@5:0.2951) test=(HR@5:0.3419,NDCG@5:0.2294) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4096782  0.20237035]
INFO:root:Epoch 17    loss=0.4097 [26.8 s]	 dev=(HR@5:0.4430,NDCG@5:0.2985) test=(HR@5:0.3611,NDCG@5:0.2363) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.37028876 0.17875439]
INFO:root:Epoch 18    loss=0.3703 [26.7 s]	 dev=(HR@5:0.4442,NDCG@5:0.3045) test=(HR@5:0.3445,NDCG@5:0.2328) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35179585 0.16520803]
INFO:root:Epoch 19    loss=0.3518 [26.7 s]	 dev=(HR@5:0.4536,NDCG@5:0.3098) test=(HR@5:0.3698,NDCG@5:0.2489) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32743695 0.1512027 ]
INFO:root:Epoch 20    loss=0.3274 [27.0 s]	 dev=(HR@5:0.4813,NDCG@5:0.3270) test=(HR@5:0.3982,NDCG@5:0.2663) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.30801153 0.14028218]
INFO:root:Epoch 21    loss=0.3080 [26.6 s]	 dev=(HR@5:0.4618,NDCG@5:0.3138) test=(HR@5:0.3694,NDCG@5:0.2518) [36.2 s] 
INFO:root:all_losses: [0.29441732 0.13014665]
INFO:root:Epoch 22    loss=0.2944 [26.6 s]	 dev=(HR@5:0.4879,NDCG@5:0.3370) test=(HR@5:0.4055,NDCG@5:0.2731) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27848265 0.12184636]
INFO:root:Epoch 23    loss=0.2785 [26.5 s]	 dev=(HR@5:0.4926,NDCG@5:0.3397) test=(HR@5:0.4124,NDCG@5:0.2783) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26506466 0.11457192]
INFO:root:Epoch 24    loss=0.2651 [26.6 s]	 dev=(HR@5:0.4787,NDCG@5:0.3325) test=(HR@5:0.4002,NDCG@5:0.2724) [36.2 s] 
INFO:root:all_losses: [0.25509745 0.11090565]
INFO:root:Epoch 25    loss=0.2551 [26.6 s]	 dev=(HR@5:0.4793,NDCG@5:0.3309) test=(HR@5:0.4067,NDCG@5:0.2759) [36.2 s] 
INFO:root:all_losses: [0.24547976 0.10534354]
INFO:root:Epoch 26    loss=0.2455 [26.6 s]	 dev=(HR@5:0.4940,NDCG@5:0.3433) test=(HR@5:0.4249,NDCG@5:0.2880) [35.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23376511 0.09972164]
INFO:root:Epoch 27    loss=0.2338 [26.6 s]	 dev=(HR@5:0.4903,NDCG@5:0.3434) test=(HR@5:0.4149,NDCG@5:0.2856) [35.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22400883 0.09527046]
INFO:root:Epoch 28    loss=0.2240 [26.6 s]	 dev=(HR@5:0.4707,NDCG@5:0.3244) test=(HR@5:0.3843,NDCG@5:0.2644) [36.1 s] 
INFO:root:all_losses: [0.21807204 0.09311033]
INFO:root:Epoch 29    loss=0.2181 [26.6 s]	 dev=(HR@5:0.4838,NDCG@5:0.3405) test=(HR@5:0.4141,NDCG@5:0.2850) [36.3 s] 
INFO:root:all_losses: [0.21322475 0.09108873]
INFO:root:Epoch 30    loss=0.2132 [26.4 s]	 dev=(HR@5:0.4748,NDCG@5:0.3323) test=(HR@5:0.3986,NDCG@5:0.2748) [36.0 s] 
INFO:root:all_losses: [0.20875345 0.08719852]
INFO:root:Epoch 31    loss=0.2088 [26.5 s]	 dev=(HR@5:0.4966,NDCG@5:0.3493) test=(HR@5:0.4328,NDCG@5:0.2982) [35.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2053021 0.0888825]
INFO:root:Epoch 32    loss=0.2053 [26.5 s]	 dev=(HR@5:0.4966,NDCG@5:0.3462) test=(HR@5:0.4310,NDCG@5:0.2920) [35.9 s] 
INFO:root:all_losses: [0.19546725 0.08336622]
INFO:root:Epoch 33    loss=0.1955 [26.6 s]	 dev=(HR@5:0.5023,NDCG@5:0.3514) test=(HR@5:0.4334,NDCG@5:0.2934) [35.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1883297  0.08056688]
INFO:root:Epoch 34    loss=0.1883 [26.6 s]	 dev=(HR@5:0.5034,NDCG@5:0.3520) test=(HR@5:0.4367,NDCG@5:0.2981) [35.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1866226  0.07996099]
INFO:root:Epoch 35    loss=0.1866 [26.5 s]	 dev=(HR@5:0.5064,NDCG@5:0.3548) test=(HR@5:0.4371,NDCG@5:0.3003) [35.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18118142 0.07742533]
INFO:root:Epoch 36    loss=0.1812 [26.5 s]	 dev=(HR@5:0.4970,NDCG@5:0.3475) test=(HR@5:0.4432,NDCG@5:0.3038) [35.7 s] 
INFO:root:all_losses: [0.17538594 0.07487284]
INFO:root:Epoch 37    loss=0.1754 [26.5 s]	 dev=(HR@5:0.4848,NDCG@5:0.3389) test=(HR@5:0.4216,NDCG@5:0.2892) [35.9 s] 
INFO:root:all_losses: [0.17394921 0.07580278]
INFO:root:Epoch 38    loss=0.1739 [26.6 s]	 dev=(HR@5:0.5001,NDCG@5:0.3503) test=(HR@5:0.4336,NDCG@5:0.2977) [35.8 s] 
INFO:root:all_losses: [0.16775401 0.073376  ]
INFO:root:Epoch 39    loss=0.1678 [26.5 s]	 dev=(HR@5:0.4797,NDCG@5:0.3396) test=(HR@5:0.4163,NDCG@5:0.2880) [35.8 s] 
INFO:root:all_losses: [0.1712663  0.07094872]
INFO:root:Epoch 40    loss=0.1713 [26.4 s]	 dev=(HR@5:0.4838,NDCG@5:0.3388) test=(HR@5:0.4236,NDCG@5:0.2921) [36.0 s] 
INFO:root:all_losses: [0.16466464 0.07068389]
INFO:root:Epoch 41    loss=0.1647 [26.5 s]	 dev=(HR@5:0.5007,NDCG@5:0.3523) test=(HR@5:0.4363,NDCG@5:0.3002) [35.7 s] 
INFO:root:all_losses: [0.1610107  0.07095683]
INFO:root:Epoch 42    loss=0.1610 [26.5 s]	 dev=(HR@5:0.5062,NDCG@5:0.3580) test=(HR@5:0.4508,NDCG@5:0.3091) [35.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1609819  0.06697619]
INFO:root:Epoch 43    loss=0.1610 [26.7 s]	 dev=(HR@5:0.4930,NDCG@5:0.3482) test=(HR@5:0.4220,NDCG@5:0.2891) [35.4 s] 
INFO:root:all_losses: [0.15632766 0.06756115]
INFO:root:Epoch 44    loss=0.1563 [26.4 s]	 dev=(HR@5:0.4981,NDCG@5:0.3525) test=(HR@5:0.4314,NDCG@5:0.2974) [35.7 s] 
INFO:root:all_losses: [0.15264946 0.06510824]
INFO:root:Epoch 45    loss=0.1526 [26.5 s]	 dev=(HR@5:0.4899,NDCG@5:0.3466) test=(HR@5:0.4257,NDCG@5:0.2922) [35.4 s] 
INFO:root:all_losses: [0.15141207 0.06752167]
INFO:root:Epoch 46    loss=0.1514 [26.6 s]	 dev=(HR@5:0.4948,NDCG@5:0.3516) test=(HR@5:0.4324,NDCG@5:0.2983) [35.4 s] 
INFO:root:all_losses: [0.14555009 0.06324667]
INFO:root:Epoch 47    loss=0.1456 [26.7 s]	 dev=(HR@5:0.4968,NDCG@5:0.3498) test=(HR@5:0.4296,NDCG@5:0.2954) [35.6 s] 
INFO:root:all_losses: [0.1485171  0.06403819]
INFO:root:Epoch 48    loss=0.1485 [26.4 s]	 dev=(HR@5:0.5030,NDCG@5:0.3539) test=(HR@5:0.4432,NDCG@5:0.3073) [35.6 s] 
INFO:root:all_losses: [0.14501077 0.06190035]
INFO:root:Epoch 49    loss=0.1450 [26.4 s]	 dev=(HR@5:0.5013,NDCG@5:0.3509) test=(HR@5:0.4379,NDCG@5:0.2992) [35.4 s] 
INFO:root:all_losses: [0.14379337 0.06261832]
INFO:root:Epoch 50    loss=0.1438 [26.5 s]	 dev=(HR@5:0.4989,NDCG@5:0.3512) test=(HR@5:0.4340,NDCG@5:0.2993) [35.6 s] 
INFO:root:all_losses: [0.14214367 0.06170875]
INFO:root:Epoch 51    loss=0.1421 [26.5 s]	 dev=(HR@5:0.5083,NDCG@5:0.3616) test=(HR@5:0.4493,NDCG@5:0.3111) [35.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13764198 0.06129844]
INFO:root:Epoch 52    loss=0.1376 [26.5 s]	 dev=(HR@5:0.5068,NDCG@5:0.3573) test=(HR@5:0.4575,NDCG@5:0.3123) [35.5 s] 
INFO:root:all_losses: [0.13637233 0.06069836]
INFO:root:Epoch 53    loss=0.1364 [26.3 s]	 dev=(HR@5:0.4824,NDCG@5:0.3388) test=(HR@5:0.4157,NDCG@5:0.2856) [35.5 s] 
INFO:root:all_losses: [0.13414994 0.05990411]
INFO:root:Epoch 54    loss=0.1341 [26.2 s]	 dev=(HR@5:0.5107,NDCG@5:0.3568) test=(HR@5:0.4530,NDCG@5:0.3098) [35.6 s] 
INFO:root:all_losses: [0.13414969 0.05910643]
INFO:root:Epoch 55    loss=0.1341 [26.3 s]	 dev=(HR@5:0.5040,NDCG@5:0.3516) test=(HR@5:0.4363,NDCG@5:0.3040) [35.6 s] 
INFO:root:all_losses: [0.14007774 0.05981265]
INFO:root:Epoch 56    loss=0.1401 [26.4 s]	 dev=(HR@5:0.5062,NDCG@5:0.3544) test=(HR@5:0.4485,NDCG@5:0.3099) [35.3 s] 
INFO:root:all_losses: [0.13192828 0.0572156 ]
INFO:root:Epoch 57    loss=0.1319 [26.5 s]	 dev=(HR@5:0.5001,NDCG@5:0.3486) test=(HR@5:0.4375,NDCG@5:0.3017) [35.3 s] 
INFO:root:all_losses: [0.12954037 0.05668485]
INFO:root:Epoch 58    loss=0.1295 [26.3 s]	 dev=(HR@5:0.5062,NDCG@5:0.3565) test=(HR@5:0.4402,NDCG@5:0.3073) [35.5 s] 
INFO:root:all_losses: [0.12959652 0.05791424]
INFO:root:Epoch 59    loss=0.1296 [26.4 s]	 dev=(HR@5:0.4970,NDCG@5:0.3487) test=(HR@5:0.4247,NDCG@5:0.2961) [35.3 s] 
INFO:root:all_losses: [0.12257533 0.05550517]
INFO:root:Epoch 60    loss=0.1226 [26.5 s]	 dev=(HR@5:0.4740,NDCG@5:0.3330) test=(HR@5:0.4033,NDCG@5:0.2809) [35.2 s] 
INFO:root:all_losses: [0.12373888 0.05387823]
INFO:root:Epoch 61    loss=0.1237 [26.5 s]	 dev=(HR@5:0.5042,NDCG@5:0.3570) test=(HR@5:0.4418,NDCG@5:0.3066) [35.2 s] 
INFO:root:all_losses: [0.12675688 0.05702792]
INFO:root:Epoch 62    loss=0.1268 [26.4 s]	 dev=(HR@5:0.5052,NDCG@5:0.3580) test=(HR@5:0.4467,NDCG@5:0.3076) [35.3 s] 
INFO:root:all_losses: [0.1211966  0.05401303]
INFO:root:Epoch 63    loss=0.1212 [26.4 s]	 dev=(HR@5:0.5017,NDCG@5:0.3578) test=(HR@5:0.4412,NDCG@5:0.3086) [35.2 s] 
INFO:root:all_losses: [0.11639546 0.05206145]
INFO:root:Epoch 64    loss=0.1164 [26.4 s]	 dev=(HR@5:0.5078,NDCG@5:0.3605) test=(HR@5:0.4546,NDCG@5:0.3150) [35.3 s] 
INFO:root:all_losses: [0.11647135 0.05066669]
INFO:root:Epoch 65    loss=0.1165 [26.4 s]	 dev=(HR@5:0.4987,NDCG@5:0.3515) test=(HR@5:0.4381,NDCG@5:0.3034) [36.2 s] 
INFO:root:all_losses: [0.11868814 0.05283651]
INFO:root:Epoch 66    loss=0.1187 [26.4 s]	 dev=(HR@5:0.4958,NDCG@5:0.3505) test=(HR@5:0.4332,NDCG@5:0.2995) [35.3 s] 
INFO:root:all_losses: [0.11973619 0.0537732 ]
INFO:root:Epoch 67    loss=0.1197 [26.4 s]	 dev=(HR@5:0.5099,NDCG@5:0.3608) test=(HR@5:0.4471,NDCG@5:0.3098) [35.2 s] 
INFO:root:all_losses: [0.11781831 0.05168002]
INFO:root:Epoch 68    loss=0.1178 [26.4 s]	 dev=(HR@5:0.5217,NDCG@5:0.3658) test=(HR@5:0.4644,NDCG@5:0.3178) [35.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11762135 0.0533694 ]
INFO:root:Epoch 69    loss=0.1176 [26.5 s]	 dev=(HR@5:0.5201,NDCG@5:0.3674) test=(HR@5:0.4603,NDCG@5:0.3145) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1207047  0.05471091]
INFO:root:Epoch 70    loss=0.1207 [26.7 s]	 dev=(HR@5:0.5046,NDCG@5:0.3573) test=(HR@5:0.4434,NDCG@5:0.3044) [35.4 s] 
INFO:root:all_losses: [0.1141797  0.05110108]
INFO:root:Epoch 71    loss=0.1142 [26.5 s]	 dev=(HR@5:0.4842,NDCG@5:0.3425) test=(HR@5:0.4167,NDCG@5:0.2901) [35.1 s] 
INFO:root:all_losses: [0.11271492 0.05143382]
INFO:root:Epoch 72    loss=0.1127 [26.5 s]	 dev=(HR@5:0.5001,NDCG@5:0.3531) test=(HR@5:0.4373,NDCG@5:0.3044) [35.3 s] 
INFO:root:all_losses: [0.11195633 0.04875771]
INFO:root:Epoch 73    loss=0.1120 [26.6 s]	 dev=(HR@5:0.4934,NDCG@5:0.3532) test=(HR@5:0.4218,NDCG@5:0.2931) [35.4 s] 
INFO:root:all_losses: [0.11209255 0.05088644]
INFO:root:Epoch 74    loss=0.1121 [26.6 s]	 dev=(HR@5:0.4954,NDCG@5:0.3517) test=(HR@5:0.4318,NDCG@5:0.3036) [36.0 s] 
INFO:root:all_losses: [0.11122227 0.04902607]
INFO:root:Epoch 75    loss=0.1112 [26.5 s]	 dev=(HR@5:0.5072,NDCG@5:0.3598) test=(HR@5:0.4406,NDCG@5:0.3080) [35.0 s] 
INFO:root:all_losses: [0.11180791 0.05049289]
INFO:root:Epoch 76    loss=0.1118 [25.7 s]	 dev=(HR@5:0.5154,NDCG@5:0.3636) test=(HR@5:0.4438,NDCG@5:0.3096) [34.7 s] 
INFO:root:all_losses: [0.10825429 0.04819171]
INFO:root:Epoch 77    loss=0.1083 [25.8 s]	 dev=(HR@5:0.5081,NDCG@5:0.3625) test=(HR@5:0.4471,NDCG@5:0.3096) [34.6 s] 
INFO:root:all_losses: [0.10899342 0.04953362]
INFO:root:Epoch 78    loss=0.1090 [25.9 s]	 dev=(HR@5:0.5015,NDCG@5:0.3559) test=(HR@5:0.4512,NDCG@5:0.3164) [34.6 s] 
INFO:root:all_losses: [0.10646768 0.04849395]
INFO:root:Epoch 79    loss=0.1065 [25.7 s]	 dev=(HR@5:0.4858,NDCG@5:0.3441) test=(HR@5:0.4232,NDCG@5:0.2983) [34.5 s] 
INFO:root:all_losses: [0.10603575 0.04770031]
INFO:root:Epoch 80    loss=0.1060 [25.8 s]	 dev=(HR@5:0.4981,NDCG@5:0.3553) test=(HR@5:0.4467,NDCG@5:0.3135) [34.4 s] 
INFO:root:all_losses: [0.11113666 0.05060671]
INFO:root:Epoch 81    loss=0.1111 [25.8 s]	 dev=(HR@5:0.4948,NDCG@5:0.3527) test=(HR@5:0.4285,NDCG@5:0.3000) [34.5 s] 
INFO:root:all_losses: [0.1075161  0.04930028]
INFO:root:Epoch 82    loss=0.1075 [25.9 s]	 dev=(HR@5:0.4926,NDCG@5:0.3526) test=(HR@5:0.4302,NDCG@5:0.3020) [34.6 s] 
INFO:root:all_losses: [0.10641746 0.04733374]
INFO:root:Epoch 83    loss=0.1064 [25.7 s]	 dev=(HR@5:0.4864,NDCG@5:0.3491) test=(HR@5:0.4290,NDCG@5:0.3037) [34.6 s] 
INFO:root:all_losses: [0.10769134 0.04931368]
INFO:root:Epoch 84    loss=0.1077 [25.7 s]	 dev=(HR@5:0.4889,NDCG@5:0.3496) test=(HR@5:0.4296,NDCG@5:0.3028) [34.5 s] 
INFO:root:all_losses: [0.10533322 0.04762886]
INFO:root:Epoch 85    loss=0.1053 [25.7 s]	 dev=(HR@5:0.4979,NDCG@5:0.3540) test=(HR@5:0.4298,NDCG@5:0.2998) [34.6 s] 
INFO:root:all_losses: [0.1022693  0.04658417]
INFO:root:Epoch 86    loss=0.1023 [25.9 s]	 dev=(HR@5:0.4785,NDCG@5:0.3440) test=(HR@5:0.4177,NDCG@5:0.2910) [34.5 s] 
INFO:root:all_losses: [0.10311425 0.04785073]
INFO:root:Epoch 87    loss=0.1031 [25.8 s]	 dev=(HR@5:0.4875,NDCG@5:0.3472) test=(HR@5:0.4304,NDCG@5:0.2984) [34.5 s] 
INFO:root:all_losses: [0.10369343 0.04819122]
INFO:root:Epoch 88    loss=0.1037 [25.7 s]	 dev=(HR@5:0.4504,NDCG@5:0.3196) test=(HR@5:0.3927,NDCG@5:0.2718) [34.3 s] 
INFO:root:all_losses: [0.1037832  0.04755898]
INFO:root:Epoch 89    loss=0.1038 [25.7 s]	 dev=(HR@5:0.4826,NDCG@5:0.3426) test=(HR@5:0.4218,NDCG@5:0.2967) [34.4 s] 
INFO:root:Early stop at 89 based on dev result.
INFO:root:
Best Iter(dev)=   69	 dev=(HR@5:0.5201,NDCG@5:0.3674) test=(HR@5:0.4603,NDCG@5:0.3145) [5431.8 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6296,HR@5:0.4603,HR@50:0.8885,NDCG@10:0.3694,NDCG@5:0.3145,NDCG@50:0.4274)
INFO:root:
--------------------------------------------- END: 2025-03-19 11:10:13 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-19 21:45:38 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005369 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [43.0 s]	 dev=(HR@5:0.1058,NDCG@5:0.0623) test=(HR@5:0.0709,NDCG@5:0.0409) [50.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.245012  0.6929539]
INFO:root:Epoch 2     loss=1.2450 [42.4 s]	 dev=(HR@5:0.1158,NDCG@5:0.0696) test=(HR@5:0.0732,NDCG@5:0.0432) [50.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242534  0.6926261]
INFO:root:Epoch 3     loss=1.2425 [42.2 s]	 dev=(HR@5:0.1121,NDCG@5:0.0636) test=(HR@5:0.0779,NDCG@5:0.0434) [51.4 s] 
INFO:root:all_losses: [1.2354351 0.6922947]
INFO:root:Epoch 4     loss=1.2354 [43.6 s]	 dev=(HR@5:0.1156,NDCG@5:0.0689) test=(HR@5:0.0758,NDCG@5:0.0446) [51.4 s] 
INFO:root:all_losses: [1.239723  0.6918259]
INFO:root:Epoch 5     loss=1.2397 [42.4 s]	 dev=(HR@5:0.1117,NDCG@5:0.0645) test=(HR@5:0.0756,NDCG@5:0.0440) [51.3 s] 
INFO:root:all_losses: [1.2387129  0.69090986]
INFO:root:Epoch 6     loss=1.2387 [42.4 s]	 dev=(HR@5:0.1172,NDCG@5:0.0670) test=(HR@5:0.0742,NDCG@5:0.0417) [51.5 s] 
INFO:root:all_losses: [1.2301697  0.68916136]
INFO:root:Epoch 7     loss=1.2302 [42.4 s]	 dev=(HR@5:0.1101,NDCG@5:0.0645) test=(HR@5:0.0683,NDCG@5:0.0390) [51.3 s] 
INFO:root:all_losses: [1.2200608  0.68050027]
INFO:root:Epoch 8     loss=1.2201 [42.3 s]	 dev=(HR@5:0.1028,NDCG@5:0.0615) test=(HR@5:0.0622,NDCG@5:0.0351) [51.5 s] 
INFO:root:all_losses: [1.1712736  0.63602644]
INFO:root:Epoch 9     loss=1.1713 [43.8 s]	 dev=(HR@5:0.1113,NDCG@5:0.0654) test=(HR@5:0.0646,NDCG@5:0.0366) [50.8 s] 
INFO:root:all_losses: [1.0673381 0.5463867]
INFO:root:Epoch 10    loss=1.0673 [44.7 s]	 dev=(HR@5:0.1036,NDCG@5:0.0607) test=(HR@5:0.0693,NDCG@5:0.0391) [55.7 s] 
INFO:root:all_losses: [0.955182   0.46117467]
INFO:root:Epoch 11    loss=0.9552 [45.3 s]	 dev=(HR@5:0.1117,NDCG@5:0.0676) test=(HR@5:0.0769,NDCG@5:0.0437) [55.0 s] 
INFO:root:all_losses: [0.8804253  0.38614747]
INFO:root:Epoch 12    loss=0.8804 [45.2 s]	 dev=(HR@5:0.1091,NDCG@5:0.0641) test=(HR@5:0.0689,NDCG@5:0.0384) [55.2 s] 
INFO:root:all_losses: [0.79979026 0.3173804 ]
INFO:root:Epoch 13    loss=0.7998 [45.0 s]	 dev=(HR@5:0.1097,NDCG@5:0.0641) test=(HR@5:0.0732,NDCG@5:0.0413) [54.6 s] 
INFO:root:all_losses: [0.74231905 0.26811633]
INFO:root:Epoch 14    loss=0.7423 [45.2 s]	 dev=(HR@5:0.1095,NDCG@5:0.0631) test=(HR@5:0.0699,NDCG@5:0.0391) [55.1 s] 
INFO:root:all_losses: [0.70564485 0.2353132 ]
INFO:root:Epoch 15    loss=0.7056 [44.9 s]	 dev=(HR@5:0.1062,NDCG@5:0.0621) test=(HR@5:0.0683,NDCG@5:0.0389) [55.1 s] 
INFO:root:all_losses: [0.67910945 0.20801802]
INFO:root:Epoch 16    loss=0.6791 [45.2 s]	 dev=(HR@5:0.1066,NDCG@5:0.0610) test=(HR@5:0.0687,NDCG@5:0.0385) [55.3 s] 
INFO:root:all_losses: [0.6534453  0.18521903]
INFO:root:Epoch 17    loss=0.6534 [46.0 s]	 dev=(HR@5:0.1105,NDCG@5:0.0652) test=(HR@5:0.0697,NDCG@5:0.0409) [54.8 s] 
INFO:root:all_losses: [0.62447757 0.16533327]
INFO:root:Epoch 18    loss=0.6245 [45.2 s]	 dev=(HR@5:0.1134,NDCG@5:0.0661) test=(HR@5:0.0687,NDCG@5:0.0389) [55.1 s] 
INFO:root:all_losses: [0.61500716 0.15210661]
INFO:root:Epoch 19    loss=0.6150 [45.5 s]	 dev=(HR@5:0.1066,NDCG@5:0.0634) test=(HR@5:0.0683,NDCG@5:0.0382) [55.0 s] 
INFO:root:all_losses: [0.59882575 0.13894919]
INFO:root:Epoch 20    loss=0.5988 [45.4 s]	 dev=(HR@5:0.1093,NDCG@5:0.0640) test=(HR@5:0.0661,NDCG@5:0.0378) [55.0 s] 
INFO:root:all_losses: [0.5877675  0.12981394]
INFO:root:Epoch 21    loss=0.5878 [45.4 s]	 dev=(HR@5:0.1064,NDCG@5:0.0635) test=(HR@5:0.0667,NDCG@5:0.0388) [55.3 s] 
INFO:root:all_losses: [0.5778691  0.12078054]
INFO:root:Epoch 22    loss=0.5779 [45.0 s]	 dev=(HR@5:0.1115,NDCG@5:0.0675) test=(HR@5:0.0679,NDCG@5:0.0392) [55.3 s] 
INFO:root:Early stop at 22 based on dev result.
INFO:root:
Best Iter(dev)=    2	 dev=(HR@5:0.1158,NDCG@5:0.0696) test=(HR@5:0.0732,NDCG@5:0.0432) [2149.0 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.1625,HR@5:0.0732,HR@50:0.6251,NDCG@10:0.0715,NDCG@5:0.0432,NDCG@50:0.1735)
INFO:root:
--------------------------------------------- END: 2025-03-19 22:22:20 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-31 22:05:50 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005395 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [54.3 s]	 dev=(HR@5:0.1062,NDCG@5:0.0625) test=(HR@5:0.0709,NDCG@5:0.0410) [58.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2450578 0.6929532]
INFO:root:Epoch 2     loss=1.2451 [53.1 s]	 dev=(HR@5:0.1160,NDCG@5:0.0695) test=(HR@5:0.0724,NDCG@5:0.0429) [58.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2431276 0.6926309]
INFO:root:Epoch 3     loss=1.2431 [52.9 s]	 dev=(HR@5:0.1109,NDCG@5:0.0626) test=(HR@5:0.0771,NDCG@5:0.0424) [58.4 s] 
INFO:root:all_losses: [1.2243631 0.6922455]
INFO:root:Epoch 4     loss=1.2244 [53.7 s]	 dev=(HR@5:0.1445,NDCG@5:0.0870) test=(HR@5:0.1060,NDCG@5:0.0668) [59.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1770962 0.6905287]
INFO:root:Epoch 5     loss=1.1771 [53.0 s]	 dev=(HR@5:0.1682,NDCG@5:0.1035) test=(HR@5:0.1278,NDCG@5:0.0794) [58.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1459398  0.68517435]
INFO:root:Epoch 6     loss=1.1459 [52.5 s]	 dev=(HR@5:0.1739,NDCG@5:0.1068) test=(HR@5:0.1272,NDCG@5:0.0771) [58.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1087762 0.6719097]
INFO:root:Epoch 7     loss=1.1088 [53.5 s]	 dev=(HR@5:0.2071,NDCG@5:0.1271) test=(HR@5:0.1478,NDCG@5:0.0902) [59.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0542637 0.6352969]
INFO:root:Epoch 8     loss=1.0543 [53.2 s]	 dev=(HR@5:0.2077,NDCG@5:0.1300) test=(HR@5:0.1541,NDCG@5:0.0941) [59.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.96957076 0.5741027 ]
INFO:root:Epoch 9     loss=0.9696 [54.3 s]	 dev=(HR@5:0.2365,NDCG@5:0.1477) test=(HR@5:0.1729,NDCG@5:0.1088) [58.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.87013274 0.5071661 ]
INFO:root:Epoch 10    loss=0.8701 [55.0 s]	 dev=(HR@5:0.2624,NDCG@5:0.1669) test=(HR@5:0.1920,NDCG@5:0.1210) [62.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7780965 0.4452806]
INFO:root:Epoch 11    loss=0.7781 [55.6 s]	 dev=(HR@5:0.3140,NDCG@5:0.2015) test=(HR@5:0.2436,NDCG@5:0.1559) [62.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.69321036 0.3874888 ]
INFO:root:Epoch 12    loss=0.6932 [55.4 s]	 dev=(HR@5:0.3323,NDCG@5:0.2141) test=(HR@5:0.2442,NDCG@5:0.1576) [62.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6083878  0.32923642]
INFO:root:Epoch 13    loss=0.6084 [55.3 s]	 dev=(HR@5:0.3558,NDCG@5:0.2322) test=(HR@5:0.2709,NDCG@5:0.1767) [63.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.53881997 0.2835843 ]
INFO:root:Epoch 14    loss=0.5388 [55.5 s]	 dev=(HR@5:0.3798,NDCG@5:0.2515) test=(HR@5:0.2873,NDCG@5:0.1909) [62.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.488426   0.24883768]
INFO:root:Epoch 15    loss=0.4884 [55.3 s]	 dev=(HR@5:0.3817,NDCG@5:0.2556) test=(HR@5:0.2932,NDCG@5:0.1939) [62.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.44582877 0.21900947]
INFO:root:Epoch 16    loss=0.4458 [54.8 s]	 dev=(HR@5:0.4045,NDCG@5:0.2727) test=(HR@5:0.3189,NDCG@5:0.2119) [62.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.41280118 0.19580476]
INFO:root:Epoch 17    loss=0.4128 [55.0 s]	 dev=(HR@5:0.4016,NDCG@5:0.2706) test=(HR@5:0.3238,NDCG@5:0.2122) [62.4 s] 
INFO:root:all_losses: [0.3694981  0.17298318]
INFO:root:Epoch 18    loss=0.3695 [55.3 s]	 dev=(HR@5:0.4398,NDCG@5:0.2979) test=(HR@5:0.3466,NDCG@5:0.2304) [62.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3534983 0.161634 ]
INFO:root:Epoch 19    loss=0.3535 [54.7 s]	 dev=(HR@5:0.4206,NDCG@5:0.2885) test=(HR@5:0.3360,NDCG@5:0.2283) [62.3 s] 
INFO:root:all_losses: [0.32908675 0.14867714]
INFO:root:Epoch 20    loss=0.3291 [55.3 s]	 dev=(HR@5:0.4606,NDCG@5:0.3140) test=(HR@5:0.3794,NDCG@5:0.2542) [62.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31141773 0.13982642]
INFO:root:Epoch 21    loss=0.3114 [55.7 s]	 dev=(HR@5:0.4396,NDCG@5:0.2985) test=(HR@5:0.3543,NDCG@5:0.2358) [62.3 s] 
INFO:root:all_losses: [0.29874775 0.1292997 ]
INFO:root:Epoch 22    loss=0.2987 [55.3 s]	 dev=(HR@5:0.4552,NDCG@5:0.3137) test=(HR@5:0.3825,NDCG@5:0.2551) [61.7 s] 
INFO:root:all_losses: [0.28457376 0.12229715]
INFO:root:Epoch 23    loss=0.2846 [54.9 s]	 dev=(HR@5:0.4514,NDCG@5:0.3138) test=(HR@5:0.3833,NDCG@5:0.2577) [62.1 s] 
INFO:root:all_losses: [0.26745576 0.11526162]
INFO:root:Epoch 24    loss=0.2675 [55.4 s]	 dev=(HR@5:0.4357,NDCG@5:0.2981) test=(HR@5:0.3476,NDCG@5:0.2354) [61.6 s] 
INFO:root:all_losses: [0.2602285  0.11152416]
INFO:root:Epoch 25    loss=0.2602 [55.4 s]	 dev=(HR@5:0.4728,NDCG@5:0.3232) test=(HR@5:0.4008,NDCG@5:0.2691) [62.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.25224137 0.10695056]
INFO:root:Epoch 26    loss=0.2522 [55.5 s]	 dev=(HR@5:0.4587,NDCG@5:0.3198) test=(HR@5:0.3778,NDCG@5:0.2570) [61.8 s] 
INFO:root:all_losses: [0.23863415 0.10017896]
INFO:root:Epoch 27    loss=0.2386 [55.0 s]	 dev=(HR@5:0.4691,NDCG@5:0.3250) test=(HR@5:0.3923,NDCG@5:0.2670) [62.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22908746 0.09749664]
INFO:root:Epoch 28    loss=0.2291 [55.5 s]	 dev=(HR@5:0.4648,NDCG@5:0.3205) test=(HR@5:0.3741,NDCG@5:0.2522) [61.5 s] 
INFO:root:all_losses: [0.22342975 0.09480147]
INFO:root:Epoch 29    loss=0.2234 [55.0 s]	 dev=(HR@5:0.4732,NDCG@5:0.3284) test=(HR@5:0.3994,NDCG@5:0.2694) [62.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21747905 0.09298401]
INFO:root:Epoch 30    loss=0.2175 [55.2 s]	 dev=(HR@5:0.4534,NDCG@5:0.3166) test=(HR@5:0.3810,NDCG@5:0.2574) [61.7 s] 
INFO:root:all_losses: [0.21349497 0.08883089]
INFO:root:Epoch 31    loss=0.2135 [55.3 s]	 dev=(HR@5:0.4783,NDCG@5:0.3376) test=(HR@5:0.4183,NDCG@5:0.2848) [62.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21034782 0.08993691]
INFO:root:Epoch 32    loss=0.2103 [55.3 s]	 dev=(HR@5:0.4779,NDCG@5:0.3352) test=(HR@5:0.4106,NDCG@5:0.2815) [62.0 s] 
INFO:root:all_losses: [0.19700134 0.08495697]
INFO:root:Epoch 33    loss=0.1970 [55.2 s]	 dev=(HR@5:0.4689,NDCG@5:0.3269) test=(HR@5:0.3910,NDCG@5:0.2698) [61.8 s] 
INFO:root:all_losses: [0.1901076 0.0819123]
INFO:root:Epoch 34    loss=0.1901 [55.5 s]	 dev=(HR@5:0.4960,NDCG@5:0.3426) test=(HR@5:0.4277,NDCG@5:0.2912) [62.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19187123 0.08134873]
INFO:root:Epoch 35    loss=0.1919 [55.9 s]	 dev=(HR@5:0.4850,NDCG@5:0.3389) test=(HR@5:0.4139,NDCG@5:0.2847) [62.1 s] 
INFO:root:all_losses: [0.18489914 0.07787968]
INFO:root:Epoch 36    loss=0.1849 [55.6 s]	 dev=(HR@5:0.4972,NDCG@5:0.3405) test=(HR@5:0.4294,NDCG@5:0.2910) [62.4 s] 
INFO:root:all_losses: [0.18363436 0.07740722]
INFO:root:Epoch 37    loss=0.1836 [55.7 s]	 dev=(HR@5:0.4477,NDCG@5:0.3099) test=(HR@5:0.3611,NDCG@5:0.2470) [62.3 s] 
INFO:root:all_losses: [0.17772356 0.07645088]
INFO:root:Epoch 38    loss=0.1777 [55.3 s]	 dev=(HR@5:0.4875,NDCG@5:0.3400) test=(HR@5:0.4130,NDCG@5:0.2823) [62.6 s] 
INFO:root:all_losses: [0.17236319 0.0745681 ]
INFO:root:Epoch 39    loss=0.1724 [55.4 s]	 dev=(HR@5:0.4648,NDCG@5:0.3264) test=(HR@5:0.3772,NDCG@5:0.2607) [62.6 s] 
INFO:root:all_losses: [0.1736722  0.07206386]
INFO:root:Epoch 40    loss=0.1737 [55.1 s]	 dev=(HR@5:0.4659,NDCG@5:0.3229) test=(HR@5:0.3967,NDCG@5:0.2719) [62.5 s] 
INFO:root:all_losses: [0.16833998 0.07181709]
INFO:root:Epoch 41    loss=0.1683 [55.3 s]	 dev=(HR@5:0.4813,NDCG@5:0.3403) test=(HR@5:0.4069,NDCG@5:0.2805) [62.1 s] 
INFO:root:all_losses: [0.16504458 0.07278039]
INFO:root:Epoch 42    loss=0.1650 [55.6 s]	 dev=(HR@5:0.4781,NDCG@5:0.3375) test=(HR@5:0.4100,NDCG@5:0.2820) [62.2 s] 
INFO:root:all_losses: [0.16553634 0.06923927]
INFO:root:Epoch 43    loss=0.1655 [55.2 s]	 dev=(HR@5:0.4793,NDCG@5:0.3368) test=(HR@5:0.4059,NDCG@5:0.2769) [61.8 s] 
INFO:root:all_losses: [0.16023375 0.06910727]
INFO:root:Epoch 44    loss=0.1602 [56.4 s]	 dev=(HR@5:0.4826,NDCG@5:0.3378) test=(HR@5:0.4047,NDCG@5:0.2806) [62.3 s] 
INFO:root:all_losses: [0.15736443 0.06690644]
INFO:root:Epoch 45    loss=0.1574 [55.6 s]	 dev=(HR@5:0.4828,NDCG@5:0.3381) test=(HR@5:0.4177,NDCG@5:0.2864) [61.8 s] 
INFO:root:all_losses: [0.15863869 0.06955594]
INFO:root:Epoch 46    loss=0.1586 [56.6 s]	 dev=(HR@5:0.4579,NDCG@5:0.3236) test=(HR@5:0.3906,NDCG@5:0.2657) [62.3 s] 
INFO:root:all_losses: [0.15038975 0.06380645]
INFO:root:Epoch 47    loss=0.1504 [55.8 s]	 dev=(HR@5:0.4818,NDCG@5:0.3397) test=(HR@5:0.4124,NDCG@5:0.2817) [62.3 s] 
INFO:root:all_losses: [0.15316088 0.0659004 ]
INFO:root:Epoch 48    loss=0.1532 [56.0 s]	 dev=(HR@5:0.4832,NDCG@5:0.3411) test=(HR@5:0.4261,NDCG@5:0.2919) [61.9 s] 
INFO:root:all_losses: [0.1476612  0.06277449]
INFO:root:Epoch 49    loss=0.1477 [55.2 s]	 dev=(HR@5:0.4856,NDCG@5:0.3399) test=(HR@5:0.4290,NDCG@5:0.2949) [61.8 s] 
INFO:root:all_losses: [0.14900723 0.06339655]
INFO:root:Epoch 50    loss=0.1490 [55.9 s]	 dev=(HR@5:0.4728,NDCG@5:0.3327) test=(HR@5:0.4112,NDCG@5:0.2831) [61.9 s] 
INFO:root:all_losses: [0.14598265 0.06331898]
INFO:root:Epoch 51    loss=0.1460 [55.9 s]	 dev=(HR@5:0.4975,NDCG@5:0.3479) test=(HR@5:0.4444,NDCG@5:0.3035) [61.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14258713 0.06142981]
INFO:root:Epoch 52    loss=0.1426 [56.2 s]	 dev=(HR@5:0.4895,NDCG@5:0.3408) test=(HR@5:0.4302,NDCG@5:0.2980) [62.2 s] 
INFO:root:all_losses: [0.1415593  0.06188297]
INFO:root:Epoch 53    loss=0.1416 [55.8 s]	 dev=(HR@5:0.4848,NDCG@5:0.3426) test=(HR@5:0.4267,NDCG@5:0.2964) [62.2 s] 
INFO:root:all_losses: [0.14073922 0.06246602]
INFO:root:Epoch 54    loss=0.1407 [56.3 s]	 dev=(HR@5:0.4842,NDCG@5:0.3423) test=(HR@5:0.4137,NDCG@5:0.2845) [61.8 s] 
INFO:root:all_losses: [0.1353766  0.05985019]
INFO:root:Epoch 55    loss=0.1354 [55.3 s]	 dev=(HR@5:0.4695,NDCG@5:0.3322) test=(HR@5:0.4053,NDCG@5:0.2817) [61.7 s] 
INFO:root:all_losses: [0.14201465 0.06200164]
INFO:root:Epoch 56    loss=0.1420 [56.0 s]	 dev=(HR@5:0.4895,NDCG@5:0.3418) test=(HR@5:0.4292,NDCG@5:0.2928) [62.0 s] 
INFO:root:all_losses: [0.13408051 0.05822675]
INFO:root:Epoch 57    loss=0.1341 [55.8 s]	 dev=(HR@5:0.4840,NDCG@5:0.3397) test=(HR@5:0.4190,NDCG@5:0.2868) [62.2 s] 
INFO:root:all_losses: [0.13373138 0.05812416]
INFO:root:Epoch 58    loss=0.1337 [56.5 s]	 dev=(HR@5:0.4793,NDCG@5:0.3335) test=(HR@5:0.4124,NDCG@5:0.2839) [62.3 s] 
INFO:root:all_losses: [0.13693434 0.06011983]
INFO:root:Epoch 59    loss=0.1369 [55.1 s]	 dev=(HR@5:0.4707,NDCG@5:0.3298) test=(HR@5:0.4047,NDCG@5:0.2776) [62.1 s] 
INFO:root:all_losses: [0.12640698 0.05682403]
INFO:root:Epoch 60    loss=0.1264 [56.0 s]	 dev=(HR@5:0.4565,NDCG@5:0.3175) test=(HR@5:0.3874,NDCG@5:0.2695) [62.0 s] 
INFO:root:Early stop at 60 based on dev result.
INFO:root:
Best Iter(dev)=   51	 dev=(HR@5:0.4975,NDCG@5:0.3479) test=(HR@5:0.4444,NDCG@5:0.3035) [7011.1 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6033,HR@5:0.4444,HR@50:0.8805,NDCG@10:0.3549,NDCG@5:0.3035,NDCG@50:0.4165)
INFO:root:
--------------------------------------------- END: 2025-04-01 00:03:45 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-04 15:24:10 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005369 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [485.1 s]	 dev=(HR@5:0.1058,NDCG@5:0.0623) test=(HR@5:0.0707,NDCG@5:0.0408) [160.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2450297 0.6929536]
INFO:root:Epoch 2     loss=1.2450 [463.9 s]	 dev=(HR@5:0.1156,NDCG@5:0.0696) test=(HR@5:0.0728,NDCG@5:0.0430) [150.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2423503 0.6926266]
INFO:root:Epoch 3     loss=1.2424 [464.9 s]	 dev=(HR@5:0.1129,NDCG@5:0.0644) test=(HR@5:0.0791,NDCG@5:0.0436) [150.1 s] 
INFO:root:all_losses: [1.2349253  0.69231933]
INFO:root:Epoch 4     loss=1.2349 [479.6 s]	 dev=(HR@5:0.1258,NDCG@5:0.0760) test=(HR@5:0.0860,NDCG@5:0.0520) [154.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1881946 0.6911536]
INFO:root:Epoch 5     loss=1.1882 [462.6 s]	 dev=(HR@5:0.1664,NDCG@5:0.1023) test=(HR@5:0.1262,NDCG@5:0.0782) [149.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1642668 0.6880388]
INFO:root:Epoch 6     loss=1.1643 [464.4 s]	 dev=(HR@5:0.1692,NDCG@5:0.1028) test=(HR@5:0.1278,NDCG@5:0.0764) [154.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1371298  0.68352705]
INFO:root:Epoch 7     loss=1.1371 [468.8 s]	 dev=(HR@5:0.1888,NDCG@5:0.1153) test=(HR@5:0.1362,NDCG@5:0.0830) [153.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1176534  0.67335397]
INFO:root:Epoch 8     loss=1.1177 [475.1 s]	 dev=(HR@5:0.1731,NDCG@5:0.1056) test=(HR@5:0.1264,NDCG@5:0.0780) [154.5 s] 
INFO:root:all_losses: [1.0833101  0.64925176]
INFO:root:Epoch 9     loss=1.0833 [480.8 s]	 dev=(HR@5:0.1894,NDCG@5:0.1173) test=(HR@5:0.1425,NDCG@5:0.0898) [154.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0165011 0.6014436]
INFO:root:Epoch 10    loss=1.0165 [480.2 s]	 dev=(HR@5:0.1990,NDCG@5:0.1205) test=(HR@5:0.1399,NDCG@5:0.0853) [198.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9340309  0.54351854]
INFO:root:Epoch 11    loss=0.9340 [480.9 s]	 dev=(HR@5:0.2298,NDCG@5:0.1430) test=(HR@5:0.1662,NDCG@5:0.1042) [200.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8545522  0.48821515]
INFO:root:Epoch 12    loss=0.8546 [483.3 s]	 dev=(HR@5:0.2489,NDCG@5:0.1567) test=(HR@5:0.1798,NDCG@5:0.1120) [200.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7696687  0.42798054]
INFO:root:Epoch 13    loss=0.7697 [483.0 s]	 dev=(HR@5:0.2738,NDCG@5:0.1720) test=(HR@5:0.2059,NDCG@5:0.1276) [200.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.69180346 0.37687078]
INFO:root:Epoch 14    loss=0.6918 [426.8 s]	 dev=(HR@5:0.2985,NDCG@5:0.1897) test=(HR@5:0.2169,NDCG@5:0.1374) [203.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6297381  0.33477527]
INFO:root:Epoch 15    loss=0.6297 [482.4 s]	 dev=(HR@5:0.3242,NDCG@5:0.2074) test=(HR@5:0.2365,NDCG@5:0.1516) [204.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5721363  0.29449034]
INFO:root:Epoch 16    loss=0.5721 [311.5 s]	 dev=(HR@5:0.3470,NDCG@5:0.2277) test=(HR@5:0.2581,NDCG@5:0.1716) [74.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.52056503 0.26166162]
INFO:root:Epoch 17    loss=0.5206 [104.7 s]	 dev=(HR@5:0.3607,NDCG@5:0.2400) test=(HR@5:0.2799,NDCG@5:0.1828) [75.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.46661767 0.23134916]
INFO:root:Epoch 18    loss=0.4666 [106.0 s]	 dev=(HR@5:0.3929,NDCG@5:0.2612) test=(HR@5:0.3025,NDCG@5:0.1992) [74.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.43944857 0.2121295 ]
INFO:root:Epoch 19    loss=0.4394 [105.0 s]	 dev=(HR@5:0.3914,NDCG@5:0.2631) test=(HR@5:0.3160,NDCG@5:0.2089) [74.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.40250093 0.19319424]
INFO:root:Epoch 20    loss=0.4025 [106.7 s]	 dev=(HR@5:0.4228,NDCG@5:0.2816) test=(HR@5:0.3474,NDCG@5:0.2272) [75.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.37967739 0.17967154]
INFO:root:Epoch 21    loss=0.3797 [105.8 s]	 dev=(HR@5:0.4018,NDCG@5:0.2664) test=(HR@5:0.3156,NDCG@5:0.2077) [74.8 s] 
INFO:root:all_losses: [0.35910878 0.16481036]
INFO:root:Epoch 22    loss=0.3591 [105.1 s]	 dev=(HR@5:0.4369,NDCG@5:0.2955) test=(HR@5:0.3535,NDCG@5:0.2363) [75.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33991477 0.15430428]
INFO:root:Epoch 23    loss=0.3399 [103.8 s]	 dev=(HR@5:0.4424,NDCG@5:0.3030) test=(HR@5:0.3694,NDCG@5:0.2472) [79.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3151181  0.14303406]
INFO:root:Epoch 24    loss=0.3151 [104.8 s]	 dev=(HR@5:0.4387,NDCG@5:0.2972) test=(HR@5:0.3572,NDCG@5:0.2354) [75.0 s] 
INFO:root:all_losses: [0.30191153 0.13627878]
INFO:root:Epoch 25    loss=0.3019 [106.1 s]	 dev=(HR@5:0.4351,NDCG@5:0.2958) test=(HR@5:0.3505,NDCG@5:0.2344) [75.3 s] 
INFO:root:all_losses: [0.29369074 0.13024582]
INFO:root:Epoch 26    loss=0.2937 [105.1 s]	 dev=(HR@5:0.4508,NDCG@5:0.3075) test=(HR@5:0.3653,NDCG@5:0.2475) [75.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27566668 0.12211841]
INFO:root:Epoch 27    loss=0.2757 [103.1 s]	 dev=(HR@5:0.4720,NDCG@5:0.3245) test=(HR@5:0.3880,NDCG@5:0.2635) [75.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26378998 0.1174328 ]
INFO:root:Epoch 28    loss=0.2638 [103.3 s]	 dev=(HR@5:0.4557,NDCG@5:0.3121) test=(HR@5:0.3753,NDCG@5:0.2497) [75.0 s] 
INFO:root:all_losses: [0.25268787 0.11209203]
INFO:root:Epoch 29    loss=0.2527 [106.6 s]	 dev=(HR@5:0.4648,NDCG@5:0.3184) test=(HR@5:0.3865,NDCG@5:0.2601) [75.1 s] 
INFO:root:all_losses: [0.24609625 0.10912497]
INFO:root:Epoch 30    loss=0.2461 [104.5 s]	 dev=(HR@5:0.4428,NDCG@5:0.3065) test=(HR@5:0.3570,NDCG@5:0.2443) [75.2 s] 
INFO:root:all_losses: [0.24067684 0.10403345]
INFO:root:Epoch 31    loss=0.2407 [104.4 s]	 dev=(HR@5:0.4781,NDCG@5:0.3290) test=(HR@5:0.4067,NDCG@5:0.2763) [74.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23410976 0.10333242]
INFO:root:Epoch 32    loss=0.2341 [105.1 s]	 dev=(HR@5:0.4809,NDCG@5:0.3305) test=(HR@5:0.4039,NDCG@5:0.2748) [74.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22068453 0.09801967]
INFO:root:Epoch 33    loss=0.2207 [105.4 s]	 dev=(HR@5:0.4650,NDCG@5:0.3177) test=(HR@5:0.3884,NDCG@5:0.2649) [74.8 s] 
INFO:root:all_losses: [0.21238595 0.09352009]
INFO:root:Epoch 34    loss=0.2124 [103.9 s]	 dev=(HR@5:0.4889,NDCG@5:0.3355) test=(HR@5:0.4096,NDCG@5:0.2761) [74.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21241952 0.09356438]
INFO:root:Epoch 35    loss=0.2124 [105.6 s]	 dev=(HR@5:0.4852,NDCG@5:0.3340) test=(HR@5:0.4088,NDCG@5:0.2794) [74.8 s] 
INFO:root:all_losses: [0.20331553 0.08919777]
INFO:root:Epoch 36    loss=0.2033 [106.4 s]	 dev=(HR@5:0.4883,NDCG@5:0.3359) test=(HR@5:0.4171,NDCG@5:0.2858) [74.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19996378 0.08790205]
INFO:root:Epoch 37    loss=0.2000 [104.3 s]	 dev=(HR@5:0.4675,NDCG@5:0.3242) test=(HR@5:0.3949,NDCG@5:0.2703) [75.4 s] 
INFO:root:all_losses: [0.19255069 0.0864389 ]
INFO:root:Epoch 38    loss=0.1926 [104.0 s]	 dev=(HR@5:0.4626,NDCG@5:0.3224) test=(HR@5:0.3947,NDCG@5:0.2694) [74.9 s] 
INFO:root:all_losses: [0.18868804 0.08499414]
INFO:root:Epoch 39    loss=0.1887 [104.2 s]	 dev=(HR@5:0.4836,NDCG@5:0.3410) test=(HR@5:0.4202,NDCG@5:0.2869) [75.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18989994 0.08183362]
INFO:root:Epoch 40    loss=0.1899 [103.5 s]	 dev=(HR@5:0.4838,NDCG@5:0.3327) test=(HR@5:0.4183,NDCG@5:0.2828) [74.9 s] 
INFO:root:all_losses: [0.18206161 0.08060433]
INFO:root:Epoch 41    loss=0.1821 [105.3 s]	 dev=(HR@5:0.4858,NDCG@5:0.3399) test=(HR@5:0.4194,NDCG@5:0.2853) [74.8 s] 
INFO:root:all_losses: [0.17723384 0.08191168]
INFO:root:Epoch 42    loss=0.1772 [103.5 s]	 dev=(HR@5:0.4930,NDCG@5:0.3436) test=(HR@5:0.4332,NDCG@5:0.2944) [74.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17525621 0.0768505 ]
INFO:root:Epoch 43    loss=0.1753 [104.4 s]	 dev=(HR@5:0.4987,NDCG@5:0.3468) test=(HR@5:0.4300,NDCG@5:0.2933) [75.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.172344   0.07680547]
INFO:root:Epoch 44    loss=0.1723 [106.5 s]	 dev=(HR@5:0.4803,NDCG@5:0.3341) test=(HR@5:0.4092,NDCG@5:0.2822) [74.8 s] 
INFO:root:all_losses: [0.16897048 0.07454578]
INFO:root:Epoch 45    loss=0.1690 [105.8 s]	 dev=(HR@5:0.4638,NDCG@5:0.3186) test=(HR@5:0.3810,NDCG@5:0.2586) [75.0 s] 
INFO:root:all_losses: [0.16739154 0.07569491]
INFO:root:Epoch 46    loss=0.1674 [105.2 s]	 dev=(HR@5:0.4842,NDCG@5:0.3358) test=(HR@5:0.4147,NDCG@5:0.2831) [74.9 s] 
INFO:root:all_losses: [0.16133383 0.07116023]
INFO:root:Epoch 47    loss=0.1613 [104.9 s]	 dev=(HR@5:0.4975,NDCG@5:0.3453) test=(HR@5:0.4379,NDCG@5:0.2975) [75.0 s] 
INFO:root:all_losses: [0.16436881 0.0726783 ]
INFO:root:Epoch 48    loss=0.1644 [105.3 s]	 dev=(HR@5:0.4954,NDCG@5:0.3461) test=(HR@5:0.4465,NDCG@5:0.3019) [75.1 s] 
INFO:root:all_losses: [0.15739204 0.06970366]
INFO:root:Epoch 49    loss=0.1574 [106.6 s]	 dev=(HR@5:0.4901,NDCG@5:0.3403) test=(HR@5:0.4328,NDCG@5:0.2967) [74.8 s] 
INFO:root:all_losses: [0.15629283 0.06980069]
INFO:root:Epoch 50    loss=0.1563 [105.2 s]	 dev=(HR@5:0.4964,NDCG@5:0.3432) test=(HR@5:0.4247,NDCG@5:0.2877) [74.8 s] 
INFO:root:all_losses: [0.15454431 0.06967604]
INFO:root:Epoch 51    loss=0.1545 [105.2 s]	 dev=(HR@5:0.5038,NDCG@5:0.3508) test=(HR@5:0.4504,NDCG@5:0.3087) [75.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14902724 0.06821207]
INFO:root:Epoch 52    loss=0.1490 [104.7 s]	 dev=(HR@5:0.5013,NDCG@5:0.3484) test=(HR@5:0.4451,NDCG@5:0.3018) [74.8 s] 
INFO:root:all_losses: [0.1463057  0.06695551]
INFO:root:Epoch 53    loss=0.1463 [105.4 s]	 dev=(HR@5:0.5001,NDCG@5:0.3497) test=(HR@5:0.4320,NDCG@5:0.2986) [75.0 s] 
INFO:root:all_losses: [0.14569254 0.06751636]
INFO:root:Epoch 54    loss=0.1457 [103.8 s]	 dev=(HR@5:0.4897,NDCG@5:0.3389) test=(HR@5:0.4151,NDCG@5:0.2846) [74.4 s] 
INFO:root:all_losses: [0.1440587  0.06602338]
INFO:root:Epoch 55    loss=0.1441 [103.5 s]	 dev=(HR@5:0.4864,NDCG@5:0.3397) test=(HR@5:0.4200,NDCG@5:0.2885) [74.7 s] 
INFO:root:all_losses: [0.145629   0.06608776]
INFO:root:Epoch 56    loss=0.1456 [105.7 s]	 dev=(HR@5:0.4999,NDCG@5:0.3440) test=(HR@5:0.4544,NDCG@5:0.3082) [74.7 s] 
INFO:root:all_losses: [0.14195576 0.06382857]
INFO:root:Epoch 57    loss=0.1420 [104.6 s]	 dev=(HR@5:0.4860,NDCG@5:0.3378) test=(HR@5:0.4257,NDCG@5:0.2903) [74.6 s] 
INFO:root:all_losses: [0.14026059 0.06357347]
INFO:root:Epoch 58    loss=0.1403 [104.0 s]	 dev=(HR@5:0.4993,NDCG@5:0.3490) test=(HR@5:0.4465,NDCG@5:0.3053) [74.3 s] 
INFO:root:all_losses: [0.1401203 0.0645011]
INFO:root:Epoch 59    loss=0.1401 [104.4 s]	 dev=(HR@5:0.4797,NDCG@5:0.3395) test=(HR@5:0.4181,NDCG@5:0.2872) [74.5 s] 
INFO:root:all_losses: [0.13372998 0.0621375 ]
INFO:root:Epoch 60    loss=0.1337 [105.5 s]	 dev=(HR@5:0.4795,NDCG@5:0.3356) test=(HR@5:0.4051,NDCG@5:0.2782) [74.5 s] 
INFO:root:all_losses: [0.1310496  0.05854189]
INFO:root:Epoch 61    loss=0.1310 [104.8 s]	 dev=(HR@5:0.4709,NDCG@5:0.3314) test=(HR@5:0.4077,NDCG@5:0.2804) [74.4 s] 
INFO:root:all_losses: [0.13725902 0.06317376]
INFO:root:Epoch 62    loss=0.1373 [104.0 s]	 dev=(HR@5:0.4938,NDCG@5:0.3457) test=(HR@5:0.4332,NDCG@5:0.2958) [74.4 s] 
INFO:root:all_losses: [0.13002296 0.06010589]
INFO:root:Epoch 63    loss=0.1300 [104.0 s]	 dev=(HR@5:0.4944,NDCG@5:0.3473) test=(HR@5:0.4391,NDCG@5:0.3021) [74.8 s] 
INFO:root:all_losses: [0.1242208  0.05811124]
INFO:root:Epoch 64    loss=0.1242 [105.9 s]	 dev=(HR@5:0.4830,NDCG@5:0.3396) test=(HR@5:0.4067,NDCG@5:0.2814) [74.8 s] 
INFO:root:all_losses: [0.12450327 0.05681197]
INFO:root:Epoch 65    loss=0.1245 [104.2 s]	 dev=(HR@5:0.4740,NDCG@5:0.3286) test=(HR@5:0.3976,NDCG@5:0.2708) [74.6 s] 
INFO:root:all_losses: [0.12681308 0.0580783 ]
INFO:root:Epoch 66    loss=0.1268 [103.6 s]	 dev=(HR@5:0.4991,NDCG@5:0.3469) test=(HR@5:0.4504,NDCG@5:0.3049) [74.9 s] 
INFO:root:all_losses: [0.12644756 0.05798805]
INFO:root:Epoch 67    loss=0.1264 [103.9 s]	 dev=(HR@5:0.4932,NDCG@5:0.3481) test=(HR@5:0.4379,NDCG@5:0.2974) [74.6 s] 
INFO:root:all_losses: [0.12439498 0.05801667]
INFO:root:Epoch 68    loss=0.1244 [105.5 s]	 dev=(HR@5:0.5089,NDCG@5:0.3554) test=(HR@5:0.4514,NDCG@5:0.3066) [74.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12280764 0.05775747]
INFO:root:Epoch 69    loss=0.1228 [104.4 s]	 dev=(HR@5:0.4942,NDCG@5:0.3474) test=(HR@5:0.4479,NDCG@5:0.3041) [74.5 s] 
INFO:root:all_losses: [0.12721752 0.05899148]
INFO:root:Epoch 70    loss=0.1272 [104.1 s]	 dev=(HR@5:0.5011,NDCG@5:0.3534) test=(HR@5:0.4479,NDCG@5:0.3068) [74.3 s] 
INFO:root:all_losses: [0.11916542 0.05613915]
INFO:root:Epoch 71    loss=0.1192 [103.7 s]	 dev=(HR@5:0.4864,NDCG@5:0.3449) test=(HR@5:0.4218,NDCG@5:0.2878) [74.6 s] 
INFO:root:all_losses: [0.1164393  0.05555327]
INFO:root:Epoch 72    loss=0.1164 [105.9 s]	 dev=(HR@5:0.4968,NDCG@5:0.3495) test=(HR@5:0.4406,NDCG@5:0.3040) [74.3 s] 
INFO:root:all_losses: [0.11875414 0.05497684]
INFO:root:Epoch 73    loss=0.1188 [104.2 s]	 dev=(HR@5:0.4795,NDCG@5:0.3407) test=(HR@5:0.4049,NDCG@5:0.2823) [74.6 s] 
INFO:root:all_losses: [0.11761498 0.05536603]
INFO:root:Epoch 74    loss=0.1176 [104.0 s]	 dev=(HR@5:0.4972,NDCG@5:0.3494) test=(HR@5:0.4300,NDCG@5:0.2995) [74.3 s] 
INFO:root:all_losses: [0.11757872 0.05364769]
INFO:root:Epoch 75    loss=0.1176 [103.9 s]	 dev=(HR@5:0.4866,NDCG@5:0.3449) test=(HR@5:0.4112,NDCG@5:0.2885) [74.2 s] 
INFO:root:all_losses: [0.11697054 0.05402074]
INFO:root:Epoch 76    loss=0.1170 [105.2 s]	 dev=(HR@5:0.5003,NDCG@5:0.3527) test=(HR@5:0.4330,NDCG@5:0.3027) [74.2 s] 
INFO:root:all_losses: [0.11447249 0.05301823]
INFO:root:Epoch 77    loss=0.1145 [104.5 s]	 dev=(HR@5:0.5040,NDCG@5:0.3606) test=(HR@5:0.4436,NDCG@5:0.3084) [74.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11748163 0.05448548]
INFO:root:Epoch 78    loss=0.1175 [102.6 s]	 dev=(HR@5:0.4875,NDCG@5:0.3456) test=(HR@5:0.4251,NDCG@5:0.2966) [74.2 s] 
INFO:root:all_losses: [0.11206089 0.05183791]
INFO:root:Epoch 79    loss=0.1121 [104.0 s]	 dev=(HR@5:0.4915,NDCG@5:0.3460) test=(HR@5:0.4322,NDCG@5:0.2988) [74.3 s] 
INFO:root:all_losses: [0.10919604 0.05102437]
INFO:root:Epoch 80    loss=0.1092 [105.5 s]	 dev=(HR@5:0.5013,NDCG@5:0.3536) test=(HR@5:0.4361,NDCG@5:0.3013) [74.2 s] 
INFO:root:all_losses: [0.11644569 0.0558561 ]
INFO:root:Epoch 81    loss=0.1164 [103.8 s]	 dev=(HR@5:0.4820,NDCG@5:0.3400) test=(HR@5:0.4120,NDCG@5:0.2847) [74.5 s] 
INFO:root:all_losses: [0.11249039 0.05263016]
INFO:root:Epoch 82    loss=0.1125 [104.3 s]	 dev=(HR@5:0.4940,NDCG@5:0.3519) test=(HR@5:0.4304,NDCG@5:0.2988) [74.4 s] 
INFO:root:all_losses: [0.11015835 0.05185228]
INFO:root:Epoch 83    loss=0.1102 [104.2 s]	 dev=(HR@5:0.5076,NDCG@5:0.3598) test=(HR@5:0.4595,NDCG@5:0.3183) [74.8 s] 
INFO:root:all_losses: [0.11063645 0.05272741]
INFO:root:Epoch 84    loss=0.1106 [105.3 s]	 dev=(HR@5:0.4854,NDCG@5:0.3441) test=(HR@5:0.4175,NDCG@5:0.2890) [74.4 s] 
INFO:root:all_losses: [0.10934413 0.05144283]
INFO:root:Epoch 85    loss=0.1093 [104.9 s]	 dev=(HR@5:0.4954,NDCG@5:0.3494) test=(HR@5:0.4459,NDCG@5:0.3059) [74.2 s] 
INFO:root:all_losses: [0.10814656 0.05075932]
INFO:root:Epoch 86    loss=0.1081 [103.3 s]	 dev=(HR@5:0.4871,NDCG@5:0.3441) test=(HR@5:0.4155,NDCG@5:0.2879) [74.1 s] 
INFO:root:all_losses: [0.11005433 0.05237548]
INFO:root:Epoch 87    loss=0.1101 [103.9 s]	 dev=(HR@5:0.4862,NDCG@5:0.3461) test=(HR@5:0.4179,NDCG@5:0.2867) [74.3 s] 
INFO:root:all_losses: [0.10743921 0.05160543]
INFO:root:Epoch 88    loss=0.1074 [104.6 s]	 dev=(HR@5:0.4610,NDCG@5:0.3247) test=(HR@5:0.3947,NDCG@5:0.2724) [74.1 s] 
INFO:root:all_losses: [0.1107769  0.05211683]
INFO:root:Epoch 89    loss=0.1108 [104.3 s]	 dev=(HR@5:0.4985,NDCG@5:0.3529) test=(HR@5:0.4418,NDCG@5:0.3032) [74.4 s] 
INFO:root:all_losses: [0.10401019 0.04883924]
INFO:root:Epoch 90    loss=0.1040 [103.9 s]	 dev=(HR@5:0.4956,NDCG@5:0.3465) test=(HR@5:0.4345,NDCG@5:0.3001) [74.0 s] 
INFO:root:all_losses: [0.10651582 0.04970945]
INFO:root:Epoch 91    loss=0.1065 [104.2 s]	 dev=(HR@5:0.4873,NDCG@5:0.3453) test=(HR@5:0.4271,NDCG@5:0.2970) [74.1 s] 
INFO:root:all_losses: [0.10452116 0.04979284]
INFO:root:Epoch 92    loss=0.1045 [104.5 s]	 dev=(HR@5:0.4803,NDCG@5:0.3408) test=(HR@5:0.4141,NDCG@5:0.2886) [74.3 s] 
INFO:root:all_losses: [0.10248256 0.04854771]
INFO:root:Epoch 93    loss=0.1025 [103.3 s]	 dev=(HR@5:0.5042,NDCG@5:0.3554) test=(HR@5:0.4326,NDCG@5:0.2974) [74.3 s] 
INFO:root:all_losses: [0.1050198  0.05020099]
INFO:root:Epoch 94    loss=0.1050 [103.6 s]	 dev=(HR@5:0.4709,NDCG@5:0.3308) test=(HR@5:0.3929,NDCG@5:0.2704) [74.3 s] 
INFO:root:all_losses: [0.10234342 0.04928222]
INFO:root:Epoch 95    loss=0.1023 [103.8 s]	 dev=(HR@5:0.4815,NDCG@5:0.3405) test=(HR@5:0.4094,NDCG@5:0.2845) [74.0 s] 
INFO:root:all_losses: [0.10231576 0.04858028]
INFO:root:Epoch 96    loss=0.1023 [104.9 s]	 dev=(HR@5:0.4697,NDCG@5:0.3335) test=(HR@5:0.3953,NDCG@5:0.2739) [74.1 s] 
INFO:root:all_losses: [0.1041856  0.05023915]
INFO:root:Epoch 97    loss=0.1042 [103.7 s]	 dev=(HR@5:0.4915,NDCG@5:0.3460) test=(HR@5:0.4336,NDCG@5:0.2991) [74.2 s] 
INFO:root:Early stop at 97 based on dev result.
INFO:root:
Best Iter(dev)=   77	 dev=(HR@5:0.5040,NDCG@5:0.3606) test=(HR@5:0.4436,NDCG@5:0.3084) [24584.6 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6020,HR@5:0.4436,HR@50:0.8797,NDCG@10:0.3599,NDCG@5:0.3084,NDCG@50:0.4222)
INFO:root:
--------------------------------------------- END: 2025-04-04 22:15:05 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-05 10:18:02 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005359 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [460.3 s]	 dev=(HR@5:0.1058,NDCG@5:0.0623) test=(HR@5:0.0709,NDCG@5:0.0409) [151.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2448502 0.6929538]
INFO:root:Epoch 2     loss=1.2449 [474.5 s]	 dev=(HR@5:0.1160,NDCG@5:0.0695) test=(HR@5:0.0716,NDCG@5:0.0429) [153.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2422316 0.6926253]
INFO:root:Epoch 3     loss=1.2422 [471.0 s]	 dev=(HR@5:0.1119,NDCG@5:0.0640) test=(HR@5:0.0793,NDCG@5:0.0442) [150.4 s] 
INFO:root:all_losses: [1.2403797 0.6923372]
INFO:root:Epoch 4     loss=1.2404 [505.7 s]	 dev=(HR@5:0.1111,NDCG@5:0.0657) test=(HR@5:0.0769,NDCG@5:0.0435) [151.7 s] 
INFO:root:all_losses: [1.2373997  0.69197255]
INFO:root:Epoch 5     loss=1.2374 [522.5 s]	 dev=(HR@5:0.1056,NDCG@5:0.0623) test=(HR@5:0.0728,NDCG@5:0.0422) [165.5 s] 
INFO:root:all_losses: [1.2074933  0.69075584]
INFO:root:Epoch 6     loss=1.2075 [484.4 s]	 dev=(HR@5:0.1556,NDCG@5:0.0963) test=(HR@5:0.1187,NDCG@5:0.0730) [149.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1590198  0.68599373]
INFO:root:Epoch 7     loss=1.1590 [466.1 s]	 dev=(HR@5:0.1686,NDCG@5:0.1027) test=(HR@5:0.1256,NDCG@5:0.0768) [157.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1362388 0.6712888]
INFO:root:Epoch 8     loss=1.1362 [477.4 s]	 dev=(HR@5:0.1588,NDCG@5:0.0986) test=(HR@5:0.1191,NDCG@5:0.0766) [152.9 s] 
INFO:root:all_losses: [1.0922515  0.63553774]
INFO:root:Epoch 9     loss=1.0923 [420.4 s]	 dev=(HR@5:0.1619,NDCG@5:0.1033) test=(HR@5:0.1315,NDCG@5:0.0836) [154.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0138457  0.57685006]
INFO:root:Epoch 10    loss=1.0138 [486.4 s]	 dev=(HR@5:0.1694,NDCG@5:0.1077) test=(HR@5:0.1268,NDCG@5:0.0823) [190.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9382449  0.51515144]
INFO:root:Epoch 11    loss=0.9382 [487.4 s]	 dev=(HR@5:0.1812,NDCG@5:0.1124) test=(HR@5:0.1368,NDCG@5:0.0854) [189.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8702051  0.46171743]
INFO:root:Epoch 12    loss=0.8702 [490.3 s]	 dev=(HR@5:0.1755,NDCG@5:0.1098) test=(HR@5:0.1321,NDCG@5:0.0840) [188.5 s] 
INFO:root:all_losses: [0.8037316  0.40484226]
INFO:root:Epoch 13    loss=0.8037 [484.2 s]	 dev=(HR@5:0.1861,NDCG@5:0.1181) test=(HR@5:0.1388,NDCG@5:0.0879) [190.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7472331  0.35810193]
INFO:root:Epoch 14    loss=0.7472 [482.2 s]	 dev=(HR@5:0.1969,NDCG@5:0.1218) test=(HR@5:0.1450,NDCG@5:0.0906) [187.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7019493  0.32133526]
INFO:root:Epoch 15    loss=0.7019 [484.0 s]	 dev=(HR@5:0.1876,NDCG@5:0.1173) test=(HR@5:0.1356,NDCG@5:0.0872) [188.4 s] 
INFO:root:all_losses: [0.66518915 0.28600615]
INFO:root:Epoch 16    loss=0.6652 [483.7 s]	 dev=(HR@5:0.1937,NDCG@5:0.1227) test=(HR@5:0.1462,NDCG@5:0.0950) [188.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6271487 0.2554201]
INFO:root:Epoch 17    loss=0.6271 [484.8 s]	 dev=(HR@5:0.1986,NDCG@5:0.1252) test=(HR@5:0.1474,NDCG@5:0.0932) [188.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5854346  0.22789063]
INFO:root:Epoch 18    loss=0.5854 [485.3 s]	 dev=(HR@5:0.1965,NDCG@5:0.1241) test=(HR@5:0.1472,NDCG@5:0.0928) [187.5 s] 
INFO:root:all_losses: [0.56460357 0.21162577]
INFO:root:Epoch 19    loss=0.5646 [486.1 s]	 dev=(HR@5:0.1957,NDCG@5:0.1264) test=(HR@5:0.1478,NDCG@5:0.0957) [185.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5405228  0.19731726]
INFO:root:Epoch 20    loss=0.5405 [487.1 s]	 dev=(HR@5:0.2173,NDCG@5:0.1437) test=(HR@5:0.1617,NDCG@5:0.1087) [186.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5236224  0.18379863]
INFO:root:Epoch 21    loss=0.5236 [488.8 s]	 dev=(HR@5:0.2124,NDCG@5:0.1419) test=(HR@5:0.1627,NDCG@5:0.1090) [185.5 s] 
INFO:root:all_losses: [0.50606287 0.17247617]
INFO:root:Epoch 22    loss=0.5061 [488.6 s]	 dev=(HR@5:0.2155,NDCG@5:0.1426) test=(HR@5:0.1660,NDCG@5:0.1114) [184.1 s] 
INFO:root:all_losses: [0.4952711 0.1621275]
INFO:root:Epoch 23    loss=0.4953 [485.1 s]	 dev=(HR@5:0.2047,NDCG@5:0.1360) test=(HR@5:0.1696,NDCG@5:0.1119) [185.1 s] 
INFO:root:all_losses: [0.4707263  0.15328674]
INFO:root:Epoch 24    loss=0.4707 [481.5 s]	 dev=(HR@5:0.2090,NDCG@5:0.1386) test=(HR@5:0.1611,NDCG@5:0.1078) [188.3 s] 
INFO:root:all_losses: [0.46247652 0.14795263]
INFO:root:Epoch 25    loss=0.4625 [484.3 s]	 dev=(HR@5:0.2084,NDCG@5:0.1374) test=(HR@5:0.1631,NDCG@5:0.1087) [187.7 s] 
INFO:root:all_losses: [0.4521977 0.1418403]
INFO:root:Epoch 26    loss=0.4522 [483.9 s]	 dev=(HR@5:0.2247,NDCG@5:0.1505) test=(HR@5:0.1761,NDCG@5:0.1207) [191.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.44074962 0.1341342 ]
INFO:root:Epoch 27    loss=0.4407 [480.4 s]	 dev=(HR@5:0.2245,NDCG@5:0.1489) test=(HR@5:0.1812,NDCG@5:0.1240) [188.1 s] 
INFO:root:all_losses: [0.42713645 0.129409  ]
INFO:root:Epoch 28    loss=0.4271 [482.0 s]	 dev=(HR@5:0.2247,NDCG@5:0.1487) test=(HR@5:0.1743,NDCG@5:0.1185) [185.5 s] 
INFO:root:all_losses: [0.42119822 0.12387999]
INFO:root:Epoch 29    loss=0.4212 [222.0 s]	 dev=(HR@5:0.2265,NDCG@5:0.1518) test=(HR@5:0.1870,NDCG@5:0.1270) [72.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4126334  0.12232248]
INFO:root:Epoch 30    loss=0.4126 [104.6 s]	 dev=(HR@5:0.2347,NDCG@5:0.1581) test=(HR@5:0.1890,NDCG@5:0.1313) [73.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4021937  0.11601292]
INFO:root:Epoch 31    loss=0.4022 [107.3 s]	 dev=(HR@5:0.2283,NDCG@5:0.1522) test=(HR@5:0.1829,NDCG@5:0.1261) [73.0 s] 
INFO:root:all_losses: [0.39944246 0.11464681]
INFO:root:Epoch 32    loss=0.3994 [105.2 s]	 dev=(HR@5:0.2290,NDCG@5:0.1550) test=(HR@5:0.1829,NDCG@5:0.1264) [72.4 s] 
INFO:root:all_losses: [0.38921997 0.10920425]
INFO:root:Epoch 33    loss=0.3892 [105.9 s]	 dev=(HR@5:0.2287,NDCG@5:0.1542) test=(HR@5:0.1859,NDCG@5:0.1276) [73.5 s] 
INFO:root:all_losses: [0.38232407 0.10405306]
INFO:root:Epoch 34    loss=0.3823 [104.5 s]	 dev=(HR@5:0.2298,NDCG@5:0.1579) test=(HR@5:0.1892,NDCG@5:0.1309) [72.4 s] 
INFO:root:all_losses: [0.3788007  0.10479908]
INFO:root:Epoch 35    loss=0.3788 [104.1 s]	 dev=(HR@5:0.2375,NDCG@5:0.1599) test=(HR@5:0.1916,NDCG@5:0.1306) [72.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3697522 0.0996587]
INFO:root:Epoch 36    loss=0.3698 [103.9 s]	 dev=(HR@5:0.2332,NDCG@5:0.1588) test=(HR@5:0.1904,NDCG@5:0.1308) [72.2 s] 
INFO:root:all_losses: [0.36830458 0.09854116]
INFO:root:Epoch 37    loss=0.3683 [104.2 s]	 dev=(HR@5:0.2410,NDCG@5:0.1635) test=(HR@5:0.1939,NDCG@5:0.1348) [71.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35888395 0.09585742]
INFO:root:Epoch 38    loss=0.3589 [103.3 s]	 dev=(HR@5:0.2292,NDCG@5:0.1555) test=(HR@5:0.1923,NDCG@5:0.1311) [72.0 s] 
INFO:root:all_losses: [0.35828885 0.09366704]
INFO:root:Epoch 39    loss=0.3583 [105.9 s]	 dev=(HR@5:0.2298,NDCG@5:0.1534) test=(HR@5:0.1900,NDCG@5:0.1314) [76.6 s] 
INFO:root:all_losses: [0.36177552 0.09090819]
INFO:root:Epoch 40    loss=0.3618 [107.2 s]	 dev=(HR@5:0.2216,NDCG@5:0.1487) test=(HR@5:0.1796,NDCG@5:0.1238) [73.0 s] 
INFO:root:all_losses: [0.35155278 0.08923691]
INFO:root:Epoch 41    loss=0.3516 [107.0 s]	 dev=(HR@5:0.2243,NDCG@5:0.1501) test=(HR@5:0.1814,NDCG@5:0.1258) [73.1 s] 
INFO:root:all_losses: [0.34860724 0.08906706]
INFO:root:Epoch 42    loss=0.3486 [106.0 s]	 dev=(HR@5:0.2292,NDCG@5:0.1545) test=(HR@5:0.1947,NDCG@5:0.1348) [73.2 s] 
INFO:root:all_losses: [0.35057893 0.08526058]
INFO:root:Epoch 43    loss=0.3506 [108.0 s]	 dev=(HR@5:0.2316,NDCG@5:0.1566) test=(HR@5:0.1894,NDCG@5:0.1308) [73.5 s] 
INFO:root:all_losses: [0.3449955  0.08489643]
INFO:root:Epoch 44    loss=0.3450 [106.4 s]	 dev=(HR@5:0.2279,NDCG@5:0.1535) test=(HR@5:0.1839,NDCG@5:0.1276) [73.4 s] 
INFO:root:all_losses: [0.3407658  0.08110482]
INFO:root:Epoch 45    loss=0.3408 [106.5 s]	 dev=(HR@5:0.2273,NDCG@5:0.1510) test=(HR@5:0.1825,NDCG@5:0.1253) [73.3 s] 
INFO:root:all_losses: [0.3393047  0.08290939]
INFO:root:Epoch 46    loss=0.3393 [107.1 s]	 dev=(HR@5:0.2228,NDCG@5:0.1485) test=(HR@5:0.1825,NDCG@5:0.1254) [73.4 s] 
INFO:root:all_losses: [0.33117375 0.07802592]
INFO:root:Epoch 47    loss=0.3312 [108.5 s]	 dev=(HR@5:0.2236,NDCG@5:0.1479) test=(HR@5:0.1817,NDCG@5:0.1261) [73.2 s] 
INFO:root:Early stop at 47 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.2410,NDCG@5:0.1635) test=(HR@5:0.1939,NDCG@5:0.1348) [21969.4 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.3076,HR@5:0.1939,HR@50:0.8120,NDCG@10:0.1714,NDCG@5:0.1348,NDCG@50:0.2818)
INFO:root:
--------------------------------------------- END: 2025-04-05 16:25:49 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-05 20:15:47 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005359 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [240.3 s]	 dev=(HR@5:0.1058,NDCG@5:0.0623) test=(HR@5:0.0709,NDCG@5:0.0409) [95.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2449571 0.6929539]
INFO:root:Epoch 2     loss=1.2450 [472.0 s]	 dev=(HR@5:0.1162,NDCG@5:0.0696) test=(HR@5:0.0709,NDCG@5:0.0425) [154.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2420415  0.69262624]
INFO:root:Epoch 3     loss=1.2420 [476.6 s]	 dev=(HR@5:0.1115,NDCG@5:0.0638) test=(HR@5:0.0779,NDCG@5:0.0431) [154.6 s] 
INFO:root:all_losses: [1.2255903 0.6922518]
INFO:root:Epoch 4     loss=1.2256 [477.4 s]	 dev=(HR@5:0.1450,NDCG@5:0.0891) test=(HR@5:0.1093,NDCG@5:0.0684) [153.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1729337  0.69049853]
INFO:root:Epoch 5     loss=1.1729 [416.5 s]	 dev=(HR@5:0.1653,NDCG@5:0.1004) test=(HR@5:0.1231,NDCG@5:0.0758) [152.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1423768 0.6845525]
INFO:root:Epoch 6     loss=1.1424 [471.0 s]	 dev=(HR@5:0.1764,NDCG@5:0.1089) test=(HR@5:0.1346,NDCG@5:0.0828) [154.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.102168   0.66913116]
INFO:root:Epoch 7     loss=1.1022 [472.0 s]	 dev=(HR@5:0.2010,NDCG@5:0.1245) test=(HR@5:0.1480,NDCG@5:0.0912) [153.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0431159 0.6272213]
INFO:root:Epoch 8     loss=1.0431 [472.2 s]	 dev=(HR@5:0.2133,NDCG@5:0.1333) test=(HR@5:0.1545,NDCG@5:0.0957) [156.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9543354 0.5623053]
INFO:root:Epoch 9     loss=0.9543 [482.4 s]	 dev=(HR@5:0.2345,NDCG@5:0.1467) test=(HR@5:0.1729,NDCG@5:0.1066) [155.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8569925  0.49696788]
INFO:root:Epoch 10    loss=0.8570 [485.7 s]	 dev=(HR@5:0.2726,NDCG@5:0.1725) test=(HR@5:0.1949,NDCG@5:0.1262) [207.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7734316  0.44155535]
INFO:root:Epoch 11    loss=0.7734 [498.0 s]	 dev=(HR@5:0.3180,NDCG@5:0.2035) test=(HR@5:0.2459,NDCG@5:0.1550) [212.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6964161  0.39001077]
INFO:root:Epoch 12    loss=0.6964 [457.4 s]	 dev=(HR@5:0.3248,NDCG@5:0.2090) test=(HR@5:0.2446,NDCG@5:0.1550) [209.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.61530346 0.3354378 ]
INFO:root:Epoch 13    loss=0.6153 [481.6 s]	 dev=(HR@5:0.3498,NDCG@5:0.2250) test=(HR@5:0.2636,NDCG@5:0.1697) [208.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.54907274 0.2915997 ]
INFO:root:Epoch 14    loss=0.5491 [487.8 s]	 dev=(HR@5:0.3863,NDCG@5:0.2519) test=(HR@5:0.2842,NDCG@5:0.1885) [207.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.49635023 0.25599983]
INFO:root:Epoch 15    loss=0.4964 [487.5 s]	 dev=(HR@5:0.3747,NDCG@5:0.2496) test=(HR@5:0.2954,NDCG@5:0.1926) [206.7 s] 
INFO:root:all_losses: [0.453447   0.22551699]
INFO:root:Epoch 16    loss=0.4534 [482.9 s]	 dev=(HR@5:0.3904,NDCG@5:0.2646) test=(HR@5:0.3005,NDCG@5:0.2009) [203.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.41983092 0.20063873]
INFO:root:Epoch 17    loss=0.4198 [485.1 s]	 dev=(HR@5:0.4065,NDCG@5:0.2708) test=(HR@5:0.3193,NDCG@5:0.2077) [203.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.37473434 0.17717399]
INFO:root:Epoch 18    loss=0.3747 [488.2 s]	 dev=(HR@5:0.4267,NDCG@5:0.2889) test=(HR@5:0.3293,NDCG@5:0.2186) [204.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.357194   0.16549966]
INFO:root:Epoch 19    loss=0.3572 [484.0 s]	 dev=(HR@5:0.4357,NDCG@5:0.2972) test=(HR@5:0.3513,NDCG@5:0.2373) [202.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33612627 0.15297599]
INFO:root:Epoch 20    loss=0.3361 [486.2 s]	 dev=(HR@5:0.4585,NDCG@5:0.3134) test=(HR@5:0.3841,NDCG@5:0.2537) [204.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31659555 0.14317812]
INFO:root:Epoch 21    loss=0.3166 [485.8 s]	 dev=(HR@5:0.4393,NDCG@5:0.2992) test=(HR@5:0.3600,NDCG@5:0.2415) [202.3 s] 
INFO:root:all_losses: [0.30357793 0.13320173]
INFO:root:Epoch 22    loss=0.3036 [487.9 s]	 dev=(HR@5:0.4552,NDCG@5:0.3128) test=(HR@5:0.3706,NDCG@5:0.2468) [198.8 s] 
INFO:root:all_losses: [0.29095277 0.12581569]
INFO:root:Epoch 23    loss=0.2910 [485.5 s]	 dev=(HR@5:0.4522,NDCG@5:0.3156) test=(HR@5:0.3666,NDCG@5:0.2470) [199.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2711612  0.11853363]
INFO:root:Epoch 24    loss=0.2712 [490.5 s]	 dev=(HR@5:0.4540,NDCG@5:0.3171) test=(HR@5:0.3704,NDCG@5:0.2476) [197.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26376605 0.11539023]
INFO:root:Epoch 25    loss=0.2638 [486.8 s]	 dev=(HR@5:0.4683,NDCG@5:0.3254) test=(HR@5:0.3829,NDCG@5:0.2603) [197.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.25570294 0.10982542]
INFO:root:Epoch 26    loss=0.2557 [487.7 s]	 dev=(HR@5:0.4815,NDCG@5:0.3333) test=(HR@5:0.4014,NDCG@5:0.2756) [198.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24282844 0.10318302]
INFO:root:Epoch 27    loss=0.2428 [489.4 s]	 dev=(HR@5:0.4873,NDCG@5:0.3379) test=(HR@5:0.4143,NDCG@5:0.2805) [197.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23223367 0.10016137]
INFO:root:Epoch 28    loss=0.2322 [491.9 s]	 dev=(HR@5:0.4720,NDCG@5:0.3258) test=(HR@5:0.3719,NDCG@5:0.2524) [196.9 s] 
INFO:root:all_losses: [0.22674161 0.09771936]
INFO:root:Epoch 29    loss=0.2267 [490.8 s]	 dev=(HR@5:0.4801,NDCG@5:0.3344) test=(HR@5:0.3988,NDCG@5:0.2686) [199.2 s] 
INFO:root:all_losses: [0.21966383 0.09578508]
INFO:root:Epoch 30    loss=0.2197 [487.2 s]	 dev=(HR@5:0.4815,NDCG@5:0.3362) test=(HR@5:0.3927,NDCG@5:0.2705) [197.0 s] 
INFO:root:all_losses: [0.2161172  0.09142605]
INFO:root:Epoch 31    loss=0.2161 [494.1 s]	 dev=(HR@5:0.4846,NDCG@5:0.3395) test=(HR@5:0.4029,NDCG@5:0.2751) [196.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21262428 0.09263261]
INFO:root:Epoch 32    loss=0.2126 [492.5 s]	 dev=(HR@5:0.5030,NDCG@5:0.3507) test=(HR@5:0.4428,NDCG@5:0.3010) [196.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.20105627 0.086369  ]
INFO:root:Epoch 33    loss=0.2011 [492.9 s]	 dev=(HR@5:0.4732,NDCG@5:0.3310) test=(HR@5:0.3851,NDCG@5:0.2650) [196.1 s] 
INFO:root:all_losses: [0.19368722 0.08383027]
INFO:root:Epoch 34    loss=0.1937 [495.5 s]	 dev=(HR@5:0.5064,NDCG@5:0.3514) test=(HR@5:0.4308,NDCG@5:0.2915) [194.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19337001 0.0839461 ]
INFO:root:Epoch 35    loss=0.1934 [495.2 s]	 dev=(HR@5:0.4777,NDCG@5:0.3343) test=(HR@5:0.4067,NDCG@5:0.2793) [199.2 s] 
INFO:root:all_losses: [0.18666418 0.08064517]
INFO:root:Epoch 36    loss=0.1867 [493.5 s]	 dev=(HR@5:0.4897,NDCG@5:0.3440) test=(HR@5:0.4292,NDCG@5:0.2950) [197.0 s] 
INFO:root:all_losses: [0.18495888 0.08020113]
INFO:root:Epoch 37    loss=0.1850 [494.2 s]	 dev=(HR@5:0.4771,NDCG@5:0.3339) test=(HR@5:0.3990,NDCG@5:0.2730) [198.1 s] 
INFO:root:all_losses: [0.17854062 0.07932686]
INFO:root:Epoch 38    loss=0.1785 [494.8 s]	 dev=(HR@5:0.4897,NDCG@5:0.3459) test=(HR@5:0.4353,NDCG@5:0.2971) [197.9 s] 
INFO:root:all_losses: [0.17629863 0.07707516]
INFO:root:Epoch 39    loss=0.1763 [496.6 s]	 dev=(HR@5:0.4928,NDCG@5:0.3449) test=(HR@5:0.4116,NDCG@5:0.2856) [196.4 s] 
INFO:root:all_losses: [0.17691562 0.07444181]
INFO:root:Epoch 40    loss=0.1769 [492.5 s]	 dev=(HR@5:0.4742,NDCG@5:0.3281) test=(HR@5:0.4122,NDCG@5:0.2812) [199.2 s] 
INFO:root:all_losses: [0.16959438 0.07354933]
INFO:root:Epoch 41    loss=0.1696 [494.6 s]	 dev=(HR@5:0.5021,NDCG@5:0.3543) test=(HR@5:0.4308,NDCG@5:0.2954) [195.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1657052  0.07507879]
INFO:root:Epoch 42    loss=0.1657 [489.3 s]	 dev=(HR@5:0.5025,NDCG@5:0.3517) test=(HR@5:0.4322,NDCG@5:0.2972) [192.6 s] 
INFO:root:all_losses: [0.16184267 0.07024331]
INFO:root:Epoch 43    loss=0.1618 [491.2 s]	 dev=(HR@5:0.4738,NDCG@5:0.3331) test=(HR@5:0.4033,NDCG@5:0.2767) [193.9 s] 
INFO:root:all_losses: [0.1617107 0.0708796]
INFO:root:Epoch 44    loss=0.1617 [496.7 s]	 dev=(HR@5:0.4787,NDCG@5:0.3352) test=(HR@5:0.4104,NDCG@5:0.2801) [190.4 s] 
INFO:root:all_losses: [0.15699786 0.06811738]
INFO:root:Epoch 45    loss=0.1570 [492.0 s]	 dev=(HR@5:0.4987,NDCG@5:0.3520) test=(HR@5:0.4432,NDCG@5:0.3036) [192.9 s] 
INFO:root:all_losses: [0.15591502 0.07038072]
INFO:root:Epoch 46    loss=0.1559 [493.7 s]	 dev=(HR@5:0.5032,NDCG@5:0.3544) test=(HR@5:0.4230,NDCG@5:0.2926) [192.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15077075 0.06605555]
INFO:root:Epoch 47    loss=0.1508 [489.8 s]	 dev=(HR@5:0.4999,NDCG@5:0.3521) test=(HR@5:0.4300,NDCG@5:0.2966) [192.3 s] 
INFO:root:all_losses: [0.15380074 0.06777374]
INFO:root:Epoch 48    loss=0.1538 [490.1 s]	 dev=(HR@5:0.5156,NDCG@5:0.3656) test=(HR@5:0.4491,NDCG@5:0.3096) [190.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1495139  0.06421585]
INFO:root:Epoch 49    loss=0.1495 [489.4 s]	 dev=(HR@5:0.5105,NDCG@5:0.3595) test=(HR@5:0.4438,NDCG@5:0.3076) [190.5 s] 
INFO:root:all_losses: [0.14726311 0.06476193]
INFO:root:Epoch 50    loss=0.1473 [490.4 s]	 dev=(HR@5:0.4905,NDCG@5:0.3468) test=(HR@5:0.4226,NDCG@5:0.2945) [190.8 s] 
INFO:root:all_losses: [0.14572574 0.06548028]
INFO:root:Epoch 51    loss=0.1457 [488.3 s]	 dev=(HR@5:0.5093,NDCG@5:0.3599) test=(HR@5:0.4438,NDCG@5:0.3098) [191.6 s] 
INFO:root:all_losses: [0.14077125 0.06263734]
INFO:root:Epoch 52    loss=0.1408 [487.8 s]	 dev=(HR@5:0.4989,NDCG@5:0.3533) test=(HR@5:0.4442,NDCG@5:0.3098) [191.0 s] 
INFO:root:all_losses: [0.14013977 0.06341819]
INFO:root:Epoch 53    loss=0.1401 [491.5 s]	 dev=(HR@5:0.4822,NDCG@5:0.3420) test=(HR@5:0.4232,NDCG@5:0.2922) [189.4 s] 
INFO:root:all_losses: [0.13952832 0.06315812]
INFO:root:Epoch 54    loss=0.1395 [488.8 s]	 dev=(HR@5:0.5011,NDCG@5:0.3552) test=(HR@5:0.4314,NDCG@5:0.2986) [190.2 s] 
INFO:root:all_losses: [0.13544765 0.06104867]
INFO:root:Epoch 55    loss=0.1354 [490.0 s]	 dev=(HR@5:0.5095,NDCG@5:0.3561) test=(HR@5:0.4444,NDCG@5:0.3080) [190.3 s] 
INFO:root:all_losses: [0.14093193 0.0632323 ]
INFO:root:Epoch 56    loss=0.1409 [490.0 s]	 dev=(HR@5:0.5083,NDCG@5:0.3564) test=(HR@5:0.4516,NDCG@5:0.3095) [192.9 s] 
INFO:root:all_losses: [0.13092671 0.05844587]
INFO:root:Epoch 57    loss=0.1309 [489.4 s]	 dev=(HR@5:0.4932,NDCG@5:0.3487) test=(HR@5:0.4183,NDCG@5:0.2926) [190.9 s] 
INFO:root:all_losses: [0.13212018 0.0592795 ]
INFO:root:Epoch 58    loss=0.1321 [485.4 s]	 dev=(HR@5:0.4911,NDCG@5:0.3433) test=(HR@5:0.4198,NDCG@5:0.2886) [191.5 s] 
INFO:root:all_losses: [0.13303316 0.06019321]
INFO:root:Epoch 59    loss=0.1330 [488.6 s]	 dev=(HR@5:0.4846,NDCG@5:0.3403) test=(HR@5:0.4216,NDCG@5:0.2905) [190.6 s] 
INFO:root:all_losses: [0.12579256 0.05710388]
INFO:root:Epoch 60    loss=0.1258 [489.5 s]	 dev=(HR@5:0.4946,NDCG@5:0.3460) test=(HR@5:0.4302,NDCG@5:0.2982) [190.6 s] 
INFO:root:all_losses: [0.12616974 0.05525309]
INFO:root:Epoch 61    loss=0.1262 [487.9 s]	 dev=(HR@5:0.4972,NDCG@5:0.3536) test=(HR@5:0.4304,NDCG@5:0.2942) [190.9 s] 
INFO:root:all_losses: [0.13233109 0.05897807]
INFO:root:Epoch 62    loss=0.1323 [495.1 s]	 dev=(HR@5:0.5001,NDCG@5:0.3525) test=(HR@5:0.4334,NDCG@5:0.3004) [187.7 s] 
INFO:root:all_losses: [0.12616776 0.05675003]
INFO:root:Epoch 63    loss=0.1262 [490.9 s]	 dev=(HR@5:0.5066,NDCG@5:0.3580) test=(HR@5:0.4510,NDCG@5:0.3141) [189.3 s] 
INFO:root:all_losses: [0.12137656 0.05501439]
INFO:root:Epoch 64    loss=0.1214 [495.4 s]	 dev=(HR@5:0.5030,NDCG@5:0.3565) test=(HR@5:0.4375,NDCG@5:0.3028) [190.1 s] 
INFO:root:all_losses: [0.12190824 0.05359261]
INFO:root:Epoch 65    loss=0.1219 [493.8 s]	 dev=(HR@5:0.5032,NDCG@5:0.3535) test=(HR@5:0.4369,NDCG@5:0.3000) [188.2 s] 
INFO:root:all_losses: [0.12055291 0.05467824]
INFO:root:Epoch 66    loss=0.1206 [488.3 s]	 dev=(HR@5:0.5115,NDCG@5:0.3576) test=(HR@5:0.4616,NDCG@5:0.3133) [190.5 s] 
INFO:root:all_losses: [0.12364008 0.05603893]
INFO:root:Epoch 67    loss=0.1236 [500.3 s]	 dev=(HR@5:0.5017,NDCG@5:0.3497) test=(HR@5:0.4479,NDCG@5:0.3051) [187.6 s] 
INFO:root:all_losses: [0.11943256 0.05437875]
INFO:root:Epoch 68    loss=0.1194 [494.1 s]	 dev=(HR@5:0.5111,NDCG@5:0.3567) test=(HR@5:0.4540,NDCG@5:0.3085) [185.2 s] 
INFO:root:Early stop at 68 based on dev result.
INFO:root:
Best Iter(dev)=   48	 dev=(HR@5:0.5156,NDCG@5:0.3656) test=(HR@5:0.4491,NDCG@5:0.3096) [45782.4 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6055,HR@5:0.4491,HR@50:0.8805,NDCG@10:0.3604,NDCG@5:0.3096,NDCG@50:0.4216)
INFO:root:
--------------------------------------------- END: 2025-04-06 09:00:56 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-06 19:52:04 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005357 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [100.5 s]	 dev=(HR@5:0.1060,NDCG@5:0.0623) test=(HR@5:0.0707,NDCG@5:0.0408) [70.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2450353 0.692954 ]
INFO:root:Epoch 2     loss=1.2450 [102.7 s]	 dev=(HR@5:0.1162,NDCG@5:0.0696) test=(HR@5:0.0728,NDCG@5:0.0429) [70.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2425498 0.6926253]
INFO:root:Epoch 3     loss=1.2425 [103.9 s]	 dev=(HR@5:0.1123,NDCG@5:0.0635) test=(HR@5:0.0769,NDCG@5:0.0434) [70.4 s] 
INFO:root:all_losses: [1.2374995  0.69230694]
INFO:root:Epoch 4     loss=1.2375 [103.8 s]	 dev=(HR@5:0.1160,NDCG@5:0.0692) test=(HR@5:0.0793,NDCG@5:0.0450) [70.1 s] 
INFO:root:all_losses: [1.2395129 0.6918522]
INFO:root:Epoch 5     loss=1.2395 [103.5 s]	 dev=(HR@5:0.1105,NDCG@5:0.0638) test=(HR@5:0.0744,NDCG@5:0.0437) [70.2 s] 
INFO:root:all_losses: [1.2397362  0.69103855]
INFO:root:Epoch 6     loss=1.2397 [103.1 s]	 dev=(HR@5:0.1172,NDCG@5:0.0670) test=(HR@5:0.0752,NDCG@5:0.0426) [70.4 s] 
INFO:root:all_losses: [1.2308742 0.689631 ]
INFO:root:Epoch 7     loss=1.2309 [105.4 s]	 dev=(HR@5:0.1107,NDCG@5:0.0646) test=(HR@5:0.0687,NDCG@5:0.0395) [70.1 s] 
INFO:root:all_losses: [1.2242196 0.6841736]
INFO:root:Epoch 8     loss=1.2242 [108.2 s]	 dev=(HR@5:0.1034,NDCG@5:0.0620) test=(HR@5:0.0614,NDCG@5:0.0349) [71.0 s] 
INFO:root:all_losses: [1.1937982 0.6557758]
INFO:root:Epoch 9     loss=1.1938 [105.2 s]	 dev=(HR@5:0.1107,NDCG@5:0.0650) test=(HR@5:0.0656,NDCG@5:0.0369) [73.0 s] 
INFO:root:all_losses: [1.0996314  0.57460165]
INFO:root:Epoch 10    loss=1.0996 [107.6 s]	 dev=(HR@5:0.1034,NDCG@5:0.0607) test=(HR@5:0.0701,NDCG@5:0.0392) [75.0 s] 
INFO:root:all_losses: [0.99312043 0.48258966]
INFO:root:Epoch 11    loss=0.9931 [110.5 s]	 dev=(HR@5:0.1044,NDCG@5:0.0623) test=(HR@5:0.0677,NDCG@5:0.0382) [74.4 s] 
INFO:root:all_losses: [0.8953709  0.39972177]
INFO:root:Epoch 12    loss=0.8954 [109.8 s]	 dev=(HR@5:0.1093,NDCG@5:0.0640) test=(HR@5:0.0654,NDCG@5:0.0369) [74.9 s] 
INFO:root:all_losses: [0.80769736 0.32379204]
INFO:root:Epoch 13    loss=0.8077 [108.3 s]	 dev=(HR@5:0.1099,NDCG@5:0.0642) test=(HR@5:0.0730,NDCG@5:0.0411) [89.2 s] 
INFO:root:all_losses: [0.7437939  0.26889262]
INFO:root:Epoch 14    loss=0.7438 [106.6 s]	 dev=(HR@5:0.1099,NDCG@5:0.0633) test=(HR@5:0.0703,NDCG@5:0.0388) [92.9 s] 
INFO:root:all_losses: [0.7032636  0.23299178]
INFO:root:Epoch 15    loss=0.7033 [109.2 s]	 dev=(HR@5:0.1042,NDCG@5:0.0612) test=(HR@5:0.0685,NDCG@5:0.0390) [93.3 s] 
INFO:root:all_losses: [0.675314 0.204639]
INFO:root:Epoch 16    loss=0.6753 [107.4 s]	 dev=(HR@5:0.1068,NDCG@5:0.0608) test=(HR@5:0.0675,NDCG@5:0.0379) [93.7 s] 
INFO:root:all_losses: [0.6489618  0.18125297]
INFO:root:Epoch 17    loss=0.6490 [107.5 s]	 dev=(HR@5:0.1097,NDCG@5:0.0645) test=(HR@5:0.0699,NDCG@5:0.0410) [94.0 s] 
INFO:root:all_losses: [0.6201785  0.16165784]
INFO:root:Epoch 18    loss=0.6202 [107.5 s]	 dev=(HR@5:0.1174,NDCG@5:0.0691) test=(HR@5:0.0765,NDCG@5:0.0433) [75.5 s] 
INFO:root:all_losses: [0.5917118  0.14900038]
INFO:root:Epoch 19    loss=0.5917 [104.9 s]	 dev=(HR@5:0.1509,NDCG@5:0.0943) test=(HR@5:0.1160,NDCG@5:0.0723) [74.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.530827 0.137789]
INFO:root:Epoch 20    loss=0.5308 [106.4 s]	 dev=(HR@5:0.2257,NDCG@5:0.1491) test=(HR@5:0.1776,NDCG@5:0.1209) [74.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.48281643 0.12932633]
INFO:root:Epoch 21    loss=0.4828 [105.3 s]	 dev=(HR@5:0.2351,NDCG@5:0.1572) test=(HR@5:0.1827,NDCG@5:0.1230) [74.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.45046473 0.12134931]
INFO:root:Epoch 22    loss=0.4505 [104.9 s]	 dev=(HR@5:0.2734,NDCG@5:0.1828) test=(HR@5:0.2122,NDCG@5:0.1424) [74.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.42193887 0.11368225]
INFO:root:Epoch 23    loss=0.4219 [104.3 s]	 dev=(HR@5:0.3211,NDCG@5:0.2151) test=(HR@5:0.2573,NDCG@5:0.1741) [74.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3840545  0.10958526]
INFO:root:Epoch 24    loss=0.3841 [104.3 s]	 dev=(HR@5:0.3476,NDCG@5:0.2345) test=(HR@5:0.2866,NDCG@5:0.1927) [74.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35310596 0.10586322]
INFO:root:Epoch 25    loss=0.3531 [105.1 s]	 dev=(HR@5:0.3959,NDCG@5:0.2694) test=(HR@5:0.3274,NDCG@5:0.2262) [74.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32931295 0.1019278 ]
INFO:root:Epoch 26    loss=0.3293 [103.9 s]	 dev=(HR@5:0.4086,NDCG@5:0.2820) test=(HR@5:0.3388,NDCG@5:0.2336) [74.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3050387  0.09575313]
INFO:root:Epoch 27    loss=0.3050 [104.7 s]	 dev=(HR@5:0.4491,NDCG@5:0.3054) test=(HR@5:0.3674,NDCG@5:0.2529) [74.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28534263 0.09430662]
INFO:root:Epoch 28    loss=0.2853 [105.6 s]	 dev=(HR@5:0.4451,NDCG@5:0.3038) test=(HR@5:0.3592,NDCG@5:0.2459) [74.0 s] 
INFO:root:all_losses: [0.2722287  0.09185886]
INFO:root:Epoch 29    loss=0.2722 [104.7 s]	 dev=(HR@5:0.4416,NDCG@5:0.3013) test=(HR@5:0.3560,NDCG@5:0.2458) [74.5 s] 
INFO:root:all_losses: [0.2604293  0.08984021]
INFO:root:Epoch 30    loss=0.2604 [104.4 s]	 dev=(HR@5:0.4481,NDCG@5:0.3070) test=(HR@5:0.3657,NDCG@5:0.2529) [73.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.25116032 0.08685382]
INFO:root:Epoch 31    loss=0.2512 [104.3 s]	 dev=(HR@5:0.4750,NDCG@5:0.3297) test=(HR@5:0.3908,NDCG@5:0.2709) [74.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2471557  0.08844966]
INFO:root:Epoch 32    loss=0.2472 [105.7 s]	 dev=(HR@5:0.4638,NDCG@5:0.3210) test=(HR@5:0.3782,NDCG@5:0.2629) [74.1 s] 
INFO:root:all_losses: [0.22877154 0.08362628]
INFO:root:Epoch 33    loss=0.2288 [105.1 s]	 dev=(HR@5:0.4756,NDCG@5:0.3297) test=(HR@5:0.3876,NDCG@5:0.2695) [74.5 s] 
INFO:root:all_losses: [0.21716611 0.07969544]
INFO:root:Epoch 34    loss=0.2172 [105.0 s]	 dev=(HR@5:0.4807,NDCG@5:0.3344) test=(HR@5:0.4039,NDCG@5:0.2786) [73.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21531975 0.07992036]
INFO:root:Epoch 35    loss=0.2153 [104.1 s]	 dev=(HR@5:0.4858,NDCG@5:0.3405) test=(HR@5:0.4071,NDCG@5:0.2834) [74.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.20761204 0.07700802]
INFO:root:Epoch 36    loss=0.2076 [106.0 s]	 dev=(HR@5:0.4813,NDCG@5:0.3366) test=(HR@5:0.4155,NDCG@5:0.2917) [74.8 s] 
INFO:root:all_losses: [0.20305967 0.07641052]
INFO:root:Epoch 37    loss=0.2031 [103.9 s]	 dev=(HR@5:0.4610,NDCG@5:0.3209) test=(HR@5:0.3841,NDCG@5:0.2688) [74.3 s] 
INFO:root:all_losses: [0.194638   0.07552418]
INFO:root:Epoch 38    loss=0.1946 [103.8 s]	 dev=(HR@5:0.4834,NDCG@5:0.3361) test=(HR@5:0.4114,NDCG@5:0.2892) [76.4 s] 
INFO:root:all_losses: [0.18867135 0.07382926]
INFO:root:Epoch 39    loss=0.1887 [104.8 s]	 dev=(HR@5:0.4860,NDCG@5:0.3397) test=(HR@5:0.4008,NDCG@5:0.2814) [74.0 s] 
INFO:root:all_losses: [0.1894011  0.07247446]
INFO:root:Epoch 40    loss=0.1894 [106.1 s]	 dev=(HR@5:0.4903,NDCG@5:0.3438) test=(HR@5:0.4186,NDCG@5:0.2927) [73.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18133414 0.07115262]
INFO:root:Epoch 41    loss=0.1813 [103.0 s]	 dev=(HR@5:0.4818,NDCG@5:0.3431) test=(HR@5:0.4133,NDCG@5:0.2894) [73.5 s] 
INFO:root:all_losses: [0.17802425 0.0729381 ]
INFO:root:Epoch 42    loss=0.1780 [104.3 s]	 dev=(HR@5:0.4762,NDCG@5:0.3384) test=(HR@5:0.4049,NDCG@5:0.2836) [74.0 s] 
INFO:root:all_losses: [0.1729784  0.06835767]
INFO:root:Epoch 43    loss=0.1730 [105.5 s]	 dev=(HR@5:0.4895,NDCG@5:0.3460) test=(HR@5:0.4122,NDCG@5:0.2910) [73.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16932943 0.06832803]
INFO:root:Epoch 44    loss=0.1693 [104.3 s]	 dev=(HR@5:0.4809,NDCG@5:0.3402) test=(HR@5:0.4112,NDCG@5:0.2868) [73.6 s] 
INFO:root:all_losses: [0.16552506 0.06639412]
INFO:root:Epoch 45    loss=0.1655 [105.0 s]	 dev=(HR@5:0.4822,NDCG@5:0.3394) test=(HR@5:0.4065,NDCG@5:0.2849) [73.8 s] 
INFO:root:all_losses: [0.16483024 0.06948107]
INFO:root:Epoch 46    loss=0.1648 [103.4 s]	 dev=(HR@5:0.4968,NDCG@5:0.3503) test=(HR@5:0.4385,NDCG@5:0.3057) [73.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15725581 0.06406064]
INFO:root:Epoch 47    loss=0.1573 [102.8 s]	 dev=(HR@5:0.4993,NDCG@5:0.3515) test=(HR@5:0.4310,NDCG@5:0.3021) [73.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15842664 0.06550311]
INFO:root:Epoch 48    loss=0.1584 [104.1 s]	 dev=(HR@5:0.4922,NDCG@5:0.3496) test=(HR@5:0.4324,NDCG@5:0.3013) [73.6 s] 
INFO:root:all_losses: [0.15460323 0.06255791]
INFO:root:Epoch 49    loss=0.1546 [103.4 s]	 dev=(HR@5:0.4960,NDCG@5:0.3489) test=(HR@5:0.4404,NDCG@5:0.3071) [73.5 s] 
INFO:root:all_losses: [0.15311919 0.06294215]
INFO:root:Epoch 50    loss=0.1531 [103.5 s]	 dev=(HR@5:0.4913,NDCG@5:0.3478) test=(HR@5:0.4247,NDCG@5:0.2974) [73.4 s] 
INFO:root:all_losses: [0.15093613 0.06276456]
INFO:root:Epoch 51    loss=0.1509 [103.5 s]	 dev=(HR@5:0.5030,NDCG@5:0.3559) test=(HR@5:0.4459,NDCG@5:0.3115) [73.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14532334 0.06249103]
INFO:root:Epoch 52    loss=0.1453 [103.8 s]	 dev=(HR@5:0.4924,NDCG@5:0.3531) test=(HR@5:0.4365,NDCG@5:0.3060) [73.2 s] 
INFO:root:all_losses: [0.14226209 0.06114081]
INFO:root:Epoch 53    loss=0.1423 [103.6 s]	 dev=(HR@5:0.4860,NDCG@5:0.3410) test=(HR@5:0.4181,NDCG@5:0.2952) [73.5 s] 
INFO:root:all_losses: [0.14462113 0.0620685 ]
INFO:root:Epoch 54    loss=0.1446 [103.6 s]	 dev=(HR@5:0.4968,NDCG@5:0.3543) test=(HR@5:0.4383,NDCG@5:0.3060) [76.9 s] 
INFO:root:all_losses: [0.14012982 0.05989748]
INFO:root:Epoch 55    loss=0.1401 [103.1 s]	 dev=(HR@5:0.4856,NDCG@5:0.3452) test=(HR@5:0.4353,NDCG@5:0.3046) [73.8 s] 
INFO:root:all_losses: [0.14123087 0.06028306]
INFO:root:Epoch 56    loss=0.1412 [104.8 s]	 dev=(HR@5:0.4883,NDCG@5:0.3483) test=(HR@5:0.4520,NDCG@5:0.3152) [73.5 s] 
INFO:root:all_losses: [0.13693872 0.05947248]
INFO:root:Epoch 57    loss=0.1369 [103.2 s]	 dev=(HR@5:0.4834,NDCG@5:0.3428) test=(HR@5:0.4222,NDCG@5:0.2948) [72.9 s] 
INFO:root:all_losses: [0.13556784 0.05780245]
INFO:root:Epoch 58    loss=0.1356 [102.8 s]	 dev=(HR@5:0.4842,NDCG@5:0.3475) test=(HR@5:0.4334,NDCG@5:0.3045) [73.4 s] 
INFO:root:all_losses: [0.13581638 0.0587832 ]
INFO:root:Epoch 59    loss=0.1358 [105.3 s]	 dev=(HR@5:0.4919,NDCG@5:0.3530) test=(HR@5:0.4277,NDCG@5:0.3041) [73.5 s] 
INFO:root:all_losses: [0.12831053 0.05736154]
INFO:root:Epoch 60    loss=0.1283 [104.4 s]	 dev=(HR@5:0.4893,NDCG@5:0.3476) test=(HR@5:0.4243,NDCG@5:0.2985) [73.1 s] 
INFO:root:all_losses: [0.12814945 0.05396165]
INFO:root:Epoch 61    loss=0.1281 [103.7 s]	 dev=(HR@5:0.5058,NDCG@5:0.3585) test=(HR@5:0.4508,NDCG@5:0.3156) [73.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13268515 0.05838189]
INFO:root:Epoch 62    loss=0.1327 [102.8 s]	 dev=(HR@5:0.5013,NDCG@5:0.3550) test=(HR@5:0.4449,NDCG@5:0.3122) [73.3 s] 
INFO:root:all_losses: [0.12486681 0.05456543]
INFO:root:Epoch 63    loss=0.1249 [105.1 s]	 dev=(HR@5:0.5050,NDCG@5:0.3631) test=(HR@5:0.4512,NDCG@5:0.3185) [73.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12380758 0.05357416]
INFO:root:Epoch 64    loss=0.1238 [103.1 s]	 dev=(HR@5:0.4913,NDCG@5:0.3537) test=(HR@5:0.4398,NDCG@5:0.3129) [73.0 s] 
INFO:root:all_losses: [0.12064928 0.05164781]
INFO:root:Epoch 65    loss=0.1206 [103.3 s]	 dev=(HR@5:0.4932,NDCG@5:0.3515) test=(HR@5:0.4353,NDCG@5:0.3069) [73.1 s] 
INFO:root:all_losses: [0.12076028 0.05327788]
INFO:root:Epoch 66    loss=0.1208 [103.7 s]	 dev=(HR@5:0.4883,NDCG@5:0.3460) test=(HR@5:0.4343,NDCG@5:0.3078) [73.1 s] 
INFO:root:all_losses: [0.1240074  0.05419585]
INFO:root:Epoch 67    loss=0.1240 [104.6 s]	 dev=(HR@5:0.4919,NDCG@5:0.3467) test=(HR@5:0.4371,NDCG@5:0.3108) [73.0 s] 
INFO:root:all_losses: [0.11946818 0.05253967]
INFO:root:Epoch 68    loss=0.1195 [103.9 s]	 dev=(HR@5:0.5003,NDCG@5:0.3550) test=(HR@5:0.4410,NDCG@5:0.3097) [73.4 s] 
INFO:root:all_losses: [0.11982057 0.05309253]
INFO:root:Epoch 69    loss=0.1198 [103.4 s]	 dev=(HR@5:0.4966,NDCG@5:0.3595) test=(HR@5:0.4377,NDCG@5:0.3113) [73.1 s] 
INFO:root:all_losses: [0.12242895 0.05515366]
INFO:root:Epoch 70    loss=0.1224 [103.0 s]	 dev=(HR@5:0.5021,NDCG@5:0.3562) test=(HR@5:0.4371,NDCG@5:0.3108) [73.0 s] 
INFO:root:all_losses: [0.11735483 0.05192035]
INFO:root:Epoch 71    loss=0.1174 [105.1 s]	 dev=(HR@5:0.4836,NDCG@5:0.3443) test=(HR@5:0.4069,NDCG@5:0.2903) [73.0 s] 
INFO:root:all_losses: [0.11348848 0.05189322]
INFO:root:Epoch 72    loss=0.1135 [103.3 s]	 dev=(HR@5:0.5001,NDCG@5:0.3584) test=(HR@5:0.4418,NDCG@5:0.3160) [72.9 s] 
INFO:root:all_losses: [0.1140881  0.05099664]
INFO:root:Epoch 73    loss=0.1141 [103.6 s]	 dev=(HR@5:0.4848,NDCG@5:0.3453) test=(HR@5:0.4198,NDCG@5:0.2985) [73.4 s] 
INFO:root:all_losses: [0.11466726 0.05223523]
INFO:root:Epoch 74    loss=0.1147 [103.7 s]	 dev=(HR@5:0.5072,NDCG@5:0.3609) test=(HR@5:0.4449,NDCG@5:0.3173) [73.0 s] 
INFO:root:all_losses: [0.11268655 0.04962703]
INFO:root:Epoch 75    loss=0.1127 [104.7 s]	 dev=(HR@5:0.4815,NDCG@5:0.3429) test=(HR@5:0.4167,NDCG@5:0.2954) [73.0 s] 
INFO:root:all_losses: [0.11540887 0.05143938]
INFO:root:Epoch 76    loss=0.1154 [103.4 s]	 dev=(HR@5:0.5064,NDCG@5:0.3622) test=(HR@5:0.4412,NDCG@5:0.3122) [73.0 s] 
INFO:root:all_losses: [0.10948886 0.04927043]
INFO:root:Epoch 77    loss=0.1095 [103.4 s]	 dev=(HR@5:0.5040,NDCG@5:0.3568) test=(HR@5:0.4385,NDCG@5:0.3126) [73.2 s] 
INFO:root:all_losses: [0.1124944  0.05134994]
INFO:root:Epoch 78    loss=0.1125 [105.1 s]	 dev=(HR@5:0.4877,NDCG@5:0.3462) test=(HR@5:0.4281,NDCG@5:0.3046) [72.9 s] 
INFO:root:all_losses: [0.10670424 0.04859313]
INFO:root:Epoch 79    loss=0.1067 [103.2 s]	 dev=(HR@5:0.4983,NDCG@5:0.3543) test=(HR@5:0.4457,NDCG@5:0.3177) [72.8 s] 
INFO:root:all_losses: [0.10666194 0.04854907]
INFO:root:Epoch 80    loss=0.1067 [103.9 s]	 dev=(HR@5:0.5003,NDCG@5:0.3594) test=(HR@5:0.4471,NDCG@5:0.3173) [73.1 s] 
INFO:root:all_losses: [0.11395992 0.05218456]
INFO:root:Epoch 81    loss=0.1140 [103.5 s]	 dev=(HR@5:0.4877,NDCG@5:0.3494) test=(HR@5:0.4241,NDCG@5:0.2978) [72.5 s] 
INFO:root:all_losses: [0.10775115 0.0497374 ]
INFO:root:Epoch 82    loss=0.1078 [105.8 s]	 dev=(HR@5:0.4897,NDCG@5:0.3504) test=(HR@5:0.4379,NDCG@5:0.3113) [77.4 s] 
INFO:root:all_losses: [0.10652863 0.04841353]
INFO:root:Epoch 83    loss=0.1065 [113.2 s]	 dev=(HR@5:0.4850,NDCG@5:0.3481) test=(HR@5:0.4230,NDCG@5:0.3031) [77.7 s] 
INFO:root:Early stop at 83 based on dev result.
INFO:root:
Best Iter(dev)=   63	 dev=(HR@5:0.5050,NDCG@5:0.3631) test=(HR@5:0.4512,NDCG@5:0.3185) [14891.9 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6175,HR@5:0.4512,HR@50:0.8871,NDCG@10:0.3724,NDCG@5:0.3185,NDCG@50:0.4331)
INFO:root:
--------------------------------------------- END: 2025-04-07 00:01:28 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-08 10:19:03 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005354 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [101.4 s]	 dev=(HR@5:0.1060,NDCG@5:0.0623) test=(HR@5:0.0707,NDCG@5:0.0408) [74.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2450421  0.69295406]
INFO:root:Epoch 2     loss=1.2450 [105.3 s]	 dev=(HR@5:0.1164,NDCG@5:0.0697) test=(HR@5:0.0730,NDCG@5:0.0430) [74.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242451  0.6926246]
INFO:root:Epoch 3     loss=1.2425 [103.6 s]	 dev=(HR@5:0.1131,NDCG@5:0.0644) test=(HR@5:0.0783,NDCG@5:0.0438) [74.5 s] 
INFO:root:all_losses: [1.2301776 0.6922804]
INFO:root:Epoch 4     loss=1.2302 [111.6 s]	 dev=(HR@5:0.1344,NDCG@5:0.0811) test=(HR@5:0.1019,NDCG@5:0.0589) [76.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.199074  0.6909681]
INFO:root:Epoch 5     loss=1.1991 [110.6 s]	 dev=(HR@5:0.1609,NDCG@5:0.0951) test=(HR@5:0.1178,NDCG@5:0.0691) [75.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1868923 0.6882409]
INFO:root:Epoch 6     loss=1.1869 [107.7 s]	 dev=(HR@5:0.1276,NDCG@5:0.0748) test=(HR@5:0.0968,NDCG@5:0.0546) [75.5 s] 
INFO:root:all_losses: [1.2198048 0.6841652]
INFO:root:Epoch 7     loss=1.2198 [109.1 s]	 dev=(HR@5:0.1095,NDCG@5:0.0642) test=(HR@5:0.0707,NDCG@5:0.0402) [75.6 s] 
INFO:root:all_losses: [1.1999907  0.67109215]
INFO:root:Epoch 8     loss=1.2000 [110.7 s]	 dev=(HR@5:0.1448,NDCG@5:0.0891) test=(HR@5:0.1044,NDCG@5:0.0636) [76.0 s] 
INFO:root:all_losses: [1.1155338  0.63538146]
INFO:root:Epoch 9     loss=1.1155 [111.7 s]	 dev=(HR@5:0.1592,NDCG@5:0.0980) test=(HR@5:0.1223,NDCG@5:0.0754) [75.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0335475 0.5740325]
INFO:root:Epoch 10    loss=1.0335 [110.0 s]	 dev=(HR@5:0.1649,NDCG@5:0.1028) test=(HR@5:0.1248,NDCG@5:0.0781) [80.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9504566 0.5128967]
INFO:root:Epoch 11    loss=0.9505 [109.8 s]	 dev=(HR@5:0.1768,NDCG@5:0.1070) test=(HR@5:0.1258,NDCG@5:0.0781) [78.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8856617  0.46075702]
INFO:root:Epoch 12    loss=0.8857 [110.3 s]	 dev=(HR@5:0.1647,NDCG@5:0.1013) test=(HR@5:0.1203,NDCG@5:0.0741) [78.8 s] 
INFO:root:all_losses: [0.8222669 0.4067296]
INFO:root:Epoch 13    loss=0.8223 [109.7 s]	 dev=(HR@5:0.1666,NDCG@5:0.1020) test=(HR@5:0.1270,NDCG@5:0.0780) [78.9 s] 
INFO:root:all_losses: [0.7692199 0.361392 ]
INFO:root:Epoch 14    loss=0.7692 [110.2 s]	 dev=(HR@5:0.1680,NDCG@5:0.1024) test=(HR@5:0.1244,NDCG@5:0.0770) [78.8 s] 
INFO:root:all_losses: [0.73528826 0.3238038 ]
INFO:root:Epoch 15    loss=0.7353 [110.3 s]	 dev=(HR@5:0.1496,NDCG@5:0.0923) test=(HR@5:0.1142,NDCG@5:0.0719) [78.9 s] 
INFO:root:all_losses: [0.7030339 0.2865324]
INFO:root:Epoch 16    loss=0.7030 [113.5 s]	 dev=(HR@5:0.1501,NDCG@5:0.0904) test=(HR@5:0.1046,NDCG@5:0.0677) [79.1 s] 
INFO:root:all_losses: [0.6806198 0.2554627]
INFO:root:Epoch 17    loss=0.6806 [113.0 s]	 dev=(HR@5:0.1584,NDCG@5:0.0957) test=(HR@5:0.1160,NDCG@5:0.0730) [78.5 s] 
INFO:root:all_losses: [0.6237094  0.22770298]
INFO:root:Epoch 18    loss=0.6237 [110.2 s]	 dev=(HR@5:0.1653,NDCG@5:0.1008) test=(HR@5:0.1172,NDCG@5:0.0710) [78.5 s] 
INFO:root:all_losses: [0.605793  0.2120277]
INFO:root:Epoch 19    loss=0.6058 [112.3 s]	 dev=(HR@5:0.1619,NDCG@5:0.1006) test=(HR@5:0.1180,NDCG@5:0.0737) [78.3 s] 
INFO:root:all_losses: [0.5853853 0.1946895]
INFO:root:Epoch 20    loss=0.5854 [108.5 s]	 dev=(HR@5:0.1639,NDCG@5:0.1031) test=(HR@5:0.1129,NDCG@5:0.0724) [78.7 s] 
INFO:root:all_losses: [0.569364   0.18139161]
INFO:root:Epoch 21    loss=0.5694 [109.7 s]	 dev=(HR@5:0.1568,NDCG@5:0.0984) test=(HR@5:0.1119,NDCG@5:0.0710) [78.7 s] 
INFO:root:all_losses: [0.5563416  0.16844219]
INFO:root:Epoch 22    loss=0.5563 [110.4 s]	 dev=(HR@5:0.1600,NDCG@5:0.0996) test=(HR@5:0.1109,NDCG@5:0.0691) [78.2 s] 
INFO:root:all_losses: [0.5490724  0.15826271]
INFO:root:Epoch 23    loss=0.5491 [108.4 s]	 dev=(HR@5:0.1566,NDCG@5:0.0955) test=(HR@5:0.1121,NDCG@5:0.0692) [78.4 s] 
INFO:root:all_losses: [0.5306131  0.14842476]
INFO:root:Epoch 24    loss=0.5306 [109.0 s]	 dev=(HR@5:0.1543,NDCG@5:0.0942) test=(HR@5:0.1064,NDCG@5:0.0668) [78.7 s] 
INFO:root:all_losses: [0.5227293 0.1418974]
INFO:root:Epoch 25    loss=0.5227 [108.8 s]	 dev=(HR@5:0.1535,NDCG@5:0.0946) test=(HR@5:0.1117,NDCG@5:0.0683) [78.8 s] 
INFO:root:all_losses: [0.51510704 0.1346951 ]
INFO:root:Epoch 26    loss=0.5151 [110.8 s]	 dev=(HR@5:0.1607,NDCG@5:0.0999) test=(HR@5:0.1144,NDCG@5:0.0704) [79.3 s] 
INFO:root:all_losses: [0.50836587 0.12575145]
INFO:root:Epoch 27    loss=0.5084 [110.3 s]	 dev=(HR@5:0.1578,NDCG@5:0.0956) test=(HR@5:0.1162,NDCG@5:0.0704) [79.1 s] 
INFO:root:all_losses: [0.4962474  0.12171229]
INFO:root:Epoch 28    loss=0.4962 [109.7 s]	 dev=(HR@5:0.1662,NDCG@5:0.1029) test=(HR@5:0.1162,NDCG@5:0.0708) [78.6 s] 
INFO:root:all_losses: [0.49389523 0.11671501]
INFO:root:Epoch 29    loss=0.4939 [110.1 s]	 dev=(HR@5:0.1564,NDCG@5:0.0974) test=(HR@5:0.1178,NDCG@5:0.0705) [78.6 s] 
INFO:root:all_losses: [0.49552146 0.11467069]
INFO:root:Epoch 30    loss=0.4955 [109.3 s]	 dev=(HR@5:0.1539,NDCG@5:0.0977) test=(HR@5:0.1113,NDCG@5:0.0685) [78.7 s] 
INFO:root:all_losses: [0.4902264  0.10885141]
INFO:root:Epoch 31    loss=0.4902 [110.3 s]	 dev=(HR@5:0.1543,NDCG@5:0.0943) test=(HR@5:0.1101,NDCG@5:0.0674) [78.4 s] 
INFO:root:Early stop at 31 based on dev result.
INFO:root:
Best Iter(dev)=   11	 dev=(HR@5:0.1768,NDCG@5:0.1070) test=(HR@5:0.1258,NDCG@5:0.0781) [5808.2 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.2308,HR@5:0.1256,HR@50:0.7521,NDCG@10:0.1117,NDCG@5:0.0780,NDCG@50:0.2262)
INFO:root:
--------------------------------------------- END: 2025-04-08 11:57:04 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-08 19:22:41 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005354 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [431.9 s]	 dev=(HR@5:0.1060,NDCG@5:0.0623) test=(HR@5:0.0707,NDCG@5:0.0408) [143.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2450421  0.69295406]
INFO:root:Epoch 2     loss=1.2450 [460.0 s]	 dev=(HR@5:0.1164,NDCG@5:0.0697) test=(HR@5:0.0730,NDCG@5:0.0430) [140.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242451  0.6926246]
INFO:root:Epoch 3     loss=1.2425 [485.2 s]	 dev=(HR@5:0.1131,NDCG@5:0.0644) test=(HR@5:0.0783,NDCG@5:0.0438) [148.6 s] 
INFO:root:all_losses: [1.2301776 0.6922804]
INFO:root:Epoch 4     loss=1.2302 [491.8 s]	 dev=(HR@5:0.1344,NDCG@5:0.0811) test=(HR@5:0.1019,NDCG@5:0.0589) [149.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.199074  0.6909681]
INFO:root:Epoch 5     loss=1.1991 [411.2 s]	 dev=(HR@5:0.1609,NDCG@5:0.0951) test=(HR@5:0.1178,NDCG@5:0.0691) [68.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1868923 0.6882409]
INFO:root:Epoch 6     loss=1.1869 [98.2 s]	 dev=(HR@5:0.1276,NDCG@5:0.0748) test=(HR@5:0.0968,NDCG@5:0.0546) [67.9 s] 
INFO:root:all_losses: [1.2198048 0.6841652]
INFO:root:Epoch 7     loss=1.2198 [98.3 s]	 dev=(HR@5:0.1095,NDCG@5:0.0642) test=(HR@5:0.0707,NDCG@5:0.0402) [67.6 s] 
INFO:root:all_losses: [1.1999907  0.67109215]
INFO:root:Epoch 8     loss=1.2000 [99.8 s]	 dev=(HR@5:0.1448,NDCG@5:0.0891) test=(HR@5:0.1044,NDCG@5:0.0636) [67.7 s] 
INFO:root:all_losses: [1.1155338  0.63538146]
INFO:root:Epoch 9     loss=1.1155 [99.5 s]	 dev=(HR@5:0.1592,NDCG@5:0.0980) test=(HR@5:0.1223,NDCG@5:0.0754) [67.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0335475 0.5740325]
INFO:root:Epoch 10    loss=1.0335 [100.4 s]	 dev=(HR@5:0.1649,NDCG@5:0.1028) test=(HR@5:0.1248,NDCG@5:0.0781) [70.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9504566 0.5128967]
INFO:root:Epoch 11    loss=0.9505 [99.6 s]	 dev=(HR@5:0.1768,NDCG@5:0.1070) test=(HR@5:0.1258,NDCG@5:0.0781) [70.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8856617  0.46075702]
INFO:root:Epoch 12    loss=0.8857 [101.4 s]	 dev=(HR@5:0.1647,NDCG@5:0.1013) test=(HR@5:0.1203,NDCG@5:0.0741) [70.9 s] 
INFO:root:all_losses: [0.8222669 0.4067296]
INFO:root:Epoch 13    loss=0.8223 [97.7 s]	 dev=(HR@5:0.1666,NDCG@5:0.1020) test=(HR@5:0.1270,NDCG@5:0.0780) [70.3 s] 
INFO:root:all_losses: [0.7692199 0.361392 ]
INFO:root:Epoch 14    loss=0.7692 [96.3 s]	 dev=(HR@5:0.1680,NDCG@5:0.1024) test=(HR@5:0.1244,NDCG@5:0.0770) [70.8 s] 
INFO:root:all_losses: [0.73528826 0.3238038 ]
INFO:root:Epoch 15    loss=0.7353 [98.3 s]	 dev=(HR@5:0.1496,NDCG@5:0.0923) test=(HR@5:0.1142,NDCG@5:0.0719) [70.7 s] 
INFO:root:all_losses: [0.7030339 0.2865324]
INFO:root:Epoch 16    loss=0.7030 [95.7 s]	 dev=(HR@5:0.1501,NDCG@5:0.0904) test=(HR@5:0.1046,NDCG@5:0.0677) [70.5 s] 
INFO:root:all_losses: [0.6806198 0.2554627]
INFO:root:Epoch 17    loss=0.6806 [96.4 s]	 dev=(HR@5:0.1584,NDCG@5:0.0957) test=(HR@5:0.1160,NDCG@5:0.0730) [70.6 s] 
INFO:root:all_losses: [0.6237094  0.22770298]
INFO:root:Epoch 18    loss=0.6237 [97.9 s]	 dev=(HR@5:0.1653,NDCG@5:0.1008) test=(HR@5:0.1172,NDCG@5:0.0710) [70.0 s] 
INFO:root:all_losses: [0.605793  0.2120277]
INFO:root:Epoch 19    loss=0.6058 [96.9 s]	 dev=(HR@5:0.1619,NDCG@5:0.1006) test=(HR@5:0.1180,NDCG@5:0.0737) [70.0 s] 
INFO:root:all_losses: [0.5853853 0.1946895]
INFO:root:Epoch 20    loss=0.5854 [98.0 s]	 dev=(HR@5:0.1639,NDCG@5:0.1031) test=(HR@5:0.1129,NDCG@5:0.0724) [69.9 s] 
INFO:root:all_losses: [0.569364   0.18139161]
INFO:root:Epoch 21    loss=0.5694 [98.0 s]	 dev=(HR@5:0.1568,NDCG@5:0.0984) test=(HR@5:0.1119,NDCG@5:0.0710) [70.1 s] 
INFO:root:all_losses: [0.5563416  0.16844219]
INFO:root:Epoch 22    loss=0.5563 [98.6 s]	 dev=(HR@5:0.1600,NDCG@5:0.0996) test=(HR@5:0.1109,NDCG@5:0.0691) [69.7 s] 
INFO:root:all_losses: [0.5490724  0.15826271]
INFO:root:Epoch 23    loss=0.5491 [100.9 s]	 dev=(HR@5:0.1566,NDCG@5:0.0955) test=(HR@5:0.1121,NDCG@5:0.0692) [70.6 s] 
INFO:root:Early stop manually
INFO:root:
Best Iter(dev)=   11	 dev=(HR@5:0.1768,NDCG@5:0.1070) test=(HR@5:0.1258,NDCG@5:0.0781) [5958.0 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-08 21:04:34 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-30 20:24:21 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005354 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [165.2 s]	 dev=(HR@5:0.1060,NDCG@5:0.0623) test=(HR@5:0.0707,NDCG@5:0.0408) [54.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2450421  0.69295406]
INFO:root:Epoch 2     loss=1.2450 [166.2 s]	 dev=(HR@5:0.1164,NDCG@5:0.0697) test=(HR@5:0.0730,NDCG@5:0.0430) [54.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.242451  0.6926246]
INFO:root:Epoch 3     loss=1.2425 [170.7 s]	 dev=(HR@5:0.1131,NDCG@5:0.0644) test=(HR@5:0.0783,NDCG@5:0.0438) [51.7 s] 
INFO:root:all_losses: [1.2301776 0.6922804]
INFO:root:Epoch 4     loss=1.2302 [170.3 s]	 dev=(HR@5:0.1344,NDCG@5:0.0811) test=(HR@5:0.1019,NDCG@5:0.0589) [51.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.199074  0.6909681]
INFO:root:Epoch 5     loss=1.1991 [172.0 s]	 dev=(HR@5:0.1609,NDCG@5:0.0951) test=(HR@5:0.1178,NDCG@5:0.0691) [51.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1868923 0.6882409]
INFO:root:Epoch 6     loss=1.1869 [176.2 s]	 dev=(HR@5:0.1276,NDCG@5:0.0748) test=(HR@5:0.0968,NDCG@5:0.0546) [51.5 s] 
INFO:root:all_losses: [1.2198048 0.6841652]
INFO:root:Epoch 7     loss=1.2198 [173.6 s]	 dev=(HR@5:0.1095,NDCG@5:0.0642) test=(HR@5:0.0707,NDCG@5:0.0402) [51.6 s] 
INFO:root:all_losses: [1.1999907  0.67109215]
INFO:root:Epoch 8     loss=1.2000 [173.8 s]	 dev=(HR@5:0.1448,NDCG@5:0.0891) test=(HR@5:0.1044,NDCG@5:0.0636) [51.5 s] 
INFO:root:all_losses: [1.1155338  0.63538146]
INFO:root:Epoch 9     loss=1.1155 [180.7 s]	 dev=(HR@5:0.1592,NDCG@5:0.0980) test=(HR@5:0.1223,NDCG@5:0.0754) [51.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0335475 0.5740325]
INFO:root:Epoch 10    loss=1.0335 [185.2 s]	 dev=(HR@5:0.1649,NDCG@5:0.1028) test=(HR@5:0.1248,NDCG@5:0.0781) [79.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9504566 0.5128967]
INFO:root:Epoch 11    loss=0.9505 [187.2 s]	 dev=(HR@5:0.1768,NDCG@5:0.1070) test=(HR@5:0.1258,NDCG@5:0.0781) [76.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8856617  0.46075702]
INFO:root:Epoch 12    loss=0.8857 [186.3 s]	 dev=(HR@5:0.1647,NDCG@5:0.1013) test=(HR@5:0.1203,NDCG@5:0.0741) [75.8 s] 
INFO:root:all_losses: [0.8222669 0.4067296]
INFO:root:Epoch 13    loss=0.8223 [185.8 s]	 dev=(HR@5:0.1666,NDCG@5:0.1020) test=(HR@5:0.1270,NDCG@5:0.0780) [75.9 s] 
INFO:root:all_losses: [0.7692199 0.361392 ]
INFO:root:Epoch 14    loss=0.7692 [187.0 s]	 dev=(HR@5:0.1680,NDCG@5:0.1024) test=(HR@5:0.1244,NDCG@5:0.0770) [75.0 s] 
INFO:root:all_losses: [0.73528826 0.3238038 ]
INFO:root:Epoch 15    loss=0.7353 [184.1 s]	 dev=(HR@5:0.1496,NDCG@5:0.0923) test=(HR@5:0.1142,NDCG@5:0.0719) [75.1 s] 
INFO:root:all_losses: [0.7030339 0.2865324]
INFO:root:Epoch 16    loss=0.7030 [186.9 s]	 dev=(HR@5:0.1501,NDCG@5:0.0904) test=(HR@5:0.1046,NDCG@5:0.0677) [75.3 s] 
INFO:root:all_losses: [0.6806198 0.2554627]
INFO:root:Epoch 17    loss=0.6806 [186.7 s]	 dev=(HR@5:0.1584,NDCG@5:0.0957) test=(HR@5:0.1160,NDCG@5:0.0730) [73.3 s] 
INFO:root:all_losses: [0.6237094  0.22770298]
INFO:root:Epoch 18    loss=0.6237 [189.5 s]	 dev=(HR@5:0.1653,NDCG@5:0.1008) test=(HR@5:0.1172,NDCG@5:0.0710) [73.3 s] 
INFO:root:all_losses: [0.605793  0.2120277]
INFO:root:Epoch 19    loss=0.6058 [189.7 s]	 dev=(HR@5:0.1619,NDCG@5:0.1006) test=(HR@5:0.1180,NDCG@5:0.0737) [73.3 s] 
INFO:root:all_losses: [0.5853853 0.1946895]
INFO:root:Epoch 20    loss=0.5854 [185.5 s]	 dev=(HR@5:0.1639,NDCG@5:0.1031) test=(HR@5:0.1129,NDCG@5:0.0724) [73.0 s] 
INFO:root:all_losses: [0.569364   0.18139161]
INFO:root:Epoch 21    loss=0.5694 [185.8 s]	 dev=(HR@5:0.1568,NDCG@5:0.0984) test=(HR@5:0.1119,NDCG@5:0.0710) [73.2 s] 
INFO:root:all_losses: [0.5563416  0.16844219]
INFO:root:Epoch 22    loss=0.5563 [185.9 s]	 dev=(HR@5:0.1600,NDCG@5:0.0996) test=(HR@5:0.1109,NDCG@5:0.0691) [73.1 s] 
INFO:root:all_losses: [0.5490724  0.15826271]
INFO:root:Epoch 23    loss=0.5491 [185.5 s]	 dev=(HR@5:0.1566,NDCG@5:0.0955) test=(HR@5:0.1121,NDCG@5:0.0692) [73.1 s] 
INFO:root:all_losses: [0.5306131  0.14842476]
INFO:root:Epoch 24    loss=0.5306 [185.7 s]	 dev=(HR@5:0.1543,NDCG@5:0.0942) test=(HR@5:0.1064,NDCG@5:0.0668) [72.7 s] 
INFO:root:all_losses: [0.5227293 0.1418974]
INFO:root:Epoch 25    loss=0.5227 [185.9 s]	 dev=(HR@5:0.1535,NDCG@5:0.0946) test=(HR@5:0.1117,NDCG@5:0.0683) [73.2 s] 
INFO:root:all_losses: [0.51510704 0.1346951 ]
INFO:root:Epoch 26    loss=0.5151 [183.7 s]	 dev=(HR@5:0.1607,NDCG@5:0.0999) test=(HR@5:0.1144,NDCG@5:0.0704) [72.9 s] 
INFO:root:all_losses: [0.50836587 0.12575145]
INFO:root:Epoch 27    loss=0.5084 [183.2 s]	 dev=(HR@5:0.1578,NDCG@5:0.0956) test=(HR@5:0.1162,NDCG@5:0.0704) [73.0 s] 
INFO:root:all_losses: [0.4962474  0.12171229]
INFO:root:Epoch 28    loss=0.4962 [184.2 s]	 dev=(HR@5:0.1662,NDCG@5:0.1029) test=(HR@5:0.1162,NDCG@5:0.0708) [72.3 s] 
INFO:root:all_losses: [0.49389523 0.11671501]
INFO:root:Epoch 29    loss=0.4939 [185.4 s]	 dev=(HR@5:0.1564,NDCG@5:0.0974) test=(HR@5:0.1178,NDCG@5:0.0705) [72.6 s] 
INFO:root:all_losses: [0.49552146 0.11467069]
INFO:root:Epoch 30    loss=0.4955 [183.5 s]	 dev=(HR@5:0.1539,NDCG@5:0.0977) test=(HR@5:0.1113,NDCG@5:0.0685) [72.5 s] 
INFO:root:all_losses: [0.4902264  0.10885141]
INFO:root:Epoch 31    loss=0.4902 [184.6 s]	 dev=(HR@5:0.1543,NDCG@5:0.0943) test=(HR@5:0.1101,NDCG@5:0.0674) [72.5 s] 
INFO:root:Early stop at 31 based on dev result.
INFO:root:
Best Iter(dev)=   11	 dev=(HR@5:0.1768,NDCG@5:0.1070) test=(HR@5:0.1258,NDCG@5:0.0781) [7732.1 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.2308,HR@5:0.1256,HR@50:0.7521,NDCG@10:0.1117,NDCG@5:0.0780,NDCG@50:0.2262)
INFO:root:
--------------------------------------------- END: 2025-04-30 22:34:08 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-09 15:10:50 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005359 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [44.5 s]	 dev=(HR@5:0.1058,NDCG@5:0.0623) test=(HR@5:0.0709,NDCG@5:0.0409) [36.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.244857  0.6929538]
INFO:root:Epoch 2     loss=1.2449 [43.8 s]	 dev=(HR@5:0.1160,NDCG@5:0.0694) test=(HR@5:0.0718,NDCG@5:0.0429) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2424475 0.6926261]
INFO:root:Epoch 3     loss=1.2424 [45.4 s]	 dev=(HR@5:0.1111,NDCG@5:0.0634) test=(HR@5:0.0779,NDCG@5:0.0435) [36.5 s] 
INFO:root:all_losses: [1.2391317 0.6923334]
INFO:root:Epoch 4     loss=1.2391 [49.9 s]	 dev=(HR@5:0.1158,NDCG@5:0.0684) test=(HR@5:0.0783,NDCG@5:0.0447) [36.6 s] 
INFO:root:all_losses: [1.2056246 0.6915994]
INFO:root:Epoch 5     loss=1.2056 [45.3 s]	 dev=(HR@5:0.1527,NDCG@5:0.0930) test=(HR@5:0.1127,NDCG@5:0.0704) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1612715 0.6880717]
INFO:root:Epoch 6     loss=1.1613 [44.4 s]	 dev=(HR@5:0.1761,NDCG@5:0.1073) test=(HR@5:0.1311,NDCG@5:0.0804) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1243923  0.67869526]
INFO:root:Epoch 7     loss=1.1244 [42.3 s]	 dev=(HR@5:0.1957,NDCG@5:0.1216) test=(HR@5:0.1386,NDCG@5:0.0880) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0772184  0.65086144]
INFO:root:Epoch 8     loss=1.0772 [41.0 s]	 dev=(HR@5:0.2037,NDCG@5:0.1284) test=(HR@5:0.1484,NDCG@5:0.0940) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9895524  0.59197986]
INFO:root:Epoch 9     loss=0.9896 [42.2 s]	 dev=(HR@5:0.2495,NDCG@5:0.1573) test=(HR@5:0.1908,NDCG@5:0.1181) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8787276  0.52209055]
INFO:root:Epoch 10    loss=0.8787 [44.0 s]	 dev=(HR@5:0.2887,NDCG@5:0.1867) test=(HR@5:0.2155,NDCG@5:0.1398) [42.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7786359 0.4579467]
INFO:root:Epoch 11    loss=0.7786 [44.5 s]	 dev=(HR@5:0.3494,NDCG@5:0.2270) test=(HR@5:0.2777,NDCG@5:0.1819) [42.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6861803  0.39719898]
INFO:root:Epoch 12    loss=0.6862 [44.7 s]	 dev=(HR@5:0.3778,NDCG@5:0.2478) test=(HR@5:0.2911,NDCG@5:0.1890) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.597923   0.33515418]
INFO:root:Epoch 13    loss=0.5979 [44.6 s]	 dev=(HR@5:0.3957,NDCG@5:0.2631) test=(HR@5:0.3042,NDCG@5:0.2009) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5247671  0.28641802]
INFO:root:Epoch 14    loss=0.5248 [45.0 s]	 dev=(HR@5:0.4092,NDCG@5:0.2746) test=(HR@5:0.3242,NDCG@5:0.2159) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4713041 0.250112 ]
INFO:root:Epoch 15    loss=0.4713 [44.8 s]	 dev=(HR@5:0.4285,NDCG@5:0.2907) test=(HR@5:0.3315,NDCG@5:0.2237) [42.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.42670348 0.21867017]
INFO:root:Epoch 16    loss=0.4267 [45.7 s]	 dev=(HR@5:0.4318,NDCG@5:0.2970) test=(HR@5:0.3515,NDCG@5:0.2381) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.39215112 0.19445324]
INFO:root:Epoch 17    loss=0.3922 [45.3 s]	 dev=(HR@5:0.4457,NDCG@5:0.3014) test=(HR@5:0.3627,NDCG@5:0.2412) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3525311  0.17191336]
INFO:root:Epoch 18    loss=0.3525 [45.2 s]	 dev=(HR@5:0.4436,NDCG@5:0.3063) test=(HR@5:0.3564,NDCG@5:0.2391) [41.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33377922 0.1591093 ]
INFO:root:Epoch 19    loss=0.3338 [45.2 s]	 dev=(HR@5:0.4422,NDCG@5:0.3045) test=(HR@5:0.3682,NDCG@5:0.2523) [41.8 s] 
INFO:root:all_losses: [0.3105054  0.14610255]
INFO:root:Epoch 20    loss=0.3105 [45.6 s]	 dev=(HR@5:0.4846,NDCG@5:0.3337) test=(HR@5:0.4214,NDCG@5:0.2802) [41.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29191923 0.13704461]
INFO:root:Epoch 21    loss=0.2919 [45.1 s]	 dev=(HR@5:0.4718,NDCG@5:0.3258) test=(HR@5:0.3923,NDCG@5:0.2633) [41.5 s] 
INFO:root:all_losses: [0.27804    0.12709422]
INFO:root:Epoch 22    loss=0.2780 [45.2 s]	 dev=(HR@5:0.4762,NDCG@5:0.3306) test=(HR@5:0.3998,NDCG@5:0.2733) [41.8 s] 
INFO:root:all_losses: [0.2642461  0.11953162]
INFO:root:Epoch 23    loss=0.2642 [46.1 s]	 dev=(HR@5:0.4793,NDCG@5:0.3350) test=(HR@5:0.4069,NDCG@5:0.2793) [41.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.24888466 0.1122806 ]
INFO:root:Epoch 24    loss=0.2489 [45.7 s]	 dev=(HR@5:0.4728,NDCG@5:0.3289) test=(HR@5:0.3941,NDCG@5:0.2688) [41.5 s] 
INFO:root:all_losses: [0.2384891  0.10745326]
INFO:root:Epoch 25    loss=0.2385 [45.8 s]	 dev=(HR@5:0.4932,NDCG@5:0.3415) test=(HR@5:0.4171,NDCG@5:0.2827) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23099564 0.10357016]
INFO:root:Epoch 26    loss=0.2310 [46.0 s]	 dev=(HR@5:0.4840,NDCG@5:0.3403) test=(HR@5:0.4145,NDCG@5:0.2849) [41.4 s] 
INFO:root:all_losses: [0.21891482 0.09737805]
INFO:root:Epoch 27    loss=0.2189 [45.6 s]	 dev=(HR@5:0.4952,NDCG@5:0.3467) test=(HR@5:0.4361,NDCG@5:0.3000) [41.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21013728 0.09418818]
INFO:root:Epoch 28    loss=0.2101 [45.7 s]	 dev=(HR@5:0.4783,NDCG@5:0.3356) test=(HR@5:0.4024,NDCG@5:0.2744) [41.4 s] 
INFO:root:all_losses: [0.20308723 0.0912046 ]
INFO:root:Epoch 29    loss=0.2031 [45.7 s]	 dev=(HR@5:0.4891,NDCG@5:0.3437) test=(HR@5:0.4210,NDCG@5:0.2884) [41.3 s] 
INFO:root:all_losses: [0.19980796 0.09012371]
INFO:root:Epoch 30    loss=0.1998 [45.3 s]	 dev=(HR@5:0.4811,NDCG@5:0.3383) test=(HR@5:0.4208,NDCG@5:0.2932) [41.4 s] 
INFO:root:all_losses: [0.19703653 0.0853059 ]
INFO:root:Epoch 31    loss=0.1970 [45.4 s]	 dev=(HR@5:0.5017,NDCG@5:0.3541) test=(HR@5:0.4410,NDCG@5:0.3061) [41.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.1941216  0.08755352]
INFO:root:Epoch 32    loss=0.1941 [45.7 s]	 dev=(HR@5:0.4871,NDCG@5:0.3425) test=(HR@5:0.4234,NDCG@5:0.2932) [41.2 s] 
INFO:root:all_losses: [0.18126738 0.08202764]
INFO:root:Epoch 33    loss=0.1813 [47.1 s]	 dev=(HR@5:0.4944,NDCG@5:0.3472) test=(HR@5:0.4194,NDCG@5:0.2906) [41.1 s] 
INFO:root:all_losses: [0.1740251  0.07953161]
INFO:root:Epoch 34    loss=0.1740 [46.0 s]	 dev=(HR@5:0.5021,NDCG@5:0.3533) test=(HR@5:0.4361,NDCG@5:0.3010) [41.0 s] 
INFO:root:all_losses: [0.1751398  0.07924959]
INFO:root:Epoch 35    loss=0.1751 [45.6 s]	 dev=(HR@5:0.5087,NDCG@5:0.3570) test=(HR@5:0.4638,NDCG@5:0.3150) [41.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16973485 0.07676442]
INFO:root:Epoch 36    loss=0.1697 [45.8 s]	 dev=(HR@5:0.5034,NDCG@5:0.3511) test=(HR@5:0.4493,NDCG@5:0.3094) [40.9 s] 
INFO:root:all_losses: [0.1670271  0.07508672]
INFO:root:Epoch 37    loss=0.1670 [46.0 s]	 dev=(HR@5:0.4577,NDCG@5:0.3240) test=(HR@5:0.3808,NDCG@5:0.2625) [40.9 s] 
INFO:root:all_losses: [0.16121212 0.07399422]
INFO:root:Epoch 38    loss=0.1612 [45.7 s]	 dev=(HR@5:0.4934,NDCG@5:0.3442) test=(HR@5:0.4161,NDCG@5:0.2881) [41.2 s] 
INFO:root:all_losses: [0.15809447 0.07259885]
INFO:root:Epoch 39    loss=0.1581 [45.6 s]	 dev=(HR@5:0.4905,NDCG@5:0.3480) test=(HR@5:0.4133,NDCG@5:0.2856) [40.9 s] 
INFO:root:all_losses: [0.15998639 0.07051328]
INFO:root:Epoch 40    loss=0.1600 [44.9 s]	 dev=(HR@5:0.5044,NDCG@5:0.3517) test=(HR@5:0.4487,NDCG@5:0.3116) [40.8 s] 
INFO:root:all_losses: [0.15403453 0.06997907]
INFO:root:Epoch 41    loss=0.1540 [45.6 s]	 dev=(HR@5:0.4942,NDCG@5:0.3483) test=(HR@5:0.4239,NDCG@5:0.2932) [40.9 s] 
INFO:root:all_losses: [0.15178359 0.07224421]
INFO:root:Epoch 42    loss=0.1518 [45.7 s]	 dev=(HR@5:0.4962,NDCG@5:0.3521) test=(HR@5:0.4214,NDCG@5:0.2927) [40.9 s] 
INFO:root:all_losses: [0.15102327 0.06745377]
INFO:root:Epoch 43    loss=0.1510 [45.7 s]	 dev=(HR@5:0.4919,NDCG@5:0.3480) test=(HR@5:0.4232,NDCG@5:0.2939) [40.7 s] 
INFO:root:all_losses: [0.14622803 0.06741982]
INFO:root:Epoch 44    loss=0.1462 [45.6 s]	 dev=(HR@5:0.4962,NDCG@5:0.3520) test=(HR@5:0.4389,NDCG@5:0.3040) [40.8 s] 
INFO:root:all_losses: [0.14268874 0.06492642]
INFO:root:Epoch 45    loss=0.1427 [45.5 s]	 dev=(HR@5:0.4685,NDCG@5:0.3306) test=(HR@5:0.3976,NDCG@5:0.2780) [40.7 s] 
INFO:root:all_losses: [0.14301063 0.06733527]
INFO:root:Epoch 46    loss=0.1430 [44.5 s]	 dev=(HR@5:0.4997,NDCG@5:0.3504) test=(HR@5:0.4355,NDCG@5:0.3021) [40.8 s] 
INFO:root:all_losses: [0.13591696 0.06307836]
INFO:root:Epoch 47    loss=0.1359 [45.3 s]	 dev=(HR@5:0.4881,NDCG@5:0.3421) test=(HR@5:0.4200,NDCG@5:0.2930) [40.8 s] 
INFO:root:all_losses: [0.14151828 0.06469028]
INFO:root:Epoch 48    loss=0.1415 [45.3 s]	 dev=(HR@5:0.5005,NDCG@5:0.3534) test=(HR@5:0.4338,NDCG@5:0.2992) [40.6 s] 
INFO:root:all_losses: [0.13482201 0.06075189]
INFO:root:Epoch 49    loss=0.1348 [44.4 s]	 dev=(HR@5:0.4952,NDCG@5:0.3478) test=(HR@5:0.4330,NDCG@5:0.3044) [40.8 s] 
INFO:root:all_losses: [0.13369556 0.06191703]
INFO:root:Epoch 50    loss=0.1337 [45.2 s]	 dev=(HR@5:0.4828,NDCG@5:0.3390) test=(HR@5:0.4133,NDCG@5:0.2852) [40.6 s] 
INFO:root:all_losses: [0.13112706 0.06043383]
INFO:root:Epoch 51    loss=0.1311 [44.6 s]	 dev=(HR@5:0.5058,NDCG@5:0.3606) test=(HR@5:0.4436,NDCG@5:0.3095) [40.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12890567 0.06061586]
INFO:root:Epoch 52    loss=0.1289 [45.0 s]	 dev=(HR@5:0.5068,NDCG@5:0.3598) test=(HR@5:0.4434,NDCG@5:0.3080) [40.7 s] 
INFO:root:all_losses: [0.12809345 0.06013496]
INFO:root:Epoch 53    loss=0.1281 [45.1 s]	 dev=(HR@5:0.5009,NDCG@5:0.3549) test=(HR@5:0.4424,NDCG@5:0.3079) [40.9 s] 
INFO:root:all_losses: [0.12574433 0.05979846]
INFO:root:Epoch 54    loss=0.1257 [45.1 s]	 dev=(HR@5:0.5015,NDCG@5:0.3487) test=(HR@5:0.4534,NDCG@5:0.3133) [40.5 s] 
INFO:root:all_losses: [0.1253028  0.05868107]
INFO:root:Epoch 55    loss=0.1253 [45.1 s]	 dev=(HR@5:0.4901,NDCG@5:0.3462) test=(HR@5:0.4359,NDCG@5:0.3025) [40.6 s] 
INFO:root:Early stop at 55 based on dev result.
INFO:root:
Best Iter(dev)=   51	 dev=(HR@5:0.5058,NDCG@5:0.3606) test=(HR@5:0.4436,NDCG@5:0.3095) [4710.2 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6010,HR@5:0.4436,HR@50:0.8856,NDCG@10:0.3605,NDCG@5:0.3095,NDCG@50:0.4239)
INFO:root:
--------------------------------------------- END: 2025-05-09 16:29:58 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-10 11:51:28 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005401 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [43.1 s]	 dev=(HR@5:0.1060,NDCG@5:0.0624) test=(HR@5:0.0703,NDCG@5:0.0407) [35.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2448056 0.6929535]
INFO:root:Epoch 2     loss=1.2448 [40.8 s]	 dev=(HR@5:0.1176,NDCG@5:0.0703) test=(HR@5:0.0736,NDCG@5:0.0437) [35.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2425351  0.69262594]
INFO:root:Epoch 3     loss=1.2425 [42.9 s]	 dev=(HR@5:0.1117,NDCG@5:0.0632) test=(HR@5:0.0773,NDCG@5:0.0432) [36.5 s] 
INFO:root:all_losses: [1.2328743 0.6923016]
INFO:root:Epoch 4     loss=1.2329 [44.4 s]	 dev=(HR@5:0.1341,NDCG@5:0.0822) test=(HR@5:0.1011,NDCG@5:0.0599) [36.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1903768 0.69119  ]
INFO:root:Epoch 5     loss=1.1904 [43.5 s]	 dev=(HR@5:0.1549,NDCG@5:0.0952) test=(HR@5:0.1152,NDCG@5:0.0720) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2203786 0.6883811]
INFO:root:Epoch 6     loss=1.2204 [42.9 s]	 dev=(HR@5:0.1103,NDCG@5:0.0632) test=(HR@5:0.0726,NDCG@5:0.0405) [36.0 s] 
INFO:root:all_losses: [1.2264616 0.6828421]
INFO:root:Epoch 7     loss=1.2265 [43.2 s]	 dev=(HR@5:0.1089,NDCG@5:0.0642) test=(HR@5:0.0669,NDCG@5:0.0384) [36.1 s] 
INFO:root:all_losses: [1.1963981  0.65880114]
INFO:root:Epoch 8     loss=1.1964 [43.6 s]	 dev=(HR@5:0.1023,NDCG@5:0.0609) test=(HR@5:0.0628,NDCG@5:0.0358) [36.1 s] 
INFO:root:all_losses: [1.1273253 0.5971197]
INFO:root:Epoch 9     loss=1.1273 [45.1 s]	 dev=(HR@5:0.1089,NDCG@5:0.0645) test=(HR@5:0.0675,NDCG@5:0.0376) [35.1 s] 
INFO:root:all_losses: [1.0393715 0.521953 ]
INFO:root:Epoch 10    loss=1.0394 [43.1 s]	 dev=(HR@5:0.1011,NDCG@5:0.0588) test=(HR@5:0.0699,NDCG@5:0.0389) [40.7 s] 
INFO:root:all_losses: [0.967486   0.46019801]
INFO:root:Epoch 11    loss=0.9675 [43.7 s]	 dev=(HR@5:0.1056,NDCG@5:0.0632) test=(HR@5:0.0679,NDCG@5:0.0382) [40.8 s] 
INFO:root:all_losses: [0.89920056 0.40325922]
INFO:root:Epoch 12    loss=0.8992 [46.0 s]	 dev=(HR@5:0.1091,NDCG@5:0.0641) test=(HR@5:0.0646,NDCG@5:0.0366) [42.3 s] 
INFO:root:all_losses: [0.82635283 0.34037048]
INFO:root:Epoch 13    loss=0.8264 [46.3 s]	 dev=(HR@5:0.1103,NDCG@5:0.0638) test=(HR@5:0.0724,NDCG@5:0.0405) [41.9 s] 
INFO:root:all_losses: [0.76581365 0.2881783 ]
INFO:root:Epoch 14    loss=0.7658 [46.1 s]	 dev=(HR@5:0.1113,NDCG@5:0.0636) test=(HR@5:0.0689,NDCG@5:0.0387) [42.2 s] 
INFO:root:all_losses: [0.72212803 0.24959171]
INFO:root:Epoch 15    loss=0.7221 [46.3 s]	 dev=(HR@5:0.1050,NDCG@5:0.0612) test=(HR@5:0.0675,NDCG@5:0.0384) [42.1 s] 
INFO:root:all_losses: [0.69031346 0.21770088]
INFO:root:Epoch 16    loss=0.6903 [46.5 s]	 dev=(HR@5:0.1066,NDCG@5:0.0605) test=(HR@5:0.0683,NDCG@5:0.0385) [42.0 s] 
INFO:root:all_losses: [0.6596677  0.19045651]
INFO:root:Epoch 17    loss=0.6597 [46.3 s]	 dev=(HR@5:0.1121,NDCG@5:0.0660) test=(HR@5:0.0716,NDCG@5:0.0416) [41.9 s] 
INFO:root:all_losses: [0.6268225  0.16722889]
INFO:root:Epoch 18    loss=0.6268 [46.5 s]	 dev=(HR@5:0.1125,NDCG@5:0.0660) test=(HR@5:0.0697,NDCG@5:0.0394) [42.1 s] 
INFO:root:all_losses: [0.6186704  0.15510903]
INFO:root:Epoch 19    loss=0.6187 [46.3 s]	 dev=(HR@5:0.1042,NDCG@5:0.0620) test=(HR@5:0.0681,NDCG@5:0.0379) [42.1 s] 
INFO:root:all_losses: [0.6021585  0.14154908]
INFO:root:Epoch 20    loss=0.6022 [46.5 s]	 dev=(HR@5:0.1093,NDCG@5:0.0638) test=(HR@5:0.0654,NDCG@5:0.0379) [41.7 s] 
INFO:root:all_losses: [0.58860064 0.13042542]
INFO:root:Epoch 21    loss=0.5886 [46.4 s]	 dev=(HR@5:0.1066,NDCG@5:0.0640) test=(HR@5:0.0669,NDCG@5:0.0385) [41.7 s] 
INFO:root:all_losses: [0.5780856  0.12079538]
INFO:root:Epoch 22    loss=0.5781 [46.1 s]	 dev=(HR@5:0.1105,NDCG@5:0.0672) test=(HR@5:0.0691,NDCG@5:0.0395) [42.1 s] 
INFO:root:all_losses: [0.5724804 0.1131769]
INFO:root:Epoch 23    loss=0.5725 [46.2 s]	 dev=(HR@5:0.1146,NDCG@5:0.0662) test=(HR@5:0.0656,NDCG@5:0.0380) [42.0 s] 
INFO:root:all_losses: [0.56086    0.10623685]
INFO:root:Epoch 24    loss=0.5609 [46.3 s]	 dev=(HR@5:0.1056,NDCG@5:0.0614) test=(HR@5:0.0630,NDCG@5:0.0354) [41.8 s] 
INFO:root:all_losses: [0.5540739  0.10260491]
INFO:root:Epoch 25    loss=0.5541 [47.1 s]	 dev=(HR@5:0.1072,NDCG@5:0.0624) test=(HR@5:0.0673,NDCG@5:0.0371) [41.8 s] 
INFO:root:Early stop at 25 based on dev result.
INFO:root:
Best Iter(dev)=    5	 dev=(HR@5:0.1549,NDCG@5:0.0952) test=(HR@5:0.1152,NDCG@5:0.0720) [2117.0 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.2102,HR@5:0.1152,HR@50:0.7091,NDCG@10:0.1023,NDCG@5:0.0720,NDCG@50:0.2121)
INFO:root:
--------------------------------------------- END: 2025-05-10 12:27:20 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-11 01:04:43 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3005401 0.6931161]
INFO:root:Epoch 1     loss=1.3005 [42.3 s]	 dev=(HR@5:0.1060,NDCG@5:0.0624) test=(HR@5:0.0703,NDCG@5:0.0407) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2448056 0.6929535]
INFO:root:Epoch 2     loss=1.2448 [44.0 s]	 dev=(HR@5:0.1176,NDCG@5:0.0703) test=(HR@5:0.0736,NDCG@5:0.0437) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2425351  0.69262594]
INFO:root:Epoch 3     loss=1.2425 [43.5 s]	 dev=(HR@5:0.1117,NDCG@5:0.0632) test=(HR@5:0.0773,NDCG@5:0.0432) [36.2 s] 
INFO:root:all_losses: [1.2328743 0.6923016]
INFO:root:Epoch 4     loss=1.2329 [44.4 s]	 dev=(HR@5:0.1341,NDCG@5:0.0822) test=(HR@5:0.1011,NDCG@5:0.0599) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1903768 0.69119  ]
INFO:root:Epoch 5     loss=1.1904 [43.3 s]	 dev=(HR@5:0.1549,NDCG@5:0.0952) test=(HR@5:0.1152,NDCG@5:0.0720) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2203786 0.6883811]
INFO:root:Epoch 6     loss=1.2204 [43.4 s]	 dev=(HR@5:0.1103,NDCG@5:0.0632) test=(HR@5:0.0726,NDCG@5:0.0405) [36.5 s] 
INFO:root:all_losses: [1.2264616 0.6828421]
INFO:root:Epoch 7     loss=1.2265 [43.7 s]	 dev=(HR@5:0.1089,NDCG@5:0.0642) test=(HR@5:0.0669,NDCG@5:0.0384) [36.4 s] 
INFO:root:all_losses: [1.1963981  0.65880114]
INFO:root:Epoch 8     loss=1.1964 [41.8 s]	 dev=(HR@5:0.1023,NDCG@5:0.0609) test=(HR@5:0.0628,NDCG@5:0.0358) [35.0 s] 
INFO:root:all_losses: [1.1273253 0.5971197]
INFO:root:Epoch 9     loss=1.1273 [43.1 s]	 dev=(HR@5:0.1089,NDCG@5:0.0645) test=(HR@5:0.0675,NDCG@5:0.0376) [35.0 s] 
INFO:root:all_losses: [1.0393715 0.521953 ]
INFO:root:Epoch 10    loss=1.0394 [43.6 s]	 dev=(HR@5:0.1011,NDCG@5:0.0588) test=(HR@5:0.0699,NDCG@5:0.0389) [40.8 s] 
INFO:root:all_losses: [0.967486   0.46019801]
INFO:root:Epoch 11    loss=0.9675 [44.0 s]	 dev=(HR@5:0.1056,NDCG@5:0.0632) test=(HR@5:0.0679,NDCG@5:0.0382) [40.9 s] 
INFO:root:all_losses: [0.89920056 0.40325922]
INFO:root:Epoch 12    loss=0.8992 [43.9 s]	 dev=(HR@5:0.1091,NDCG@5:0.0641) test=(HR@5:0.0646,NDCG@5:0.0366) [40.9 s] 
INFO:root:all_losses: [0.82635283 0.34037048]
INFO:root:Epoch 13    loss=0.8264 [44.1 s]	 dev=(HR@5:0.1103,NDCG@5:0.0638) test=(HR@5:0.0724,NDCG@5:0.0405) [40.7 s] 
INFO:root:all_losses: [0.76581365 0.2881783 ]
INFO:root:Epoch 14    loss=0.7658 [44.0 s]	 dev=(HR@5:0.1113,NDCG@5:0.0636) test=(HR@5:0.0689,NDCG@5:0.0387) [41.0 s] 
INFO:root:all_losses: [0.72212803 0.24959171]
INFO:root:Epoch 15    loss=0.7221 [44.2 s]	 dev=(HR@5:0.1050,NDCG@5:0.0612) test=(HR@5:0.0675,NDCG@5:0.0384) [40.9 s] 
INFO:root:all_losses: [0.69031346 0.21770088]
INFO:root:Epoch 16    loss=0.6903 [44.2 s]	 dev=(HR@5:0.1066,NDCG@5:0.0605) test=(HR@5:0.0683,NDCG@5:0.0385) [40.9 s] 
INFO:root:all_losses: [0.6596677  0.19045651]
INFO:root:Epoch 17    loss=0.6597 [44.1 s]	 dev=(HR@5:0.1121,NDCG@5:0.0660) test=(HR@5:0.0716,NDCG@5:0.0416) [40.6 s] 
INFO:root:all_losses: [0.6268225  0.16722889]
INFO:root:Epoch 18    loss=0.6268 [44.4 s]	 dev=(HR@5:0.1125,NDCG@5:0.0660) test=(HR@5:0.0697,NDCG@5:0.0394) [40.6 s] 
INFO:root:all_losses: [0.6186704  0.15510903]
INFO:root:Epoch 19    loss=0.6187 [44.0 s]	 dev=(HR@5:0.1042,NDCG@5:0.0620) test=(HR@5:0.0681,NDCG@5:0.0379) [41.2 s] 
INFO:root:all_losses: [0.6021585  0.14154908]
INFO:root:Epoch 20    loss=0.6022 [44.1 s]	 dev=(HR@5:0.1093,NDCG@5:0.0638) test=(HR@5:0.0654,NDCG@5:0.0379) [40.6 s] 
INFO:root:all_losses: [0.58860064 0.13042542]
INFO:root:Epoch 21    loss=0.5886 [43.5 s]	 dev=(HR@5:0.1066,NDCG@5:0.0640) test=(HR@5:0.0669,NDCG@5:0.0385) [40.6 s] 
INFO:root:all_losses: [0.5780856  0.12079538]
INFO:root:Epoch 22    loss=0.5781 [43.2 s]	 dev=(HR@5:0.1105,NDCG@5:0.0672) test=(HR@5:0.0691,NDCG@5:0.0395) [40.9 s] 
INFO:root:all_losses: [0.5724804 0.1131769]
INFO:root:Epoch 23    loss=0.5725 [43.6 s]	 dev=(HR@5:0.1146,NDCG@5:0.0662) test=(HR@5:0.0656,NDCG@5:0.0380) [40.8 s] 
INFO:root:all_losses: [0.56086    0.10623685]
INFO:root:Epoch 24    loss=0.5609 [43.3 s]	 dev=(HR@5:0.1056,NDCG@5:0.0614) test=(HR@5:0.0630,NDCG@5:0.0354) [40.5 s] 
INFO:root:all_losses: [0.5540739  0.10260491]
INFO:root:Epoch 25    loss=0.5541 [43.4 s]	 dev=(HR@5:0.1072,NDCG@5:0.0624) test=(HR@5:0.0673,NDCG@5:0.0371) [40.7 s] 
INFO:root:Early stop at 25 based on dev result.
INFO:root:
Best Iter(dev)=    5	 dev=(HR@5:0.1549,NDCG@5:0.0952) test=(HR@5:0.1152,NDCG@5:0.0720) [2067.9 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.2102,HR@5:0.1152,HR@50:0.7091,NDCG@10:0.1023,NDCG@5:0.0720,NDCG@50:0.2121)
INFO:root:
--------------------------------------------- END: 2025-05-11 01:39:46 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-11 10:17:59 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2997766 0.6931139]
INFO:root:Epoch 1     loss=1.2998 [12.6 s]	 dev=(HR@5:0.1123,NDCG@5:0.0655) test=(HR@5:0.0718,NDCG@5:0.0415) [28.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2426369  0.69297606]
INFO:root:Epoch 2     loss=1.2426 [11.6 s]	 dev=(HR@5:0.1140,NDCG@5:0.0676) test=(HR@5:0.0732,NDCG@5:0.0429) [27.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2380412  0.69263333]
INFO:root:Epoch 3     loss=1.2380 [11.4 s]	 dev=(HR@5:0.1140,NDCG@5:0.0677) test=(HR@5:0.0738,NDCG@5:0.0434) [27.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2257574  0.69217896]
INFO:root:Epoch 4     loss=1.2258 [13.2 s]	 dev=(HR@5:0.1197,NDCG@5:0.0684) test=(HR@5:0.0801,NDCG@5:0.0455) [27.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1779264  0.69088894]
INFO:root:Epoch 5     loss=1.1779 [11.4 s]	 dev=(HR@5:0.1788,NDCG@5:0.1085) test=(HR@5:0.1244,NDCG@5:0.0768) [27.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.141806   0.68622786]
INFO:root:Epoch 6     loss=1.1418 [11.4 s]	 dev=(HR@5:0.1702,NDCG@5:0.1046) test=(HR@5:0.1339,NDCG@5:0.0822) [27.9 s] 
INFO:root:all_losses: [1.1072501  0.67499727]
INFO:root:Epoch 7     loss=1.1073 [11.3 s]	 dev=(HR@5:0.1929,NDCG@5:0.1145) test=(HR@5:0.1354,NDCG@5:0.0800) [27.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0576718 0.6456639]
INFO:root:Epoch 8     loss=1.0577 [11.4 s]	 dev=(HR@5:0.2145,NDCG@5:0.1315) test=(HR@5:0.1566,NDCG@5:0.0968) [28.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.96756893 0.5872648 ]
INFO:root:Epoch 9     loss=0.9676 [12.4 s]	 dev=(HR@5:0.2548,NDCG@5:0.1604) test=(HR@5:0.1857,NDCG@5:0.1188) [28.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8503264  0.51260287]
INFO:root:Epoch 10    loss=0.8503 [14.4 s]	 dev=(HR@5:0.3150,NDCG@5:0.2063) test=(HR@5:0.2361,NDCG@5:0.1528) [35.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.73222256 0.43407303]
INFO:root:Epoch 11    loss=0.7322 [15.0 s]	 dev=(HR@5:0.3368,NDCG@5:0.2205) test=(HR@5:0.2642,NDCG@5:0.1720) [35.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6283569  0.36405668]
INFO:root:Epoch 12    loss=0.6284 [15.1 s]	 dev=(HR@5:0.3945,NDCG@5:0.2630) test=(HR@5:0.3113,NDCG@5:0.2053) [35.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.540651  0.3039641]
INFO:root:Epoch 13    loss=0.5407 [15.0 s]	 dev=(HR@5:0.4086,NDCG@5:0.2726) test=(HR@5:0.3193,NDCG@5:0.2121) [35.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.47495395 0.26074046]
INFO:root:Epoch 14    loss=0.4750 [15.1 s]	 dev=(HR@5:0.4267,NDCG@5:0.2887) test=(HR@5:0.3382,NDCG@5:0.2245) [35.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4292447 0.2288303]
INFO:root:Epoch 15    loss=0.4292 [15.1 s]	 dev=(HR@5:0.4147,NDCG@5:0.2799) test=(HR@5:0.3235,NDCG@5:0.2187) [35.0 s] 
INFO:root:all_losses: [0.39244735 0.20235553]
INFO:root:Epoch 16    loss=0.3924 [15.1 s]	 dev=(HR@5:0.4349,NDCG@5:0.2947) test=(HR@5:0.3537,NDCG@5:0.2332) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35844097 0.18205516]
INFO:root:Epoch 17    loss=0.3584 [15.0 s]	 dev=(HR@5:0.4622,NDCG@5:0.3152) test=(HR@5:0.3827,NDCG@5:0.2552) [34.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.32070336 0.16220544]
INFO:root:Epoch 18    loss=0.3207 [15.0 s]	 dev=(HR@5:0.4532,NDCG@5:0.3136) test=(HR@5:0.3743,NDCG@5:0.2509) [34.7 s] 
INFO:root:all_losses: [0.30168623 0.1499187 ]
INFO:root:Epoch 19    loss=0.3017 [15.0 s]	 dev=(HR@5:0.4701,NDCG@5:0.3241) test=(HR@5:0.3898,NDCG@5:0.2632) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28481853 0.13882805]
INFO:root:Epoch 20    loss=0.2848 [15.1 s]	 dev=(HR@5:0.4877,NDCG@5:0.3355) test=(HR@5:0.4088,NDCG@5:0.2755) [34.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26423335 0.12956788]
INFO:root:Epoch 21    loss=0.2642 [15.0 s]	 dev=(HR@5:0.4722,NDCG@5:0.3234) test=(HR@5:0.3992,NDCG@5:0.2695) [34.7 s] 
INFO:root:all_losses: [0.25196847 0.12063619]
INFO:root:Epoch 22    loss=0.2520 [15.1 s]	 dev=(HR@5:0.4799,NDCG@5:0.3326) test=(HR@5:0.4118,NDCG@5:0.2764) [34.6 s] 
INFO:root:all_losses: [0.24116825 0.11457653]
INFO:root:Epoch 23    loss=0.2412 [15.1 s]	 dev=(HR@5:0.4767,NDCG@5:0.3320) test=(HR@5:0.4096,NDCG@5:0.2781) [34.6 s] 
INFO:root:all_losses: [0.22522266 0.10830458]
INFO:root:Epoch 24    loss=0.2252 [15.1 s]	 dev=(HR@5:0.4716,NDCG@5:0.3288) test=(HR@5:0.3927,NDCG@5:0.2670) [34.6 s] 
INFO:root:all_losses: [0.21477057 0.10392269]
INFO:root:Epoch 25    loss=0.2148 [15.0 s]	 dev=(HR@5:0.4803,NDCG@5:0.3341) test=(HR@5:0.4018,NDCG@5:0.2761) [34.6 s] 
INFO:root:all_losses: [0.20967472 0.10046405]
INFO:root:Epoch 26    loss=0.2097 [15.0 s]	 dev=(HR@5:0.4805,NDCG@5:0.3365) test=(HR@5:0.4016,NDCG@5:0.2786) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19795091 0.09359914]
INFO:root:Epoch 27    loss=0.1980 [15.1 s]	 dev=(HR@5:0.5040,NDCG@5:0.3528) test=(HR@5:0.4381,NDCG@5:0.3002) [34.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19102171 0.0912117 ]
INFO:root:Epoch 28    loss=0.1910 [15.0 s]	 dev=(HR@5:0.4712,NDCG@5:0.3312) test=(HR@5:0.4018,NDCG@5:0.2752) [34.2 s] 
INFO:root:all_losses: [0.18305849 0.08927061]
INFO:root:Epoch 29    loss=0.1831 [15.1 s]	 dev=(HR@5:0.4722,NDCG@5:0.3342) test=(HR@5:0.4010,NDCG@5:0.2813) [34.5 s] 
INFO:root:all_losses: [0.1781531  0.08731432]
INFO:root:Epoch 30    loss=0.1782 [15.1 s]	 dev=(HR@5:0.4987,NDCG@5:0.3516) test=(HR@5:0.4230,NDCG@5:0.2925) [34.5 s] 
INFO:root:all_losses: [0.17549384 0.08293789]
INFO:root:Epoch 31    loss=0.1755 [15.1 s]	 dev=(HR@5:0.4813,NDCG@5:0.3425) test=(HR@5:0.4116,NDCG@5:0.2846) [34.5 s] 
INFO:root:all_losses: [0.17521837 0.08389506]
INFO:root:Epoch 32    loss=0.1752 [15.0 s]	 dev=(HR@5:0.4942,NDCG@5:0.3480) test=(HR@5:0.4473,NDCG@5:0.3072) [34.2 s] 
INFO:root:all_losses: [0.16374491 0.08033323]
INFO:root:Epoch 33    loss=0.1637 [15.0 s]	 dev=(HR@5:0.4815,NDCG@5:0.3436) test=(HR@5:0.4194,NDCG@5:0.2895) [34.2 s] 
INFO:root:all_losses: [0.15881708 0.07749044]
INFO:root:Epoch 34    loss=0.1588 [15.1 s]	 dev=(HR@5:0.4887,NDCG@5:0.3450) test=(HR@5:0.4045,NDCG@5:0.2827) [34.3 s] 
INFO:root:all_losses: [0.15602894 0.07746546]
INFO:root:Epoch 35    loss=0.1560 [15.0 s]	 dev=(HR@5:0.5083,NDCG@5:0.3590) test=(HR@5:0.4471,NDCG@5:0.3093) [34.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15099213 0.07284315]
INFO:root:Epoch 36    loss=0.1510 [15.0 s]	 dev=(HR@5:0.5013,NDCG@5:0.3532) test=(HR@5:0.4414,NDCG@5:0.3044) [34.3 s] 
INFO:root:all_losses: [0.14926274 0.07294018]
INFO:root:Epoch 37    loss=0.1493 [14.9 s]	 dev=(HR@5:0.5138,NDCG@5:0.3602) test=(HR@5:0.4659,NDCG@5:0.3230) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14589506 0.07252774]
INFO:root:Epoch 38    loss=0.1459 [15.0 s]	 dev=(HR@5:0.5109,NDCG@5:0.3626) test=(HR@5:0.4534,NDCG@5:0.3139) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13958336 0.07066401]
INFO:root:Epoch 39    loss=0.1396 [14.9 s]	 dev=(HR@5:0.5142,NDCG@5:0.3647) test=(HR@5:0.4642,NDCG@5:0.3200) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14128481 0.06912506]
INFO:root:Epoch 40    loss=0.1413 [15.1 s]	 dev=(HR@5:0.5036,NDCG@5:0.3560) test=(HR@5:0.4510,NDCG@5:0.3130) [34.0 s] 
INFO:root:all_losses: [0.13799879 0.06739209]
INFO:root:Epoch 41    loss=0.1380 [15.0 s]	 dev=(HR@5:0.4608,NDCG@5:0.3266) test=(HR@5:0.3957,NDCG@5:0.2738) [34.1 s] 
INFO:root:all_losses: [0.1352478  0.06935804]
INFO:root:Epoch 42    loss=0.1352 [15.1 s]	 dev=(HR@5:0.4942,NDCG@5:0.3523) test=(HR@5:0.4234,NDCG@5:0.2920) [33.9 s] 
INFO:root:all_losses: [0.1324937  0.06419992]
INFO:root:Epoch 43    loss=0.1325 [15.1 s]	 dev=(HR@5:0.4742,NDCG@5:0.3355) test=(HR@5:0.4116,NDCG@5:0.2888) [34.0 s] 
INFO:root:all_losses: [0.13261025 0.06509049]
INFO:root:Epoch 44    loss=0.1326 [15.0 s]	 dev=(HR@5:0.5060,NDCG@5:0.3597) test=(HR@5:0.4402,NDCG@5:0.3072) [34.1 s] 
INFO:root:all_losses: [0.12747924 0.06321263]
INFO:root:Epoch 45    loss=0.1275 [14.9 s]	 dev=(HR@5:0.5011,NDCG@5:0.3524) test=(HR@5:0.4338,NDCG@5:0.3027) [34.1 s] 
INFO:root:all_losses: [0.1264784 0.0650277]
INFO:root:Epoch 46    loss=0.1265 [15.0 s]	 dev=(HR@5:0.5001,NDCG@5:0.3553) test=(HR@5:0.4385,NDCG@5:0.3043) [34.1 s] 
INFO:root:all_losses: [0.12073244 0.06018694]
INFO:root:Epoch 47    loss=0.1207 [15.0 s]	 dev=(HR@5:0.5068,NDCG@5:0.3531) test=(HR@5:0.4487,NDCG@5:0.3079) [34.1 s] 
INFO:root:all_losses: [0.12367081 0.06164265]
INFO:root:Epoch 48    loss=0.1237 [15.0 s]	 dev=(HR@5:0.5162,NDCG@5:0.3671) test=(HR@5:0.4473,NDCG@5:0.3163) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11988328 0.05931884]
INFO:root:Epoch 49    loss=0.1199 [15.0 s]	 dev=(HR@5:0.5034,NDCG@5:0.3557) test=(HR@5:0.4389,NDCG@5:0.3076) [34.2 s] 
INFO:root:all_losses: [0.1174966  0.05991771]
INFO:root:Epoch 50    loss=0.1175 [14.9 s]	 dev=(HR@5:0.5032,NDCG@5:0.3602) test=(HR@5:0.4504,NDCG@5:0.3152) [34.1 s] 
INFO:root:all_losses: [0.11729889 0.05849055]
INFO:root:Epoch 51    loss=0.1173 [15.0 s]	 dev=(HR@5:0.4762,NDCG@5:0.3395) test=(HR@5:0.4112,NDCG@5:0.2882) [34.1 s] 
INFO:root:all_losses: [0.11454535 0.05783579]
INFO:root:Epoch 52    loss=0.1145 [15.1 s]	 dev=(HR@5:0.5007,NDCG@5:0.3601) test=(HR@5:0.4420,NDCG@5:0.3060) [33.9 s] 
INFO:root:all_losses: [0.11203588 0.05658645]
INFO:root:Epoch 53    loss=0.1120 [14.9 s]	 dev=(HR@5:0.4938,NDCG@5:0.3503) test=(HR@5:0.4359,NDCG@5:0.3039) [34.1 s] 
INFO:root:all_losses: [0.11329491 0.05766583]
INFO:root:Epoch 54    loss=0.1133 [15.0 s]	 dev=(HR@5:0.5050,NDCG@5:0.3564) test=(HR@5:0.4522,NDCG@5:0.3117) [33.9 s] 
INFO:root:all_losses: [0.11127777 0.05657918]
INFO:root:Epoch 55    loss=0.1113 [14.9 s]	 dev=(HR@5:0.4864,NDCG@5:0.3468) test=(HR@5:0.4334,NDCG@5:0.3050) [33.9 s] 
INFO:root:all_losses: [0.11360968 0.0570516 ]
INFO:root:Epoch 56    loss=0.1136 [15.0 s]	 dev=(HR@5:0.4905,NDCG@5:0.3474) test=(HR@5:0.4359,NDCG@5:0.3039) [33.9 s] 
INFO:root:all_losses: [0.10648157 0.05424504]
INFO:root:Epoch 57    loss=0.1065 [15.1 s]	 dev=(HR@5:0.4999,NDCG@5:0.3541) test=(HR@5:0.4555,NDCG@5:0.3162) [34.0 s] 
INFO:root:all_losses: [0.10529157 0.05294987]
INFO:root:Epoch 58    loss=0.1053 [15.0 s]	 dev=(HR@5:0.4903,NDCG@5:0.3468) test=(HR@5:0.4396,NDCG@5:0.3077) [33.8 s] 
INFO:root:all_losses: [0.10755325 0.05587001]
INFO:root:Epoch 59    loss=0.1076 [15.0 s]	 dev=(HR@5:0.4866,NDCG@5:0.3438) test=(HR@5:0.4542,NDCG@5:0.3142) [33.7 s] 
INFO:root:all_losses: [0.10215282 0.05245838]
INFO:root:Epoch 60    loss=0.1022 [15.0 s]	 dev=(HR@5:0.4911,NDCG@5:0.3486) test=(HR@5:0.4275,NDCG@5:0.2986) [33.7 s] 
INFO:root:all_losses: [0.09828305 0.04935924]
INFO:root:Epoch 61    loss=0.0983 [15.1 s]	 dev=(HR@5:0.4970,NDCG@5:0.3537) test=(HR@5:0.4383,NDCG@5:0.3049) [34.0 s] 
INFO:root:all_losses: [0.1054232 0.0527775]
INFO:root:Epoch 62    loss=0.1054 [15.1 s]	 dev=(HR@5:0.5011,NDCG@5:0.3564) test=(HR@5:0.4440,NDCG@5:0.3052) [33.7 s] 
INFO:root:all_losses: [0.09727816 0.04949357]
INFO:root:Epoch 63    loss=0.0973 [15.1 s]	 dev=(HR@5:0.5009,NDCG@5:0.3573) test=(HR@5:0.4654,NDCG@5:0.3240) [33.7 s] 
INFO:root:all_losses: [0.09642196 0.04951315]
INFO:root:Epoch 64    loss=0.0964 [14.9 s]	 dev=(HR@5:0.5019,NDCG@5:0.3589) test=(HR@5:0.4518,NDCG@5:0.3145) [33.9 s] 
INFO:root:all_losses: [0.09370605 0.04797333]
INFO:root:Epoch 65    loss=0.0937 [15.0 s]	 dev=(HR@5:0.4881,NDCG@5:0.3512) test=(HR@5:0.4381,NDCG@5:0.3058) [33.9 s] 
INFO:root:all_losses: [0.09664255 0.04964411]
INFO:root:Epoch 66    loss=0.0966 [15.0 s]	 dev=(HR@5:0.5009,NDCG@5:0.3558) test=(HR@5:0.4485,NDCG@5:0.3126) [33.7 s] 
INFO:root:all_losses: [0.09896393 0.05074379]
INFO:root:Epoch 67    loss=0.0990 [15.0 s]	 dev=(HR@5:0.4991,NDCG@5:0.3562) test=(HR@5:0.4481,NDCG@5:0.3085) [33.6 s] 
INFO:root:all_losses: [0.09455861 0.04820597]
INFO:root:Epoch 68    loss=0.0946 [15.1 s]	 dev=(HR@5:0.5054,NDCG@5:0.3602) test=(HR@5:0.4491,NDCG@5:0.3107) [33.6 s] 
INFO:root:Early stop at 68 based on dev result.
INFO:root:
Best Iter(dev)=   48	 dev=(HR@5:0.5162,NDCG@5:0.3671) test=(HR@5:0.4473,NDCG@5:0.3163) [3266.2 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6098,HR@5:0.4473,HR@50:0.8838,NDCG@10:0.3689,NDCG@5:0.3163,NDCG@50:0.4304)
INFO:root:
--------------------------------------------- END: 2025-05-11 11:12:57 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-12 10:19:19 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 517184
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0936,HR@5:0.0467,HR@50:0.4685,NDCG@10:0.0419,NDCG@5:0.0271,NDCG@50:0.1191)
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-12 20:34:37 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-12 20:38:46 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5034,NDCG@10:0.0442,NDCG@5:0.0281,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3003373 0.6931162]
INFO:root:Epoch 1     loss=1.3003 [25.4 s]	 dev=(HR@5:0.1060,NDCG@5:0.0622) test=(HR@5:0.0712,NDCG@5:0.0411) [31.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.244318   0.69295335]
INFO:root:Epoch 2     loss=1.2443 [25.6 s]	 dev=(HR@5:0.1176,NDCG@5:0.0704) test=(HR@5:0.0720,NDCG@5:0.0431) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2411221  0.69262415]
INFO:root:Epoch 3     loss=1.2411 [25.6 s]	 dev=(HR@5:0.1109,NDCG@5:0.0642) test=(HR@5:0.0783,NDCG@5:0.0432) [31.7 s] 
INFO:root:all_losses: [1.2317733  0.69228923]
INFO:root:Epoch 4     loss=1.2318 [27.7 s]	 dev=(HR@5:0.1178,NDCG@5:0.0687) test=(HR@5:0.0840,NDCG@5:0.0466) [31.2 s] 
INFO:root:all_losses: [1.1857042 0.6910123]
INFO:root:Epoch 5     loss=1.1857 [24.1 s]	 dev=(HR@5:0.1645,NDCG@5:0.1015) test=(HR@5:0.1264,NDCG@5:0.0791) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.147526   0.68613017]
INFO:root:Epoch 6     loss=1.1475 [24.1 s]	 dev=(HR@5:0.1792,NDCG@5:0.1100) test=(HR@5:0.1360,NDCG@5:0.0844) [31.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.114668   0.67440015]
INFO:root:Epoch 7     loss=1.1147 [24.1 s]	 dev=(HR@5:0.1920,NDCG@5:0.1202) test=(HR@5:0.1413,NDCG@5:0.0901) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0714817  0.64362514]
INFO:root:Epoch 8     loss=1.0715 [24.3 s]	 dev=(HR@5:0.1867,NDCG@5:0.1160) test=(HR@5:0.1309,NDCG@5:0.0835) [30.9 s] 
INFO:root:all_losses: [1.000671  0.5877572]
INFO:root:Epoch 9     loss=1.0007 [25.6 s]	 dev=(HR@5:0.2073,NDCG@5:0.1311) test=(HR@5:0.1527,NDCG@5:0.0960) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9049116 0.5213647]
INFO:root:Epoch 10    loss=0.9049 [27.1 s]	 dev=(HR@5:0.2255,NDCG@5:0.1420) test=(HR@5:0.1617,NDCG@5:0.1047) [37.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8101334  0.45893112]
INFO:root:Epoch 11    loss=0.8101 [27.7 s]	 dev=(HR@5:0.2862,NDCG@5:0.1841) test=(HR@5:0.2230,NDCG@5:0.1414) [37.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.7253127 0.4001882]
INFO:root:Epoch 12    loss=0.7253 [27.5 s]	 dev=(HR@5:0.2903,NDCG@5:0.1826) test=(HR@5:0.2084,NDCG@5:0.1321) [37.4 s] 
INFO:root:all_losses: [0.6389171  0.34097373]
INFO:root:Epoch 13    loss=0.6389 [27.2 s]	 dev=(HR@5:0.3258,NDCG@5:0.2066) test=(HR@5:0.2444,NDCG@5:0.1564) [37.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.56896824 0.29627082]
INFO:root:Epoch 14    loss=0.5690 [27.0 s]	 dev=(HR@5:0.3533,NDCG@5:0.2293) test=(HR@5:0.2671,NDCG@5:0.1753) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.51614726 0.26151714]
INFO:root:Epoch 15    loss=0.5161 [27.1 s]	 dev=(HR@5:0.3523,NDCG@5:0.2305) test=(HR@5:0.2675,NDCG@5:0.1740) [37.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4742377  0.23117553]
INFO:root:Epoch 16    loss=0.4742 [26.9 s]	 dev=(HR@5:0.3808,NDCG@5:0.2524) test=(HR@5:0.2979,NDCG@5:0.1972) [37.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.43962088 0.20562293]
INFO:root:Epoch 17    loss=0.4396 [27.1 s]	 dev=(HR@5:0.3949,NDCG@5:0.2612) test=(HR@5:0.3127,NDCG@5:0.2035) [37.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3937359  0.18128657]
INFO:root:Epoch 18    loss=0.3937 [27.2 s]	 dev=(HR@5:0.4236,NDCG@5:0.2826) test=(HR@5:0.3303,NDCG@5:0.2196) [37.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.3747656  0.16835631]
INFO:root:Epoch 19    loss=0.3748 [27.3 s]	 dev=(HR@5:0.4267,NDCG@5:0.2865) test=(HR@5:0.3452,NDCG@5:0.2314) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35248    0.15544267]
INFO:root:Epoch 20    loss=0.3525 [27.4 s]	 dev=(HR@5:0.4404,NDCG@5:0.3001) test=(HR@5:0.3710,NDCG@5:0.2446) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33103862 0.14530604]
INFO:root:Epoch 21    loss=0.3310 [27.6 s]	 dev=(HR@5:0.4239,NDCG@5:0.2851) test=(HR@5:0.3441,NDCG@5:0.2291) [36.5 s] 
INFO:root:all_losses: [0.31709138 0.13446957]
INFO:root:Epoch 22    loss=0.3171 [27.5 s]	 dev=(HR@5:0.4361,NDCG@5:0.3018) test=(HR@5:0.3660,NDCG@5:0.2447) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.30502987 0.12738173]
INFO:root:Epoch 23    loss=0.3050 [27.6 s]	 dev=(HR@5:0.4398,NDCG@5:0.3037) test=(HR@5:0.3592,NDCG@5:0.2428) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2837487  0.11920905]
INFO:root:Epoch 24    loss=0.2837 [27.8 s]	 dev=(HR@5:0.4499,NDCG@5:0.3084) test=(HR@5:0.3649,NDCG@5:0.2463) [36.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.27615127 0.11490275]
INFO:root:Epoch 25    loss=0.2762 [27.7 s]	 dev=(HR@5:0.4620,NDCG@5:0.3135) test=(HR@5:0.3796,NDCG@5:0.2564) [36.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2676402  0.11034665]
INFO:root:Epoch 26    loss=0.2676 [27.7 s]	 dev=(HR@5:0.4693,NDCG@5:0.3214) test=(HR@5:0.3971,NDCG@5:0.2686) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.25282577 0.10371773]
INFO:root:Epoch 27    loss=0.2528 [27.5 s]	 dev=(HR@5:0.4683,NDCG@5:0.3191) test=(HR@5:0.4057,NDCG@5:0.2700) [36.7 s] 
INFO:root:all_losses: [0.24375571 0.10025865]
INFO:root:Epoch 28    loss=0.2438 [27.8 s]	 dev=(HR@5:0.4652,NDCG@5:0.3189) test=(HR@5:0.3759,NDCG@5:0.2537) [36.3 s] 
INFO:root:all_losses: [0.23640414 0.09719828]
INFO:root:Epoch 29    loss=0.2364 [27.8 s]	 dev=(HR@5:0.4891,NDCG@5:0.3380) test=(HR@5:0.4004,NDCG@5:0.2693) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23007031 0.09535194]
INFO:root:Epoch 30    loss=0.2301 [27.8 s]	 dev=(HR@5:0.4791,NDCG@5:0.3346) test=(HR@5:0.4000,NDCG@5:0.2730) [36.4 s] 
INFO:root:all_losses: [0.22699021 0.0915756 ]
INFO:root:Epoch 31    loss=0.2270 [27.6 s]	 dev=(HR@5:0.4877,NDCG@5:0.3392) test=(HR@5:0.4128,NDCG@5:0.2819) [36.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22092678 0.09271182]
INFO:root:Epoch 32    loss=0.2209 [27.7 s]	 dev=(HR@5:0.4970,NDCG@5:0.3435) test=(HR@5:0.4290,NDCG@5:0.2923) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21020688 0.08752587]
INFO:root:Epoch 33    loss=0.2102 [27.9 s]	 dev=(HR@5:0.4758,NDCG@5:0.3302) test=(HR@5:0.3835,NDCG@5:0.2658) [36.3 s] 
INFO:root:all_losses: [0.20139253 0.08372185]
INFO:root:Epoch 34    loss=0.2014 [27.8 s]	 dev=(HR@5:0.5013,NDCG@5:0.3472) test=(HR@5:0.4381,NDCG@5:0.2959) [36.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.2037375 0.0839492]
INFO:root:Epoch 35    loss=0.2037 [27.6 s]	 dev=(HR@5:0.5017,NDCG@5:0.3483) test=(HR@5:0.4381,NDCG@5:0.2981) [36.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19448504 0.08047196]
INFO:root:Epoch 36    loss=0.1945 [27.4 s]	 dev=(HR@5:0.5011,NDCG@5:0.3475) test=(HR@5:0.4304,NDCG@5:0.2959) [36.1 s] 
INFO:root:all_losses: [0.19192551 0.07960986]
INFO:root:Epoch 37    loss=0.1919 [27.5 s]	 dev=(HR@5:0.4724,NDCG@5:0.3273) test=(HR@5:0.3884,NDCG@5:0.2670) [36.1 s] 
INFO:root:all_losses: [0.18696283 0.07937364]
INFO:root:Epoch 38    loss=0.1870 [27.5 s]	 dev=(HR@5:0.4956,NDCG@5:0.3471) test=(HR@5:0.4216,NDCG@5:0.2913) [36.2 s] 
INFO:root:all_losses: [0.1806568  0.07636132]
INFO:root:Epoch 39    loss=0.1807 [27.5 s]	 dev=(HR@5:0.4889,NDCG@5:0.3434) test=(HR@5:0.3976,NDCG@5:0.2776) [36.2 s] 
INFO:root:all_losses: [0.18414298 0.07420214]
INFO:root:Epoch 40    loss=0.1841 [27.6 s]	 dev=(HR@5:0.4801,NDCG@5:0.3337) test=(HR@5:0.4000,NDCG@5:0.2769) [36.2 s] 
INFO:root:all_losses: [0.1777243  0.07414994]
INFO:root:Epoch 41    loss=0.1777 [27.6 s]	 dev=(HR@5:0.4862,NDCG@5:0.3409) test=(HR@5:0.4010,NDCG@5:0.2784) [36.3 s] 
INFO:root:all_losses: [0.17245784 0.0742989 ]
INFO:root:Epoch 42    loss=0.1725 [27.7 s]	 dev=(HR@5:0.4797,NDCG@5:0.3327) test=(HR@5:0.4124,NDCG@5:0.2833) [36.0 s] 
INFO:root:all_losses: [0.1706408  0.07012088]
INFO:root:Epoch 43    loss=0.1706 [27.7 s]	 dev=(HR@5:0.5076,NDCG@5:0.3534) test=(HR@5:0.4410,NDCG@5:0.3010) [36.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.16695367 0.07034278]
INFO:root:Epoch 44    loss=0.1670 [27.7 s]	 dev=(HR@5:0.4922,NDCG@5:0.3443) test=(HR@5:0.4198,NDCG@5:0.2898) [36.2 s] 
INFO:root:all_losses: [0.16306715 0.06816358]
INFO:root:Epoch 45    loss=0.1631 [27.7 s]	 dev=(HR@5:0.4917,NDCG@5:0.3452) test=(HR@5:0.4179,NDCG@5:0.2892) [36.2 s] 
INFO:root:all_losses: [0.1605155  0.07024382]
INFO:root:Epoch 46    loss=0.1605 [27.6 s]	 dev=(HR@5:0.4840,NDCG@5:0.3360) test=(HR@5:0.4118,NDCG@5:0.2822) [36.1 s] 
INFO:root:all_losses: [0.15746462 0.06614243]
INFO:root:Epoch 47    loss=0.1575 [27.7 s]	 dev=(HR@5:0.5017,NDCG@5:0.3492) test=(HR@5:0.4328,NDCG@5:0.2961) [36.3 s] 
INFO:root:all_losses: [0.15994494 0.06701032]
INFO:root:Epoch 48    loss=0.1599 [27.7 s]	 dev=(HR@5:0.4993,NDCG@5:0.3519) test=(HR@5:0.4340,NDCG@5:0.3028) [36.0 s] 
INFO:root:all_losses: [0.15702525 0.06466531]
INFO:root:Epoch 49    loss=0.1570 [27.5 s]	 dev=(HR@5:0.5048,NDCG@5:0.3500) test=(HR@5:0.4338,NDCG@5:0.2979) [36.1 s] 
INFO:root:all_losses: [0.15166914 0.06507023]
INFO:root:Epoch 50    loss=0.1517 [27.7 s]	 dev=(HR@5:0.4956,NDCG@5:0.3489) test=(HR@5:0.4261,NDCG@5:0.2952) [36.1 s] 
INFO:root:all_losses: [0.14972931 0.06365853]
INFO:root:Epoch 51    loss=0.1497 [27.7 s]	 dev=(HR@5:0.4983,NDCG@5:0.3533) test=(HR@5:0.4294,NDCG@5:0.3002) [36.1 s] 
INFO:root:all_losses: [0.14678954 0.06248334]
INFO:root:Epoch 52    loss=0.1468 [27.4 s]	 dev=(HR@5:0.5040,NDCG@5:0.3526) test=(HR@5:0.4463,NDCG@5:0.3101) [36.0 s] 
INFO:root:all_losses: [0.14426036 0.06225322]
INFO:root:Epoch 53    loss=0.1443 [27.6 s]	 dev=(HR@5:0.4952,NDCG@5:0.3491) test=(HR@5:0.4375,NDCG@5:0.3034) [36.3 s] 
INFO:root:all_losses: [0.14587645 0.06231826]
INFO:root:Epoch 54    loss=0.1459 [27.8 s]	 dev=(HR@5:0.5032,NDCG@5:0.3522) test=(HR@5:0.4294,NDCG@5:0.3001) [36.2 s] 
INFO:root:all_losses: [0.14093584 0.06082501]
INFO:root:Epoch 55    loss=0.1409 [28.0 s]	 dev=(HR@5:0.4952,NDCG@5:0.3421) test=(HR@5:0.4365,NDCG@5:0.3034) [36.2 s] 
INFO:root:all_losses: [0.14691971 0.06226139]
INFO:root:Epoch 56    loss=0.1469 [27.8 s]	 dev=(HR@5:0.5032,NDCG@5:0.3512) test=(HR@5:0.4351,NDCG@5:0.3043) [36.0 s] 
INFO:root:all_losses: [0.13875061 0.06007861]
INFO:root:Epoch 57    loss=0.1388 [27.8 s]	 dev=(HR@5:0.4958,NDCG@5:0.3447) test=(HR@5:0.4300,NDCG@5:0.2987) [36.1 s] 
INFO:root:all_losses: [0.1362568  0.05822634]
INFO:root:Epoch 58    loss=0.1363 [27.8 s]	 dev=(HR@5:0.4781,NDCG@5:0.3356) test=(HR@5:0.4053,NDCG@5:0.2815) [36.1 s] 
INFO:root:all_losses: [0.13763747 0.05963257]
INFO:root:Epoch 59    loss=0.1376 [27.6 s]	 dev=(HR@5:0.4862,NDCG@5:0.3408) test=(HR@5:0.4175,NDCG@5:0.2891) [36.1 s] 
INFO:root:all_losses: [0.13003445 0.05705524]
INFO:root:Epoch 60    loss=0.1300 [27.9 s]	 dev=(HR@5:0.4828,NDCG@5:0.3410) test=(HR@5:0.4155,NDCG@5:0.2874) [36.0 s] 
INFO:root:all_losses: [0.12927657 0.05403219]
INFO:root:Epoch 61    loss=0.1293 [28.0 s]	 dev=(HR@5:0.5068,NDCG@5:0.3577) test=(HR@5:0.4389,NDCG@5:0.3041) [36.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.13315107 0.05871747]
INFO:root:Epoch 62    loss=0.1332 [27.9 s]	 dev=(HR@5:0.5087,NDCG@5:0.3573) test=(HR@5:0.4565,NDCG@5:0.3179) [36.2 s] 
INFO:root:all_losses: [0.12744106 0.05567749]
INFO:root:Epoch 63    loss=0.1274 [27.8 s]	 dev=(HR@5:0.5054,NDCG@5:0.3563) test=(HR@5:0.4424,NDCG@5:0.3124) [36.1 s] 
INFO:root:all_losses: [0.12335276 0.05410003]
INFO:root:Epoch 64    loss=0.1234 [27.9 s]	 dev=(HR@5:0.4964,NDCG@5:0.3499) test=(HR@5:0.4204,NDCG@5:0.2957) [36.3 s] 
INFO:root:all_losses: [0.1258423  0.05245701]
INFO:root:Epoch 65    loss=0.1258 [27.9 s]	 dev=(HR@5:0.5044,NDCG@5:0.3521) test=(HR@5:0.4418,NDCG@5:0.3030) [36.2 s] 
INFO:root:all_losses: [0.12774533 0.0546811 ]
INFO:root:Epoch 66    loss=0.1277 [27.5 s]	 dev=(HR@5:0.5040,NDCG@5:0.3510) test=(HR@5:0.4465,NDCG@5:0.3064) [36.0 s] 
INFO:root:all_losses: [0.12898192 0.05506048]
INFO:root:Epoch 67    loss=0.1290 [27.7 s]	 dev=(HR@5:0.4991,NDCG@5:0.3496) test=(HR@5:0.4367,NDCG@5:0.3039) [36.2 s] 
INFO:root:all_losses: [0.12334417 0.05312383]
INFO:root:Epoch 68    loss=0.1233 [27.6 s]	 dev=(HR@5:0.5078,NDCG@5:0.3591) test=(HR@5:0.4502,NDCG@5:0.3116) [35.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12139142 0.05371389]
INFO:root:Epoch 69    loss=0.1214 [27.9 s]	 dev=(HR@5:0.5072,NDCG@5:0.3574) test=(HR@5:0.4512,NDCG@5:0.3127) [36.0 s] 
INFO:root:all_losses: [0.12613253 0.05533143]
INFO:root:Epoch 70    loss=0.1261 [27.7 s]	 dev=(HR@5:0.4975,NDCG@5:0.3492) test=(HR@5:0.4251,NDCG@5:0.2965) [36.0 s] 
INFO:root:all_losses: [0.11905877 0.05294067]
INFO:root:Epoch 71    loss=0.1191 [27.9 s]	 dev=(HR@5:0.5087,NDCG@5:0.3588) test=(HR@5:0.4426,NDCG@5:0.3067) [36.0 s] 
INFO:root:all_losses: [0.11583181 0.05226608]
INFO:root:Epoch 72    loss=0.1158 [27.8 s]	 dev=(HR@5:0.5015,NDCG@5:0.3546) test=(HR@5:0.4300,NDCG@5:0.3052) [36.0 s] 
INFO:root:all_losses: [0.11541218 0.05105787]
INFO:root:Epoch 73    loss=0.1154 [28.0 s]	 dev=(HR@5:0.5025,NDCG@5:0.3576) test=(HR@5:0.4226,NDCG@5:0.2983) [36.2 s] 
INFO:root:all_losses: [0.11541249 0.05145719]
INFO:root:Epoch 74    loss=0.1154 [28.2 s]	 dev=(HR@5:0.4987,NDCG@5:0.3526) test=(HR@5:0.4249,NDCG@5:0.2998) [36.0 s] 
INFO:root:all_losses: [0.11546545 0.0509349 ]
INFO:root:Epoch 75    loss=0.1155 [28.1 s]	 dev=(HR@5:0.4877,NDCG@5:0.3454) test=(HR@5:0.4151,NDCG@5:0.2904) [36.1 s] 
INFO:root:all_losses: [0.11527943 0.05093916]
INFO:root:Epoch 76    loss=0.1153 [28.1 s]	 dev=(HR@5:0.5070,NDCG@5:0.3604) test=(HR@5:0.4426,NDCG@5:0.3106) [36.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11369113 0.04992305]
INFO:root:Epoch 77    loss=0.1137 [28.2 s]	 dev=(HR@5:0.5068,NDCG@5:0.3569) test=(HR@5:0.4355,NDCG@5:0.3087) [36.0 s] 
INFO:root:all_losses: [0.11452544 0.05134513]
INFO:root:Epoch 78    loss=0.1145 [27.9 s]	 dev=(HR@5:0.4985,NDCG@5:0.3512) test=(HR@5:0.4277,NDCG@5:0.3021) [35.7 s] 
INFO:root:all_losses: [0.11236636 0.04992214]
INFO:root:Epoch 79    loss=0.1124 [28.0 s]	 dev=(HR@5:0.5001,NDCG@5:0.3538) test=(HR@5:0.4300,NDCG@5:0.3046) [35.8 s] 
INFO:root:all_losses: [0.1108393  0.04932968]
INFO:root:Epoch 80    loss=0.1108 [28.1 s]	 dev=(HR@5:0.4948,NDCG@5:0.3499) test=(HR@5:0.4304,NDCG@5:0.3043) [36.1 s] 
INFO:root:all_losses: [0.11497447 0.05177414]
INFO:root:Epoch 81    loss=0.1150 [28.0 s]	 dev=(HR@5:0.5025,NDCG@5:0.3554) test=(HR@5:0.4265,NDCG@5:0.3023) [36.2 s] 
INFO:root:all_losses: [0.1123287 0.0504928]
INFO:root:Epoch 82    loss=0.1123 [28.1 s]	 dev=(HR@5:0.4893,NDCG@5:0.3507) test=(HR@5:0.4179,NDCG@5:0.2981) [35.8 s] 
INFO:root:all_losses: [0.1099298  0.04939008]
INFO:root:Epoch 83    loss=0.1099 [28.1 s]	 dev=(HR@5:0.4985,NDCG@5:0.3548) test=(HR@5:0.4446,NDCG@5:0.3133) [35.8 s] 
INFO:root:all_losses: [0.11047212 0.05030626]
INFO:root:Epoch 84    loss=0.1105 [28.3 s]	 dev=(HR@5:0.4922,NDCG@5:0.3510) test=(HR@5:0.4369,NDCG@5:0.3053) [36.1 s] 
INFO:root:all_losses: [0.10921024 0.04850268]
INFO:root:Epoch 85    loss=0.1092 [28.3 s]	 dev=(HR@5:0.5044,NDCG@5:0.3552) test=(HR@5:0.4591,NDCG@5:0.3186) [35.5 s] 
INFO:root:all_losses: [0.10686809 0.04770001]
INFO:root:Epoch 86    loss=0.1069 [28.2 s]	 dev=(HR@5:0.4856,NDCG@5:0.3471) test=(HR@5:0.4151,NDCG@5:0.2930) [35.9 s] 
INFO:root:all_losses: [0.10810483 0.04882857]
INFO:root:Epoch 87    loss=0.1081 [27.9 s]	 dev=(HR@5:0.4964,NDCG@5:0.3550) test=(HR@5:0.4320,NDCG@5:0.3002) [35.6 s] 
INFO:root:all_losses: [0.10555489 0.04800975]
INFO:root:Epoch 88    loss=0.1056 [28.2 s]	 dev=(HR@5:0.4926,NDCG@5:0.3519) test=(HR@5:0.4206,NDCG@5:0.2969) [35.9 s] 
INFO:root:all_losses: [0.10705805 0.04816448]
INFO:root:Epoch 89    loss=0.1071 [28.2 s]	 dev=(HR@5:0.5009,NDCG@5:0.3568) test=(HR@5:0.4424,NDCG@5:0.3098) [35.6 s] 
INFO:root:all_losses: [0.10384981 0.04661275]
INFO:root:Epoch 90    loss=0.1038 [28.3 s]	 dev=(HR@5:0.4846,NDCG@5:0.3422) test=(HR@5:0.4200,NDCG@5:0.2947) [35.7 s] 
INFO:root:all_losses: [0.1040808 0.0466684]
INFO:root:Epoch 91    loss=0.1041 [28.1 s]	 dev=(HR@5:0.5032,NDCG@5:0.3541) test=(HR@5:0.4353,NDCG@5:0.3072) [35.6 s] 
INFO:root:all_losses: [0.10149158 0.0464615 ]
INFO:root:Epoch 92    loss=0.1015 [28.0 s]	 dev=(HR@5:0.4712,NDCG@5:0.3340) test=(HR@5:0.4010,NDCG@5:0.2840) [36.1 s] 
INFO:root:all_losses: [0.10267405 0.04521934]
INFO:root:Epoch 93    loss=0.1027 [28.0 s]	 dev=(HR@5:0.4940,NDCG@5:0.3494) test=(HR@5:0.4292,NDCG@5:0.2990) [35.4 s] 
INFO:root:all_losses: [0.10418659 0.04633077]
INFO:root:Epoch 94    loss=0.1042 [28.0 s]	 dev=(HR@5:0.4871,NDCG@5:0.3448) test=(HR@5:0.4190,NDCG@5:0.2936) [35.8 s] 
INFO:root:all_losses: [0.10137523 0.04569747]
INFO:root:Epoch 95    loss=0.1014 [27.9 s]	 dev=(HR@5:0.4944,NDCG@5:0.3501) test=(HR@5:0.4365,NDCG@5:0.3059) [35.4 s] 
INFO:root:all_losses: [0.10115904 0.04669037]
INFO:root:Epoch 96    loss=0.1012 [28.0 s]	 dev=(HR@5:0.4950,NDCG@5:0.3500) test=(HR@5:0.4281,NDCG@5:0.2983) [35.4 s] 
INFO:root:Early stop at 96 based on dev result.
INFO:root:
Best Iter(dev)=   76	 dev=(HR@5:0.5070,NDCG@5:0.3604) test=(HR@5:0.4426,NDCG@5:0.3106) [6072.6 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.5986,HR@5:0.4426,HR@50:0.8736,NDCG@10:0.3611,NDCG@5:0.3106,NDCG@50:0.4223)
INFO:root:
--------------------------------------------- END: 2025-05-12 22:20:33 ---------------------------------------------
