INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-25 10:52:07 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | 0.0          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 6            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0498,HR@50:0.4825,NDCG@10:0.0441,NDCG@5:0.0300,NDCG@50:0.1258)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.43360823 0.6931471 ]
INFO:root:Epoch 1     loss=0.4336 [143.2 s]	 dev=(HR@5:0.2163,NDCG@5:0.1391) test=(HR@5:0.2036,NDCG@5:0.1400) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4101839  0.69313353]
INFO:root:Epoch 2     loss=0.4102 [208.1 s]	 dev=(HR@5:0.2142,NDCG@5:0.1420) test=(HR@5:0.2110,NDCG@5:0.1413) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34738746 0.6934335 ]
INFO:root:Epoch 3     loss=0.3474 [144.4 s]	 dev=(HR@5:0.3160,NDCG@5:0.2178) test=(HR@5:0.2757,NDCG@5:0.1913) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2610991  0.69379276]
INFO:root:Epoch 4     loss=0.2611 [152.2 s]	 dev=(HR@5:0.4645,NDCG@5:0.3332) test=(HR@5:0.4030,NDCG@5:0.2712) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.210662  0.6934341]
INFO:root:Epoch 5     loss=0.2107 [169.8 s]	 dev=(HR@5:0.4560,NDCG@5:0.3219) test=(HR@5:0.4178,NDCG@5:0.2821) [33.7 s] 
INFO:root:all_losses: [0.1931674  0.69280845]
INFO:root:Epoch 6     loss=0.1932 [169.4 s]	 dev=(HR@5:0.4984,NDCG@5:0.3572) test=(HR@5:0.4751,NDCG@5:0.3200) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18294062 0.69190043]
INFO:root:Epoch 7     loss=0.1829 [169.3 s]	 dev=(HR@5:0.4878,NDCG@5:0.3419) test=(HR@5:0.4528,NDCG@5:0.3068) [34.2 s] 
INFO:root:all_losses: [0.17772901 0.69084543]
INFO:root:Epoch 8     loss=0.1777 [169.1 s]	 dev=(HR@5:0.5270,NDCG@5:0.3727) test=(HR@5:0.5080,NDCG@5:0.3425) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1696081 0.6902811]
INFO:root:Epoch 9     loss=0.1696 [170.3 s]	 dev=(HR@5:0.5451,NDCG@5:0.3784) test=(HR@5:0.4995,NDCG@5:0.3520) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16783164 0.6897332 ]
INFO:root:Epoch 10    loss=0.1678 [169.1 s]	 dev=(HR@5:0.5366,NDCG@5:0.3745) test=(HR@5:0.4687,NDCG@5:0.3304) [33.7 s] 
INFO:root:all_losses: [0.15947181 0.6889076 ]
INFO:root:Epoch 11    loss=0.1595 [169.1 s]	 dev=(HR@5:0.5514,NDCG@5:0.3869) test=(HR@5:0.5122,NDCG@5:0.3614) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1528048 0.6887171]
INFO:root:Epoch 12    loss=0.1528 [169.4 s]	 dev=(HR@5:0.5652,NDCG@5:0.3967) test=(HR@5:0.5143,NDCG@5:0.3573) [34.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15269125 0.6883765 ]
INFO:root:Epoch 13    loss=0.1527 [169.8 s]	 dev=(HR@5:0.5716,NDCG@5:0.4029) test=(HR@5:0.5027,NDCG@5:0.3542) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14651044 0.688406  ]
INFO:root:Epoch 14    loss=0.1465 [169.2 s]	 dev=(HR@5:0.5610,NDCG@5:0.3897) test=(HR@5:0.5069,NDCG@5:0.3532) [34.3 s] 
INFO:root:all_losses: [0.14597161 0.68778235]
INFO:root:Epoch 15    loss=0.1460 [169.9 s]	 dev=(HR@5:0.5864,NDCG@5:0.4101) test=(HR@5:0.5196,NDCG@5:0.3751) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14021277 0.6874322 ]
INFO:root:Epoch 16    loss=0.1402 [170.1 s]	 dev=(HR@5:0.5769,NDCG@5:0.4114) test=(HR@5:0.5186,NDCG@5:0.3703) [34.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13749762 0.6873004 ]
INFO:root:Epoch 17    loss=0.1375 [169.3 s]	 dev=(HR@5:0.5642,NDCG@5:0.4077) test=(HR@5:0.5175,NDCG@5:0.3752) [34.2 s] 
INFO:root:all_losses: [0.13610937 0.6869892 ]
INFO:root:Epoch 18    loss=0.1361 [169.3 s]	 dev=(HR@5:0.5801,NDCG@5:0.4112) test=(HR@5:0.5281,NDCG@5:0.3812) [34.4 s] 
INFO:root:all_losses: [0.13225368 0.68669665]
INFO:root:Epoch 19    loss=0.1323 [170.5 s]	 dev=(HR@5:0.5673,NDCG@5:0.4045) test=(HR@5:0.5069,NDCG@5:0.3648) [34.1 s] 
INFO:root:all_losses: [0.13256352 0.68611956]
INFO:root:Epoch 20    loss=0.1326 [169.1 s]	 dev=(HR@5:0.6002,NDCG@5:0.4260) test=(HR@5:0.5408,NDCG@5:0.3939) [34.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1307147  0.68643475]
INFO:root:Epoch 21    loss=0.1307 [169.2 s]	 dev=(HR@5:0.5716,NDCG@5:0.4069) test=(HR@5:0.5228,NDCG@5:0.3814) [33.9 s] 
INFO:root:all_losses: [0.12575807 0.6861747 ]
INFO:root:Epoch 22    loss=0.1258 [169.1 s]	 dev=(HR@5:0.5875,NDCG@5:0.4106) test=(HR@5:0.5281,NDCG@5:0.3832) [34.3 s] 
INFO:root:all_losses: [0.12880974 0.6858301 ]
INFO:root:Epoch 23    loss=0.1288 [169.9 s]	 dev=(HR@5:0.5949,NDCG@5:0.4227) test=(HR@5:0.5323,NDCG@5:0.3821) [33.9 s] 
INFO:root:all_losses: [0.12336781 0.6857241 ]
INFO:root:Epoch 24    loss=0.1234 [169.0 s]	 dev=(HR@5:0.5938,NDCG@5:0.4312) test=(HR@5:0.5387,NDCG@5:0.3904) [34.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12294838 0.68509364]
INFO:root:Epoch 25    loss=0.1229 [168.6 s]	 dev=(HR@5:0.5907,NDCG@5:0.4234) test=(HR@5:0.5196,NDCG@5:0.3776) [34.0 s] 
INFO:root:all_losses: [0.11996595 0.684767  ]
INFO:root:Epoch 26    loss=0.1200 [169.5 s]	 dev=(HR@5:0.5960,NDCG@5:0.4309) test=(HR@5:0.5387,NDCG@5:0.3820) [34.1 s] 
INFO:root:all_losses: [0.11775764 0.6845814 ]
INFO:root:Epoch 27    loss=0.1178 [169.0 s]	 dev=(HR@5:0.5705,NDCG@5:0.4073) test=(HR@5:0.5164,NDCG@5:0.3780) [33.9 s] 
INFO:root:all_losses: [0.11777682 0.6851988 ]
INFO:root:Epoch 28    loss=0.1178 [169.0 s]	 dev=(HR@5:0.6172,NDCG@5:0.4280) test=(HR@5:0.5493,NDCG@5:0.3932) [34.2 s] 
INFO:root:all_losses: [0.11535599 0.68484896]
INFO:root:Epoch 29    loss=0.1154 [169.7 s]	 dev=(HR@5:0.5917,NDCG@5:0.4276) test=(HR@5:0.5270,NDCG@5:0.3794) [34.1 s] 
INFO:root:all_losses: [0.11661315 0.6851363 ]
INFO:root:Epoch 30    loss=0.1166 [169.1 s]	 dev=(HR@5:0.5970,NDCG@5:0.4302) test=(HR@5:0.5345,NDCG@5:0.3873) [33.8 s] 
INFO:root:all_losses: [0.11605072 0.6855468 ]
INFO:root:Epoch 31    loss=0.1161 [169.0 s]	 dev=(HR@5:0.5875,NDCG@5:0.4233) test=(HR@5:0.5472,NDCG@5:0.3921) [33.6 s] 
INFO:root:all_losses: [0.11395279 0.6858141 ]
INFO:root:Epoch 32    loss=0.1140 [170.0 s]	 dev=(HR@5:0.5981,NDCG@5:0.4329) test=(HR@5:0.5514,NDCG@5:0.3995) [33.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11078329 0.6862798 ]
INFO:root:Epoch 33    loss=0.1108 [168.8 s]	 dev=(HR@5:0.5960,NDCG@5:0.4146) test=(HR@5:0.5334,NDCG@5:0.3836) [33.9 s] 
INFO:root:all_losses: [0.11434101 0.6868665 ]
INFO:root:Epoch 34    loss=0.1143 [168.6 s]	 dev=(HR@5:0.5758,NDCG@5:0.4130) test=(HR@5:0.5408,NDCG@5:0.3874) [34.0 s] 
INFO:root:all_losses: [0.11108737 0.6870023 ]
INFO:root:Epoch 35    loss=0.1111 [168.9 s]	 dev=(HR@5:0.5970,NDCG@5:0.4326) test=(HR@5:0.5536,NDCG@5:0.4006) [33.9 s] 
INFO:root:all_losses: [0.10859895 0.68706775]
INFO:root:Epoch 36    loss=0.1086 [169.6 s]	 dev=(HR@5:0.5992,NDCG@5:0.4292) test=(HR@5:0.5345,NDCG@5:0.3796) [34.0 s] 
INFO:root:all_losses: [0.10731871 0.6872731 ]
INFO:root:Epoch 37    loss=0.1073 [168.9 s]	 dev=(HR@5:0.6034,NDCG@5:0.4371) test=(HR@5:0.5472,NDCG@5:0.3910) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10868632 0.6876232 ]
INFO:root:Epoch 38    loss=0.1087 [168.7 s]	 dev=(HR@5:0.6140,NDCG@5:0.4342) test=(HR@5:0.5705,NDCG@5:0.4103) [34.0 s] 
INFO:root:all_losses: [0.10494928 0.6876375 ]
INFO:root:Epoch 39    loss=0.1049 [169.6 s]	 dev=(HR@5:0.6002,NDCG@5:0.4261) test=(HR@5:0.5419,NDCG@5:0.3907) [33.9 s] 
INFO:root:all_losses: [0.10395095 0.6877681 ]
INFO:root:Epoch 40    loss=0.1040 [169.3 s]	 dev=(HR@5:0.6055,NDCG@5:0.4331) test=(HR@5:0.5451,NDCG@5:0.3974) [33.5 s] 
INFO:root:all_losses: [0.10614228 0.68794894]
INFO:root:Epoch 41    loss=0.1061 [169.0 s]	 dev=(HR@5:0.5992,NDCG@5:0.4310) test=(HR@5:0.5589,NDCG@5:0.3979) [33.7 s] 
INFO:root:all_losses: [0.10325496 0.68854874]
INFO:root:Epoch 42    loss=0.1033 [169.7 s]	 dev=(HR@5:0.5811,NDCG@5:0.4207) test=(HR@5:0.5355,NDCG@5:0.3906) [34.0 s] 
INFO:root:all_losses: [0.10317368 0.68863845]
INFO:root:Epoch 43    loss=0.1032 [168.8 s]	 dev=(HR@5:0.5960,NDCG@5:0.4303) test=(HR@5:0.5461,NDCG@5:0.3924) [33.9 s] 
INFO:root:all_losses: [0.10333585 0.6885059 ]
INFO:root:Epoch 44    loss=0.1033 [169.0 s]	 dev=(HR@5:0.5716,NDCG@5:0.4207) test=(HR@5:0.5536,NDCG@5:0.3933) [33.8 s] 
INFO:root:all_losses: [0.10088181 0.68886673]
INFO:root:Epoch 45    loss=0.1009 [169.7 s]	 dev=(HR@5:0.5938,NDCG@5:0.4320) test=(HR@5:0.5578,NDCG@5:0.3925) [33.8 s] 
INFO:root:all_losses: [0.09975061 0.68915635]
INFO:root:Epoch 46    loss=0.0998 [168.7 s]	 dev=(HR@5:0.6119,NDCG@5:0.4325) test=(HR@5:0.5419,NDCG@5:0.3898) [34.0 s] 
INFO:root:all_losses: [0.10078732 0.6888742 ]
INFO:root:Epoch 47    loss=0.1008 [168.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4246) test=(HR@5:0.5302,NDCG@5:0.3744) [33.9 s] 
INFO:root:all_losses: [0.09858235 0.6893808 ]
INFO:root:Epoch 48    loss=0.0986 [169.5 s]	 dev=(HR@5:0.5811,NDCG@5:0.4212) test=(HR@5:0.5302,NDCG@5:0.3762) [33.4 s] 
INFO:root:all_losses: [0.0994335 0.6896263]
INFO:root:Epoch 49    loss=0.0994 [169.8 s]	 dev=(HR@5:0.5970,NDCG@5:0.4293) test=(HR@5:0.5429,NDCG@5:0.3905) [33.6 s] 
INFO:root:all_losses: [0.09701408 0.6901985 ]
INFO:root:Epoch 50    loss=0.0970 [169.4 s]	 dev=(HR@5:0.5907,NDCG@5:0.4235) test=(HR@5:0.5504,NDCG@5:0.3874) [33.4 s] 
INFO:root:all_losses: [0.09882303 0.69039583]
INFO:root:Epoch 51    loss=0.0988 [169.1 s]	 dev=(HR@5:0.5885,NDCG@5:0.4237) test=(HR@5:0.5387,NDCG@5:0.3830) [33.4 s] 
INFO:root:all_losses: [0.09850026 0.69020313]
INFO:root:Epoch 52    loss=0.0985 [170.0 s]	 dev=(HR@5:0.5907,NDCG@5:0.4225) test=(HR@5:0.5451,NDCG@5:0.3898) [33.5 s] 
INFO:root:all_losses: [0.09624459 0.69051397]
INFO:root:Epoch 53    loss=0.0962 [169.6 s]	 dev=(HR@5:0.5642,NDCG@5:0.4004) test=(HR@5:0.5355,NDCG@5:0.3783) [33.9 s] 
INFO:root:all_losses: [0.09537832 0.69185907]
INFO:root:Epoch 54    loss=0.0954 [169.7 s]	 dev=(HR@5:0.5769,NDCG@5:0.4127) test=(HR@5:0.5334,NDCG@5:0.3796) [33.9 s] 
INFO:root:all_losses: [0.0937479 0.6916068]
INFO:root:Epoch 55    loss=0.0937 [171.7 s]	 dev=(HR@5:0.5992,NDCG@5:0.4234) test=(HR@5:0.5323,NDCG@5:0.3870) [33.9 s] 
INFO:root:all_losses: [0.09514388 0.69125575]
INFO:root:Epoch 56    loss=0.0951 [173.1 s]	 dev=(HR@5:0.5811,NDCG@5:0.4126) test=(HR@5:0.5536,NDCG@5:0.3942) [33.6 s] 
INFO:root:all_losses: [0.09313554 0.69160926]
INFO:root:Epoch 57    loss=0.0931 [173.2 s]	 dev=(HR@5:0.5938,NDCG@5:0.4300) test=(HR@5:0.5504,NDCG@5:0.3956) [33.5 s] 
INFO:root:Early stop at 57 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.6034,NDCG@5:0.4371) test=(HR@5:0.5472,NDCG@5:0.3910) [11558.8 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=6_num_heads=4_gamma=0.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7169,HR@5:0.5472,HR@50:0.9661,NDCG@10:0.4455,NDCG@5:0.3910,NDCG@50:0.5032)
INFO:root:
--------------------------------------------- END: 2025-05-25 14:05:18 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-30 11:00:08 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | 0.0          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 6            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0498,HR@50:0.4825,NDCG@10:0.0441,NDCG@5:0.0300,NDCG@50:0.1258)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.43360823 0.6931471 ]
INFO:root:Epoch 1     loss=0.4336 [135.5 s]	 dev=(HR@5:0.2163,NDCG@5:0.1391) test=(HR@5:0.2036,NDCG@5:0.1400) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4101839  0.69313353]
INFO:root:Epoch 2     loss=0.4102 [207.4 s]	 dev=(HR@5:0.2142,NDCG@5:0.1420) test=(HR@5:0.2110,NDCG@5:0.1413) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34738746 0.6934335 ]
INFO:root:Epoch 3     loss=0.3474 [149.3 s]	 dev=(HR@5:0.3160,NDCG@5:0.2178) test=(HR@5:0.2757,NDCG@5:0.1913) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2610991  0.69379276]
INFO:root:Epoch 4     loss=0.2611 [152.0 s]	 dev=(HR@5:0.4645,NDCG@5:0.3332) test=(HR@5:0.4030,NDCG@5:0.2712) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.210662  0.6934341]
INFO:root:Epoch 5     loss=0.2107 [174.4 s]	 dev=(HR@5:0.4560,NDCG@5:0.3219) test=(HR@5:0.4178,NDCG@5:0.2821) [34.5 s] 
INFO:root:all_losses: [0.1931674  0.69280845]
INFO:root:Epoch 6     loss=0.1932 [178.6 s]	 dev=(HR@5:0.4984,NDCG@5:0.3572) test=(HR@5:0.4751,NDCG@5:0.3200) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18294062 0.69190043]
INFO:root:Epoch 7     loss=0.1829 [178.4 s]	 dev=(HR@5:0.4878,NDCG@5:0.3419) test=(HR@5:0.4528,NDCG@5:0.3068) [34.4 s] 
INFO:root:all_losses: [0.17772901 0.69084543]
INFO:root:Epoch 8     loss=0.1777 [178.2 s]	 dev=(HR@5:0.5270,NDCG@5:0.3727) test=(HR@5:0.5080,NDCG@5:0.3425) [34.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1696081 0.6902811]
INFO:root:Epoch 9     loss=0.1696 [178.6 s]	 dev=(HR@5:0.5451,NDCG@5:0.3784) test=(HR@5:0.4995,NDCG@5:0.3520) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16783164 0.6897332 ]
INFO:root:Epoch 10    loss=0.1678 [178.3 s]	 dev=(HR@5:0.5366,NDCG@5:0.3745) test=(HR@5:0.4687,NDCG@5:0.3304) [34.4 s] 
INFO:root:all_losses: [0.15947181 0.6889076 ]
INFO:root:Epoch 11    loss=0.1595 [179.0 s]	 dev=(HR@5:0.5514,NDCG@5:0.3869) test=(HR@5:0.5122,NDCG@5:0.3614) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1528048 0.6887171]
INFO:root:Epoch 12    loss=0.1528 [178.1 s]	 dev=(HR@5:0.5652,NDCG@5:0.3967) test=(HR@5:0.5143,NDCG@5:0.3573) [34.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15269125 0.6883765 ]
INFO:root:Epoch 13    loss=0.1527 [178.3 s]	 dev=(HR@5:0.5716,NDCG@5:0.4029) test=(HR@5:0.5027,NDCG@5:0.3542) [34.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14651044 0.688406  ]
INFO:root:Epoch 14    loss=0.1465 [178.3 s]	 dev=(HR@5:0.5610,NDCG@5:0.3897) test=(HR@5:0.5069,NDCG@5:0.3532) [34.4 s] 
INFO:root:all_losses: [0.14597161 0.68778235]
INFO:root:Epoch 15    loss=0.1460 [179.6 s]	 dev=(HR@5:0.5864,NDCG@5:0.4101) test=(HR@5:0.5196,NDCG@5:0.3751) [34.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14021277 0.6874322 ]
INFO:root:Epoch 16    loss=0.1402 [178.5 s]	 dev=(HR@5:0.5769,NDCG@5:0.4114) test=(HR@5:0.5186,NDCG@5:0.3703) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13749762 0.6873004 ]
INFO:root:Epoch 17    loss=0.1375 [178.7 s]	 dev=(HR@5:0.5642,NDCG@5:0.4077) test=(HR@5:0.5175,NDCG@5:0.3752) [33.9 s] 
INFO:root:all_losses: [0.13610937 0.6869892 ]
INFO:root:Epoch 18    loss=0.1361 [178.6 s]	 dev=(HR@5:0.5801,NDCG@5:0.4112) test=(HR@5:0.5281,NDCG@5:0.3812) [34.2 s] 
INFO:root:all_losses: [0.13225368 0.68669665]
INFO:root:Epoch 19    loss=0.1323 [179.4 s]	 dev=(HR@5:0.5673,NDCG@5:0.4045) test=(HR@5:0.5069,NDCG@5:0.3648) [34.1 s] 
INFO:root:all_losses: [0.13256352 0.68611956]
INFO:root:Epoch 20    loss=0.1326 [178.1 s]	 dev=(HR@5:0.6002,NDCG@5:0.4260) test=(HR@5:0.5408,NDCG@5:0.3939) [34.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1307147  0.68643475]
INFO:root:Epoch 21    loss=0.1307 [178.1 s]	 dev=(HR@5:0.5716,NDCG@5:0.4069) test=(HR@5:0.5228,NDCG@5:0.3814) [33.9 s] 
INFO:root:all_losses: [0.12575807 0.6861747 ]
INFO:root:Epoch 22    loss=0.1258 [178.8 s]	 dev=(HR@5:0.5875,NDCG@5:0.4106) test=(HR@5:0.5281,NDCG@5:0.3832) [34.0 s] 
INFO:root:all_losses: [0.12880974 0.6858301 ]
INFO:root:Epoch 23    loss=0.1288 [178.6 s]	 dev=(HR@5:0.5949,NDCG@5:0.4227) test=(HR@5:0.5323,NDCG@5:0.3821) [34.1 s] 
INFO:root:all_losses: [0.12336781 0.6857241 ]
INFO:root:Epoch 24    loss=0.1234 [179.0 s]	 dev=(HR@5:0.5938,NDCG@5:0.4312) test=(HR@5:0.5387,NDCG@5:0.3904) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12294838 0.68509364]
INFO:root:Epoch 25    loss=0.1229 [178.1 s]	 dev=(HR@5:0.5907,NDCG@5:0.4234) test=(HR@5:0.5196,NDCG@5:0.3776) [33.8 s] 
INFO:root:all_losses: [0.11996595 0.684767  ]
INFO:root:Epoch 26    loss=0.1200 [177.9 s]	 dev=(HR@5:0.5960,NDCG@5:0.4309) test=(HR@5:0.5387,NDCG@5:0.3820) [33.7 s] 
INFO:root:all_losses: [0.11775764 0.6845814 ]
INFO:root:Epoch 27    loss=0.1178 [177.9 s]	 dev=(HR@5:0.5705,NDCG@5:0.4073) test=(HR@5:0.5164,NDCG@5:0.3780) [34.4 s] 
INFO:root:all_losses: [0.11777682 0.6851988 ]
INFO:root:Epoch 28    loss=0.1178 [179.0 s]	 dev=(HR@5:0.6172,NDCG@5:0.4280) test=(HR@5:0.5493,NDCG@5:0.3932) [34.0 s] 
INFO:root:all_losses: [0.11535599 0.68484896]
INFO:root:Epoch 29    loss=0.1154 [178.3 s]	 dev=(HR@5:0.5917,NDCG@5:0.4276) test=(HR@5:0.5270,NDCG@5:0.3794) [34.3 s] 
INFO:root:all_losses: [0.11661315 0.6851363 ]
INFO:root:Epoch 30    loss=0.1166 [178.2 s]	 dev=(HR@5:0.5970,NDCG@5:0.4302) test=(HR@5:0.5345,NDCG@5:0.3873) [33.7 s] 
INFO:root:all_losses: [0.11605072 0.6855468 ]
INFO:root:Epoch 31    loss=0.1161 [178.2 s]	 dev=(HR@5:0.5875,NDCG@5:0.4233) test=(HR@5:0.5472,NDCG@5:0.3921) [34.3 s] 
INFO:root:all_losses: [0.11395279 0.6858141 ]
INFO:root:Epoch 32    loss=0.1140 [179.2 s]	 dev=(HR@5:0.5981,NDCG@5:0.4329) test=(HR@5:0.5514,NDCG@5:0.3995) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11078329 0.6862798 ]
INFO:root:Epoch 33    loss=0.1108 [178.5 s]	 dev=(HR@5:0.5960,NDCG@5:0.4146) test=(HR@5:0.5334,NDCG@5:0.3836) [34.1 s] 
INFO:root:all_losses: [0.11434101 0.6868665 ]
INFO:root:Epoch 34    loss=0.1143 [178.1 s]	 dev=(HR@5:0.5758,NDCG@5:0.4130) test=(HR@5:0.5408,NDCG@5:0.3874) [33.9 s] 
INFO:root:all_losses: [0.11108737 0.6870023 ]
INFO:root:Epoch 35    loss=0.1111 [178.4 s]	 dev=(HR@5:0.5970,NDCG@5:0.4326) test=(HR@5:0.5536,NDCG@5:0.4006) [34.1 s] 
INFO:root:all_losses: [0.10859895 0.68706775]
INFO:root:Epoch 36    loss=0.1086 [178.1 s]	 dev=(HR@5:0.5992,NDCG@5:0.4292) test=(HR@5:0.5345,NDCG@5:0.3796) [33.9 s] 
INFO:root:all_losses: [0.10731871 0.6872731 ]
INFO:root:Epoch 37    loss=0.1073 [178.9 s]	 dev=(HR@5:0.6034,NDCG@5:0.4371) test=(HR@5:0.5472,NDCG@5:0.3910) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10868632 0.6876232 ]
INFO:root:Epoch 38    loss=0.1087 [178.4 s]	 dev=(HR@5:0.6140,NDCG@5:0.4342) test=(HR@5:0.5705,NDCG@5:0.4103) [34.0 s] 
INFO:root:all_losses: [0.10494928 0.6876375 ]
INFO:root:Epoch 39    loss=0.1049 [177.9 s]	 dev=(HR@5:0.6002,NDCG@5:0.4261) test=(HR@5:0.5419,NDCG@5:0.3907) [33.8 s] 
INFO:root:all_losses: [0.10395095 0.6877681 ]
INFO:root:Epoch 40    loss=0.1040 [178.2 s]	 dev=(HR@5:0.6055,NDCG@5:0.4331) test=(HR@5:0.5451,NDCG@5:0.3974) [33.8 s] 
INFO:root:all_losses: [0.10614228 0.68794894]
INFO:root:Epoch 41    loss=0.1061 [179.3 s]	 dev=(HR@5:0.5992,NDCG@5:0.4310) test=(HR@5:0.5589,NDCG@5:0.3979) [34.0 s] 
INFO:root:all_losses: [0.10325496 0.68854874]
INFO:root:Epoch 42    loss=0.1033 [178.4 s]	 dev=(HR@5:0.5811,NDCG@5:0.4207) test=(HR@5:0.5355,NDCG@5:0.3906) [33.7 s] 
INFO:root:all_losses: [0.10317368 0.68863845]
INFO:root:Epoch 43    loss=0.1032 [178.4 s]	 dev=(HR@5:0.5960,NDCG@5:0.4303) test=(HR@5:0.5461,NDCG@5:0.3924) [34.1 s] 
INFO:root:all_losses: [0.10333585 0.6885059 ]
INFO:root:Epoch 44    loss=0.1033 [178.2 s]	 dev=(HR@5:0.5716,NDCG@5:0.4207) test=(HR@5:0.5536,NDCG@5:0.3933) [33.5 s] 
INFO:root:all_losses: [0.10088181 0.68886673]
INFO:root:Epoch 45    loss=0.1009 [178.3 s]	 dev=(HR@5:0.5938,NDCG@5:0.4320) test=(HR@5:0.5578,NDCG@5:0.3925) [33.4 s] 
INFO:root:all_losses: [0.09975061 0.68915635]
INFO:root:Epoch 46    loss=0.0998 [179.0 s]	 dev=(HR@5:0.6119,NDCG@5:0.4325) test=(HR@5:0.5419,NDCG@5:0.3898) [34.0 s] 
INFO:root:all_losses: [0.10078732 0.6888742 ]
INFO:root:Epoch 47    loss=0.1008 [178.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4246) test=(HR@5:0.5302,NDCG@5:0.3744) [33.9 s] 
INFO:root:all_losses: [0.09858235 0.6893808 ]
INFO:root:Epoch 48    loss=0.0986 [178.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4212) test=(HR@5:0.5302,NDCG@5:0.3762) [33.5 s] 
INFO:root:all_losses: [0.0994335 0.6896263]
INFO:root:Epoch 49    loss=0.0994 [178.2 s]	 dev=(HR@5:0.5970,NDCG@5:0.4293) test=(HR@5:0.5429,NDCG@5:0.3905) [33.5 s] 
INFO:root:all_losses: [0.09701408 0.6901985 ]
INFO:root:Epoch 50    loss=0.0970 [179.3 s]	 dev=(HR@5:0.5907,NDCG@5:0.4235) test=(HR@5:0.5504,NDCG@5:0.3874) [33.5 s] 
INFO:root:all_losses: [0.09882303 0.69039583]
INFO:root:Epoch 51    loss=0.0988 [178.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4237) test=(HR@5:0.5387,NDCG@5:0.3830) [34.0 s] 
INFO:root:all_losses: [0.09850026 0.69020313]
INFO:root:Epoch 52    loss=0.0985 [179.0 s]	 dev=(HR@5:0.5907,NDCG@5:0.4225) test=(HR@5:0.5451,NDCG@5:0.3898) [33.6 s] 
INFO:root:all_losses: [0.09624459 0.69051397]
INFO:root:Epoch 53    loss=0.0962 [179.4 s]	 dev=(HR@5:0.5642,NDCG@5:0.4004) test=(HR@5:0.5355,NDCG@5:0.3783) [33.5 s] 
INFO:root:all_losses: [0.09537832 0.69185907]
INFO:root:Epoch 54    loss=0.0954 [180.0 s]	 dev=(HR@5:0.5769,NDCG@5:0.4127) test=(HR@5:0.5334,NDCG@5:0.3796) [33.8 s] 
INFO:root:all_losses: [0.0937479 0.6916068]
INFO:root:Epoch 55    loss=0.0937 [179.9 s]	 dev=(HR@5:0.5992,NDCG@5:0.4234) test=(HR@5:0.5323,NDCG@5:0.3870) [33.9 s] 
INFO:root:all_losses: [0.09514388 0.69125575]
INFO:root:Epoch 56    loss=0.0951 [182.6 s]	 dev=(HR@5:0.5811,NDCG@5:0.4126) test=(HR@5:0.5536,NDCG@5:0.3942) [34.1 s] 
INFO:root:all_losses: [0.09313554 0.69160926]
INFO:root:Epoch 57    loss=0.0931 [182.4 s]	 dev=(HR@5:0.5938,NDCG@5:0.4300) test=(HR@5:0.5504,NDCG@5:0.3956) [33.6 s] 
INFO:root:Early stop at 57 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.6034,NDCG@5:0.4371) test=(HR@5:0.5472,NDCG@5:0.3910) [12042.1 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=6_num_heads=4_gamma=0.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7169,HR@5:0.5472,HR@50:0.9661,NDCG@10:0.4455,NDCG@5:0.3910,NDCG@50:0.5032)
INFO:root:
--------------------------------------------- END: 2025-05-30 14:21:23 ---------------------------------------------
