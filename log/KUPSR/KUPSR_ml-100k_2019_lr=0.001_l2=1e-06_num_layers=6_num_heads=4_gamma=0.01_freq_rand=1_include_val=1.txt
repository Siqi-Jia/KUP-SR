INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-25 20:04:03 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | 0.01         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 6            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0498,HR@50:0.4825,NDCG@10:0.0441,NDCG@5:0.0300,NDCG@50:0.1258)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.44061777 0.6931212 ]
INFO:root:Epoch 1     loss=0.4406 [142.8 s]	 dev=(HR@5:0.2163,NDCG@5:0.1384) test=(HR@5:0.2047,NDCG@5:0.1389) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.41975042 0.6930558 ]
INFO:root:Epoch 2     loss=0.4198 [191.1 s]	 dev=(HR@5:0.2322,NDCG@5:0.1505) test=(HR@5:0.2142,NDCG@5:0.1449) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.40122554 0.6930304 ]
INFO:root:Epoch 3     loss=0.4012 [161.8 s]	 dev=(HR@5:0.2619,NDCG@5:0.1732) test=(HR@5:0.2312,NDCG@5:0.1534) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.30209917 0.69311506]
INFO:root:Epoch 4     loss=0.3021 [154.0 s]	 dev=(HR@5:0.4592,NDCG@5:0.3308) test=(HR@5:0.4051,NDCG@5:0.2736) [33.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22055924 0.6909392 ]
INFO:root:Epoch 5     loss=0.2206 [168.6 s]	 dev=(HR@5:0.4613,NDCG@5:0.3187) test=(HR@5:0.4157,NDCG@5:0.2797) [34.0 s] 
INFO:root:all_losses: [0.19674788 0.6870009 ]
INFO:root:Epoch 6     loss=0.1967 [169.4 s]	 dev=(HR@5:0.4995,NDCG@5:0.3563) test=(HR@5:0.4496,NDCG@5:0.3108) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18600887 0.6831358 ]
INFO:root:Epoch 7     loss=0.1860 [169.1 s]	 dev=(HR@5:0.5207,NDCG@5:0.3588) test=(HR@5:0.4719,NDCG@5:0.3189) [33.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18124574 0.6789137 ]
INFO:root:Epoch 8     loss=0.1812 [168.8 s]	 dev=(HR@5:0.5323,NDCG@5:0.3711) test=(HR@5:0.5058,NDCG@5:0.3400) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17354122 0.676327  ]
INFO:root:Epoch 9     loss=0.1735 [169.4 s]	 dev=(HR@5:0.5472,NDCG@5:0.3830) test=(HR@5:0.5037,NDCG@5:0.3529) [34.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17170635 0.672807  ]
INFO:root:Epoch 10    loss=0.1717 [168.8 s]	 dev=(HR@5:0.5239,NDCG@5:0.3697) test=(HR@5:0.4496,NDCG@5:0.3168) [33.9 s] 
INFO:root:all_losses: [0.16431285 0.6697104 ]
INFO:root:Epoch 11    loss=0.1643 [168.5 s]	 dev=(HR@5:0.5652,NDCG@5:0.4018) test=(HR@5:0.5302,NDCG@5:0.3745) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15746753 0.66775614]
INFO:root:Epoch 12    loss=0.1575 [168.5 s]	 dev=(HR@5:0.5695,NDCG@5:0.3999) test=(HR@5:0.5249,NDCG@5:0.3603) [33.5 s] 
INFO:root:all_losses: [0.15770437 0.66552585]
INFO:root:Epoch 13    loss=0.1577 [169.5 s]	 dev=(HR@5:0.5589,NDCG@5:0.3871) test=(HR@5:0.4984,NDCG@5:0.3427) [34.2 s] 
INFO:root:all_losses: [0.15213811 0.66347724]
INFO:root:Epoch 14    loss=0.1521 [168.5 s]	 dev=(HR@5:0.5652,NDCG@5:0.3918) test=(HR@5:0.5175,NDCG@5:0.3633) [34.1 s] 
INFO:root:all_losses: [0.15208343 0.66111207]
INFO:root:Epoch 15    loss=0.1521 [168.9 s]	 dev=(HR@5:0.5716,NDCG@5:0.3999) test=(HR@5:0.5101,NDCG@5:0.3623) [33.8 s] 
INFO:root:all_losses: [0.14656451 0.6584751 ]
INFO:root:Epoch 16    loss=0.1466 [169.5 s]	 dev=(HR@5:0.5440,NDCG@5:0.3880) test=(HR@5:0.5005,NDCG@5:0.3501) [34.2 s] 
INFO:root:all_losses: [0.14488643 0.65646905]
INFO:root:Epoch 17    loss=0.1449 [168.6 s]	 dev=(HR@5:0.5779,NDCG@5:0.4059) test=(HR@5:0.5154,NDCG@5:0.3710) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14291382 0.65542746]
INFO:root:Epoch 18    loss=0.1429 [169.4 s]	 dev=(HR@5:0.5737,NDCG@5:0.4098) test=(HR@5:0.5196,NDCG@5:0.3762) [34.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14041764 0.6541614 ]
INFO:root:Epoch 19    loss=0.1404 [169.3 s]	 dev=(HR@5:0.5737,NDCG@5:0.3989) test=(HR@5:0.5239,NDCG@5:0.3706) [33.6 s] 
INFO:root:all_losses: [0.14015779 0.65181315]
INFO:root:Epoch 20    loss=0.1402 [168.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4145) test=(HR@5:0.5429,NDCG@5:0.3897) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13870504 0.65062845]
INFO:root:Epoch 21    loss=0.1387 [169.2 s]	 dev=(HR@5:0.5578,NDCG@5:0.4041) test=(HR@5:0.5281,NDCG@5:0.3830) [33.5 s] 
INFO:root:all_losses: [0.13351576 0.64933896]
INFO:root:Epoch 22    loss=0.1335 [169.6 s]	 dev=(HR@5:0.5642,NDCG@5:0.4091) test=(HR@5:0.5292,NDCG@5:0.3766) [34.0 s] 
INFO:root:all_losses: [0.1371618 0.6483023]
INFO:root:Epoch 23    loss=0.1372 [168.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4218) test=(HR@5:0.5281,NDCG@5:0.3780) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13225308 0.6474297 ]
INFO:root:Epoch 24    loss=0.1323 [168.6 s]	 dev=(HR@5:0.5779,NDCG@5:0.4217) test=(HR@5:0.5323,NDCG@5:0.3783) [34.0 s] 
INFO:root:all_losses: [0.13168389 0.6450715 ]
INFO:root:Epoch 25    loss=0.1317 [169.2 s]	 dev=(HR@5:0.5716,NDCG@5:0.4151) test=(HR@5:0.5398,NDCG@5:0.3787) [33.4 s] 
INFO:root:all_losses: [0.12900603 0.6447838 ]
INFO:root:Epoch 26    loss=0.1290 [168.8 s]	 dev=(HR@5:0.5695,NDCG@5:0.4139) test=(HR@5:0.5313,NDCG@5:0.3758) [33.8 s] 
INFO:root:all_losses: [0.1258595 0.6433216]
INFO:root:Epoch 27    loss=0.1259 [168.4 s]	 dev=(HR@5:0.5832,NDCG@5:0.4135) test=(HR@5:0.5345,NDCG@5:0.3724) [34.1 s] 
INFO:root:Early stop at 27 based on dev result.
INFO:root:
Best Iter(dev)=   23	 dev=(HR@5:0.5875,NDCG@5:0.4218) test=(HR@5:0.5281,NDCG@5:0.3780) [5445.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=6_num_heads=4_gamma=0.01_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7052,HR@5:0.5281,HR@50:0.9629,NDCG@10:0.4356,NDCG@5:0.3780,NDCG@50:0.4958)
INFO:root:
--------------------------------------------- END: 2025-05-25 21:35:21 ---------------------------------------------
