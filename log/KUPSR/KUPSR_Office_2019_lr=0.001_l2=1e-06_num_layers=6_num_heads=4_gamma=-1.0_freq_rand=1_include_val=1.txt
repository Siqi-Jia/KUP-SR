INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-21 20:06:23 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 6            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5032,NDCG@10:0.0442,NDCG@5:0.0282,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.3006234 0.693116 ]
INFO:root:Epoch 1     loss=1.3006 [53.7 s]	 dev=(HR@5:0.1060,NDCG@5:0.0625) test=(HR@5:0.0703,NDCG@5:0.0407) [41.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2446859 0.6929522]
INFO:root:Epoch 2     loss=1.2447 [56.1 s]	 dev=(HR@5:0.1158,NDCG@5:0.0693) test=(HR@5:0.0716,NDCG@5:0.0426) [41.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2422996 0.6926211]
INFO:root:Epoch 3     loss=1.2423 [57.5 s]	 dev=(HR@5:0.1119,NDCG@5:0.0641) test=(HR@5:0.0773,NDCG@5:0.0434) [42.2 s] 
INFO:root:all_losses: [1.2406372  0.69232833]
INFO:root:Epoch 4     loss=1.2406 [63.7 s]	 dev=(HR@5:0.1131,NDCG@5:0.0672) test=(HR@5:0.0777,NDCG@5:0.0444) [42.2 s] 
INFO:root:all_losses: [1.237643   0.69196784]
INFO:root:Epoch 5     loss=1.2376 [63.4 s]	 dev=(HR@5:0.1093,NDCG@5:0.0645) test=(HR@5:0.0720,NDCG@5:0.0428) [44.3 s] 
INFO:root:all_losses: [1.2356037  0.69112843]
INFO:root:Epoch 6     loss=1.2356 [135.2 s]	 dev=(HR@5:0.1142,NDCG@5:0.0659) test=(HR@5:0.0720,NDCG@5:0.0411) [56.2 s] 
INFO:root:all_losses: [1.2328633 0.6898195]
INFO:root:Epoch 7     loss=1.2329 [65.0 s]	 dev=(HR@5:0.1093,NDCG@5:0.0643) test=(HR@5:0.0671,NDCG@5:0.0387) [44.7 s] 
INFO:root:all_losses: [1.2238008 0.6829723]
INFO:root:Epoch 8     loss=1.2238 [57.4 s]	 dev=(HR@5:0.1025,NDCG@5:0.0609) test=(HR@5:0.0618,NDCG@5:0.0349) [48.7 s] 
INFO:root:all_losses: [1.1815822  0.64484733]
INFO:root:Epoch 9     loss=1.1816 [69.6 s]	 dev=(HR@5:0.1078,NDCG@5:0.0637) test=(HR@5:0.0644,NDCG@5:0.0361) [43.5 s] 
INFO:root:all_losses: [1.0843598 0.5611928]
INFO:root:Epoch 10    loss=1.0844 [82.7 s]	 dev=(HR@5:0.1028,NDCG@5:0.0604) test=(HR@5:0.0693,NDCG@5:0.0390) [50.4 s] 
INFO:root:all_losses: [0.9888374  0.47886798]
INFO:root:Epoch 11    loss=0.9888 [87.3 s]	 dev=(HR@5:0.1046,NDCG@5:0.0624) test=(HR@5:0.0673,NDCG@5:0.0382) [50.8 s] 
INFO:root:all_losses: [0.9021957 0.4057046]
INFO:root:Epoch 12    loss=0.9022 [80.4 s]	 dev=(HR@5:0.1078,NDCG@5:0.0634) test=(HR@5:0.0640,NDCG@5:0.0363) [70.0 s] 
INFO:root:all_losses: [0.81973636 0.33433968]
INFO:root:Epoch 13    loss=0.8197 [66.3 s]	 dev=(HR@5:0.1105,NDCG@5:0.0643) test=(HR@5:0.0720,NDCG@5:0.0405) [76.5 s] 
INFO:root:all_losses: [0.757717   0.28103694]
INFO:root:Epoch 14    loss=0.7577 [69.2 s]	 dev=(HR@5:0.1101,NDCG@5:0.0631) test=(HR@5:0.0703,NDCG@5:0.0388) [75.7 s] 
INFO:root:all_losses: [0.7179     0.24572858]
INFO:root:Epoch 15    loss=0.7179 [70.6 s]	 dev=(HR@5:0.1046,NDCG@5:0.0614) test=(HR@5:0.0677,NDCG@5:0.0385) [77.3 s] 
INFO:root:all_losses: [0.6714861  0.21709745]
INFO:root:Epoch 16    loss=0.6715 [69.1 s]	 dev=(HR@5:0.1166,NDCG@5:0.0710) test=(HR@5:0.0875,NDCG@5:0.0531) [49.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5936851  0.19335453]
INFO:root:Epoch 17    loss=0.5937 [64.5 s]	 dev=(HR@5:0.2292,NDCG@5:0.1477) test=(HR@5:0.1761,NDCG@5:0.1146) [50.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.532912   0.17272829]
INFO:root:Epoch 18    loss=0.5329 [64.9 s]	 dev=(HR@5:0.2298,NDCG@5:0.1483) test=(HR@5:0.1715,NDCG@5:0.1096) [50.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.50574476 0.16080056]
INFO:root:Epoch 19    loss=0.5057 [64.9 s]	 dev=(HR@5:0.2389,NDCG@5:0.1579) test=(HR@5:0.1808,NDCG@5:0.1197) [51.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.46805638 0.14746797]
INFO:root:Epoch 20    loss=0.4681 [64.5 s]	 dev=(HR@5:0.2791,NDCG@5:0.1858) test=(HR@5:0.2133,NDCG@5:0.1416) [50.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.42751944 0.1375594 ]
INFO:root:Epoch 21    loss=0.4275 [64.0 s]	 dev=(HR@5:0.3244,NDCG@5:0.2164) test=(HR@5:0.2644,NDCG@5:0.1765) [50.1 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.39290047 0.12914523]
INFO:root:Epoch 22    loss=0.3929 [65.4 s]	 dev=(HR@5:0.3623,NDCG@5:0.2484) test=(HR@5:0.2966,NDCG@5:0.2018) [52.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.36465412 0.12167509]
INFO:root:Epoch 23    loss=0.3647 [62.4 s]	 dev=(HR@5:0.3900,NDCG@5:0.2675) test=(HR@5:0.3185,NDCG@5:0.2157) [50.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.33004946 0.11476964]
INFO:root:Epoch 24    loss=0.3300 [64.4 s]	 dev=(HR@5:0.4328,NDCG@5:0.2940) test=(HR@5:0.3627,NDCG@5:0.2474) [51.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31159726 0.11109018]
INFO:root:Epoch 25    loss=0.3116 [66.6 s]	 dev=(HR@5:0.4573,NDCG@5:0.3152) test=(HR@5:0.3878,NDCG@5:0.2682) [51.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.29622808 0.10699977]
INFO:root:Epoch 26    loss=0.2962 [66.8 s]	 dev=(HR@5:0.4489,NDCG@5:0.3076) test=(HR@5:0.3786,NDCG@5:0.2594) [51.7 s] 
INFO:root:all_losses: [0.27751598 0.10049721]
INFO:root:Epoch 27    loss=0.2775 [67.1 s]	 dev=(HR@5:0.4707,NDCG@5:0.3280) test=(HR@5:0.3984,NDCG@5:0.2756) [51.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26547372 0.09755716]
INFO:root:Epoch 28    loss=0.2655 [67.3 s]	 dev=(HR@5:0.4587,NDCG@5:0.3120) test=(HR@5:0.3823,NDCG@5:0.2613) [51.5 s] 
INFO:root:all_losses: [0.2536059  0.09472279]
INFO:root:Epoch 29    loss=0.2536 [66.6 s]	 dev=(HR@5:0.4634,NDCG@5:0.3202) test=(HR@5:0.3890,NDCG@5:0.2676) [51.7 s] 
INFO:root:all_losses: [0.24397324 0.09201989]
INFO:root:Epoch 30    loss=0.2440 [67.0 s]	 dev=(HR@5:0.4654,NDCG@5:0.3202) test=(HR@5:0.3845,NDCG@5:0.2679) [51.9 s] 
INFO:root:all_losses: [0.23904498 0.08901235]
INFO:root:Epoch 31    loss=0.2390 [62.4 s]	 dev=(HR@5:0.4813,NDCG@5:0.3384) test=(HR@5:0.4198,NDCG@5:0.2903) [51.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.23541696 0.0903902 ]
INFO:root:Epoch 32    loss=0.2354 [64.5 s]	 dev=(HR@5:0.4636,NDCG@5:0.3200) test=(HR@5:0.3790,NDCG@5:0.2646) [51.6 s] 
INFO:root:all_losses: [0.21975814 0.08503706]
INFO:root:Epoch 33    loss=0.2198 [64.5 s]	 dev=(HR@5:0.4828,NDCG@5:0.3381) test=(HR@5:0.4055,NDCG@5:0.2837) [51.4 s] 
INFO:root:all_losses: [0.21169843 0.08134573]
INFO:root:Epoch 34    loss=0.2117 [64.6 s]	 dev=(HR@5:0.4793,NDCG@5:0.3364) test=(HR@5:0.4073,NDCG@5:0.2865) [51.4 s] 
INFO:root:all_losses: [0.21050277 0.08177905]
INFO:root:Epoch 35    loss=0.2105 [66.4 s]	 dev=(HR@5:0.4811,NDCG@5:0.3407) test=(HR@5:0.4188,NDCG@5:0.2938) [51.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.20065358 0.07807004]
INFO:root:Epoch 36    loss=0.2007 [66.4 s]	 dev=(HR@5:0.4885,NDCG@5:0.3398) test=(HR@5:0.4214,NDCG@5:0.2949) [51.4 s] 
INFO:root:all_losses: [0.19678046 0.07717434]
INFO:root:Epoch 37    loss=0.1968 [66.4 s]	 dev=(HR@5:0.4734,NDCG@5:0.3312) test=(HR@5:0.4008,NDCG@5:0.2820) [51.7 s] 
INFO:root:all_losses: [0.18983027 0.07669742]
INFO:root:Epoch 38    loss=0.1898 [63.7 s]	 dev=(HR@5:0.4891,NDCG@5:0.3455) test=(HR@5:0.4236,NDCG@5:0.2995) [51.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.18839164 0.07604761]
INFO:root:Epoch 39    loss=0.1884 [63.7 s]	 dev=(HR@5:0.4834,NDCG@5:0.3372) test=(HR@5:0.4173,NDCG@5:0.2906) [51.7 s] 
INFO:root:all_losses: [0.18673038 0.07246694]
INFO:root:Epoch 40    loss=0.1867 [64.7 s]	 dev=(HR@5:0.4785,NDCG@5:0.3363) test=(HR@5:0.4247,NDCG@5:0.2974) [51.5 s] 
INFO:root:all_losses: [0.1795215  0.07205222]
INFO:root:Epoch 41    loss=0.1795 [64.8 s]	 dev=(HR@5:0.4738,NDCG@5:0.3346) test=(HR@5:0.4057,NDCG@5:0.2868) [51.5 s] 
INFO:root:all_losses: [0.17792645 0.07409678]
INFO:root:Epoch 42    loss=0.1779 [62.6 s]	 dev=(HR@5:0.4781,NDCG@5:0.3371) test=(HR@5:0.4080,NDCG@5:0.2899) [51.3 s] 
INFO:root:all_losses: [0.17402785 0.06862095]
INFO:root:Epoch 43    loss=0.1740 [62.6 s]	 dev=(HR@5:0.4828,NDCG@5:0.3414) test=(HR@5:0.4179,NDCG@5:0.2949) [51.4 s] 
INFO:root:all_losses: [0.1672391 0.0684502]
INFO:root:Epoch 44    loss=0.1672 [62.8 s]	 dev=(HR@5:0.4838,NDCG@5:0.3418) test=(HR@5:0.4200,NDCG@5:0.2956) [51.2 s] 
INFO:root:all_losses: [0.1663348  0.06725915]
INFO:root:Epoch 45    loss=0.1663 [67.1 s]	 dev=(HR@5:0.4730,NDCG@5:0.3330) test=(HR@5:0.4053,NDCG@5:0.2869) [51.4 s] 
INFO:root:all_losses: [0.16306636 0.06861245]
INFO:root:Epoch 46    loss=0.1631 [67.0 s]	 dev=(HR@5:0.4661,NDCG@5:0.3294) test=(HR@5:0.4061,NDCG@5:0.2870) [51.2 s] 
INFO:root:all_losses: [0.15867028 0.06438285]
INFO:root:Epoch 47    loss=0.1587 [66.8 s]	 dev=(HR@5:0.4954,NDCG@5:0.3481) test=(HR@5:0.4239,NDCG@5:0.2983) [64.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.15602896 0.06538398]
INFO:root:Epoch 48    loss=0.1560 [88.6 s]	 dev=(HR@5:0.4887,NDCG@5:0.3424) test=(HR@5:0.4257,NDCG@5:0.2993) [107.6 s] 
INFO:root:all_losses: [0.15493621 0.06337059]
INFO:root:Epoch 49    loss=0.1549 [213.1 s]	 dev=(HR@5:0.4740,NDCG@5:0.3357) test=(HR@5:0.4118,NDCG@5:0.2887) [108.0 s] 
INFO:root:all_losses: [0.1521762 0.0642183]
INFO:root:Epoch 50    loss=0.1522 [214.0 s]	 dev=(HR@5:0.4838,NDCG@5:0.3437) test=(HR@5:0.4257,NDCG@5:0.2980) [108.0 s] 
INFO:root:all_losses: [0.1502997  0.06314675]
INFO:root:Epoch 51    loss=0.1503 [211.8 s]	 dev=(HR@5:0.4836,NDCG@5:0.3447) test=(HR@5:0.4243,NDCG@5:0.3013) [108.1 s] 
INFO:root:all_losses: [0.14654602 0.06256757]
INFO:root:Epoch 52    loss=0.1465 [213.1 s]	 dev=(HR@5:0.4879,NDCG@5:0.3434) test=(HR@5:0.4359,NDCG@5:0.3081) [89.4 s] 
INFO:root:all_losses: [0.14309584 0.06133412]
INFO:root:Epoch 53    loss=0.1431 [163.3 s]	 dev=(HR@5:0.4838,NDCG@5:0.3414) test=(HR@5:0.4216,NDCG@5:0.2990) [108.5 s] 
INFO:root:all_losses: [0.14401233 0.06207405]
INFO:root:Epoch 54    loss=0.1440 [213.2 s]	 dev=(HR@5:0.4911,NDCG@5:0.3451) test=(HR@5:0.4300,NDCG@5:0.3012) [107.3 s] 
INFO:root:all_losses: [0.13841581 0.05910464]
INFO:root:Epoch 55    loss=0.1384 [214.4 s]	 dev=(HR@5:0.4824,NDCG@5:0.3422) test=(HR@5:0.4220,NDCG@5:0.2986) [107.0 s] 
INFO:root:all_losses: [0.14361203 0.06091214]
INFO:root:Epoch 56    loss=0.1436 [216.1 s]	 dev=(HR@5:0.4911,NDCG@5:0.3437) test=(HR@5:0.4281,NDCG@5:0.3008) [106.8 s] 
INFO:root:all_losses: [0.13558246 0.05824392]
INFO:root:Epoch 57    loss=0.1356 [213.7 s]	 dev=(HR@5:0.4795,NDCG@5:0.3390) test=(HR@5:0.4253,NDCG@5:0.2978) [107.0 s] 
INFO:root:all_losses: [0.13416265 0.05791655]
INFO:root:Epoch 58    loss=0.1342 [216.8 s]	 dev=(HR@5:0.4789,NDCG@5:0.3370) test=(HR@5:0.4173,NDCG@5:0.2932) [107.1 s] 
INFO:root:all_losses: [0.13601042 0.0588447 ]
INFO:root:Epoch 59    loss=0.1360 [215.0 s]	 dev=(HR@5:0.4864,NDCG@5:0.3413) test=(HR@5:0.4287,NDCG@5:0.2995) [120.8 s] 
INFO:root:all_losses: [0.12796354 0.05587921]
INFO:root:Epoch 60    loss=0.1280 [205.9 s]	 dev=(HR@5:0.4714,NDCG@5:0.3298) test=(HR@5:0.4045,NDCG@5:0.2863) [101.0 s] 
INFO:root:all_losses: [0.12639353 0.0535762 ]
INFO:root:Epoch 61    loss=0.1264 [205.0 s]	 dev=(HR@5:0.4956,NDCG@5:0.3464) test=(HR@5:0.4343,NDCG@5:0.3052) [100.3 s] 
INFO:root:all_losses: [0.13060722 0.05765937]
INFO:root:Epoch 62    loss=0.1306 [204.1 s]	 dev=(HR@5:0.4983,NDCG@5:0.3537) test=(HR@5:0.4502,NDCG@5:0.3162) [100.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12414516 0.05424093]
INFO:root:Epoch 63    loss=0.1241 [204.4 s]	 dev=(HR@5:0.5032,NDCG@5:0.3538) test=(HR@5:0.4538,NDCG@5:0.3178) [99.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12341853 0.05309279]
INFO:root:Epoch 64    loss=0.1234 [206.3 s]	 dev=(HR@5:0.4679,NDCG@5:0.3298) test=(HR@5:0.4057,NDCG@5:0.2855) [99.0 s] 
INFO:root:all_losses: [0.12019476 0.05080278]
INFO:root:Epoch 65    loss=0.1202 [204.6 s]	 dev=(HR@5:0.4813,NDCG@5:0.3383) test=(HR@5:0.4196,NDCG@5:0.2971) [99.5 s] 
INFO:root:all_losses: [0.1207196  0.05383503]
INFO:root:Epoch 66    loss=0.1207 [200.6 s]	 dev=(HR@5:0.4783,NDCG@5:0.3387) test=(HR@5:0.4257,NDCG@5:0.3020) [98.9 s] 
INFO:root:all_losses: [0.12245358 0.05345038]
INFO:root:Epoch 67    loss=0.1225 [203.5 s]	 dev=(HR@5:0.4856,NDCG@5:0.3416) test=(HR@5:0.4334,NDCG@5:0.3073) [98.9 s] 
INFO:root:all_losses: [0.1198848  0.05218136]
INFO:root:Epoch 68    loss=0.1199 [204.4 s]	 dev=(HR@5:0.4909,NDCG@5:0.3497) test=(HR@5:0.4451,NDCG@5:0.3117) [98.7 s] 
INFO:root:all_losses: [0.11886541 0.05369419]
INFO:root:Epoch 69    loss=0.1189 [204.1 s]	 dev=(HR@5:0.4775,NDCG@5:0.3417) test=(HR@5:0.4224,NDCG@5:0.2958) [98.5 s] 
INFO:root:all_losses: [0.12138823 0.0547353 ]
INFO:root:Epoch 70    loss=0.1214 [204.5 s]	 dev=(HR@5:0.4799,NDCG@5:0.3404) test=(HR@5:0.4212,NDCG@5:0.2947) [98.5 s] 
INFO:root:all_losses: [0.11463895 0.05075437]
INFO:root:Epoch 71    loss=0.1146 [205.0 s]	 dev=(HR@5:0.4697,NDCG@5:0.3328) test=(HR@5:0.4098,NDCG@5:0.2883) [97.9 s] 
INFO:root:all_losses: [0.11402617 0.05149757]
INFO:root:Epoch 72    loss=0.1140 [203.7 s]	 dev=(HR@5:0.4932,NDCG@5:0.3512) test=(HR@5:0.4438,NDCG@5:0.3098) [97.9 s] 
INFO:root:all_losses: [0.1123981  0.05038038]
INFO:root:Epoch 73    loss=0.1124 [203.6 s]	 dev=(HR@5:0.4707,NDCG@5:0.3323) test=(HR@5:0.4073,NDCG@5:0.2879) [98.0 s] 
INFO:root:all_losses: [0.11396003 0.05050974]
INFO:root:Epoch 74    loss=0.1140 [204.2 s]	 dev=(HR@5:0.4775,NDCG@5:0.3382) test=(HR@5:0.4228,NDCG@5:0.3005) [98.3 s] 
INFO:root:all_losses: [0.11110424 0.04844354]
INFO:root:Epoch 75    loss=0.1111 [203.7 s]	 dev=(HR@5:0.4866,NDCG@5:0.3435) test=(HR@5:0.4391,NDCG@5:0.3074) [98.1 s] 
INFO:root:all_losses: [0.11212113 0.05012224]
INFO:root:Epoch 76    loss=0.1121 [203.1 s]	 dev=(HR@5:0.4956,NDCG@5:0.3544) test=(HR@5:0.4514,NDCG@5:0.3159) [97.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.10932363 0.04879264]
INFO:root:Epoch 77    loss=0.1093 [204.3 s]	 dev=(HR@5:0.4818,NDCG@5:0.3454) test=(HR@5:0.4379,NDCG@5:0.3074) [97.7 s] 
INFO:root:all_losses: [0.10979108 0.05017011]
INFO:root:Epoch 78    loss=0.1098 [202.7 s]	 dev=(HR@5:0.4712,NDCG@5:0.3399) test=(HR@5:0.4216,NDCG@5:0.2975) [97.4 s] 
INFO:root:all_losses: [0.10697044 0.04788344]
INFO:root:Epoch 79    loss=0.1070 [203.7 s]	 dev=(HR@5:0.4720,NDCG@5:0.3368) test=(HR@5:0.4247,NDCG@5:0.2989) [97.4 s] 
INFO:root:all_losses: [0.10701969 0.04765505]
INFO:root:Epoch 80    loss=0.1070 [204.8 s]	 dev=(HR@5:0.4852,NDCG@5:0.3458) test=(HR@5:0.4347,NDCG@5:0.3068) [97.2 s] 
INFO:root:all_losses: [0.10973554 0.0507144 ]
INFO:root:Epoch 81    loss=0.1097 [203.8 s]	 dev=(HR@5:0.4699,NDCG@5:0.3370) test=(HR@5:0.4192,NDCG@5:0.2966) [97.1 s] 
INFO:root:all_losses: [0.10694066 0.04875045]
INFO:root:Epoch 82    loss=0.1069 [204.8 s]	 dev=(HR@5:0.4685,NDCG@5:0.3358) test=(HR@5:0.4112,NDCG@5:0.2943) [96.9 s] 
INFO:root:all_losses: [0.10272327 0.04713166]
INFO:root:Epoch 83    loss=0.1027 [201.0 s]	 dev=(HR@5:0.4785,NDCG@5:0.3394) test=(HR@5:0.4330,NDCG@5:0.3066) [96.8 s] 
INFO:root:all_losses: [0.1077916  0.04998073]
INFO:root:Epoch 84    loss=0.1078 [202.9 s]	 dev=(HR@5:0.4824,NDCG@5:0.3415) test=(HR@5:0.4357,NDCG@5:0.3055) [96.8 s] 
INFO:root:all_losses: [0.10607114 0.04829769]
INFO:root:Epoch 85    loss=0.1061 [203.7 s]	 dev=(HR@5:0.4785,NDCG@5:0.3417) test=(HR@5:0.4287,NDCG@5:0.3024) [96.5 s] 
INFO:root:all_losses: [0.10291528 0.04717195]
INFO:root:Epoch 86    loss=0.1029 [200.8 s]	 dev=(HR@5:0.4693,NDCG@5:0.3344) test=(HR@5:0.4126,NDCG@5:0.2907) [96.2 s] 
INFO:root:all_losses: [0.10215191 0.04720069]
INFO:root:Epoch 87    loss=0.1022 [202.6 s]	 dev=(HR@5:0.4852,NDCG@5:0.3443) test=(HR@5:0.4432,NDCG@5:0.3107) [95.8 s] 
INFO:root:all_losses: [0.10441274 0.04841316]
INFO:root:Epoch 88    loss=0.1044 [202.7 s]	 dev=(HR@5:0.4703,NDCG@5:0.3346) test=(HR@5:0.4192,NDCG@5:0.2940) [96.0 s] 
INFO:root:all_losses: [0.10228429 0.04683257]
INFO:root:Epoch 89    loss=0.1023 [203.7 s]	 dev=(HR@5:0.4722,NDCG@5:0.3338) test=(HR@5:0.4206,NDCG@5:0.2941) [95.7 s] 
INFO:root:all_losses: [0.09625527 0.04466122]
INFO:root:Epoch 90    loss=0.0963 [200.6 s]	 dev=(HR@5:0.4807,NDCG@5:0.3401) test=(HR@5:0.4469,NDCG@5:0.3112) [95.5 s] 
INFO:root:all_losses: [0.09992084 0.04561347]
INFO:root:Epoch 91    loss=0.0999 [202.8 s]	 dev=(HR@5:0.4744,NDCG@5:0.3373) test=(HR@5:0.4267,NDCG@5:0.3031) [95.7 s] 
INFO:root:all_losses: [0.09990554 0.04562117]
INFO:root:Epoch 92    loss=0.0999 [201.1 s]	 dev=(HR@5:0.4795,NDCG@5:0.3444) test=(HR@5:0.4340,NDCG@5:0.3026) [95.4 s] 
INFO:root:all_losses: [0.09576178 0.04366886]
INFO:root:Epoch 93    loss=0.0958 [202.4 s]	 dev=(HR@5:0.4667,NDCG@5:0.3353) test=(HR@5:0.4112,NDCG@5:0.2878) [95.0 s] 
INFO:root:all_losses: [0.10087296 0.04608224]
INFO:root:Epoch 94    loss=0.1009 [202.3 s]	 dev=(HR@5:0.4536,NDCG@5:0.3236) test=(HR@5:0.4086,NDCG@5:0.2869) [95.6 s] 
INFO:root:all_losses: [0.09530426 0.04476256]
INFO:root:Epoch 95    loss=0.0953 [203.6 s]	 dev=(HR@5:0.4699,NDCG@5:0.3389) test=(HR@5:0.4204,NDCG@5:0.2927) [94.8 s] 
INFO:root:all_losses: [0.09753907 0.04433271]
INFO:root:Epoch 96    loss=0.0975 [204.6 s]	 dev=(HR@5:0.4693,NDCG@5:0.3365) test=(HR@5:0.4130,NDCG@5:0.2882) [95.1 s] 
INFO:root:Early stop at 96 based on dev result.
INFO:root:
Best Iter(dev)=   76	 dev=(HR@5:0.4956,NDCG@5:0.3544) test=(HR@5:0.4514,NDCG@5:0.3159) [20436.1 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=6_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6047,HR@5:0.4514,HR@50:0.8805,NDCG@10:0.3656,NDCG@5:0.3159,NDCG@50:0.4271)
INFO:root:
--------------------------------------------- END: 2025-04-22 01:48:08 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-10 19:46:50 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | Office       
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 6            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader.pkl
INFO:root:#params: 624768
INFO:root:KDA(
  (user_embeddings): Embedding(4906, 64)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(5, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(5, 64)
    (freq_real): Embedding(5, 33)
    (freq_imag): Embedding(5, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0471,HR@50:0.5032,NDCG@10:0.0442,NDCG@5:0.0282,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.300623 0.693116]
INFO:root:Epoch 1     loss=1.3006 [43.2 s]	 dev=(HR@5:0.1058,NDCG@5:0.0624) test=(HR@5:0.0703,NDCG@5:0.0407) [38.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.244884  0.6929533]
INFO:root:Epoch 2     loss=1.2449 [43.9 s]	 dev=(HR@5:0.1146,NDCG@5:0.0689) test=(HR@5:0.0709,NDCG@5:0.0421) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.2427118  0.69262546]
INFO:root:Epoch 3     loss=1.2427 [44.6 s]	 dev=(HR@5:0.1119,NDCG@5:0.0637) test=(HR@5:0.0781,NDCG@5:0.0438) [38.6 s] 
INFO:root:all_losses: [1.2394567 0.6923348]
INFO:root:Epoch 4     loss=1.2395 [51.8 s]	 dev=(HR@5:0.1134,NDCG@5:0.0675) test=(HR@5:0.0760,NDCG@5:0.0437) [38.8 s] 
INFO:root:all_losses: [1.2072306 0.6916486]
INFO:root:Epoch 5     loss=1.2072 [44.8 s]	 dev=(HR@5:0.1580,NDCG@5:0.0948) test=(HR@5:0.1140,NDCG@5:0.0704) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.163617  0.6884734]
INFO:root:Epoch 6     loss=1.1636 [44.0 s]	 dev=(HR@5:0.1766,NDCG@5:0.1078) test=(HR@5:0.1299,NDCG@5:0.0802) [38.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.1280627 0.6804191]
INFO:root:Epoch 7     loss=1.1281 [43.8 s]	 dev=(HR@5:0.1973,NDCG@5:0.1229) test=(HR@5:0.1407,NDCG@5:0.0899) [38.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [1.0914618  0.65823686]
INFO:root:Epoch 8     loss=1.0915 [41.1 s]	 dev=(HR@5:0.1957,NDCG@5:0.1214) test=(HR@5:0.1452,NDCG@5:0.0906) [37.4 s] 
INFO:root:all_losses: [1.0251237  0.61008155]
INFO:root:Epoch 9     loss=1.0251 [42.8 s]	 dev=(HR@5:0.2294,NDCG@5:0.1423) test=(HR@5:0.1684,NDCG@5:0.1054) [37.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.9271768 0.5452568]
INFO:root:Epoch 10    loss=0.9272 [44.7 s]	 dev=(HR@5:0.2426,NDCG@5:0.1516) test=(HR@5:0.1751,NDCG@5:0.1103) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.8268424  0.47956076]
INFO:root:Epoch 11    loss=0.8268 [45.0 s]	 dev=(HR@5:0.3076,NDCG@5:0.1973) test=(HR@5:0.2340,NDCG@5:0.1509) [44.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.73039985 0.41530955]
INFO:root:Epoch 12    loss=0.7304 [45.0 s]	 dev=(HR@5:0.3358,NDCG@5:0.2161) test=(HR@5:0.2461,NDCG@5:0.1594) [44.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.6334064  0.34908697]
INFO:root:Epoch 13    loss=0.6334 [45.3 s]	 dev=(HR@5:0.3757,NDCG@5:0.2442) test=(HR@5:0.2822,NDCG@5:0.1849) [44.8 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.5552106  0.29616588]
INFO:root:Epoch 14    loss=0.5552 [45.3 s]	 dev=(HR@5:0.3825,NDCG@5:0.2521) test=(HR@5:0.2924,NDCG@5:0.1929) [44.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.49655116 0.25615016]
INFO:root:Epoch 15    loss=0.4966 [45.3 s]	 dev=(HR@5:0.3994,NDCG@5:0.2658) test=(HR@5:0.2985,NDCG@5:0.1978) [44.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.45118436 0.223305  ]
INFO:root:Epoch 16    loss=0.4512 [45.5 s]	 dev=(HR@5:0.3990,NDCG@5:0.2684) test=(HR@5:0.3217,NDCG@5:0.2142) [44.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.4138594  0.19775589]
INFO:root:Epoch 17    loss=0.4139 [45.6 s]	 dev=(HR@5:0.4177,NDCG@5:0.2785) test=(HR@5:0.3382,NDCG@5:0.2192) [44.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.37237275 0.17460646]
INFO:root:Epoch 18    loss=0.3724 [44.7 s]	 dev=(HR@5:0.4393,NDCG@5:0.2978) test=(HR@5:0.3417,NDCG@5:0.2327) [44.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.35156295 0.16073948]
INFO:root:Epoch 19    loss=0.3516 [44.5 s]	 dev=(HR@5:0.4298,NDCG@5:0.2918) test=(HR@5:0.3488,NDCG@5:0.2347) [44.2 s] 
INFO:root:all_losses: [0.33001152 0.14796993]
INFO:root:Epoch 20    loss=0.3300 [45.7 s]	 dev=(HR@5:0.4532,NDCG@5:0.3108) test=(HR@5:0.3839,NDCG@5:0.2551) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.31257126 0.13823736]
INFO:root:Epoch 21    loss=0.3126 [44.9 s]	 dev=(HR@5:0.4457,NDCG@5:0.2993) test=(HR@5:0.3613,NDCG@5:0.2419) [43.9 s] 
INFO:root:all_losses: [0.29760516 0.12808847]
INFO:root:Epoch 22    loss=0.2976 [45.4 s]	 dev=(HR@5:0.4534,NDCG@5:0.3142) test=(HR@5:0.3668,NDCG@5:0.2489) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.28318334 0.12029256]
INFO:root:Epoch 23    loss=0.2832 [45.4 s]	 dev=(HR@5:0.4681,NDCG@5:0.3239) test=(HR@5:0.3971,NDCG@5:0.2667) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.26651797 0.11350463]
INFO:root:Epoch 24    loss=0.2665 [45.4 s]	 dev=(HR@5:0.4514,NDCG@5:0.3116) test=(HR@5:0.3735,NDCG@5:0.2525) [43.8 s] 
INFO:root:all_losses: [0.25632617 0.10875477]
INFO:root:Epoch 25    loss=0.2563 [45.6 s]	 dev=(HR@5:0.4742,NDCG@5:0.3256) test=(HR@5:0.3935,NDCG@5:0.2663) [43.9 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.25039524 0.10350245]
INFO:root:Epoch 26    loss=0.2504 [45.4 s]	 dev=(HR@5:0.4697,NDCG@5:0.3230) test=(HR@5:0.3886,NDCG@5:0.2650) [43.7 s] 
INFO:root:all_losses: [0.23726018 0.09773771]
INFO:root:Epoch 27    loss=0.2373 [45.4 s]	 dev=(HR@5:0.4742,NDCG@5:0.3298) test=(HR@5:0.4059,NDCG@5:0.2769) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.22715163 0.09421065]
INFO:root:Epoch 28    loss=0.2272 [45.5 s]	 dev=(HR@5:0.4762,NDCG@5:0.3273) test=(HR@5:0.3927,NDCG@5:0.2668) [43.6 s] 
INFO:root:all_losses: [0.22101462 0.09213642]
INFO:root:Epoch 29    loss=0.2210 [45.2 s]	 dev=(HR@5:0.4830,NDCG@5:0.3349) test=(HR@5:0.4057,NDCG@5:0.2758) [43.5 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.21537036 0.09024334]
INFO:root:Epoch 30    loss=0.2154 [45.4 s]	 dev=(HR@5:0.4760,NDCG@5:0.3347) test=(HR@5:0.4073,NDCG@5:0.2784) [43.8 s] 
INFO:root:all_losses: [0.21148571 0.08682711]
INFO:root:Epoch 31    loss=0.2115 [45.3 s]	 dev=(HR@5:0.4836,NDCG@5:0.3403) test=(HR@5:0.4183,NDCG@5:0.2844) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.20946631 0.08745165]
INFO:root:Epoch 32    loss=0.2095 [45.3 s]	 dev=(HR@5:0.4889,NDCG@5:0.3396) test=(HR@5:0.4277,NDCG@5:0.2869) [43.6 s] 
INFO:root:all_losses: [0.1994728  0.08312276]
INFO:root:Epoch 33    loss=0.1995 [45.5 s]	 dev=(HR@5:0.4791,NDCG@5:0.3334) test=(HR@5:0.3943,NDCG@5:0.2725) [43.4 s] 
INFO:root:all_losses: [0.1900025  0.07997621]
INFO:root:Epoch 34    loss=0.1900 [45.4 s]	 dev=(HR@5:0.4956,NDCG@5:0.3438) test=(HR@5:0.4232,NDCG@5:0.2880) [43.6 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.19005804 0.07976286]
INFO:root:Epoch 35    loss=0.1901 [45.4 s]	 dev=(HR@5:0.4850,NDCG@5:0.3373) test=(HR@5:0.4263,NDCG@5:0.2916) [43.6 s] 
INFO:root:all_losses: [0.1844494  0.07676245]
INFO:root:Epoch 36    loss=0.1844 [45.7 s]	 dev=(HR@5:0.4728,NDCG@5:0.3266) test=(HR@5:0.4039,NDCG@5:0.2771) [43.5 s] 
INFO:root:all_losses: [0.18155995 0.07563458]
INFO:root:Epoch 37    loss=0.1816 [45.3 s]	 dev=(HR@5:0.4644,NDCG@5:0.3255) test=(HR@5:0.3865,NDCG@5:0.2668) [43.5 s] 
INFO:root:all_losses: [0.17516397 0.07444944]
INFO:root:Epoch 38    loss=0.1752 [45.4 s]	 dev=(HR@5:0.4824,NDCG@5:0.3399) test=(HR@5:0.4077,NDCG@5:0.2781) [43.6 s] 
INFO:root:all_losses: [0.17160726 0.07257473]
INFO:root:Epoch 39    loss=0.1716 [45.3 s]	 dev=(HR@5:0.4897,NDCG@5:0.3441) test=(HR@5:0.4153,NDCG@5:0.2861) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.17278853 0.07071217]
INFO:root:Epoch 40    loss=0.1728 [45.2 s]	 dev=(HR@5:0.4673,NDCG@5:0.3273) test=(HR@5:0.4245,NDCG@5:0.2896) [43.4 s] 
INFO:root:all_losses: [0.16519684 0.07005143]
INFO:root:Epoch 41    loss=0.1652 [45.4 s]	 dev=(HR@5:0.4836,NDCG@5:0.3397) test=(HR@5:0.4126,NDCG@5:0.2809) [43.3 s] 
INFO:root:all_losses: [0.16533536 0.07113021]
INFO:root:Epoch 42    loss=0.1653 [45.3 s]	 dev=(HR@5:0.4864,NDCG@5:0.3434) test=(HR@5:0.4304,NDCG@5:0.2937) [43.3 s] 
INFO:root:all_losses: [0.1617634  0.06689352]
INFO:root:Epoch 43    loss=0.1618 [45.4 s]	 dev=(HR@5:0.4852,NDCG@5:0.3403) test=(HR@5:0.4212,NDCG@5:0.2866) [43.3 s] 
INFO:root:all_losses: [0.16020234 0.06740051]
INFO:root:Epoch 44    loss=0.1602 [45.6 s]	 dev=(HR@5:0.4762,NDCG@5:0.3341) test=(HR@5:0.4247,NDCG@5:0.2892) [43.2 s] 
INFO:root:all_losses: [0.15643188 0.06511512]
INFO:root:Epoch 45    loss=0.1564 [45.6 s]	 dev=(HR@5:0.4756,NDCG@5:0.3320) test=(HR@5:0.4045,NDCG@5:0.2783) [43.1 s] 
INFO:root:all_losses: [0.15239054 0.06666405]
INFO:root:Epoch 46    loss=0.1524 [45.3 s]	 dev=(HR@5:0.4862,NDCG@5:0.3410) test=(HR@5:0.4218,NDCG@5:0.2881) [43.2 s] 
INFO:root:all_losses: [0.14893246 0.0623638 ]
INFO:root:Epoch 47    loss=0.1489 [45.5 s]	 dev=(HR@5:0.4883,NDCG@5:0.3402) test=(HR@5:0.4196,NDCG@5:0.2857) [43.2 s] 
INFO:root:all_losses: [0.15030354 0.06424083]
INFO:root:Epoch 48    loss=0.1503 [45.3 s]	 dev=(HR@5:0.4944,NDCG@5:0.3475) test=(HR@5:0.4275,NDCG@5:0.2917) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14628038 0.06112545]
INFO:root:Epoch 49    loss=0.1463 [45.5 s]	 dev=(HR@5:0.4985,NDCG@5:0.3521) test=(HR@5:0.4367,NDCG@5:0.3001) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.14629497 0.06189528]
INFO:root:Epoch 50    loss=0.1463 [45.4 s]	 dev=(HR@5:0.4907,NDCG@5:0.3431) test=(HR@5:0.4243,NDCG@5:0.2907) [43.0 s] 
INFO:root:all_losses: [0.14146195 0.06085481]
INFO:root:Epoch 51    loss=0.1415 [45.4 s]	 dev=(HR@5:0.4842,NDCG@5:0.3447) test=(HR@5:0.4173,NDCG@5:0.2889) [43.2 s] 
INFO:root:all_losses: [0.14134645 0.06078044]
INFO:root:Epoch 52    loss=0.1413 [45.6 s]	 dev=(HR@5:0.4930,NDCG@5:0.3483) test=(HR@5:0.4316,NDCG@5:0.2967) [42.9 s] 
INFO:root:all_losses: [0.1378311  0.05892898]
INFO:root:Epoch 53    loss=0.1378 [45.4 s]	 dev=(HR@5:0.4854,NDCG@5:0.3420) test=(HR@5:0.4273,NDCG@5:0.2923) [43.2 s] 
INFO:root:all_losses: [0.13982573 0.06070574]
INFO:root:Epoch 54    loss=0.1398 [45.3 s]	 dev=(HR@5:0.4977,NDCG@5:0.3490) test=(HR@5:0.4365,NDCG@5:0.2965) [42.9 s] 
INFO:root:all_losses: [0.13401482 0.05823286]
INFO:root:Epoch 55    loss=0.1340 [45.6 s]	 dev=(HR@5:0.4897,NDCG@5:0.3462) test=(HR@5:0.4324,NDCG@5:0.2989) [43.0 s] 
INFO:root:all_losses: [0.1398029  0.06069138]
INFO:root:Epoch 56    loss=0.1398 [45.4 s]	 dev=(HR@5:0.4795,NDCG@5:0.3357) test=(HR@5:0.4220,NDCG@5:0.2912) [43.0 s] 
INFO:root:all_losses: [0.13474534 0.05710881]
INFO:root:Epoch 57    loss=0.1347 [45.4 s]	 dev=(HR@5:0.4718,NDCG@5:0.3339) test=(HR@5:0.3994,NDCG@5:0.2756) [42.8 s] 
INFO:root:all_losses: [0.13157026 0.05588115]
INFO:root:Epoch 58    loss=0.1316 [45.4 s]	 dev=(HR@5:0.4926,NDCG@5:0.3463) test=(HR@5:0.4373,NDCG@5:0.3025) [42.9 s] 
INFO:root:all_losses: [0.1316148  0.05737099]
INFO:root:Epoch 59    loss=0.1316 [45.4 s]	 dev=(HR@5:0.4873,NDCG@5:0.3412) test=(HR@5:0.4200,NDCG@5:0.2886) [43.0 s] 
INFO:root:all_losses: [0.12767898 0.05599811]
INFO:root:Epoch 60    loss=0.1277 [45.5 s]	 dev=(HR@5:0.4887,NDCG@5:0.3439) test=(HR@5:0.4259,NDCG@5:0.2943) [42.9 s] 
INFO:root:all_losses: [0.12674017 0.05253987]
INFO:root:Epoch 61    loss=0.1267 [45.4 s]	 dev=(HR@5:0.4879,NDCG@5:0.3439) test=(HR@5:0.4192,NDCG@5:0.2892) [42.8 s] 
INFO:root:all_losses: [0.1282899  0.05579261]
INFO:root:Epoch 62    loss=0.1283 [45.4 s]	 dev=(HR@5:0.4866,NDCG@5:0.3391) test=(HR@5:0.4249,NDCG@5:0.2913) [42.8 s] 
INFO:root:all_losses: [0.1232416  0.05331318]
INFO:root:Epoch 63    loss=0.1232 [45.8 s]	 dev=(HR@5:0.4989,NDCG@5:0.3515) test=(HR@5:0.4369,NDCG@5:0.3030) [42.6 s] 
INFO:root:all_losses: [0.12012732 0.05262919]
INFO:root:Epoch 64    loss=0.1201 [45.4 s]	 dev=(HR@5:0.4824,NDCG@5:0.3401) test=(HR@5:0.4141,NDCG@5:0.2871) [43.0 s] 
INFO:root:all_losses: [0.12192164 0.05156248]
INFO:root:Epoch 65    loss=0.1219 [49.0 s]	 dev=(HR@5:0.4738,NDCG@5:0.3332) test=(HR@5:0.4198,NDCG@5:0.2883) [44.2 s] 
INFO:root:all_losses: [0.11985681 0.0522222 ]
INFO:root:Epoch 66    loss=0.1199 [48.5 s]	 dev=(HR@5:0.4907,NDCG@5:0.3412) test=(HR@5:0.4414,NDCG@5:0.3018) [44.2 s] 
INFO:root:all_losses: [0.12205505 0.05271994]
INFO:root:Epoch 67    loss=0.1221 [48.5 s]	 dev=(HR@5:0.4775,NDCG@5:0.3404) test=(HR@5:0.4230,NDCG@5:0.2904) [43.9 s] 
INFO:root:all_losses: [0.11861502 0.05090267]
INFO:root:Epoch 68    loss=0.1186 [48.5 s]	 dev=(HR@5:0.4958,NDCG@5:0.3532) test=(HR@5:0.4444,NDCG@5:0.3051) [44.2 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.11874993 0.05251974]
INFO:root:Epoch 69    loss=0.1187 [48.4 s]	 dev=(HR@5:0.5019,NDCG@5:0.3554) test=(HR@5:0.4473,NDCG@5:0.3061) [44.0 s] 
INFO:root:Save model to ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num...
INFO:root:all_losses: [0.12208281 0.054371  ]
INFO:root:Epoch 70    loss=0.1221 [47.1 s]	 dev=(HR@5:0.4656,NDCG@5:0.3292) test=(HR@5:0.4020,NDCG@5:0.2787) [42.9 s] 
INFO:root:all_losses: [0.11536434 0.05069556]
INFO:root:Epoch 71    loss=0.1154 [45.8 s]	 dev=(HR@5:0.4922,NDCG@5:0.3455) test=(HR@5:0.4269,NDCG@5:0.2940) [42.8 s] 
INFO:root:all_losses: [0.11637175 0.05136436]
INFO:root:Epoch 72    loss=0.1164 [45.5 s]	 dev=(HR@5:0.4793,NDCG@5:0.3381) test=(HR@5:0.4318,NDCG@5:0.2983) [42.8 s] 
INFO:root:all_losses: [0.11118779 0.04784407]
INFO:root:Epoch 73    loss=0.1112 [45.5 s]	 dev=(HR@5:0.4746,NDCG@5:0.3342) test=(HR@5:0.4057,NDCG@5:0.2801) [42.8 s] 
INFO:root:all_losses: [0.11444373 0.05042245]
INFO:root:Epoch 74    loss=0.1144 [45.4 s]	 dev=(HR@5:0.4783,NDCG@5:0.3394) test=(HR@5:0.4022,NDCG@5:0.2813) [42.7 s] 
INFO:root:all_losses: [0.11385794 0.04875008]
INFO:root:Epoch 75    loss=0.1139 [45.5 s]	 dev=(HR@5:0.4610,NDCG@5:0.3270) test=(HR@5:0.3990,NDCG@5:0.2777) [42.6 s] 
INFO:root:all_losses: [0.11384591 0.0499457 ]
INFO:root:Epoch 76    loss=0.1138 [45.5 s]	 dev=(HR@5:0.4899,NDCG@5:0.3458) test=(HR@5:0.4245,NDCG@5:0.2983) [42.8 s] 
INFO:root:all_losses: [0.10909711 0.04823961]
INFO:root:Epoch 77    loss=0.1091 [45.4 s]	 dev=(HR@5:0.4885,NDCG@5:0.3475) test=(HR@5:0.4253,NDCG@5:0.2998) [43.0 s] 
INFO:root:all_losses: [0.11183412 0.04956282]
INFO:root:Epoch 78    loss=0.1118 [45.4 s]	 dev=(HR@5:0.4811,NDCG@5:0.3413) test=(HR@5:0.4075,NDCG@5:0.2843) [42.9 s] 
INFO:root:all_losses: [0.10893881 0.04722644]
INFO:root:Epoch 79    loss=0.1089 [45.5 s]	 dev=(HR@5:0.4895,NDCG@5:0.3480) test=(HR@5:0.4391,NDCG@5:0.3021) [42.7 s] 
INFO:root:all_losses: [0.11113372 0.04805091]
INFO:root:Epoch 80    loss=0.1111 [45.4 s]	 dev=(HR@5:0.4952,NDCG@5:0.3525) test=(HR@5:0.4457,NDCG@5:0.3108) [42.5 s] 
INFO:root:all_losses: [0.11316209 0.05091093]
INFO:root:Epoch 81    loss=0.1132 [45.3 s]	 dev=(HR@5:0.4679,NDCG@5:0.3327) test=(HR@5:0.3949,NDCG@5:0.2773) [42.8 s] 
INFO:root:all_losses: [0.10860274 0.04859225]
INFO:root:Epoch 82    loss=0.1086 [45.6 s]	 dev=(HR@5:0.4897,NDCG@5:0.3471) test=(HR@5:0.4316,NDCG@5:0.2968) [42.7 s] 
INFO:root:all_losses: [0.10655123 0.04633272]
INFO:root:Epoch 83    loss=0.1066 [45.4 s]	 dev=(HR@5:0.4805,NDCG@5:0.3381) test=(HR@5:0.4357,NDCG@5:0.2984) [42.8 s] 
INFO:root:all_losses: [0.10914785 0.049644  ]
INFO:root:Epoch 84    loss=0.1091 [45.4 s]	 dev=(HR@5:0.4905,NDCG@5:0.3497) test=(HR@5:0.4173,NDCG@5:0.2904) [42.8 s] 
INFO:root:all_losses: [0.10638219 0.04693943]
INFO:root:Epoch 85    loss=0.1064 [45.4 s]	 dev=(HR@5:0.4758,NDCG@5:0.3365) test=(HR@5:0.4165,NDCG@5:0.2908) [42.4 s] 
INFO:root:all_losses: [0.10298602 0.04573075]
INFO:root:Epoch 86    loss=0.1030 [45.4 s]	 dev=(HR@5:0.4779,NDCG@5:0.3381) test=(HR@5:0.4049,NDCG@5:0.2812) [42.6 s] 
INFO:root:all_losses: [0.10711502 0.04731723]
INFO:root:Epoch 87    loss=0.1071 [45.6 s]	 dev=(HR@5:0.4883,NDCG@5:0.3482) test=(HR@5:0.4175,NDCG@5:0.2924) [42.6 s] 
INFO:root:all_losses: [0.10443228 0.04680701]
INFO:root:Epoch 88    loss=0.1044 [48.8 s]	 dev=(HR@5:0.4936,NDCG@5:0.3476) test=(HR@5:0.4157,NDCG@5:0.2912) [43.8 s] 
INFO:root:all_losses: [0.10477658 0.04650879]
INFO:root:Epoch 89    loss=0.1048 [48.3 s]	 dev=(HR@5:0.4983,NDCG@5:0.3499) test=(HR@5:0.4324,NDCG@5:0.2997) [44.0 s] 
INFO:root:Early stop at 89 based on dev result.
INFO:root:
Best Iter(dev)=   69	 dev=(HR@5:0.5019,NDCG@5:0.3554) test=(HR@5:0.4473,NDCG@5:0.3061) [7873.3 s] 
INFO:root:Load model from ../model/KDA/KDA_Office_2019_lr=0.001_l2=1e-06_num_layers=6_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6120,HR@5:0.4473,HR@50:0.8795,NDCG@10:0.3595,NDCG@5:0.3062,NDCG@50:0.4193)
INFO:root:
--------------------------------------------- END: 2025-05-10 21:58:44 ---------------------------------------------
