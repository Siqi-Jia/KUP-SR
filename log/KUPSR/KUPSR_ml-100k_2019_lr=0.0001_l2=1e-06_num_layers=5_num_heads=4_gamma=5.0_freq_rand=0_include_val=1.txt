INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-07-15 19:19:58 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 0            
 gamma           | 5.0          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [4.0122547 0.6931464]
INFO:root:Epoch 1     loss=4.0123 [121.1 s]	 dev=(HR@5:0.2333,NDCG@5:0.1553) test=(HR@5:0.2163,NDCG@5:0.1478) [28.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.9002764 0.6931392]
INFO:root:Epoch 2     loss=3.9003 [122.3 s]	 dev=(HR@5:0.2322,NDCG@5:0.1528) test=(HR@5:0.2110,NDCG@5:0.1441) [28.2 s] 
INFO:root:all_losses: [3.8770962  0.69312334]
INFO:root:Epoch 3     loss=3.8771 [120.8 s]	 dev=(HR@5:0.2238,NDCG@5:0.1509) test=(HR@5:0.2047,NDCG@5:0.1430) [28.0 s] 
INFO:root:all_losses: [3.8685074  0.69310206]
INFO:root:Epoch 4     loss=3.8685 [120.5 s]	 dev=(HR@5:0.2322,NDCG@5:0.1558) test=(HR@5:0.2089,NDCG@5:0.1439) [28.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.867738  0.6930856]
INFO:root:Epoch 5     loss=3.8677 [121.2 s]	 dev=(HR@5:0.2333,NDCG@5:0.1576) test=(HR@5:0.2100,NDCG@5:0.1425) [28.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.8658257 0.6930553]
INFO:root:Epoch 6     loss=3.8658 [122.9 s]	 dev=(HR@5:0.2407,NDCG@5:0.1595) test=(HR@5:0.2131,NDCG@5:0.1447) [28.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.864998   0.69303626]
INFO:root:Epoch 7     loss=3.8650 [130.4 s]	 dev=(HR@5:0.2280,NDCG@5:0.1545) test=(HR@5:0.2163,NDCG@5:0.1454) [28.3 s] 
INFO:root:all_losses: [3.8658943 0.693014 ]
INFO:root:Epoch 8     loss=3.8659 [143.4 s]	 dev=(HR@5:0.2333,NDCG@5:0.1549) test=(HR@5:0.2110,NDCG@5:0.1455) [28.2 s] 
INFO:root:all_losses: [3.8637822 0.6930011]
INFO:root:Epoch 9     loss=3.8638 [177.4 s]	 dev=(HR@5:0.2333,NDCG@5:0.1543) test=(HR@5:0.2163,NDCG@5:0.1486) [28.2 s] 
INFO:root:all_losses: [3.8665895 0.6929826]
INFO:root:Epoch 10    loss=3.8666 [192.3 s]	 dev=(HR@5:0.2291,NDCG@5:0.1501) test=(HR@5:0.2110,NDCG@5:0.1458) [27.8 s] 
INFO:root:all_losses: [3.8655047 0.6929511]
INFO:root:Epoch 11    loss=3.8655 [191.2 s]	 dev=(HR@5:0.2397,NDCG@5:0.1546) test=(HR@5:0.2163,NDCG@5:0.1462) [28.1 s] 
INFO:root:all_losses: [3.862056  0.6929225]
INFO:root:Epoch 12    loss=3.8621 [178.8 s]	 dev=(HR@5:0.2301,NDCG@5:0.1518) test=(HR@5:0.2121,NDCG@5:0.1424) [29.1 s] 
INFO:root:all_losses: [3.863614  0.6929231]
INFO:root:Epoch 13    loss=3.8636 [150.3 s]	 dev=(HR@5:0.2386,NDCG@5:0.1555) test=(HR@5:0.2110,NDCG@5:0.1446) [31.2 s] 
INFO:root:all_losses: [3.8608515 0.6928757]
INFO:root:Epoch 14    loss=3.8609 [146.0 s]	 dev=(HR@5:0.2354,NDCG@5:0.1523) test=(HR@5:0.2142,NDCG@5:0.1450) [33.2 s] 
INFO:root:all_losses: [3.8462133 0.6928292]
INFO:root:Epoch 15    loss=3.8462 [171.4 s]	 dev=(HR@5:0.2397,NDCG@5:0.1574) test=(HR@5:0.2142,NDCG@5:0.1444) [39.3 s] 
INFO:root:all_losses: [3.8366077  0.69274855]
INFO:root:Epoch 16    loss=3.8366 [219.3 s]	 dev=(HR@5:0.2428,NDCG@5:0.1615) test=(HR@5:0.2131,NDCG@5:0.1440) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.8268998 0.692613 ]
INFO:root:Epoch 17    loss=3.8269 [282.0 s]	 dev=(HR@5:0.2619,NDCG@5:0.1718) test=(HR@5:0.2227,NDCG@5:0.1502) [32.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.8165574  0.69253254]
INFO:root:Epoch 18    loss=3.8166 [336.0 s]	 dev=(HR@5:0.2672,NDCG@5:0.1724) test=(HR@5:0.2354,NDCG@5:0.1560) [28.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.8040462  0.69235617]
INFO:root:Epoch 19    loss=3.8040 [368.3 s]	 dev=(HR@5:0.2821,NDCG@5:0.1840) test=(HR@5:0.2397,NDCG@5:0.1601) [28.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.7731464 0.6920702]
INFO:root:Epoch 20    loss=3.7731 [387.2 s]	 dev=(HR@5:0.3574,NDCG@5:0.2415) test=(HR@5:0.3022,NDCG@5:0.2088) [28.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.73969    0.69177806]
INFO:root:Epoch 21    loss=3.7397 [390.6 s]	 dev=(HR@5:0.3998,NDCG@5:0.2782) test=(HR@5:0.3510,NDCG@5:0.2394) [29.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.713126   0.69131136]
INFO:root:Epoch 22    loss=3.7131 [384.7 s]	 dev=(HR@5:0.4369,NDCG@5:0.3139) test=(HR@5:0.3955,NDCG@5:0.2661) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.6945295  0.69068354]
INFO:root:Epoch 23    loss=3.6945 [386.2 s]	 dev=(HR@5:0.4634,NDCG@5:0.3296) test=(HR@5:0.4221,NDCG@5:0.2801) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.6748104 0.6898246]
INFO:root:Epoch 24    loss=3.6748 [392.3 s]	 dev=(HR@5:0.4814,NDCG@5:0.3399) test=(HR@5:0.4496,NDCG@5:0.3025) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.658874 0.688786]
INFO:root:Epoch 25    loss=3.6589 [396.2 s]	 dev=(HR@5:0.4655,NDCG@5:0.3308) test=(HR@5:0.4358,NDCG@5:0.2936) [30.2 s] 
INFO:root:all_losses: [3.6452477  0.68769026]
INFO:root:Epoch 26    loss=3.6452 [349.4 s]	 dev=(HR@5:0.4910,NDCG@5:0.3484) test=(HR@5:0.4613,NDCG@5:0.3076) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.6304157 0.686167 ]
INFO:root:Epoch 27    loss=3.6304 [254.3 s]	 dev=(HR@5:0.4878,NDCG@5:0.3462) test=(HR@5:0.4708,NDCG@5:0.3141) [32.6 s] 
INFO:root:all_losses: [3.618981   0.68471503]
INFO:root:Epoch 28    loss=3.6190 [253.6 s]	 dev=(HR@5:0.5037,NDCG@5:0.3557) test=(HR@5:0.4751,NDCG@5:0.3196) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.603682   0.68261516]
INFO:root:Epoch 29    loss=3.6037 [179.0 s]	 dev=(HR@5:0.4836,NDCG@5:0.3412) test=(HR@5:0.4539,NDCG@5:0.3102) [32.9 s] 
INFO:root:all_losses: [3.5875144 0.6799454]
INFO:root:Epoch 30    loss=3.5875 [151.3 s]	 dev=(HR@5:0.5122,NDCG@5:0.3543) test=(HR@5:0.4783,NDCG@5:0.3206) [30.6 s] 
INFO:root:all_losses: [3.571699  0.6770926]
INFO:root:Epoch 31    loss=3.5717 [148.6 s]	 dev=(HR@5:0.5016,NDCG@5:0.3517) test=(HR@5:0.4645,NDCG@5:0.3145) [30.5 s] 
INFO:root:all_losses: [3.5512319 0.6738665]
INFO:root:Epoch 32    loss=3.5512 [200.1 s]	 dev=(HR@5:0.5175,NDCG@5:0.3604) test=(HR@5:0.4740,NDCG@5:0.3259) [55.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.525683  0.6694435]
INFO:root:Epoch 33    loss=3.5257 [352.4 s]	 dev=(HR@5:0.5175,NDCG@5:0.3594) test=(HR@5:0.4634,NDCG@5:0.3163) [54.9 s] 
INFO:root:all_losses: [3.5029976  0.66475075]
INFO:root:Epoch 34    loss=3.5030 [352.4 s]	 dev=(HR@5:0.5239,NDCG@5:0.3635) test=(HR@5:0.4836,NDCG@5:0.3328) [55.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.4724762 0.6591302]
INFO:root:Epoch 35    loss=3.4725 [352.7 s]	 dev=(HR@5:0.5387,NDCG@5:0.3746) test=(HR@5:0.4920,NDCG@5:0.3347) [55.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.4387372 0.6524638]
INFO:root:Epoch 36    loss=3.4387 [352.5 s]	 dev=(HR@5:0.5133,NDCG@5:0.3628) test=(HR@5:0.4730,NDCG@5:0.3216) [54.7 s] 
INFO:root:all_losses: [3.4008403 0.6449737]
INFO:root:Epoch 37    loss=3.4008 [352.4 s]	 dev=(HR@5:0.5260,NDCG@5:0.3746) test=(HR@5:0.4910,NDCG@5:0.3333) [54.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.358018   0.63632184]
INFO:root:Epoch 38    loss=3.3580 [351.7 s]	 dev=(HR@5:0.5207,NDCG@5:0.3756) test=(HR@5:0.4995,NDCG@5:0.3453) [54.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.3082402 0.6268704]
INFO:root:Epoch 39    loss=3.3082 [351.7 s]	 dev=(HR@5:0.5270,NDCG@5:0.3772) test=(HR@5:0.5069,NDCG@5:0.3478) [53.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.2544553  0.61638224]
INFO:root:Epoch 40    loss=3.2545 [351.6 s]	 dev=(HR@5:0.5292,NDCG@5:0.3746) test=(HR@5:0.4920,NDCG@5:0.3424) [53.2 s] 
INFO:root:all_losses: [3.1954515  0.60423285]
INFO:root:Epoch 41    loss=3.1955 [351.1 s]	 dev=(HR@5:0.5260,NDCG@5:0.3695) test=(HR@5:0.4793,NDCG@5:0.3311) [53.0 s] 
INFO:root:all_losses: [3.1394682  0.59325457]
INFO:root:Epoch 42    loss=3.1395 [350.8 s]	 dev=(HR@5:0.5270,NDCG@5:0.3768) test=(HR@5:0.5048,NDCG@5:0.3510) [52.8 s] 
INFO:root:all_losses: [3.0687783 0.5793071]
INFO:root:Epoch 43    loss=3.0688 [351.2 s]	 dev=(HR@5:0.5292,NDCG@5:0.3739) test=(HR@5:0.4825,NDCG@5:0.3365) [53.4 s] 
INFO:root:all_losses: [3.007308  0.5668506]
INFO:root:Epoch 44    loss=3.0073 [351.0 s]	 dev=(HR@5:0.5355,NDCG@5:0.3814) test=(HR@5:0.4973,NDCG@5:0.3503) [53.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.9424083 0.5544502]
INFO:root:Epoch 45    loss=2.9424 [350.7 s]	 dev=(HR@5:0.5270,NDCG@5:0.3722) test=(HR@5:0.4963,NDCG@5:0.3486) [52.7 s] 
INFO:root:all_losses: [2.8773437 0.5413972]
INFO:root:Epoch 46    loss=2.8773 [350.8 s]	 dev=(HR@5:0.5334,NDCG@5:0.3713) test=(HR@5:0.4825,NDCG@5:0.3343) [51.6 s] 
INFO:root:all_losses: [2.8142462  0.52857435]
INFO:root:Epoch 47    loss=2.8142 [350.1 s]	 dev=(HR@5:0.5207,NDCG@5:0.3644) test=(HR@5:0.4910,NDCG@5:0.3405) [51.9 s] 
INFO:root:all_losses: [2.7482054  0.51564586]
INFO:root:Epoch 48    loss=2.7482 [349.9 s]	 dev=(HR@5:0.5196,NDCG@5:0.3676) test=(HR@5:0.4889,NDCG@5:0.3404) [52.7 s] 
INFO:root:all_losses: [2.6885588 0.5034835]
INFO:root:Epoch 49    loss=2.6886 [349.7 s]	 dev=(HR@5:0.5270,NDCG@5:0.3720) test=(HR@5:0.4889,NDCG@5:0.3418) [51.3 s] 
INFO:root:all_losses: [2.6316862  0.49290952]
INFO:root:Epoch 50    loss=2.6317 [349.4 s]	 dev=(HR@5:0.5313,NDCG@5:0.3722) test=(HR@5:0.4825,NDCG@5:0.3346) [50.8 s] 
INFO:root:all_losses: [2.5719087  0.48050097]
INFO:root:Epoch 51    loss=2.5719 [336.5 s]	 dev=(HR@5:0.5260,NDCG@5:0.3699) test=(HR@5:0.4984,NDCG@5:0.3451) [30.0 s] 
INFO:root:all_losses: [2.5182266  0.46971345]
INFO:root:Epoch 52    loss=2.5182 [148.5 s]	 dev=(HR@5:0.5366,NDCG@5:0.3753) test=(HR@5:0.4984,NDCG@5:0.3471) [30.1 s] 
INFO:root:all_losses: [2.4684103  0.45994928]
INFO:root:Epoch 53    loss=2.4684 [148.6 s]	 dev=(HR@5:0.5323,NDCG@5:0.3705) test=(HR@5:0.4846,NDCG@5:0.3363) [30.1 s] 
INFO:root:all_losses: [2.4171805  0.45007965]
INFO:root:Epoch 54    loss=2.4172 [147.9 s]	 dev=(HR@5:0.5355,NDCG@5:0.3744) test=(HR@5:0.5016,NDCG@5:0.3437) [29.7 s] 
INFO:root:all_losses: [2.3643377 0.4396594]
INFO:root:Epoch 55    loss=2.3643 [148.2 s]	 dev=(HR@5:0.5419,NDCG@5:0.3803) test=(HR@5:0.5048,NDCG@5:0.3502) [30.4 s] 
INFO:root:all_losses: [2.3247724 0.4311626]
INFO:root:Epoch 56    loss=2.3248 [147.4 s]	 dev=(HR@5:0.5408,NDCG@5:0.3864) test=(HR@5:0.4952,NDCG@5:0.3447) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.2762034  0.42230952]
INFO:root:Epoch 57    loss=2.2762 [148.3 s]	 dev=(HR@5:0.5292,NDCG@5:0.3787) test=(HR@5:0.4963,NDCG@5:0.3415) [29.6 s] 
INFO:root:all_losses: [2.2403634  0.41577655]
INFO:root:Epoch 58    loss=2.2404 [148.3 s]	 dev=(HR@5:0.5472,NDCG@5:0.3917) test=(HR@5:0.4931,NDCG@5:0.3476) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.1886237  0.40526956]
INFO:root:Epoch 59    loss=2.1886 [147.6 s]	 dev=(HR@5:0.5546,NDCG@5:0.3924) test=(HR@5:0.5101,NDCG@5:0.3553) [30.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.1540117  0.39787734]
INFO:root:Epoch 60    loss=2.1540 [147.7 s]	 dev=(HR@5:0.5525,NDCG@5:0.3916) test=(HR@5:0.5143,NDCG@5:0.3614) [30.1 s] 
INFO:root:all_losses: [2.113095   0.39022973]
INFO:root:Epoch 61    loss=2.1131 [148.2 s]	 dev=(HR@5:0.5493,NDCG@5:0.3855) test=(HR@5:0.4995,NDCG@5:0.3431) [29.6 s] 
INFO:root:all_losses: [2.0801644 0.3835578]
INFO:root:Epoch 62    loss=2.0802 [148.0 s]	 dev=(HR@5:0.5419,NDCG@5:0.3852) test=(HR@5:0.4984,NDCG@5:0.3464) [29.8 s] 
INFO:root:all_losses: [2.045542   0.37662876]
INFO:root:Epoch 63    loss=2.0455 [147.5 s]	 dev=(HR@5:0.5281,NDCG@5:0.3730) test=(HR@5:0.4666,NDCG@5:0.3257) [29.5 s] 
INFO:root:Early stop at 63 based on dev result.
INFO:root:
Best Iter(dev)=   59	 dev=(HR@5:0.5546,NDCG@5:0.3924) test=(HR@5:0.5101,NDCG@5:0.3553) [18071.7 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=5_num_heads=4_gamma=5.0_freq_rand=0_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6893,HR@5:0.5101,HR@50:0.9682,NDCG@10:0.4135,NDCG@5:0.3553,NDCG@50:0.4786)
INFO:root:
--------------------------------------------- END: 2025-07-16 00:21:39 ---------------------------------------------
