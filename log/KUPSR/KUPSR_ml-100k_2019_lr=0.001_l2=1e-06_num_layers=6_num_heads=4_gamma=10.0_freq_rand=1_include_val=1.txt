INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-05-29 22:08:50 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | 10.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 6            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0498,HR@50:0.4825,NDCG@10:0.0441,NDCG@5:0.0300,NDCG@50:0.1258)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [7.3634987 0.6930338]
INFO:root:Epoch 1     loss=7.3635 [141.4 s]	 dev=(HR@5:0.2174,NDCG@5:0.1367) test=(HR@5:0.2047,NDCG@5:0.1399) [31.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [7.3119535 0.6918555]
INFO:root:Epoch 2     loss=7.3120 [183.6 s]	 dev=(HR@5:0.2715,NDCG@5:0.1804) test=(HR@5:0.2354,NDCG@5:0.1556) [33.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [6.9441333 0.6624425]
INFO:root:Epoch 3     loss=6.9441 [152.1 s]	 dev=(HR@5:0.3584,NDCG@5:0.2453) test=(HR@5:0.3256,NDCG@5:0.2130) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [5.638703   0.53950685]
INFO:root:Epoch 4     loss=5.6387 [150.3 s]	 dev=(HR@5:0.4136,NDCG@5:0.2886) test=(HR@5:0.3839,NDCG@5:0.2587) [33.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [4.142536   0.39317828]
INFO:root:Epoch 5     loss=4.1425 [167.7 s]	 dev=(HR@5:0.4878,NDCG@5:0.3281) test=(HR@5:0.4581,NDCG@5:0.3044) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [3.3406928 0.3147205]
INFO:root:Epoch 6     loss=3.3407 [167.7 s]	 dev=(HR@5:0.4963,NDCG@5:0.3512) test=(HR@5:0.4517,NDCG@5:0.3097) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [2.6812139  0.24992207]
INFO:root:Epoch 7     loss=2.6812 [168.4 s]	 dev=(HR@5:0.5101,NDCG@5:0.3587) test=(HR@5:0.4899,NDCG@5:0.3263) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [2.090861   0.19121817]
INFO:root:Epoch 8     loss=2.0909 [167.2 s]	 dev=(HR@5:0.5239,NDCG@5:0.3679) test=(HR@5:0.4942,NDCG@5:0.3404) [33.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.8177806  0.16449767]
INFO:root:Epoch 9     loss=1.8178 [167.1 s]	 dev=(HR@5:0.5345,NDCG@5:0.3756) test=(HR@5:0.4836,NDCG@5:0.3402) [33.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.6760633  0.15039164]
INFO:root:Epoch 10    loss=1.6761 [168.1 s]	 dev=(HR@5:0.5164,NDCG@5:0.3612) test=(HR@5:0.4677,NDCG@5:0.3218) [33.6 s] 
INFO:root:all_losses: [1.6192157  0.14505105]
INFO:root:Epoch 11    loss=1.6192 [167.2 s]	 dev=(HR@5:0.5323,NDCG@5:0.3710) test=(HR@5:0.5143,NDCG@5:0.3460) [33.5 s] 
INFO:root:all_losses: [1.5832615  0.14200924]
INFO:root:Epoch 12    loss=1.5833 [167.2 s]	 dev=(HR@5:0.5461,NDCG@5:0.3823) test=(HR@5:0.5196,NDCG@5:0.3548) [33.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.5270104 0.1364468]
INFO:root:Epoch 13    loss=1.5270 [167.8 s]	 dev=(HR@5:0.5334,NDCG@5:0.3723) test=(HR@5:0.5048,NDCG@5:0.3529) [33.6 s] 
INFO:root:all_losses: [1.5298963  0.13701557]
INFO:root:Epoch 14    loss=1.5299 [167.0 s]	 dev=(HR@5:0.5525,NDCG@5:0.3771) test=(HR@5:0.5175,NDCG@5:0.3548) [33.6 s] 
INFO:root:all_losses: [1.4855843  0.13255371]
INFO:root:Epoch 15    loss=1.4856 [166.8 s]	 dev=(HR@5:0.5567,NDCG@5:0.3853) test=(HR@5:0.5101,NDCG@5:0.3473) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4747473  0.13189113]
INFO:root:Epoch 16    loss=1.4747 [167.9 s]	 dev=(HR@5:0.5207,NDCG@5:0.3638) test=(HR@5:0.4751,NDCG@5:0.3278) [33.7 s] 
INFO:root:all_losses: [1.4767026  0.13225302]
INFO:root:Epoch 17    loss=1.4767 [167.4 s]	 dev=(HR@5:0.5578,NDCG@5:0.3906) test=(HR@5:0.5069,NDCG@5:0.3451) [33.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4767222  0.13241862]
INFO:root:Epoch 18    loss=1.4767 [167.7 s]	 dev=(HR@5:0.5546,NDCG@5:0.3937) test=(HR@5:0.5186,NDCG@5:0.3558) [33.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4684366  0.13161445]
INFO:root:Epoch 19    loss=1.4684 [167.7 s]	 dev=(HR@5:0.5461,NDCG@5:0.3834) test=(HR@5:0.5302,NDCG@5:0.3591) [33.7 s] 
INFO:root:all_losses: [1.4482428  0.12973544]
INFO:root:Epoch 20    loss=1.4482 [167.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.3991) test=(HR@5:0.5376,NDCG@5:0.3663) [33.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4627221  0.13119599]
INFO:root:Epoch 21    loss=1.4627 [167.3 s]	 dev=(HR@5:0.5461,NDCG@5:0.3792) test=(HR@5:0.5058,NDCG@5:0.3527) [33.6 s] 
INFO:root:all_losses: [1.4504699  0.13058157]
INFO:root:Epoch 22    loss=1.4505 [168.2 s]	 dev=(HR@5:0.5652,NDCG@5:0.3976) test=(HR@5:0.5345,NDCG@5:0.3706) [33.6 s] 
INFO:root:all_losses: [1.4427896  0.12939584]
INFO:root:Epoch 23    loss=1.4428 [167.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4017) test=(HR@5:0.5302,NDCG@5:0.3541) [33.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4365628  0.12932056]
INFO:root:Epoch 24    loss=1.4366 [167.2 s]	 dev=(HR@5:0.5642,NDCG@5:0.4023) test=(HR@5:0.5207,NDCG@5:0.3579) [33.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4350861  0.12903966]
INFO:root:Epoch 25    loss=1.4351 [168.4 s]	 dev=(HR@5:0.5642,NDCG@5:0.3984) test=(HR@5:0.5090,NDCG@5:0.3588) [33.5 s] 
INFO:root:all_losses: [1.4322993  0.12899086]
INFO:root:Epoch 26    loss=1.4323 [167.2 s]	 dev=(HR@5:0.5620,NDCG@5:0.3938) test=(HR@5:0.5133,NDCG@5:0.3534) [33.2 s] 
INFO:root:all_losses: [1.4325984  0.12939647]
INFO:root:Epoch 27    loss=1.4326 [167.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.4000) test=(HR@5:0.5270,NDCG@5:0.3588) [33.6 s] 
INFO:root:all_losses: [1.4455823 0.1305086]
INFO:root:Epoch 28    loss=1.4456 [167.8 s]	 dev=(HR@5:0.5769,NDCG@5:0.4128) test=(HR@5:0.5207,NDCG@5:0.3594) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4315716  0.12931892]
INFO:root:Epoch 29    loss=1.4316 [166.7 s]	 dev=(HR@5:0.5652,NDCG@5:0.4045) test=(HR@5:0.5217,NDCG@5:0.3538) [33.2 s] 
INFO:root:all_losses: [1.4344339  0.12952746]
INFO:root:Epoch 30    loss=1.4344 [166.9 s]	 dev=(HR@5:0.5790,NDCG@5:0.4068) test=(HR@5:0.5398,NDCG@5:0.3661) [33.3 s] 
INFO:root:all_losses: [1.4295825  0.12897064]
INFO:root:Epoch 31    loss=1.4296 [167.6 s]	 dev=(HR@5:0.5779,NDCG@5:0.4026) test=(HR@5:0.5101,NDCG@5:0.3535) [33.2 s] 
INFO:root:all_losses: [1.4257528  0.12890816]
INFO:root:Epoch 32    loss=1.4258 [166.4 s]	 dev=(HR@5:0.5896,NDCG@5:0.4170) test=(HR@5:0.5143,NDCG@5:0.3563) [33.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4073347  0.12720305]
INFO:root:Epoch 33    loss=1.4073 [166.8 s]	 dev=(HR@5:0.5758,NDCG@5:0.4117) test=(HR@5:0.5355,NDCG@5:0.3637) [33.4 s] 
INFO:root:all_losses: [1.4085205  0.12716381]
INFO:root:Epoch 34    loss=1.4085 [168.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4183) test=(HR@5:0.5175,NDCG@5:0.3655) [33.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4378382  0.13032833]
INFO:root:Epoch 35    loss=1.4378 [166.9 s]	 dev=(HR@5:0.5642,NDCG@5:0.4100) test=(HR@5:0.5154,NDCG@5:0.3624) [33.2 s] 
INFO:root:all_losses: [1.410975   0.12778294]
INFO:root:Epoch 36    loss=1.4110 [166.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4163) test=(HR@5:0.5143,NDCG@5:0.3563) [33.1 s] 
INFO:root:all_losses: [1.415459   0.12824608]
INFO:root:Epoch 37    loss=1.4155 [167.1 s]	 dev=(HR@5:0.5769,NDCG@5:0.4088) test=(HR@5:0.5376,NDCG@5:0.3680) [33.5 s] 
INFO:root:all_losses: [1.4136823  0.12818915]
INFO:root:Epoch 38    loss=1.4137 [166.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4197) test=(HR@5:0.5334,NDCG@5:0.3759) [33.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4276507 0.1296569]
INFO:root:Epoch 39    loss=1.4277 [166.8 s]	 dev=(HR@5:0.5864,NDCG@5:0.4152) test=(HR@5:0.5355,NDCG@5:0.3780) [33.0 s] 
INFO:root:all_losses: [1.4049777  0.12756024]
INFO:root:Epoch 40    loss=1.4050 [167.5 s]	 dev=(HR@5:0.5970,NDCG@5:0.4173) test=(HR@5:0.5281,NDCG@5:0.3767) [33.2 s] 
INFO:root:all_losses: [1.410664   0.12797408]
INFO:root:Epoch 41    loss=1.4107 [166.9 s]	 dev=(HR@5:0.5748,NDCG@5:0.4139) test=(HR@5:0.5260,NDCG@5:0.3679) [33.2 s] 
INFO:root:all_losses: [1.4128286  0.12827589]
INFO:root:Epoch 42    loss=1.4128 [166.8 s]	 dev=(HR@5:0.5610,NDCG@5:0.4097) test=(HR@5:0.5281,NDCG@5:0.3745) [33.4 s] 
INFO:root:all_losses: [1.4154029  0.12872568]
INFO:root:Epoch 43    loss=1.4154 [167.8 s]	 dev=(HR@5:0.5843,NDCG@5:0.4136) test=(HR@5:0.5228,NDCG@5:0.3684) [33.2 s] 
INFO:root:all_losses: [1.3865628  0.12580909]
INFO:root:Epoch 44    loss=1.3866 [166.6 s]	 dev=(HR@5:0.5811,NDCG@5:0.4192) test=(HR@5:0.5260,NDCG@5:0.3737) [33.4 s] 
INFO:root:all_losses: [1.4048065  0.12779072]
INFO:root:Epoch 45    loss=1.4048 [166.9 s]	 dev=(HR@5:0.5779,NDCG@5:0.4131) test=(HR@5:0.5164,NDCG@5:0.3617) [33.2 s] 
INFO:root:all_losses: [1.4195552  0.12933187]
INFO:root:Epoch 46    loss=1.4196 [167.4 s]	 dev=(HR@5:0.5726,NDCG@5:0.4043) test=(HR@5:0.5090,NDCG@5:0.3576) [33.2 s] 
INFO:root:all_losses: [1.4050484  0.12781405]
INFO:root:Epoch 47    loss=1.4050 [166.6 s]	 dev=(HR@5:0.5907,NDCG@5:0.4199) test=(HR@5:0.5260,NDCG@5:0.3679) [33.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.4018258  0.12780096]
INFO:root:Epoch 48    loss=1.4018 [166.6 s]	 dev=(HR@5:0.5970,NDCG@5:0.4171) test=(HR@5:0.5228,NDCG@5:0.3626) [33.2 s] 
INFO:root:all_losses: [1.400704   0.12743834]
INFO:root:Epoch 49    loss=1.4007 [167.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4162) test=(HR@5:0.5313,NDCG@5:0.3741) [33.4 s] 
INFO:root:all_losses: [1.4004534  0.12773119]
INFO:root:Epoch 50    loss=1.4005 [166.3 s]	 dev=(HR@5:0.5822,NDCG@5:0.4125) test=(HR@5:0.5069,NDCG@5:0.3599) [33.1 s] 
INFO:root:all_losses: [1.4211959  0.12960942]
INFO:root:Epoch 51    loss=1.4212 [166.6 s]	 dev=(HR@5:0.5875,NDCG@5:0.4146) test=(HR@5:0.5249,NDCG@5:0.3689) [33.5 s] 
INFO:root:all_losses: [1.4073788  0.12826543]
INFO:root:Epoch 52    loss=1.4074 [167.3 s]	 dev=(HR@5:0.5769,NDCG@5:0.4060) test=(HR@5:0.5313,NDCG@5:0.3738) [33.5 s] 
INFO:root:all_losses: [1.411735   0.12882301]
INFO:root:Epoch 53    loss=1.4117 [166.1 s]	 dev=(HR@5:0.5589,NDCG@5:0.3975) test=(HR@5:0.5143,NDCG@5:0.3541) [33.1 s] 
INFO:root:all_losses: [1.3934553  0.12724483]
INFO:root:Epoch 54    loss=1.3935 [166.8 s]	 dev=(HR@5:0.5875,NDCG@5:0.4120) test=(HR@5:0.5186,NDCG@5:0.3631) [33.6 s] 
INFO:root:all_losses: [1.3924782  0.12704462]
INFO:root:Epoch 55    loss=1.3925 [167.5 s]	 dev=(HR@5:0.5832,NDCG@5:0.4139) test=(HR@5:0.5440,NDCG@5:0.3802) [33.2 s] 
INFO:root:all_losses: [1.3903747  0.12671003]
INFO:root:Epoch 56    loss=1.3904 [166.6 s]	 dev=(HR@5:0.5949,NDCG@5:0.4197) test=(HR@5:0.5334,NDCG@5:0.3693) [33.2 s] 
INFO:root:all_losses: [1.3867644 0.1265985]
INFO:root:Epoch 57    loss=1.3868 [167.1 s]	 dev=(HR@5:0.5864,NDCG@5:0.4178) test=(HR@5:0.5398,NDCG@5:0.3805) [33.0 s] 
INFO:root:all_losses: [1.398409   0.12803979]
INFO:root:Epoch 58    loss=1.3984 [167.0 s]	 dev=(HR@5:0.5769,NDCG@5:0.4143) test=(HR@5:0.5461,NDCG@5:0.3807) [33.3 s] 
INFO:root:all_losses: [1.3778998 0.1260115]
INFO:root:Epoch 59    loss=1.3779 [166.9 s]	 dev=(HR@5:0.5928,NDCG@5:0.4277) test=(HR@5:0.5366,NDCG@5:0.3751) [33.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [1.3992233  0.12782219]
INFO:root:Epoch 60    loss=1.3992 [166.7 s]	 dev=(HR@5:0.5801,NDCG@5:0.4172) test=(HR@5:0.5461,NDCG@5:0.3832) [33.1 s] 
INFO:root:all_losses: [1.3968962  0.12773931]
INFO:root:Epoch 61    loss=1.3969 [168.0 s]	 dev=(HR@5:0.5726,NDCG@5:0.4083) test=(HR@5:0.5281,NDCG@5:0.3707) [33.2 s] 
INFO:root:all_losses: [1.3913791 0.1272899]
INFO:root:Epoch 62    loss=1.3914 [166.8 s]	 dev=(HR@5:0.5748,NDCG@5:0.4065) test=(HR@5:0.5313,NDCG@5:0.3733) [33.0 s] 
INFO:root:all_losses: [1.3908062  0.12711175]
INFO:root:Epoch 63    loss=1.3908 [166.4 s]	 dev=(HR@5:0.5695,NDCG@5:0.4018) test=(HR@5:0.5461,NDCG@5:0.3776) [33.2 s] 
INFO:root:Early stop at 63 based on dev result.
INFO:root:
Best Iter(dev)=   59	 dev=(HR@5:0.5928,NDCG@5:0.4277) test=(HR@5:0.5366,NDCG@5:0.3751) [12591.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=6_num_heads=4_gamma=10.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7200,HR@5:0.5366,HR@50:0.9629,NDCG@10:0.4349,NDCG@5:0.3751,NDCG@50:0.4903)
INFO:root:
--------------------------------------------- END: 2025-05-30 01:39:13 ---------------------------------------------
