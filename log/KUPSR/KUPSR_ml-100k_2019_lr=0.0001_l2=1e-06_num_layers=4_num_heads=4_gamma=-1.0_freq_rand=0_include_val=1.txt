INFO:root:Namespace(model_name='KUPSR')
INFO:root:--------------------------------------------- BEGIN: 2025-08-27 15:30:29 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 0            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 4            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KUPSR(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.5725657 0.6931467]
INFO:root:Epoch 1     loss=0.5726 [108.9 s]	 dev=(HR@5:0.2333,NDCG@5:0.1553) test=(HR@5:0.2174,NDCG@5:0.1482) [26.3 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.46038583 0.6931421 ]
INFO:root:Epoch 2     loss=0.4604 [108.1 s]	 dev=(HR@5:0.2322,NDCG@5:0.1528) test=(HR@5:0.2110,NDCG@5:0.1441) [26.2 s] 
INFO:root:all_losses: [0.4375656  0.69313264]
INFO:root:Epoch 3     loss=0.4376 [107.7 s]	 dev=(HR@5:0.2238,NDCG@5:0.1508) test=(HR@5:0.2047,NDCG@5:0.1434) [26.3 s] 
INFO:root:all_losses: [0.42928436 0.6931204 ]
INFO:root:Epoch 4     loss=0.4293 [107.9 s]	 dev=(HR@5:0.2312,NDCG@5:0.1554) test=(HR@5:0.2089,NDCG@5:0.1439) [26.0 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.42872202 0.6931146 ]
INFO:root:Epoch 5     loss=0.4287 [107.8 s]	 dev=(HR@5:0.2344,NDCG@5:0.1580) test=(HR@5:0.2089,NDCG@5:0.1421) [26.1 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.42700034 0.69310004]
INFO:root:Epoch 6     loss=0.4270 [109.6 s]	 dev=(HR@5:0.2407,NDCG@5:0.1599) test=(HR@5:0.2153,NDCG@5:0.1456) [25.9 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.42629477 0.69309306]
INFO:root:Epoch 7     loss=0.4263 [114.9 s]	 dev=(HR@5:0.2291,NDCG@5:0.1549) test=(HR@5:0.2174,NDCG@5:0.1460) [26.2 s] 
INFO:root:all_losses: [0.4273035  0.69308627]
INFO:root:Epoch 8     loss=0.4273 [127.2 s]	 dev=(HR@5:0.2354,NDCG@5:0.1556) test=(HR@5:0.2121,NDCG@5:0.1460) [26.2 s] 
INFO:root:all_losses: [0.42524844 0.6930852 ]
INFO:root:Epoch 9     loss=0.4252 [151.9 s]	 dev=(HR@5:0.2333,NDCG@5:0.1543) test=(HR@5:0.2185,NDCG@5:0.1491) [26.2 s] 
INFO:root:all_losses: [0.42813563 0.6930816 ]
INFO:root:Epoch 10    loss=0.4281 [166.4 s]	 dev=(HR@5:0.2280,NDCG@5:0.1496) test=(HR@5:0.2110,NDCG@5:0.1459) [26.1 s] 
INFO:root:all_losses: [0.42724463 0.69307274]
INFO:root:Epoch 11    loss=0.4272 [164.6 s]	 dev=(HR@5:0.2386,NDCG@5:0.1542) test=(HR@5:0.2153,NDCG@5:0.1457) [26.3 s] 
INFO:root:all_losses: [0.42390585 0.6930678 ]
INFO:root:Epoch 12    loss=0.4239 [155.0 s]	 dev=(HR@5:0.2301,NDCG@5:0.1526) test=(HR@5:0.2131,NDCG@5:0.1434) [27.4 s] 
INFO:root:all_losses: [0.42516193 0.6930752 ]
INFO:root:Epoch 13    loss=0.4252 [132.1 s]	 dev=(HR@5:0.2386,NDCG@5:0.1565) test=(HR@5:0.2121,NDCG@5:0.1458) [29.2 s] 
INFO:root:all_losses: [0.41608623 0.69306195]
INFO:root:Epoch 14    loss=0.4161 [132.3 s]	 dev=(HR@5:0.2375,NDCG@5:0.1531) test=(HR@5:0.2110,NDCG@5:0.1438) [30.7 s] 
INFO:root:all_losses: [0.40293005 0.6930621 ]
INFO:root:Epoch 15    loss=0.4029 [156.3 s]	 dev=(HR@5:0.2428,NDCG@5:0.1601) test=(HR@5:0.2195,NDCG@5:0.1475) [35.0 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.3930276  0.69305235]
INFO:root:Epoch 16    loss=0.3930 [200.6 s]	 dev=(HR@5:0.2513,NDCG@5:0.1655) test=(HR@5:0.2206,NDCG@5:0.1501) [34.3 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.3844842 0.6930221]
INFO:root:Epoch 17    loss=0.3845 [255.3 s]	 dev=(HR@5:0.2662,NDCG@5:0.1703) test=(HR@5:0.2238,NDCG@5:0.1497) [29.3 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.37390682 0.69301057]
INFO:root:Epoch 18    loss=0.3739 [295.1 s]	 dev=(HR@5:0.2715,NDCG@5:0.1754) test=(HR@5:0.2333,NDCG@5:0.1535) [26.0 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.35813212 0.69297844]
INFO:root:Epoch 19    loss=0.3581 [313.6 s]	 dev=(HR@5:0.3001,NDCG@5:0.2008) test=(HR@5:0.2683,NDCG@5:0.1781) [26.1 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.33319393 0.6929307 ]
INFO:root:Epoch 20    loss=0.3332 [323.1 s]	 dev=(HR@5:0.3330,NDCG@5:0.2283) test=(HR@5:0.2821,NDCG@5:0.1928) [26.9 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.31810108 0.6928591 ]
INFO:root:Epoch 21    loss=0.3181 [322.2 s]	 dev=(HR@5:0.3351,NDCG@5:0.2324) test=(HR@5:0.3043,NDCG@5:0.2030) [29.2 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.3038296 0.692763 ]
INFO:root:Epoch 22    loss=0.3038 [308.5 s]	 dev=(HR@5:0.3775,NDCG@5:0.2622) test=(HR@5:0.3330,NDCG@5:0.2216) [33.6 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.29607818 0.6926613 ]
INFO:root:Epoch 23    loss=0.2961 [294.4 s]	 dev=(HR@5:0.4125,NDCG@5:0.2882) test=(HR@5:0.3680,NDCG@5:0.2432) [34.3 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.2847288  0.69247234]
INFO:root:Epoch 24    loss=0.2847 [288.4 s]	 dev=(HR@5:0.4369,NDCG@5:0.3023) test=(HR@5:0.3934,NDCG@5:0.2570) [34.5 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.2761459  0.69227785]
INFO:root:Epoch 25    loss=0.2761 [286.2 s]	 dev=(HR@5:0.4316,NDCG@5:0.3077) test=(HR@5:0.3977,NDCG@5:0.2629) [34.6 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.26584592 0.6920968 ]
INFO:root:Epoch 26    loss=0.2658 [285.5 s]	 dev=(HR@5:0.4454,NDCG@5:0.3180) test=(HR@5:0.4093,NDCG@5:0.2711) [34.9 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.25301465 0.6918075 ]
INFO:root:Epoch 27    loss=0.2530 [283.4 s]	 dev=(HR@5:0.4655,NDCG@5:0.3336) test=(HR@5:0.4390,NDCG@5:0.2880) [36.5 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.24138886 0.69153124]
INFO:root:Epoch 28    loss=0.2414 [283.2 s]	 dev=(HR@5:0.4910,NDCG@5:0.3449) test=(HR@5:0.4687,NDCG@5:0.3093) [36.4 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.23352611 0.6911607 ]
INFO:root:Epoch 29    loss=0.2335 [284.6 s]	 dev=(HR@5:0.4878,NDCG@5:0.3422) test=(HR@5:0.4433,NDCG@5:0.2966) [36.4 s] 
INFO:root:all_losses: [0.22872965 0.6907928 ]
INFO:root:Epoch 30    loss=0.2287 [287.1 s]	 dev=(HR@5:0.5016,NDCG@5:0.3541) test=(HR@5:0.4783,NDCG@5:0.3140) [36.1 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.22544737 0.69036096]
INFO:root:Epoch 31    loss=0.2254 [287.7 s]	 dev=(HR@5:0.4825,NDCG@5:0.3446) test=(HR@5:0.4666,NDCG@5:0.3109) [36.6 s] 
INFO:root:all_losses: [0.21997912 0.6899923 ]
INFO:root:Epoch 32    loss=0.2200 [288.3 s]	 dev=(HR@5:0.5005,NDCG@5:0.3535) test=(HR@5:0.4730,NDCG@5:0.3156) [37.1 s] 
INFO:root:all_losses: [0.21602473 0.6895931 ]
INFO:root:Epoch 33    loss=0.2160 [288.9 s]	 dev=(HR@5:0.4952,NDCG@5:0.3513) test=(HR@5:0.4698,NDCG@5:0.3156) [36.6 s] 
INFO:root:all_losses: [0.21543425 0.689152  ]
INFO:root:Epoch 34    loss=0.2154 [290.9 s]	 dev=(HR@5:0.4984,NDCG@5:0.3518) test=(HR@5:0.4751,NDCG@5:0.3184) [35.5 s] 
INFO:root:all_losses: [0.21203029 0.6887707 ]
INFO:root:Epoch 35    loss=0.2120 [292.4 s]	 dev=(HR@5:0.5058,NDCG@5:0.3579) test=(HR@5:0.4857,NDCG@5:0.3257) [35.0 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.21019964 0.6883414 ]
INFO:root:Epoch 36    loss=0.2102 [292.3 s]	 dev=(HR@5:0.5143,NDCG@5:0.3654) test=(HR@5:0.4804,NDCG@5:0.3240) [36.0 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.20773716 0.68787587]
INFO:root:Epoch 37    loss=0.2077 [292.0 s]	 dev=(HR@5:0.5207,NDCG@5:0.3646) test=(HR@5:0.4910,NDCG@5:0.3303) [34.9 s] 
INFO:root:all_losses: [0.20767358 0.6874361 ]
INFO:root:Epoch 38    loss=0.2077 [294.9 s]	 dev=(HR@5:0.5133,NDCG@5:0.3589) test=(HR@5:0.4783,NDCG@5:0.3228) [34.2 s] 
INFO:root:all_losses: [0.2044784 0.6870246]
INFO:root:Epoch 39    loss=0.2045 [296.2 s]	 dev=(HR@5:0.5323,NDCG@5:0.3680) test=(HR@5:0.5005,NDCG@5:0.3379) [32.8 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.20146438 0.6865687 ]
INFO:root:Epoch 40    loss=0.2015 [306.7 s]	 dev=(HR@5:0.5239,NDCG@5:0.3698) test=(HR@5:0.4825,NDCG@5:0.3298) [30.5 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.20235716 0.6860418 ]
INFO:root:Epoch 41    loss=0.2024 [319.3 s]	 dev=(HR@5:0.5037,NDCG@5:0.3531) test=(HR@5:0.4571,NDCG@5:0.3125) [30.1 s] 
INFO:root:all_losses: [0.20023838 0.68569064]
INFO:root:Epoch 42    loss=0.2002 [328.9 s]	 dev=(HR@5:0.5239,NDCG@5:0.3659) test=(HR@5:0.4825,NDCG@5:0.3272) [29.4 s] 
INFO:root:all_losses: [0.19784234 0.68510604]
INFO:root:Epoch 43    loss=0.1978 [339.0 s]	 dev=(HR@5:0.5207,NDCG@5:0.3656) test=(HR@5:0.4730,NDCG@5:0.3241) [29.6 s] 
INFO:root:all_losses: [0.19666329 0.6847182 ]
INFO:root:Epoch 44    loss=0.1967 [335.4 s]	 dev=(HR@5:0.5408,NDCG@5:0.3757) test=(HR@5:0.4963,NDCG@5:0.3404) [29.7 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.19373485 0.6843027 ]
INFO:root:Epoch 45    loss=0.1937 [292.6 s]	 dev=(HR@5:0.5366,NDCG@5:0.3748) test=(HR@5:0.4857,NDCG@5:0.3342) [29.8 s] 
INFO:root:all_losses: [0.19220062 0.68385357]
INFO:root:Epoch 46    loss=0.1922 [268.7 s]	 dev=(HR@5:0.5345,NDCG@5:0.3738) test=(HR@5:0.4899,NDCG@5:0.3371) [31.8 s] 
INFO:root:all_losses: [0.19226024 0.6832181 ]
INFO:root:Epoch 47    loss=0.1923 [211.5 s]	 dev=(HR@5:0.5345,NDCG@5:0.3742) test=(HR@5:0.4963,NDCG@5:0.3370) [34.4 s] 
INFO:root:all_losses: [0.18920459 0.68278575]
INFO:root:Epoch 48    loss=0.1892 [205.8 s]	 dev=(HR@5:0.5461,NDCG@5:0.3809) test=(HR@5:0.4942,NDCG@5:0.3350) [30.8 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.1886226  0.68250364]
INFO:root:Epoch 49    loss=0.1886 [186.4 s]	 dev=(HR@5:0.5440,NDCG@5:0.3769) test=(HR@5:0.4761,NDCG@5:0.3318) [30.6 s] 
INFO:root:all_losses: [0.18549088 0.6819248 ]
INFO:root:Epoch 50    loss=0.1855 [145.2 s]	 dev=(HR@5:0.5483,NDCG@5:0.3870) test=(HR@5:0.5090,NDCG@5:0.3508) [31.2 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.1864074 0.6812825]
INFO:root:Epoch 51    loss=0.1864 [138.5 s]	 dev=(HR@5:0.5483,NDCG@5:0.3864) test=(HR@5:0.5027,NDCG@5:0.3482) [29.8 s] 
INFO:root:all_losses: [0.18502614 0.6806753 ]
INFO:root:Epoch 52    loss=0.1850 [136.5 s]	 dev=(HR@5:0.5567,NDCG@5:0.3894) test=(HR@5:0.5090,NDCG@5:0.3554) [29.4 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.18245211 0.6802174 ]
INFO:root:Epoch 53    loss=0.1825 [137.0 s]	 dev=(HR@5:0.5536,NDCG@5:0.3872) test=(HR@5:0.5005,NDCG@5:0.3491) [29.3 s] 
INFO:root:all_losses: [0.18095762 0.67974085]
INFO:root:Epoch 54    loss=0.1810 [137.1 s]	 dev=(HR@5:0.5705,NDCG@5:0.3954) test=(HR@5:0.5048,NDCG@5:0.3529) [29.2 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.17961392 0.6793488 ]
INFO:root:Epoch 55    loss=0.1796 [136.4 s]	 dev=(HR@5:0.5769,NDCG@5:0.3975) test=(HR@5:0.5217,NDCG@5:0.3631) [29.2 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.18104242 0.6791084 ]
INFO:root:Epoch 56    loss=0.1810 [136.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.3958) test=(HR@5:0.5133,NDCG@5:0.3574) [29.1 s] 
INFO:root:all_losses: [0.17697872 0.67832047]
INFO:root:Epoch 57    loss=0.1770 [136.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.4017) test=(HR@5:0.5111,NDCG@5:0.3567) [28.9 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.17289543 0.678267  ]
INFO:root:Epoch 58    loss=0.1729 [136.5 s]	 dev=(HR@5:0.5758,NDCG@5:0.4044) test=(HR@5:0.5164,NDCG@5:0.3617) [28.8 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.17306931 0.6776108 ]
INFO:root:Epoch 59    loss=0.1731 [136.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4129) test=(HR@5:0.5175,NDCG@5:0.3631) [29.1 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.17421785 0.6771475 ]
INFO:root:Epoch 60    loss=0.1742 [135.9 s]	 dev=(HR@5:0.5928,NDCG@5:0.4183) test=(HR@5:0.5239,NDCG@5:0.3693) [29.1 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.17147042 0.6771382 ]
INFO:root:Epoch 61    loss=0.1715 [136.5 s]	 dev=(HR@5:0.5673,NDCG@5:0.3975) test=(HR@5:0.5016,NDCG@5:0.3528) [28.8 s] 
INFO:root:all_losses: [0.17119728 0.67642987]
INFO:root:Epoch 62    loss=0.1712 [136.0 s]	 dev=(HR@5:0.5917,NDCG@5:0.4124) test=(HR@5:0.5260,NDCG@5:0.3715) [28.9 s] 
INFO:root:all_losses: [0.17000562 0.6763724 ]
INFO:root:Epoch 63    loss=0.1700 [136.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3932) test=(HR@5:0.4942,NDCG@5:0.3455) [28.9 s] 
INFO:root:all_losses: [0.16674674 0.67569244]
INFO:root:Epoch 64    loss=0.1667 [136.1 s]	 dev=(HR@5:0.5832,NDCG@5:0.4106) test=(HR@5:0.5239,NDCG@5:0.3717) [29.0 s] 
INFO:root:all_losses: [0.1671952 0.6756046]
INFO:root:Epoch 65    loss=0.1672 [136.2 s]	 dev=(HR@5:0.5949,NDCG@5:0.4153) test=(HR@5:0.5260,NDCG@5:0.3730) [28.7 s] 
INFO:root:all_losses: [0.16539526 0.6751394 ]
INFO:root:Epoch 66    loss=0.1654 [136.4 s]	 dev=(HR@5:0.5864,NDCG@5:0.4085) test=(HR@5:0.5228,NDCG@5:0.3672) [28.8 s] 
INFO:root:all_losses: [0.16356173 0.67482805]
INFO:root:Epoch 67    loss=0.1636 [136.0 s]	 dev=(HR@5:0.6066,NDCG@5:0.4264) test=(HR@5:0.5260,NDCG@5:0.3773) [28.9 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.16528   0.6744626]
INFO:root:Epoch 68    loss=0.1653 [136.1 s]	 dev=(HR@5:0.5843,NDCG@5:0.4088) test=(HR@5:0.5239,NDCG@5:0.3708) [28.8 s] 
INFO:root:all_losses: [0.16153307 0.6746032 ]
INFO:root:Epoch 69    loss=0.1615 [136.1 s]	 dev=(HR@5:0.5811,NDCG@5:0.4071) test=(HR@5:0.5122,NDCG@5:0.3624) [28.9 s] 
INFO:root:all_losses: [0.16297606 0.67435205]
INFO:root:Epoch 70    loss=0.1630 [136.4 s]	 dev=(HR@5:0.5917,NDCG@5:0.4173) test=(HR@5:0.5323,NDCG@5:0.3757) [28.7 s] 
INFO:root:all_losses: [0.16184242 0.673415  ]
INFO:root:Epoch 71    loss=0.1618 [136.0 s]	 dev=(HR@5:0.5992,NDCG@5:0.4216) test=(HR@5:0.5334,NDCG@5:0.3796) [28.3 s] 
INFO:root:all_losses: [0.16035153 0.6730287 ]
INFO:root:Epoch 72    loss=0.1604 [135.9 s]	 dev=(HR@5:0.5981,NDCG@5:0.4212) test=(HR@5:0.5302,NDCG@5:0.3789) [28.7 s] 
INFO:root:all_losses: [0.16151121 0.6730148 ]
INFO:root:Epoch 73    loss=0.1615 [135.8 s]	 dev=(HR@5:0.5811,NDCG@5:0.4077) test=(HR@5:0.5164,NDCG@5:0.3667) [28.6 s] 
INFO:root:all_losses: [0.15860264 0.6727702 ]
INFO:root:Epoch 74    loss=0.1586 [136.1 s]	 dev=(HR@5:0.5938,NDCG@5:0.4242) test=(HR@5:0.5334,NDCG@5:0.3826) [28.7 s] 
INFO:root:all_losses: [0.156228  0.6724839]
INFO:root:Epoch 75    loss=0.1562 [142.9 s]	 dev=(HR@5:0.6055,NDCG@5:0.4297) test=(HR@5:0.5483,NDCG@5:0.3903) [28.7 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.15685429 0.67224187]
INFO:root:Epoch 76    loss=0.1569 [136.4 s]	 dev=(HR@5:0.5949,NDCG@5:0.4237) test=(HR@5:0.5313,NDCG@5:0.3800) [28.6 s] 
INFO:root:all_losses: [0.15498237 0.6713827 ]
INFO:root:Epoch 77    loss=0.1550 [136.3 s]	 dev=(HR@5:0.5938,NDCG@5:0.4275) test=(HR@5:0.5334,NDCG@5:0.3848) [28.6 s] 
INFO:root:all_losses: [0.15386392 0.6714812 ]
INFO:root:Epoch 78    loss=0.1539 [135.5 s]	 dev=(HR@5:0.5970,NDCG@5:0.4253) test=(HR@5:0.5408,NDCG@5:0.3829) [28.7 s] 
INFO:root:all_losses: [0.15461953 0.6712137 ]
INFO:root:Epoch 79    loss=0.1546 [136.1 s]	 dev=(HR@5:0.6034,NDCG@5:0.4358) test=(HR@5:0.5387,NDCG@5:0.3901) [28.3 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.15156391 0.6708093 ]
INFO:root:Epoch 80    loss=0.1516 [136.3 s]	 dev=(HR@5:0.6204,NDCG@5:0.4347) test=(HR@5:0.5355,NDCG@5:0.3795) [28.6 s] 
INFO:root:all_losses: [0.15287147 0.67105126]
INFO:root:Epoch 81    loss=0.1529 [136.3 s]	 dev=(HR@5:0.5970,NDCG@5:0.4250) test=(HR@5:0.5323,NDCG@5:0.3805) [28.8 s] 
INFO:root:all_losses: [0.15107387 0.67025083]
INFO:root:Epoch 82    loss=0.1511 [135.6 s]	 dev=(HR@5:0.6119,NDCG@5:0.4368) test=(HR@5:0.5514,NDCG@5:0.3945) [28.5 s] 
INFO:root:Save model to ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-...
INFO:root:all_losses: [0.15086332 0.67040956]
INFO:root:Epoch 83    loss=0.1509 [136.5 s]	 dev=(HR@5:0.5949,NDCG@5:0.4323) test=(HR@5:0.5504,NDCG@5:0.3945) [28.6 s] 
INFO:root:all_losses: [0.1506957 0.6697738]
INFO:root:Epoch 84    loss=0.1507 [136.4 s]	 dev=(HR@5:0.5885,NDCG@5:0.4232) test=(HR@5:0.5154,NDCG@5:0.3691) [28.3 s] 
INFO:root:all_losses: [0.15064783 0.6697272 ]
INFO:root:Epoch 85    loss=0.1506 [136.2 s]	 dev=(HR@5:0.5928,NDCG@5:0.4230) test=(HR@5:0.5313,NDCG@5:0.3807) [28.4 s] 
INFO:root:all_losses: [0.14987531 0.6693318 ]
INFO:root:Epoch 86    loss=0.1499 [135.3 s]	 dev=(HR@5:0.6045,NDCG@5:0.4292) test=(HR@5:0.5461,NDCG@5:0.3907) [28.3 s] 
INFO:root:all_losses: [0.14847189 0.66907275]
INFO:root:Epoch 87    loss=0.1485 [135.9 s]	 dev=(HR@5:0.6034,NDCG@5:0.4268) test=(HR@5:0.5557,NDCG@5:0.3917) [28.6 s] 
INFO:root:all_losses: [0.148516  0.6685769]
INFO:root:Epoch 88    loss=0.1485 [136.0 s]	 dev=(HR@5:0.6013,NDCG@5:0.4289) test=(HR@5:0.5536,NDCG@5:0.3919) [28.5 s] 
INFO:root:all_losses: [0.14613445 0.6681865 ]
INFO:root:Epoch 89    loss=0.1461 [135.8 s]	 dev=(HR@5:0.5960,NDCG@5:0.4241) test=(HR@5:0.5504,NDCG@5:0.3908) [28.4 s] 
INFO:root:all_losses: [0.14853428 0.6682356 ]
INFO:root:Epoch 90    loss=0.1485 [135.6 s]	 dev=(HR@5:0.5981,NDCG@5:0.4275) test=(HR@5:0.5567,NDCG@5:0.3985) [28.6 s] 
INFO:root:all_losses: [0.1465971 0.668077 ]
INFO:root:Epoch 91    loss=0.1466 [135.6 s]	 dev=(HR@5:0.6108,NDCG@5:0.4339) test=(HR@5:0.5536,NDCG@5:0.3931) [28.4 s] 
INFO:root:all_losses: [0.14584942 0.6678949 ]
INFO:root:Epoch 92    loss=0.1458 [135.9 s]	 dev=(HR@5:0.6013,NDCG@5:0.4248) test=(HR@5:0.5376,NDCG@5:0.3825) [28.5 s] 
INFO:root:all_losses: [0.14527836 0.6671847 ]
INFO:root:Epoch 93    loss=0.1453 [148.2 s]	 dev=(HR@5:0.6023,NDCG@5:0.4262) test=(HR@5:0.5472,NDCG@5:0.3884) [28.4 s] 
INFO:root:all_losses: [0.14490736 0.66703784]
INFO:root:Epoch 94    loss=0.1449 [136.4 s]	 dev=(HR@5:0.6076,NDCG@5:0.4325) test=(HR@5:0.5451,NDCG@5:0.3867) [28.5 s] 
INFO:root:all_losses: [0.14397985 0.6669846 ]
INFO:root:Epoch 95    loss=0.1440 [136.0 s]	 dev=(HR@5:0.6119,NDCG@5:0.4342) test=(HR@5:0.5546,NDCG@5:0.3941) [28.4 s] 
INFO:root:all_losses: [0.14261265 0.66656977]
INFO:root:Epoch 96    loss=0.1426 [136.1 s]	 dev=(HR@5:0.6023,NDCG@5:0.4318) test=(HR@5:0.5440,NDCG@5:0.3897) [28.6 s] 
INFO:root:all_losses: [0.14253344 0.66664755]
INFO:root:Epoch 97    loss=0.1425 [135.0 s]	 dev=(HR@5:0.6087,NDCG@5:0.4346) test=(HR@5:0.5557,NDCG@5:0.3928) [28.2 s] 
INFO:root:all_losses: [0.1427912 0.6663291]
INFO:root:Epoch 98    loss=0.1428 [135.9 s]	 dev=(HR@5:0.6002,NDCG@5:0.4288) test=(HR@5:0.5589,NDCG@5:0.4002) [28.5 s] 
INFO:root:all_losses: [0.14366855 0.66561276]
INFO:root:Epoch 99    loss=0.1437 [135.9 s]	 dev=(HR@5:0.5992,NDCG@5:0.4195) test=(HR@5:0.5578,NDCG@5:0.3967) [28.5 s] 
INFO:root:all_losses: [0.14086749 0.66580045]
INFO:root:Epoch 100   loss=0.1409 [136.6 s]	 dev=(HR@5:0.6087,NDCG@5:0.4327) test=(HR@5:0.5483,NDCG@5:0.3969) [28.6 s] 
INFO:root:all_losses: [0.14164506 0.6653976 ]
INFO:root:Epoch 101   loss=0.1416 [136.0 s]	 dev=(HR@5:0.5928,NDCG@5:0.4212) test=(HR@5:0.5387,NDCG@5:0.3869) [28.6 s] 
INFO:root:all_losses: [0.14038062 0.6648303 ]
INFO:root:Epoch 102   loss=0.1404 [136.5 s]	 dev=(HR@5:0.6055,NDCG@5:0.4302) test=(HR@5:0.5610,NDCG@5:0.4011) [28.2 s] 
INFO:root:Early stop at 102 based on dev result.
INFO:root:
Best Iter(dev)=   82	 dev=(HR@5:0.6119,NDCG@5:0.4368) test=(HR@5:0.5514,NDCG@5:0.3945) [21973.7 s] 
INFO:root:Load model from ../model/KUPSR/KUPSR_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=4_num_heads=4_gamma=-1.0_freq_rand=0_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7211,HR@5:0.5514,HR@50:0.9682,NDCG@10:0.4490,NDCG@5:0.3945,NDCG@50:0.5068)
INFO:root:
--------------------------------------------- END: 2025-08-27 21:37:10 ---------------------------------------------
