INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-01 20:20:03 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Reading data from "../data/", dataset = "ml-100k" 
INFO:root:Counting dataset statistics...
INFO:root:"# user": 944, "# item": 1350, "# entry": 99287
INFO:root:Appending history info...
INFO:root:Constructing relation triplets...
INFO:root:Item-item relations:[]
INFO:root:Attribute-based relations:['i_year', 'i_Action', 'i_Adventure', 'i_Animation', "i_Children's", 'i_Comedy', 'i_Crime', 'i_Documentary', 'i_Drama', 'i_Fantasy', 'i_Film-Noir', 'i_Horror', 'i_Musical', 'i_Mystery', 'i_Romance', 'i_Sci-Fi', 'i_Thriller', 'i_War', 'i_Western', 'i_Other']
INFO:root:"# relation": 21, "# triplet": 3789
INFO:root:Save corpus to ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45986494 0.6930996 ]
INFO:root:Epoch 1     loss=0.4599 [96.8 s]	 dev=(HR@5:0.2206,NDCG@5:0.1428) test=(HR@5:0.2163,NDCG@5:0.1489) [36.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.40968716 0.692948  ]
INFO:root:Epoch 2     loss=0.4097 [140.5 s]	 dev=(HR@5:0.2524,NDCG@5:0.1645) test=(HR@5:0.2312,NDCG@5:0.1524) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3310019 0.6923905]
INFO:root:Epoch 3     loss=0.3310 [112.2 s]	 dev=(HR@5:0.4019,NDCG@5:0.2735) test=(HR@5:0.3531,NDCG@5:0.2337) [36.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.27508074 0.6896937 ]
INFO:root:Epoch 4     loss=0.2751 [109.7 s]	 dev=(HR@5:0.4549,NDCG@5:0.3171) test=(HR@5:0.4115,NDCG@5:0.2833) [40.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23894244 0.6845882 ]
INFO:root:Epoch 5     loss=0.2389 [127.4 s]	 dev=(HR@5:0.3987,NDCG@5:0.2860) test=(HR@5:0.3669,NDCG@5:0.2477) [41.1 s] 
INFO:root:all_losses: [0.21960342 0.67807716]
INFO:root:Epoch 6     loss=0.2196 [127.9 s]	 dev=(HR@5:0.4846,NDCG@5:0.3364) test=(HR@5:0.4316,NDCG@5:0.2973) [40.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2124164 0.6722522]
INFO:root:Epoch 7     loss=0.2124 [128.0 s]	 dev=(HR@5:0.4867,NDCG@5:0.3348) test=(HR@5:0.4390,NDCG@5:0.2873) [41.4 s] 
INFO:root:all_losses: [0.20844081 0.66680366]
INFO:root:Epoch 8     loss=0.2084 [130.0 s]	 dev=(HR@5:0.5048,NDCG@5:0.3548) test=(HR@5:0.4655,NDCG@5:0.3179) [40.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20358582 0.6640845 ]
INFO:root:Epoch 9     loss=0.2036 [129.2 s]	 dev=(HR@5:0.5037,NDCG@5:0.3514) test=(HR@5:0.4624,NDCG@5:0.3148) [42.1 s] 
INFO:root:all_losses: [0.20124315 0.6589356 ]
INFO:root:Epoch 10    loss=0.2012 [132.2 s]	 dev=(HR@5:0.5133,NDCG@5:0.3613) test=(HR@5:0.4761,NDCG@5:0.3239) [42.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19485475 0.65419626]
INFO:root:Epoch 11    loss=0.1949 [132.3 s]	 dev=(HR@5:0.5037,NDCG@5:0.3486) test=(HR@5:0.4464,NDCG@5:0.3037) [42.1 s] 
INFO:root:all_losses: [0.18774419 0.6514868 ]
INFO:root:Epoch 12    loss=0.1877 [132.9 s]	 dev=(HR@5:0.5281,NDCG@5:0.3699) test=(HR@5:0.4878,NDCG@5:0.3241) [42.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18808234 0.6473698 ]
INFO:root:Epoch 13    loss=0.1881 [131.9 s]	 dev=(HR@5:0.5451,NDCG@5:0.3865) test=(HR@5:0.4942,NDCG@5:0.3410) [42.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1825434 0.6435059]
INFO:root:Epoch 14    loss=0.1825 [132.8 s]	 dev=(HR@5:0.5461,NDCG@5:0.3778) test=(HR@5:0.5037,NDCG@5:0.3496) [58.3 s] 
INFO:root:all_losses: [0.1822286 0.6392961]
INFO:root:Epoch 15    loss=0.1822 [308.9 s]	 dev=(HR@5:0.5461,NDCG@5:0.3837) test=(HR@5:0.5016,NDCG@5:0.3460) [79.8 s] 
INFO:root:all_losses: [0.17635901 0.63461494]
INFO:root:Epoch 16    loss=0.1764 [307.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.3928) test=(HR@5:0.4963,NDCG@5:0.3424) [79.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17347719 0.62978333]
INFO:root:Epoch 17    loss=0.1735 [307.9 s]	 dev=(HR@5:0.5546,NDCG@5:0.3888) test=(HR@5:0.5027,NDCG@5:0.3465) [80.1 s] 
INFO:root:all_losses: [0.17057824 0.62629443]
INFO:root:Epoch 18    loss=0.1706 [312.4 s]	 dev=(HR@5:0.5578,NDCG@5:0.3913) test=(HR@5:0.5048,NDCG@5:0.3567) [81.5 s] 
INFO:root:all_losses: [0.16834386 0.622389  ]
INFO:root:Epoch 19    loss=0.1683 [314.8 s]	 dev=(HR@5:0.5620,NDCG@5:0.3916) test=(HR@5:0.5228,NDCG@5:0.3694) [80.5 s] 
INFO:root:all_losses: [0.16684173 0.6160564 ]
INFO:root:Epoch 20    loss=0.1668 [313.9 s]	 dev=(HR@5:0.5748,NDCG@5:0.4047) test=(HR@5:0.5005,NDCG@5:0.3622) [82.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1650988 0.6114933]
INFO:root:Epoch 21    loss=0.1651 [309.0 s]	 dev=(HR@5:0.5419,NDCG@5:0.3847) test=(HR@5:0.5005,NDCG@5:0.3526) [78.4 s] 
INFO:root:all_losses: [0.15830019 0.60739374]
INFO:root:Epoch 22    loss=0.1583 [308.2 s]	 dev=(HR@5:0.5758,NDCG@5:0.4144) test=(HR@5:0.5175,NDCG@5:0.3663) [79.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16155921 0.60278493]
INFO:root:Epoch 23    loss=0.1616 [287.7 s]	 dev=(HR@5:0.5631,NDCG@5:0.4063) test=(HR@5:0.5260,NDCG@5:0.3675) [43.9 s] 
INFO:root:all_losses: [0.1560838  0.59912646]
INFO:root:Epoch 24    loss=0.1561 [132.8 s]	 dev=(HR@5:0.5663,NDCG@5:0.4115) test=(HR@5:0.5302,NDCG@5:0.3629) [42.2 s] 
INFO:root:all_losses: [0.15652382 0.5931013 ]
INFO:root:Epoch 25    loss=0.1565 [133.4 s]	 dev=(HR@5:0.5748,NDCG@5:0.4116) test=(HR@5:0.5122,NDCG@5:0.3609) [42.4 s] 
INFO:root:all_losses: [0.15242854 0.589284  ]
INFO:root:Epoch 26    loss=0.1524 [108.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3893) test=(HR@5:0.5058,NDCG@5:0.3505) [39.0 s] 
INFO:root:all_losses: [0.14991349 0.5845333 ]
INFO:root:Epoch 27    loss=0.1499 [107.1 s]	 dev=(HR@5:0.5790,NDCG@5:0.4130) test=(HR@5:0.5323,NDCG@5:0.3737) [38.5 s] 
INFO:root:all_losses: [0.14983556 0.5811019 ]
INFO:root:Epoch 28    loss=0.1498 [107.2 s]	 dev=(HR@5:0.5864,NDCG@5:0.4133) test=(HR@5:0.5260,NDCG@5:0.3694) [38.5 s] 
INFO:root:all_losses: [0.1463099  0.57556117]
INFO:root:Epoch 29    loss=0.1463 [107.6 s]	 dev=(HR@5:0.5875,NDCG@5:0.4159) test=(HR@5:0.5027,NDCG@5:0.3625) [38.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14820933 0.5705013 ]
INFO:root:Epoch 30    loss=0.1482 [108.5 s]	 dev=(HR@5:0.6023,NDCG@5:0.4257) test=(HR@5:0.5228,NDCG@5:0.3734) [38.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14693019 0.56641287]
INFO:root:Epoch 31    loss=0.1469 [108.8 s]	 dev=(HR@5:0.5790,NDCG@5:0.4068) test=(HR@5:0.5133,NDCG@5:0.3645) [38.6 s] 
INFO:root:all_losses: [0.14281861 0.5600615 ]
INFO:root:Epoch 32    loss=0.1428 [108.8 s]	 dev=(HR@5:0.5928,NDCG@5:0.4237) test=(HR@5:0.5345,NDCG@5:0.3778) [38.8 s] 
INFO:root:all_losses: [0.14039893 0.5557823 ]
INFO:root:Epoch 33    loss=0.1404 [109.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4141) test=(HR@5:0.5408,NDCG@5:0.3801) [38.7 s] 
INFO:root:all_losses: [0.14263491 0.5497037 ]
INFO:root:Epoch 34    loss=0.1426 [109.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4111) test=(HR@5:0.5398,NDCG@5:0.3758) [38.6 s] 
INFO:root:all_losses: [0.13949873 0.5463443 ]
INFO:root:Epoch 35    loss=0.1395 [110.0 s]	 dev=(HR@5:0.5748,NDCG@5:0.4141) test=(HR@5:0.5302,NDCG@5:0.3757) [38.5 s] 
INFO:root:all_losses: [0.13834523 0.5413775 ]
INFO:root:Epoch 36    loss=0.1383 [109.0 s]	 dev=(HR@5:0.5938,NDCG@5:0.4262) test=(HR@5:0.5451,NDCG@5:0.3842) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13604002 0.5355081 ]
INFO:root:Epoch 37    loss=0.1360 [109.3 s]	 dev=(HR@5:0.5949,NDCG@5:0.4232) test=(HR@5:0.5461,NDCG@5:0.3807) [38.8 s] 
INFO:root:all_losses: [0.13686271 0.5305566 ]
INFO:root:Epoch 38    loss=0.1369 [109.3 s]	 dev=(HR@5:0.5960,NDCG@5:0.4219) test=(HR@5:0.5419,NDCG@5:0.3864) [38.4 s] 
INFO:root:all_losses: [0.13243414 0.527446  ]
INFO:root:Epoch 39    loss=0.1324 [110.3 s]	 dev=(HR@5:0.5832,NDCG@5:0.4144) test=(HR@5:0.5472,NDCG@5:0.3851) [38.5 s] 
INFO:root:all_losses: [0.13179623 0.5198406 ]
INFO:root:Epoch 40    loss=0.1318 [109.8 s]	 dev=(HR@5:0.5864,NDCG@5:0.4124) test=(HR@5:0.5249,NDCG@5:0.3716) [38.3 s] 
INFO:root:Early stop at 40 based on dev result.
INFO:root:
Best Iter(dev)=   36	 dev=(HR@5:0.5938,NDCG@5:0.4262) test=(HR@5:0.5451,NDCG@5:0.3842) [8367.1 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7137,HR@5:0.5451,HR@50:0.9650,NDCG@10:0.4392,NDCG@5:0.3843,NDCG@50:0.4972)
INFO:root:
--------------------------------------------- END: 2025-01-01 22:40:09 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-03 09:53:33 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45994467 0.69309986]
INFO:root:Epoch 1     loss=0.4599 [123.9 s]	 dev=(HR@5:0.2216,NDCG@5:0.1434) test=(HR@5:0.2163,NDCG@5:0.1486) [38.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43344298 0.6930062 ]
INFO:root:Epoch 2     loss=0.4334 [145.9 s]	 dev=(HR@5:0.2344,NDCG@5:0.1489) test=(HR@5:0.2131,NDCG@5:0.1415) [39.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3738915  0.69279987]
INFO:root:Epoch 3     loss=0.3739 [173.1 s]	 dev=(HR@5:0.3277,NDCG@5:0.2171) test=(HR@5:0.2906,NDCG@5:0.1901) [46.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.303314  0.6914242]
INFO:root:Epoch 4     loss=0.3033 [156.4 s]	 dev=(HR@5:0.4062,NDCG@5:0.2793) test=(HR@5:0.3765,NDCG@5:0.2451) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.27825224 0.6885378 ]
INFO:root:Epoch 5     loss=0.2783 [154.8 s]	 dev=(HR@5:0.4146,NDCG@5:0.2891) test=(HR@5:0.3712,NDCG@5:0.2436) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.24002707 0.6837092 ]
INFO:root:Epoch 6     loss=0.2400 [157.2 s]	 dev=(HR@5:0.4783,NDCG@5:0.3288) test=(HR@5:0.4358,NDCG@5:0.2936) [43.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2195312 0.6774225]
INFO:root:Epoch 7     loss=0.2195 [156.3 s]	 dev=(HR@5:0.4952,NDCG@5:0.3426) test=(HR@5:0.4549,NDCG@5:0.2992) [43.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21302687 0.6716988 ]
INFO:root:Epoch 8     loss=0.2130 [157.1 s]	 dev=(HR@5:0.4825,NDCG@5:0.3333) test=(HR@5:0.4507,NDCG@5:0.3055) [43.6 s] 
INFO:root:all_losses: [0.20722064 0.6683081 ]
INFO:root:Epoch 9     loss=0.2072 [155.9 s]	 dev=(HR@5:0.5207,NDCG@5:0.3592) test=(HR@5:0.4825,NDCG@5:0.3243) [43.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20567812 0.66286707]
INFO:root:Epoch 10    loss=0.2057 [156.6 s]	 dev=(HR@5:0.5058,NDCG@5:0.3536) test=(HR@5:0.4730,NDCG@5:0.3246) [42.8 s] 
INFO:root:all_losses: [0.19909982 0.6579602 ]
INFO:root:Epoch 11    loss=0.1991 [156.5 s]	 dev=(HR@5:0.5239,NDCG@5:0.3597) test=(HR@5:0.4645,NDCG@5:0.3238) [43.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1916478  0.65508634]
INFO:root:Epoch 12    loss=0.1916 [155.3 s]	 dev=(HR@5:0.5133,NDCG@5:0.3519) test=(HR@5:0.4783,NDCG@5:0.3154) [43.2 s] 
INFO:root:all_losses: [0.19330138 0.650548  ]
INFO:root:Epoch 13    loss=0.1933 [156.3 s]	 dev=(HR@5:0.5334,NDCG@5:0.3694) test=(HR@5:0.4740,NDCG@5:0.3295) [43.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18873942 0.6464071 ]
INFO:root:Epoch 14    loss=0.1887 [155.9 s]	 dev=(HR@5:0.5366,NDCG@5:0.3728) test=(HR@5:0.4942,NDCG@5:0.3396) [42.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18774983 0.64200807]
INFO:root:Epoch 15    loss=0.1877 [155.2 s]	 dev=(HR@5:0.5652,NDCG@5:0.3907) test=(HR@5:0.4995,NDCG@5:0.3525) [42.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18307228 0.6371658 ]
INFO:root:Epoch 16    loss=0.1831 [155.7 s]	 dev=(HR@5:0.5419,NDCG@5:0.3854) test=(HR@5:0.4846,NDCG@5:0.3403) [42.7 s] 
INFO:root:all_losses: [0.18039031 0.63202137]
INFO:root:Epoch 17    loss=0.1804 [155.9 s]	 dev=(HR@5:0.5334,NDCG@5:0.3782) test=(HR@5:0.4942,NDCG@5:0.3476) [42.3 s] 
INFO:root:all_losses: [0.17834276 0.62858653]
INFO:root:Epoch 18    loss=0.1783 [154.3 s]	 dev=(HR@5:0.5493,NDCG@5:0.3871) test=(HR@5:0.5069,NDCG@5:0.3545) [42.8 s] 
INFO:root:all_losses: [0.17600735 0.6248119 ]
INFO:root:Epoch 19    loss=0.1760 [155.7 s]	 dev=(HR@5:0.5514,NDCG@5:0.3887) test=(HR@5:0.5016,NDCG@5:0.3548) [42.3 s] 
INFO:root:all_losses: [0.17450337 0.6181876 ]
INFO:root:Epoch 20    loss=0.1745 [156.5 s]	 dev=(HR@5:0.5620,NDCG@5:0.3957) test=(HR@5:0.4952,NDCG@5:0.3526) [42.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1727617 0.6132415]
INFO:root:Epoch 21    loss=0.1728 [156.2 s]	 dev=(HR@5:0.5281,NDCG@5:0.3760) test=(HR@5:0.4910,NDCG@5:0.3457) [42.1 s] 
INFO:root:all_losses: [0.16622914 0.6088148 ]
INFO:root:Epoch 22    loss=0.1662 [154.8 s]	 dev=(HR@5:0.5557,NDCG@5:0.3969) test=(HR@5:0.5005,NDCG@5:0.3537) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16870981 0.60283786]
INFO:root:Epoch 23    loss=0.1687 [156.4 s]	 dev=(HR@5:0.5472,NDCG@5:0.3921) test=(HR@5:0.5154,NDCG@5:0.3629) [42.2 s] 
INFO:root:all_losses: [0.16327092 0.59890664]
INFO:root:Epoch 24    loss=0.1633 [155.7 s]	 dev=(HR@5:0.5684,NDCG@5:0.4029) test=(HR@5:0.5122,NDCG@5:0.3584) [42.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16260214 0.5919793 ]
INFO:root:Epoch 25    loss=0.1626 [157.3 s]	 dev=(HR@5:0.5589,NDCG@5:0.4018) test=(HR@5:0.5122,NDCG@5:0.3606) [42.6 s] 
INFO:root:all_losses: [0.15880193 0.58821595]
INFO:root:Epoch 26    loss=0.1588 [155.9 s]	 dev=(HR@5:0.5631,NDCG@5:0.3936) test=(HR@5:0.5217,NDCG@5:0.3675) [42.4 s] 
INFO:root:all_losses: [0.15618233 0.58313096]
INFO:root:Epoch 27    loss=0.1562 [155.7 s]	 dev=(HR@5:0.5557,NDCG@5:0.3965) test=(HR@5:0.5228,NDCG@5:0.3722) [42.7 s] 
INFO:root:all_losses: [0.15420534 0.5793303 ]
INFO:root:Epoch 28    loss=0.1542 [156.1 s]	 dev=(HR@5:0.5599,NDCG@5:0.3933) test=(HR@5:0.5164,NDCG@5:0.3667) [42.6 s] 
INFO:root:all_losses: [0.15142965 0.57317287]
INFO:root:Epoch 29    loss=0.1514 [156.6 s]	 dev=(HR@5:0.5716,NDCG@5:0.4092) test=(HR@5:0.5090,NDCG@5:0.3618) [42.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15255193 0.568314  ]
INFO:root:Epoch 30    loss=0.1526 [137.0 s]	 dev=(HR@5:0.5864,NDCG@5:0.4186) test=(HR@5:0.5207,NDCG@5:0.3703) [41.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15200262 0.56331486]
INFO:root:Epoch 31    loss=0.1520 [154.1 s]	 dev=(HR@5:0.5684,NDCG@5:0.4016) test=(HR@5:0.5101,NDCG@5:0.3599) [41.4 s] 
INFO:root:all_losses: [0.14836411 0.55715406]
INFO:root:Epoch 32    loss=0.1484 [153.7 s]	 dev=(HR@5:0.5726,NDCG@5:0.4077) test=(HR@5:0.5292,NDCG@5:0.3765) [41.5 s] 
INFO:root:all_losses: [0.14509346 0.5515358 ]
INFO:root:Epoch 33    loss=0.1451 [153.8 s]	 dev=(HR@5:0.5663,NDCG@5:0.4007) test=(HR@5:0.5292,NDCG@5:0.3718) [41.4 s] 
INFO:root:all_losses: [0.14769933 0.54500705]
INFO:root:Epoch 34    loss=0.1477 [155.3 s]	 dev=(HR@5:0.5758,NDCG@5:0.4104) test=(HR@5:0.5164,NDCG@5:0.3678) [41.2 s] 
INFO:root:all_losses: [0.14360605 0.539943  ]
INFO:root:Epoch 35    loss=0.1436 [154.6 s]	 dev=(HR@5:0.5684,NDCG@5:0.4141) test=(HR@5:0.5292,NDCG@5:0.3757) [41.4 s] 
INFO:root:all_losses: [0.14214872 0.5337419 ]
INFO:root:Epoch 36    loss=0.1421 [159.2 s]	 dev=(HR@5:0.5843,NDCG@5:0.4239) test=(HR@5:0.5440,NDCG@5:0.3792) [41.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13977535 0.5282173 ]
INFO:root:Epoch 37    loss=0.1398 [158.1 s]	 dev=(HR@5:0.5790,NDCG@5:0.4156) test=(HR@5:0.5313,NDCG@5:0.3786) [41.3 s] 
INFO:root:all_losses: [0.14057392 0.5213547 ]
INFO:root:Epoch 38    loss=0.1406 [154.6 s]	 dev=(HR@5:0.5758,NDCG@5:0.4129) test=(HR@5:0.5345,NDCG@5:0.3815) [41.3 s] 
INFO:root:all_losses: [0.13711134 0.5142086 ]
INFO:root:Epoch 39    loss=0.1371 [153.7 s]	 dev=(HR@5:0.5663,NDCG@5:0.3970) test=(HR@5:0.5249,NDCG@5:0.3756) [41.4 s] 
INFO:root:all_losses: [0.13475066 0.50592995]
INFO:root:Epoch 40    loss=0.1348 [153.7 s]	 dev=(HR@5:0.5652,NDCG@5:0.4112) test=(HR@5:0.5345,NDCG@5:0.3774) [41.2 s] 
INFO:root:all_losses: [0.13607635 0.49756083]
INFO:root:Epoch 41    loss=0.1361 [154.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.4129) test=(HR@5:0.5345,NDCG@5:0.3789) [41.3 s] 
INFO:root:all_losses: [0.13424216 0.4903507 ]
INFO:root:Epoch 42    loss=0.1342 [152.0 s]	 dev=(HR@5:0.5843,NDCG@5:0.4195) test=(HR@5:0.5440,NDCG@5:0.3882) [41.2 s] 
INFO:root:all_losses: [0.13233721 0.47832808]
INFO:root:Epoch 43    loss=0.1323 [153.4 s]	 dev=(HR@5:0.5854,NDCG@5:0.4208) test=(HR@5:0.5493,NDCG@5:0.3829) [41.3 s] 
INFO:root:all_losses: [0.13140142 0.4700212 ]
INFO:root:Epoch 44    loss=0.1314 [153.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4134) test=(HR@5:0.5366,NDCG@5:0.3856) [41.0 s] 
INFO:root:all_losses: [0.12808748 0.46179175]
INFO:root:Epoch 45    loss=0.1281 [154.5 s]	 dev=(HR@5:0.5854,NDCG@5:0.4136) test=(HR@5:0.5493,NDCG@5:0.3900) [41.4 s] 
INFO:root:all_losses: [0.12854962 0.45233807]
INFO:root:Epoch 46    loss=0.1285 [153.3 s]	 dev=(HR@5:0.5769,NDCG@5:0.4165) test=(HR@5:0.5281,NDCG@5:0.3737) [41.2 s] 
INFO:root:all_losses: [0.1279267  0.44150943]
INFO:root:Epoch 47    loss=0.1279 [153.3 s]	 dev=(HR@5:0.5801,NDCG@5:0.4160) test=(HR@5:0.5313,NDCG@5:0.3808) [41.3 s] 
INFO:root:all_losses: [0.12377532 0.43508685]
INFO:root:Epoch 48    loss=0.1238 [154.0 s]	 dev=(HR@5:0.5811,NDCG@5:0.4195) test=(HR@5:0.5334,NDCG@5:0.3788) [41.0 s] 
INFO:root:all_losses: [0.12630084 0.42643353]
INFO:root:Epoch 49    loss=0.1263 [152.8 s]	 dev=(HR@5:0.5864,NDCG@5:0.4170) test=(HR@5:0.5398,NDCG@5:0.3869) [41.0 s] 
INFO:root:all_losses: [0.12234028 0.4204824 ]
INFO:root:Epoch 50    loss=0.1223 [153.7 s]	 dev=(HR@5:0.5801,NDCG@5:0.4184) test=(HR@5:0.5493,NDCG@5:0.3793) [40.9 s] 
INFO:root:all_losses: [0.12327109 0.4134784 ]
INFO:root:Epoch 51    loss=0.1233 [152.8 s]	 dev=(HR@5:0.5832,NDCG@5:0.4174) test=(HR@5:0.5536,NDCG@5:0.3857) [41.1 s] 
INFO:root:all_losses: [0.12286926 0.40642935]
INFO:root:Epoch 52    loss=0.1229 [153.6 s]	 dev=(HR@5:0.5811,NDCG@5:0.4136) test=(HR@5:0.5313,NDCG@5:0.3802) [41.0 s] 
INFO:root:all_losses: [0.12002246 0.39889774]
INFO:root:Epoch 53    loss=0.1200 [153.9 s]	 dev=(HR@5:0.5938,NDCG@5:0.4230) test=(HR@5:0.5281,NDCG@5:0.3793) [41.3 s] 
INFO:root:all_losses: [0.11821837 0.39333305]
INFO:root:Epoch 54    loss=0.1182 [153.9 s]	 dev=(HR@5:0.5896,NDCG@5:0.4203) test=(HR@5:0.5419,NDCG@5:0.3851) [41.1 s] 
INFO:root:all_losses: [0.11837633 0.38814223]
INFO:root:Epoch 55    loss=0.1184 [154.2 s]	 dev=(HR@5:0.5938,NDCG@5:0.4197) test=(HR@5:0.5398,NDCG@5:0.3907) [41.1 s] 
INFO:root:all_losses: [0.11800788 0.384324  ]
INFO:root:Epoch 56    loss=0.1180 [153.6 s]	 dev=(HR@5:0.5864,NDCG@5:0.4181) test=(HR@5:0.5334,NDCG@5:0.3803) [41.5 s] 
INFO:root:Early stop at 56 based on dev result.
INFO:root:
Best Iter(dev)=   36	 dev=(HR@5:0.5843,NDCG@5:0.4239) test=(HR@5:0.5440,NDCG@5:0.3792) [10991.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7084,HR@5:0.5440,HR@50:0.9629,NDCG@10:0.4328,NDCG@5:0.3796,NDCG@50:0.4915)
INFO:root:
--------------------------------------------- END: 2025-01-03 12:57:25 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-03 15:16:09 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45896277 0.6930987 ]
INFO:root:Epoch 1     loss=0.4590 [97.3 s]	 dev=(HR@5:0.2216,NDCG@5:0.1441) test=(HR@5:0.2174,NDCG@5:0.1500) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.40319926 0.69293255]
INFO:root:Epoch 2     loss=0.4032 [126.8 s]	 dev=(HR@5:0.2641,NDCG@5:0.1705) test=(HR@5:0.2365,NDCG@5:0.1541) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3127865  0.69205576]
INFO:root:Epoch 3     loss=0.3128 [111.3 s]	 dev=(HR@5:0.4199,NDCG@5:0.2871) test=(HR@5:0.3807,NDCG@5:0.2552) [37.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.25372493 0.68840486]
INFO:root:Epoch 4     loss=0.2537 [127.0 s]	 dev=(HR@5:0.4878,NDCG@5:0.3395) test=(HR@5:0.4348,NDCG@5:0.2849) [42.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22113502 0.6827096 ]
INFO:root:Epoch 5     loss=0.2211 [144.7 s]	 dev=(HR@5:0.4528,NDCG@5:0.3177) test=(HR@5:0.4242,NDCG@5:0.2837) [42.2 s] 
INFO:root:all_losses: [0.21014552 0.67679435]
INFO:root:Epoch 6     loss=0.2101 [145.7 s]	 dev=(HR@5:0.4899,NDCG@5:0.3470) test=(HR@5:0.4464,NDCG@5:0.3054) [42.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20202874 0.67105776]
INFO:root:Epoch 7     loss=0.2020 [144.7 s]	 dev=(HR@5:0.5175,NDCG@5:0.3510) test=(HR@5:0.4571,NDCG@5:0.3087) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19680944 0.6651656 ]
INFO:root:Epoch 8     loss=0.1968 [145.6 s]	 dev=(HR@5:0.5175,NDCG@5:0.3586) test=(HR@5:0.4825,NDCG@5:0.3258) [42.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19051507 0.6618903 ]
INFO:root:Epoch 9     loss=0.1905 [144.6 s]	 dev=(HR@5:0.5366,NDCG@5:0.3709) test=(HR@5:0.4995,NDCG@5:0.3444) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18658067 0.6554684 ]
INFO:root:Epoch 10    loss=0.1866 [144.9 s]	 dev=(HR@5:0.5270,NDCG@5:0.3612) test=(HR@5:0.4804,NDCG@5:0.3353) [42.2 s] 
INFO:root:all_losses: [0.17903201 0.6489554 ]
INFO:root:Epoch 11    loss=0.1790 [145.4 s]	 dev=(HR@5:0.5440,NDCG@5:0.3780) test=(HR@5:0.4889,NDCG@5:0.3404) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.171275 0.644576]
INFO:root:Epoch 12    loss=0.1713 [144.9 s]	 dev=(HR@5:0.5567,NDCG@5:0.3829) test=(HR@5:0.5154,NDCG@5:0.3471) [41.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16850153 0.6371709 ]
INFO:root:Epoch 13    loss=0.1685 [144.3 s]	 dev=(HR@5:0.5737,NDCG@5:0.3989) test=(HR@5:0.5217,NDCG@5:0.3663) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16133596 0.6308113 ]
INFO:root:Epoch 14    loss=0.1613 [144.1 s]	 dev=(HR@5:0.5716,NDCG@5:0.3888) test=(HR@5:0.5175,NDCG@5:0.3655) [41.9 s] 
INFO:root:all_losses: [0.15922113 0.6234741 ]
INFO:root:Epoch 15    loss=0.1592 [144.9 s]	 dev=(HR@5:0.5758,NDCG@5:0.4086) test=(HR@5:0.5557,NDCG@5:0.3843) [41.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15114523 0.6155708 ]
INFO:root:Epoch 16    loss=0.1511 [143.3 s]	 dev=(HR@5:0.5726,NDCG@5:0.4051) test=(HR@5:0.5239,NDCG@5:0.3685) [41.4 s] 
INFO:root:all_losses: [0.14771377 0.6085504 ]
INFO:root:Epoch 17    loss=0.1477 [144.6 s]	 dev=(HR@5:0.5854,NDCG@5:0.4137) test=(HR@5:0.5313,NDCG@5:0.3742) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14383012 0.602039  ]
INFO:root:Epoch 18    loss=0.1438 [143.6 s]	 dev=(HR@5:0.5726,NDCG@5:0.4172) test=(HR@5:0.5376,NDCG@5:0.3895) [41.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14023995 0.595318  ]
INFO:root:Epoch 19    loss=0.1402 [144.4 s]	 dev=(HR@5:0.5843,NDCG@5:0.4139) test=(HR@5:0.5536,NDCG@5:0.3968) [41.6 s] 
INFO:root:all_losses: [0.1388701  0.58628404]
INFO:root:Epoch 20    loss=0.1389 [144.6 s]	 dev=(HR@5:0.5811,NDCG@5:0.4112) test=(HR@5:0.5366,NDCG@5:0.3847) [41.3 s] 
INFO:root:all_losses: [0.13578855 0.57862973]
INFO:root:Epoch 21    loss=0.1358 [144.3 s]	 dev=(HR@5:0.5705,NDCG@5:0.4086) test=(HR@5:0.5429,NDCG@5:0.3840) [41.2 s] 
INFO:root:all_losses: [0.12920895 0.57027864]
INFO:root:Epoch 22    loss=0.1292 [148.4 s]	 dev=(HR@5:0.6023,NDCG@5:0.4343) test=(HR@5:0.5483,NDCG@5:0.3936) [41.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1318049  0.56167567]
INFO:root:Epoch 23    loss=0.1318 [144.0 s]	 dev=(HR@5:0.5907,NDCG@5:0.4277) test=(HR@5:0.5642,NDCG@5:0.3950) [41.2 s] 
INFO:root:all_losses: [0.12599853 0.5536595 ]
INFO:root:Epoch 24    loss=0.1260 [144.7 s]	 dev=(HR@5:0.5896,NDCG@5:0.4261) test=(HR@5:0.5620,NDCG@5:0.3992) [41.1 s] 
INFO:root:all_losses: [0.1250195  0.54276437]
INFO:root:Epoch 25    loss=0.1250 [144.9 s]	 dev=(HR@5:0.6045,NDCG@5:0.4355) test=(HR@5:0.5493,NDCG@5:0.3910) [41.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12108812 0.53405654]
INFO:root:Epoch 26    loss=0.1211 [143.6 s]	 dev=(HR@5:0.5737,NDCG@5:0.4155) test=(HR@5:0.5461,NDCG@5:0.3802) [41.2 s] 
INFO:root:all_losses: [0.11813716 0.5248302 ]
INFO:root:Epoch 27    loss=0.1181 [143.8 s]	 dev=(HR@5:0.5896,NDCG@5:0.4238) test=(HR@5:0.5599,NDCG@5:0.3959) [41.1 s] 
INFO:root:all_losses: [0.11711492 0.51612115]
INFO:root:Epoch 28    loss=0.1171 [143.8 s]	 dev=(HR@5:0.6129,NDCG@5:0.4382) test=(HR@5:0.5589,NDCG@5:0.3936) [41.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11293136 0.5041526 ]
INFO:root:Epoch 29    loss=0.1129 [144.0 s]	 dev=(HR@5:0.6161,NDCG@5:0.4456) test=(HR@5:0.5514,NDCG@5:0.3929) [41.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11369148 0.49191073]
INFO:root:Epoch 30    loss=0.1137 [147.3 s]	 dev=(HR@5:0.6151,NDCG@5:0.4408) test=(HR@5:0.5684,NDCG@5:0.4057) [41.1 s] 
INFO:root:all_losses: [0.11087567 0.48372054]
INFO:root:Epoch 31    loss=0.1109 [147.5 s]	 dev=(HR@5:0.6002,NDCG@5:0.4325) test=(HR@5:0.5557,NDCG@5:0.3960) [41.1 s] 
INFO:root:all_losses: [0.10859604 0.4708    ]
INFO:root:Epoch 32    loss=0.1086 [148.3 s]	 dev=(HR@5:0.6161,NDCG@5:0.4395) test=(HR@5:0.5695,NDCG@5:0.4127) [41.0 s] 
INFO:root:all_losses: [0.10519776 0.46037802]
INFO:root:Epoch 33    loss=0.1052 [148.5 s]	 dev=(HR@5:0.6013,NDCG@5:0.4345) test=(HR@5:0.5758,NDCG@5:0.4035) [41.4 s] 
INFO:root:all_losses: [0.10590996 0.44878042]
INFO:root:Epoch 34    loss=0.1059 [147.3 s]	 dev=(HR@5:0.5896,NDCG@5:0.4233) test=(HR@5:0.5419,NDCG@5:0.3911) [41.1 s] 
INFO:root:all_losses: [0.10184976 0.43871236]
INFO:root:Epoch 35    loss=0.1018 [149.6 s]	 dev=(HR@5:0.6235,NDCG@5:0.4478) test=(HR@5:0.5642,NDCG@5:0.4064) [40.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10015889 0.42898852]
INFO:root:Epoch 36    loss=0.1002 [147.9 s]	 dev=(HR@5:0.6182,NDCG@5:0.4504) test=(HR@5:0.5843,NDCG@5:0.4173) [41.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.09802011 0.416574  ]
INFO:root:Epoch 37    loss=0.0980 [149.6 s]	 dev=(HR@5:0.6182,NDCG@5:0.4413) test=(HR@5:0.5801,NDCG@5:0.4072) [41.4 s] 
INFO:root:all_losses: [0.09734909 0.40732968]
INFO:root:Epoch 38    loss=0.0973 [148.4 s]	 dev=(HR@5:0.6098,NDCG@5:0.4440) test=(HR@5:0.5620,NDCG@5:0.4096) [41.0 s] 
INFO:root:all_losses: [0.0940621  0.39796007]
INFO:root:Epoch 39    loss=0.0941 [147.6 s]	 dev=(HR@5:0.6119,NDCG@5:0.4445) test=(HR@5:0.5737,NDCG@5:0.4092) [41.0 s] 
INFO:root:all_losses: [0.09112884 0.3861207 ]
INFO:root:Epoch 40    loss=0.0911 [147.3 s]	 dev=(HR@5:0.6140,NDCG@5:0.4480) test=(HR@5:0.5578,NDCG@5:0.4005) [41.1 s] 
INFO:root:all_losses: [0.09268114 0.37708256]
INFO:root:Epoch 41    loss=0.0927 [148.1 s]	 dev=(HR@5:0.5949,NDCG@5:0.4394) test=(HR@5:0.5578,NDCG@5:0.3954) [41.2 s] 
INFO:root:all_losses: [0.09029758 0.3686748 ]
INFO:root:Epoch 42    loss=0.0903 [147.0 s]	 dev=(HR@5:0.5981,NDCG@5:0.4446) test=(HR@5:0.5684,NDCG@5:0.4096) [40.6 s] 
INFO:root:all_losses: [0.08759935 0.35797217]
INFO:root:Epoch 43    loss=0.0876 [146.3 s]	 dev=(HR@5:0.6087,NDCG@5:0.4465) test=(HR@5:0.5748,NDCG@5:0.4095) [40.9 s] 
INFO:root:all_losses: [0.08624058 0.34888813]
INFO:root:Epoch 44    loss=0.0862 [147.6 s]	 dev=(HR@5:0.6034,NDCG@5:0.4407) test=(HR@5:0.5472,NDCG@5:0.3979) [40.7 s] 
INFO:root:all_losses: [0.08330897 0.34192723]
INFO:root:Epoch 45    loss=0.0833 [146.9 s]	 dev=(HR@5:0.6193,NDCG@5:0.4508) test=(HR@5:0.5790,NDCG@5:0.4198) [40.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.08420113 0.33447057]
INFO:root:Epoch 46    loss=0.0842 [146.8 s]	 dev=(HR@5:0.6193,NDCG@5:0.4478) test=(HR@5:0.5695,NDCG@5:0.4073) [40.7 s] 
INFO:root:all_losses: [0.08341284 0.3245483 ]
INFO:root:Epoch 47    loss=0.0834 [146.3 s]	 dev=(HR@5:0.6193,NDCG@5:0.4502) test=(HR@5:0.5875,NDCG@5:0.4169) [40.7 s] 
INFO:root:all_losses: [0.08028539 0.31739774]
INFO:root:Epoch 48    loss=0.0803 [147.3 s]	 dev=(HR@5:0.6182,NDCG@5:0.4495) test=(HR@5:0.5779,NDCG@5:0.4106) [40.9 s] 
INFO:root:all_losses: [0.08060301 0.31052175]
INFO:root:Epoch 49    loss=0.0806 [146.3 s]	 dev=(HR@5:0.6257,NDCG@5:0.4555) test=(HR@5:0.5907,NDCG@5:0.4240) [41.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.07787161 0.30277446]
INFO:root:Epoch 50    loss=0.0779 [146.9 s]	 dev=(HR@5:0.6204,NDCG@5:0.4524) test=(HR@5:0.5769,NDCG@5:0.4081) [40.7 s] 
INFO:root:all_losses: [0.07816193 0.29649645]
INFO:root:Epoch 51    loss=0.0782 [281.2 s]	 dev=(HR@5:0.6299,NDCG@5:0.4588) test=(HR@5:0.5801,NDCG@5:0.4198) [71.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.0765888 0.2895368]
INFO:root:Epoch 52    loss=0.0766 [347.1 s]	 dev=(HR@5:0.6182,NDCG@5:0.4507) test=(HR@5:0.5695,NDCG@5:0.4066) [71.4 s] 
INFO:root:all_losses: [0.07482472 0.2837946 ]
INFO:root:Epoch 53    loss=0.0748 [344.9 s]	 dev=(HR@5:0.6257,NDCG@5:0.4609) test=(HR@5:0.5610,NDCG@5:0.4078) [71.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.0728576  0.28037372]
INFO:root:Epoch 54    loss=0.0729 [346.5 s]	 dev=(HR@5:0.6257,NDCG@5:0.4566) test=(HR@5:0.5748,NDCG@5:0.4179) [71.7 s] 
INFO:root:all_losses: [0.07323904 0.2751059 ]
INFO:root:Epoch 55    loss=0.0732 [350.0 s]	 dev=(HR@5:0.6235,NDCG@5:0.4510) test=(HR@5:0.5737,NDCG@5:0.4142) [71.4 s] 
INFO:root:all_losses: [0.07343625 0.27010474]
INFO:root:Epoch 56    loss=0.0734 [355.5 s]	 dev=(HR@5:0.6204,NDCG@5:0.4485) test=(HR@5:0.5758,NDCG@5:0.4136) [71.9 s] 
INFO:root:all_losses: [0.06964294 0.2654906 ]
INFO:root:Epoch 57    loss=0.0696 [355.0 s]	 dev=(HR@5:0.6246,NDCG@5:0.4573) test=(HR@5:0.5822,NDCG@5:0.4108) [71.6 s] 
INFO:root:all_losses: [0.06828251 0.26357278]
INFO:root:Epoch 58    loss=0.0683 [356.2 s]	 dev=(HR@5:0.6087,NDCG@5:0.4452) test=(HR@5:0.5673,NDCG@5:0.4114) [72.5 s] 
INFO:root:all_losses: [0.06825528 0.2578457 ]
INFO:root:Epoch 59    loss=0.0683 [356.6 s]	 dev=(HR@5:0.6066,NDCG@5:0.4493) test=(HR@5:0.5811,NDCG@5:0.4172) [72.7 s] 
INFO:root:all_losses: [0.06862812 0.2539745 ]
INFO:root:Epoch 60    loss=0.0686 [355.9 s]	 dev=(HR@5:0.6098,NDCG@5:0.4438) test=(HR@5:0.5642,NDCG@5:0.4109) [72.5 s] 
INFO:root:all_losses: [0.06840179 0.25144905]
INFO:root:Epoch 61    loss=0.0684 [356.3 s]	 dev=(HR@5:0.6002,NDCG@5:0.4440) test=(HR@5:0.5684,NDCG@5:0.4085) [72.5 s] 
INFO:root:all_losses: [0.06658819 0.24676017]
INFO:root:Epoch 62    loss=0.0666 [357.7 s]	 dev=(HR@5:0.6129,NDCG@5:0.4518) test=(HR@5:0.5737,NDCG@5:0.4102) [72.5 s] 
INFO:root:all_losses: [0.06571604 0.24524374]
INFO:root:Epoch 63    loss=0.0657 [315.0 s]	 dev=(HR@5:0.6193,NDCG@5:0.4459) test=(HR@5:0.5705,NDCG@5:0.4120) [41.1 s] 
INFO:root:all_losses: [0.06485681 0.24212861]
INFO:root:Epoch 64    loss=0.0649 [154.1 s]	 dev=(HR@5:0.6225,NDCG@5:0.4500) test=(HR@5:0.5705,NDCG@5:0.4166) [41.6 s] 
INFO:root:all_losses: [0.06425976 0.24183728]
INFO:root:Epoch 65    loss=0.0643 [150.4 s]	 dev=(HR@5:0.6299,NDCG@5:0.4639) test=(HR@5:0.5748,NDCG@5:0.4192) [41.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.06372203 0.23860124]
INFO:root:Epoch 66    loss=0.0637 [151.1 s]	 dev=(HR@5:0.6373,NDCG@5:0.4584) test=(HR@5:0.5758,NDCG@5:0.4144) [41.1 s] 
INFO:root:all_losses: [0.06225935 0.23501123]
INFO:root:Epoch 67    loss=0.0623 [262.7 s]	 dev=(HR@5:0.6299,NDCG@5:0.4636) test=(HR@5:0.5822,NDCG@5:0.4202) [72.6 s] 
INFO:root:all_losses: [0.06289065 0.23364575]
INFO:root:Epoch 68    loss=0.0629 [355.4 s]	 dev=(HR@5:0.6310,NDCG@5:0.4630) test=(HR@5:0.5748,NDCG@5:0.4197) [72.1 s] 
INFO:root:all_losses: [0.0611526  0.23313034]
INFO:root:Epoch 69    loss=0.0612 [353.6 s]	 dev=(HR@5:0.6225,NDCG@5:0.4583) test=(HR@5:0.5726,NDCG@5:0.4161) [72.0 s] 
INFO:root:all_losses: [0.06116211 0.22710253]
INFO:root:Epoch 70    loss=0.0612 [354.7 s]	 dev=(HR@5:0.6161,NDCG@5:0.4495) test=(HR@5:0.5705,NDCG@5:0.4210) [72.2 s] 
INFO:root:all_losses: [0.06081702 0.22743526]
INFO:root:Epoch 71    loss=0.0608 [357.7 s]	 dev=(HR@5:0.6246,NDCG@5:0.4542) test=(HR@5:0.5716,NDCG@5:0.4104) [72.1 s] 
INFO:root:all_losses: [0.05846264 0.22545736]
INFO:root:Epoch 72    loss=0.0585 [360.3 s]	 dev=(HR@5:0.6267,NDCG@5:0.4644) test=(HR@5:0.5726,NDCG@5:0.4178) [71.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.05933205 0.22632168]
INFO:root:Epoch 73    loss=0.0593 [360.7 s]	 dev=(HR@5:0.6087,NDCG@5:0.4435) test=(HR@5:0.5822,NDCG@5:0.4287) [71.9 s] 
INFO:root:all_losses: [0.05870011 0.22394577]
INFO:root:Epoch 74    loss=0.0587 [364.3 s]	 dev=(HR@5:0.6182,NDCG@5:0.4556) test=(HR@5:0.5620,NDCG@5:0.4100) [72.0 s] 
INFO:root:all_losses: [0.05657258 0.21772203]
INFO:root:Epoch 75    loss=0.0566 [365.9 s]	 dev=(HR@5:0.6437,NDCG@5:0.4651) test=(HR@5:0.5811,NDCG@5:0.4280) [72.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.05701758 0.21828783]
INFO:root:Epoch 76    loss=0.0570 [366.2 s]	 dev=(HR@5:0.6310,NDCG@5:0.4658) test=(HR@5:0.5737,NDCG@5:0.4203) [71.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.05678985 0.21863092]
INFO:root:Epoch 77    loss=0.0568 [353.9 s]	 dev=(HR@5:0.6108,NDCG@5:0.4541) test=(HR@5:0.5652,NDCG@5:0.4165) [73.2 s] 
INFO:root:all_losses: [0.05499377 0.21412055]
INFO:root:Epoch 78    loss=0.0550 [376.9 s]	 dev=(HR@5:0.6341,NDCG@5:0.4677) test=(HR@5:0.5822,NDCG@5:0.4222) [72.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.05544836 0.212986  ]
INFO:root:Epoch 79    loss=0.0554 [371.9 s]	 dev=(HR@5:0.6225,NDCG@5:0.4578) test=(HR@5:0.5801,NDCG@5:0.4226) [73.6 s] 
INFO:root:all_losses: [0.05419402 0.21270712]
INFO:root:Epoch 80    loss=0.0542 [369.3 s]	 dev=(HR@5:0.6331,NDCG@5:0.4667) test=(HR@5:0.5822,NDCG@5:0.4219) [72.0 s] 
INFO:root:all_losses: [0.0546257  0.21449767]
INFO:root:Epoch 81    loss=0.0546 [370.0 s]	 dev=(HR@5:0.6373,NDCG@5:0.4644) test=(HR@5:0.5748,NDCG@5:0.4172) [71.9 s] 
INFO:root:all_losses: [0.0531038 0.2105574]
INFO:root:Epoch 82    loss=0.0531 [171.6 s]	 dev=(HR@5:0.6469,NDCG@5:0.4709) test=(HR@5:0.5811,NDCG@5:0.4221) [41.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.05401432 0.21153393]
INFO:root:Epoch 83    loss=0.0540 [156.3 s]	 dev=(HR@5:0.6299,NDCG@5:0.4590) test=(HR@5:0.5769,NDCG@5:0.4165) [41.0 s] 
INFO:root:all_losses: [0.05327174 0.20879556]
INFO:root:Epoch 84    loss=0.0533 [151.7 s]	 dev=(HR@5:0.6246,NDCG@5:0.4586) test=(HR@5:0.5875,NDCG@5:0.4285) [41.0 s] 
INFO:root:all_losses: [0.05307951 0.20898224]
INFO:root:Epoch 85    loss=0.0531 [152.4 s]	 dev=(HR@5:0.6310,NDCG@5:0.4619) test=(HR@5:0.5663,NDCG@5:0.4143) [41.3 s] 
INFO:root:all_losses: [0.05191859 0.20652646]
INFO:root:Epoch 86    loss=0.0519 [151.6 s]	 dev=(HR@5:0.6320,NDCG@5:0.4547) test=(HR@5:0.5811,NDCG@5:0.4184) [41.1 s] 
INFO:root:all_losses: [0.051446   0.20622444]
INFO:root:Epoch 87    loss=0.0514 [151.7 s]	 dev=(HR@5:0.6394,NDCG@5:0.4614) test=(HR@5:0.5716,NDCG@5:0.4203) [41.0 s] 
INFO:root:all_losses: [0.05156808 0.20510009]
INFO:root:Epoch 88    loss=0.0516 [151.7 s]	 dev=(HR@5:0.6288,NDCG@5:0.4549) test=(HR@5:0.5673,NDCG@5:0.4100) [41.0 s] 
INFO:root:all_losses: [0.05006659 0.2031216 ]
INFO:root:Epoch 89    loss=0.0501 [150.8 s]	 dev=(HR@5:0.6225,NDCG@5:0.4556) test=(HR@5:0.5705,NDCG@5:0.4137) [40.8 s] 
INFO:root:all_losses: [0.05132264 0.20427631]
INFO:root:Epoch 90    loss=0.0513 [158.3 s]	 dev=(HR@5:0.6214,NDCG@5:0.4519) test=(HR@5:0.5663,NDCG@5:0.4090) [41.3 s] 
INFO:root:all_losses: [0.05040114 0.19960263]
INFO:root:Epoch 91    loss=0.0504 [154.2 s]	 dev=(HR@5:0.6299,NDCG@5:0.4621) test=(HR@5:0.5684,NDCG@5:0.4145) [41.2 s] 
INFO:root:all_losses: [0.05010026 0.20283642]
INFO:root:Epoch 92    loss=0.0501 [151.5 s]	 dev=(HR@5:0.6341,NDCG@5:0.4613) test=(HR@5:0.5642,NDCG@5:0.4139) [41.3 s] 
INFO:root:all_losses: [0.0501463  0.20077646]
INFO:root:Epoch 93    loss=0.0501 [151.7 s]	 dev=(HR@5:0.6394,NDCG@5:0.4669) test=(HR@5:0.5716,NDCG@5:0.4146) [40.9 s] 
INFO:root:all_losses: [0.04907716 0.20105864]
INFO:root:Epoch 94    loss=0.0491 [151.1 s]	 dev=(HR@5:0.6341,NDCG@5:0.4574) test=(HR@5:0.5779,NDCG@5:0.4146) [41.2 s] 
INFO:root:all_losses: [0.04719815 0.1980439 ]
INFO:root:Epoch 95    loss=0.0472 [151.8 s]	 dev=(HR@5:0.6225,NDCG@5:0.4634) test=(HR@5:0.5705,NDCG@5:0.4186) [41.2 s] 
INFO:root:all_losses: [0.0476802 0.1975421]
INFO:root:Epoch 96    loss=0.0477 [151.4 s]	 dev=(HR@5:0.6055,NDCG@5:0.4509) test=(HR@5:0.5695,NDCG@5:0.4127) [41.4 s] 
INFO:root:all_losses: [0.0485506  0.19801816]
INFO:root:Epoch 97    loss=0.0486 [151.5 s]	 dev=(HR@5:0.6225,NDCG@5:0.4568) test=(HR@5:0.5758,NDCG@5:0.4145) [41.0 s] 
INFO:root:all_losses: [0.04823859 0.19721594]
INFO:root:Epoch 98    loss=0.0482 [152.4 s]	 dev=(HR@5:0.6299,NDCG@5:0.4607) test=(HR@5:0.5642,NDCG@5:0.4136) [40.6 s] 
INFO:root:all_losses: [0.04728033 0.19634129]
INFO:root:Epoch 99    loss=0.0473 [152.6 s]	 dev=(HR@5:0.6161,NDCG@5:0.4492) test=(HR@5:0.5716,NDCG@5:0.4156) [40.5 s] 
INFO:root:all_losses: [0.04567005 0.19673294]
INFO:root:Epoch 100   loss=0.0457 [152.3 s]	 dev=(HR@5:0.6363,NDCG@5:0.4683) test=(HR@5:0.5779,NDCG@5:0.4223) [41.0 s] 
INFO:root:all_losses: [0.04718566 0.19536157]
INFO:root:Epoch 101   loss=0.0472 [152.2 s]	 dev=(HR@5:0.6341,NDCG@5:0.4562) test=(HR@5:0.5610,NDCG@5:0.4074) [41.2 s] 
INFO:root:all_losses: [0.04673274 0.1930443 ]
INFO:root:Epoch 102   loss=0.0467 [152.8 s]	 dev=(HR@5:0.6267,NDCG@5:0.4542) test=(HR@5:0.5716,NDCG@5:0.4113) [41.1 s] 
INFO:root:Early stop at 102 based on dev result.
INFO:root:
Best Iter(dev)=   82	 dev=(HR@5:0.6469,NDCG@5:0.4709) test=(HR@5:0.5811,NDCG@5:0.4221) [25705.0 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7306,HR@5:0.5811,HR@50:0.9671,NDCG@10:0.4706,NDCG@5:0.4221,NDCG@50:0.5243)
INFO:root:
--------------------------------------------- END: 2025-01-03 22:25:13 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-03 22:38:53 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.4595798  0.69309926]
INFO:root:Epoch 1     loss=0.4596 [119.0 s]	 dev=(HR@5:0.2227,NDCG@5:0.1434) test=(HR@5:0.2153,NDCG@5:0.1480) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4096544 0.6929353]
INFO:root:Epoch 2     loss=0.4097 [140.3 s]	 dev=(HR@5:0.2460,NDCG@5:0.1625) test=(HR@5:0.2280,NDCG@5:0.1503) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34653455 0.6924835 ]
INFO:root:Epoch 3     loss=0.3465 [139.4 s]	 dev=(HR@5:0.3372,NDCG@5:0.2253) test=(HR@5:0.2895,NDCG@5:0.1922) [38.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2845901  0.69033355]
INFO:root:Epoch 4     loss=0.2846 [132.8 s]	 dev=(HR@5:0.4528,NDCG@5:0.3171) test=(HR@5:0.4062,NDCG@5:0.2675) [42.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23825765 0.68598044]
INFO:root:Epoch 5     loss=0.2383 [150.6 s]	 dev=(HR@5:0.4210,NDCG@5:0.2984) test=(HR@5:0.3913,NDCG@5:0.2640) [42.7 s] 
INFO:root:all_losses: [0.21920113 0.6807665 ]
INFO:root:Epoch 6     loss=0.2192 [150.6 s]	 dev=(HR@5:0.4804,NDCG@5:0.3413) test=(HR@5:0.4475,NDCG@5:0.3048) [42.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2104015 0.675461 ]
INFO:root:Epoch 7     loss=0.2104 [151.7 s]	 dev=(HR@5:0.4963,NDCG@5:0.3417) test=(HR@5:0.4422,NDCG@5:0.2969) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20530857 0.6700463 ]
INFO:root:Epoch 8     loss=0.2053 [151.9 s]	 dev=(HR@5:0.5101,NDCG@5:0.3590) test=(HR@5:0.4783,NDCG@5:0.3276) [42.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19962326 0.66662574]
INFO:root:Epoch 9     loss=0.1996 [151.2 s]	 dev=(HR@5:0.5281,NDCG@5:0.3669) test=(HR@5:0.4751,NDCG@5:0.3298) [42.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19741155 0.6608853 ]
INFO:root:Epoch 10    loss=0.1974 [151.1 s]	 dev=(HR@5:0.5111,NDCG@5:0.3575) test=(HR@5:0.4814,NDCG@5:0.3297) [42.5 s] 
INFO:root:all_losses: [0.19091165 0.65529186]
INFO:root:Epoch 11    loss=0.1909 [150.7 s]	 dev=(HR@5:0.5196,NDCG@5:0.3599) test=(HR@5:0.4528,NDCG@5:0.3095) [42.5 s] 
INFO:root:all_losses: [0.18388045 0.65183294]
INFO:root:Epoch 12    loss=0.1839 [150.7 s]	 dev=(HR@5:0.5196,NDCG@5:0.3655) test=(HR@5:0.4973,NDCG@5:0.3368) [42.3 s] 
INFO:root:all_losses: [0.18457404 0.64672   ]
INFO:root:Epoch 13    loss=0.1846 [150.6 s]	 dev=(HR@5:0.5419,NDCG@5:0.3778) test=(HR@5:0.4920,NDCG@5:0.3440) [42.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17891225 0.6423489 ]
INFO:root:Epoch 14    loss=0.1789 [151.1 s]	 dev=(HR@5:0.5472,NDCG@5:0.3750) test=(HR@5:0.5090,NDCG@5:0.3552) [42.6 s] 
INFO:root:all_losses: [0.17684443 0.6371583 ]
INFO:root:Epoch 15    loss=0.1768 [150.6 s]	 dev=(HR@5:0.5610,NDCG@5:0.3926) test=(HR@5:0.5101,NDCG@5:0.3557) [42.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17102784 0.6311104 ]
INFO:root:Epoch 16    loss=0.1710 [150.0 s]	 dev=(HR@5:0.5514,NDCG@5:0.3918) test=(HR@5:0.5260,NDCG@5:0.3610) [42.2 s] 
INFO:root:all_losses: [0.16767794 0.62506515]
INFO:root:Epoch 17    loss=0.1677 [151.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.3994) test=(HR@5:0.5217,NDCG@5:0.3710) [42.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16430672 0.6202455 ]
INFO:root:Epoch 18    loss=0.1643 [151.0 s]	 dev=(HR@5:0.5557,NDCG@5:0.4001) test=(HR@5:0.5207,NDCG@5:0.3679) [42.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1606504 0.6150171]
INFO:root:Epoch 19    loss=0.1607 [152.3 s]	 dev=(HR@5:0.5557,NDCG@5:0.3939) test=(HR@5:0.5281,NDCG@5:0.3862) [42.2 s] 
INFO:root:all_losses: [0.16005296 0.6079907 ]
INFO:root:Epoch 20    loss=0.1601 [151.5 s]	 dev=(HR@5:0.5705,NDCG@5:0.4026) test=(HR@5:0.5133,NDCG@5:0.3715) [42.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1575647 0.6022758]
INFO:root:Epoch 21    loss=0.1576 [141.2 s]	 dev=(HR@5:0.5652,NDCG@5:0.4025) test=(HR@5:0.5143,NDCG@5:0.3720) [43.2 s] 
INFO:root:all_losses: [0.15061577 0.5964652 ]
INFO:root:Epoch 22    loss=0.1506 [151.2 s]	 dev=(HR@5:0.5726,NDCG@5:0.4133) test=(HR@5:0.5345,NDCG@5:0.3765) [42.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1535301 0.5905757]
INFO:root:Epoch 23    loss=0.1535 [150.8 s]	 dev=(HR@5:0.5684,NDCG@5:0.4100) test=(HR@5:0.5366,NDCG@5:0.3796) [42.3 s] 
INFO:root:all_losses: [0.14864248 0.58565104]
INFO:root:Epoch 24    loss=0.1486 [149.9 s]	 dev=(HR@5:0.5790,NDCG@5:0.4090) test=(HR@5:0.5228,NDCG@5:0.3684) [41.8 s] 
INFO:root:all_losses: [0.1484547 0.5780186]
INFO:root:Epoch 25    loss=0.1485 [151.0 s]	 dev=(HR@5:0.5769,NDCG@5:0.4147) test=(HR@5:0.5207,NDCG@5:0.3669) [42.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14415301 0.5738575 ]
INFO:root:Epoch 26    loss=0.1442 [150.7 s]	 dev=(HR@5:0.5652,NDCG@5:0.4093) test=(HR@5:0.5249,NDCG@5:0.3740) [41.8 s] 
INFO:root:all_losses: [0.14130402 0.5686183 ]
INFO:root:Epoch 27    loss=0.1413 [150.1 s]	 dev=(HR@5:0.5758,NDCG@5:0.4169) test=(HR@5:0.5472,NDCG@5:0.3889) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14055598 0.56371903]
INFO:root:Epoch 28    loss=0.1406 [150.6 s]	 dev=(HR@5:0.5652,NDCG@5:0.4077) test=(HR@5:0.5133,NDCG@5:0.3700) [41.9 s] 
INFO:root:all_losses: [0.13740465 0.5556243 ]
INFO:root:Epoch 29    loss=0.1374 [151.9 s]	 dev=(HR@5:0.5864,NDCG@5:0.4203) test=(HR@5:0.5313,NDCG@5:0.3786) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13899843 0.5497947 ]
INFO:root:Epoch 30    loss=0.1390 [153.6 s]	 dev=(HR@5:0.5864,NDCG@5:0.4187) test=(HR@5:0.5408,NDCG@5:0.3887) [42.0 s] 
INFO:root:all_losses: [0.13720967 0.54445845]
INFO:root:Epoch 31    loss=0.1372 [155.1 s]	 dev=(HR@5:0.5737,NDCG@5:0.4133) test=(HR@5:0.5281,NDCG@5:0.3794) [41.7 s] 
INFO:root:all_losses: [0.13373095 0.5368072 ]
INFO:root:Epoch 32    loss=0.1337 [154.9 s]	 dev=(HR@5:0.5832,NDCG@5:0.4136) test=(HR@5:0.5408,NDCG@5:0.3863) [41.5 s] 
INFO:root:all_losses: [0.13019152 0.530605  ]
INFO:root:Epoch 33    loss=0.1302 [154.7 s]	 dev=(HR@5:0.5885,NDCG@5:0.4191) test=(HR@5:0.5408,NDCG@5:0.3820) [41.7 s] 
INFO:root:all_losses: [0.13269521 0.5216796 ]
INFO:root:Epoch 34    loss=0.1327 [154.0 s]	 dev=(HR@5:0.5705,NDCG@5:0.4112) test=(HR@5:0.5260,NDCG@5:0.3737) [41.7 s] 
INFO:root:all_losses: [0.12944783 0.5153713 ]
INFO:root:Epoch 35    loss=0.1294 [153.6 s]	 dev=(HR@5:0.5822,NDCG@5:0.4248) test=(HR@5:0.5345,NDCG@5:0.3754) [42.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12663053 0.50743026]
INFO:root:Epoch 36    loss=0.1266 [154.2 s]	 dev=(HR@5:0.5885,NDCG@5:0.4247) test=(HR@5:0.5557,NDCG@5:0.3865) [41.5 s] 
INFO:root:all_losses: [0.12418132 0.4997196 ]
INFO:root:Epoch 37    loss=0.1242 [154.4 s]	 dev=(HR@5:0.5864,NDCG@5:0.4193) test=(HR@5:0.5419,NDCG@5:0.3826) [41.8 s] 
INFO:root:all_losses: [0.1252986  0.49215823]
INFO:root:Epoch 38    loss=0.1253 [154.4 s]	 dev=(HR@5:0.5917,NDCG@5:0.4261) test=(HR@5:0.5313,NDCG@5:0.3723) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12190534 0.48439625]
INFO:root:Epoch 39    loss=0.1219 [153.6 s]	 dev=(HR@5:0.5854,NDCG@5:0.4194) test=(HR@5:0.5419,NDCG@5:0.3872) [41.5 s] 
INFO:root:all_losses: [0.11821173 0.4742513 ]
INFO:root:Epoch 40    loss=0.1182 [153.7 s]	 dev=(HR@5:0.5769,NDCG@5:0.4206) test=(HR@5:0.5419,NDCG@5:0.3822) [41.5 s] 
INFO:root:all_losses: [0.12158374 0.4651898 ]
INFO:root:Epoch 41    loss=0.1216 [153.0 s]	 dev=(HR@5:0.5801,NDCG@5:0.4244) test=(HR@5:0.5313,NDCG@5:0.3746) [41.4 s] 
INFO:root:all_losses: [0.11890426 0.45969328]
INFO:root:Epoch 42    loss=0.1189 [153.3 s]	 dev=(HR@5:0.5875,NDCG@5:0.4318) test=(HR@5:0.5376,NDCG@5:0.3875) [41.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11616556 0.45072573]
INFO:root:Epoch 43    loss=0.1162 [152.6 s]	 dev=(HR@5:0.5832,NDCG@5:0.4260) test=(HR@5:0.5408,NDCG@5:0.3859) [41.2 s] 
INFO:root:all_losses: [0.11571075 0.4401698 ]
INFO:root:Epoch 44    loss=0.1157 [152.1 s]	 dev=(HR@5:0.5705,NDCG@5:0.4176) test=(HR@5:0.5313,NDCG@5:0.3834) [41.3 s] 
INFO:root:all_losses: [0.11221224 0.43297777]
INFO:root:Epoch 45    loss=0.1122 [153.5 s]	 dev=(HR@5:0.5790,NDCG@5:0.4237) test=(HR@5:0.5302,NDCG@5:0.3789) [41.5 s] 
INFO:root:all_losses: [0.11274592 0.42676833]
INFO:root:Epoch 46    loss=0.1127 [153.5 s]	 dev=(HR@5:0.5652,NDCG@5:0.4184) test=(HR@5:0.5260,NDCG@5:0.3804) [41.1 s] 
INFO:root:all_losses: [0.1122584  0.41628236]
INFO:root:Epoch 47    loss=0.1123 [153.2 s]	 dev=(HR@5:0.5822,NDCG@5:0.4227) test=(HR@5:0.5323,NDCG@5:0.3766) [41.4 s] 
INFO:root:all_losses: [0.10804237 0.40977624]
INFO:root:Epoch 48    loss=0.1080 [153.3 s]	 dev=(HR@5:0.5843,NDCG@5:0.4256) test=(HR@5:0.5281,NDCG@5:0.3707) [41.1 s] 
INFO:root:all_losses: [0.10989606 0.40222633]
INFO:root:Epoch 49    loss=0.1099 [154.0 s]	 dev=(HR@5:0.6013,NDCG@5:0.4369) test=(HR@5:0.5483,NDCG@5:0.3910) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10636726 0.3972169 ]
INFO:root:Epoch 50    loss=0.1064 [152.9 s]	 dev=(HR@5:0.6076,NDCG@5:0.4415) test=(HR@5:0.5536,NDCG@5:0.3934) [41.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10784893 0.39001715]
INFO:root:Epoch 51    loss=0.1078 [152.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4284) test=(HR@5:0.5589,NDCG@5:0.4044) [41.3 s] 
INFO:root:all_losses: [0.10628738 0.38264048]
INFO:root:Epoch 52    loss=0.1063 [152.8 s]	 dev=(HR@5:0.6045,NDCG@5:0.4376) test=(HR@5:0.5429,NDCG@5:0.3863) [41.3 s] 
INFO:root:all_losses: [0.10444135 0.3774491 ]
INFO:root:Epoch 53    loss=0.1044 [152.5 s]	 dev=(HR@5:0.6098,NDCG@5:0.4428) test=(HR@5:0.5620,NDCG@5:0.3923) [41.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10151271 0.36858585]
INFO:root:Epoch 54    loss=0.1015 [152.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4298) test=(HR@5:0.5440,NDCG@5:0.3849) [41.3 s] 
INFO:root:all_losses: [0.10254014 0.36308795]
INFO:root:Epoch 55    loss=0.1025 [153.8 s]	 dev=(HR@5:0.5938,NDCG@5:0.4276) test=(HR@5:0.5514,NDCG@5:0.3979) [41.2 s] 
INFO:root:all_losses: [0.10314599 0.35865057]
INFO:root:Epoch 56    loss=0.1031 [152.6 s]	 dev=(HR@5:0.5928,NDCG@5:0.4286) test=(HR@5:0.5695,NDCG@5:0.4000) [41.4 s] 
INFO:root:all_losses: [0.09991068 0.35403717]
INFO:root:Epoch 57    loss=0.0999 [153.0 s]	 dev=(HR@5:0.6023,NDCG@5:0.4323) test=(HR@5:0.5366,NDCG@5:0.3843) [41.4 s] 
INFO:root:all_losses: [0.09766329 0.34767964]
INFO:root:Epoch 58    loss=0.0977 [154.6 s]	 dev=(HR@5:0.5875,NDCG@5:0.4232) test=(HR@5:0.5387,NDCG@5:0.3799) [41.6 s] 
INFO:root:all_losses: [0.09789985 0.34344095]
INFO:root:Epoch 59    loss=0.0979 [154.1 s]	 dev=(HR@5:0.5896,NDCG@5:0.4315) test=(HR@5:0.5472,NDCG@5:0.3891) [41.6 s] 
INFO:root:all_losses: [0.09819143 0.33700904]
INFO:root:Epoch 60    loss=0.0982 [154.7 s]	 dev=(HR@5:0.5864,NDCG@5:0.4170) test=(HR@5:0.5292,NDCG@5:0.3775) [41.3 s] 
INFO:root:all_losses: [0.09700642 0.33326408]
INFO:root:Epoch 61    loss=0.0970 [153.8 s]	 dev=(HR@5:0.6013,NDCG@5:0.4281) test=(HR@5:0.5504,NDCG@5:0.3886) [41.4 s] 
INFO:root:all_losses: [0.0950591 0.3283857]
INFO:root:Epoch 62    loss=0.0951 [155.0 s]	 dev=(HR@5:0.6055,NDCG@5:0.4283) test=(HR@5:0.5578,NDCG@5:0.3971) [41.8 s] 
INFO:root:all_losses: [0.0955819  0.32507983]
INFO:root:Epoch 63    loss=0.0956 [156.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4191) test=(HR@5:0.5461,NDCG@5:0.3907) [42.0 s] 
INFO:root:all_losses: [0.09404726 0.32237563]
INFO:root:Epoch 64    loss=0.0940 [159.7 s]	 dev=(HR@5:0.5917,NDCG@5:0.4247) test=(HR@5:0.5663,NDCG@5:0.4033) [41.5 s] 
INFO:root:all_losses: [0.09392466 0.3210217 ]
INFO:root:Epoch 65    loss=0.0939 [157.6 s]	 dev=(HR@5:0.5949,NDCG@5:0.4303) test=(HR@5:0.5525,NDCG@5:0.3964) [41.4 s] 
INFO:root:all_losses: [0.09267192 0.31914198]
INFO:root:Epoch 66    loss=0.0927 [159.1 s]	 dev=(HR@5:0.5896,NDCG@5:0.4279) test=(HR@5:0.5642,NDCG@5:0.3984) [42.1 s] 
INFO:root:all_losses: [0.09063811 0.31235513]
INFO:root:Epoch 67    loss=0.0906 [159.9 s]	 dev=(HR@5:0.6066,NDCG@5:0.4368) test=(HR@5:0.5493,NDCG@5:0.3891) [41.7 s] 
INFO:root:all_losses: [0.09213101 0.30914134]
INFO:root:Epoch 68    loss=0.0921 [159.3 s]	 dev=(HR@5:0.5790,NDCG@5:0.4257) test=(HR@5:0.5514,NDCG@5:0.3992) [42.2 s] 
INFO:root:all_losses: [0.09108587 0.30851963]
INFO:root:Epoch 69    loss=0.0911 [158.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4204) test=(HR@5:0.5323,NDCG@5:0.3802) [41.8 s] 
INFO:root:all_losses: [0.09155233 0.302836  ]
INFO:root:Epoch 70    loss=0.0916 [159.1 s]	 dev=(HR@5:0.5907,NDCG@5:0.4278) test=(HR@5:0.5472,NDCG@5:0.3928) [41.9 s] 
INFO:root:all_losses: [0.09145335 0.30146924]
INFO:root:Epoch 71    loss=0.0915 [159.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4238) test=(HR@5:0.5302,NDCG@5:0.3758) [42.0 s] 
INFO:root:all_losses: [0.090741   0.29996365]
INFO:root:Epoch 72    loss=0.0907 [159.0 s]	 dev=(HR@5:0.5843,NDCG@5:0.4303) test=(HR@5:0.5323,NDCG@5:0.3843) [41.7 s] 
INFO:root:all_losses: [0.09055381 0.29614437]
INFO:root:Epoch 73    loss=0.0906 [160.0 s]	 dev=(HR@5:0.5960,NDCG@5:0.4249) test=(HR@5:0.5578,NDCG@5:0.3939) [42.0 s] 
INFO:root:Early stop at 73 based on dev result.
INFO:root:
Best Iter(dev)=   53	 dev=(HR@5:0.6098,NDCG@5:0.4428) test=(HR@5:0.5620,NDCG@5:0.3923) [14158.0 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7253,HR@5:0.5620,HR@50:0.9692,NDCG@10:0.4447,NDCG@5:0.3923,NDCG@50:0.5009)
INFO:root:
--------------------------------------------- END: 2025-01-04 02:35:30 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-04 13:58:19 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46000266 0.6930998 ]
INFO:root:Epoch 1     loss=0.4600 [122.1 s]	 dev=(HR@5:0.2216,NDCG@5:0.1432) test=(HR@5:0.2163,NDCG@5:0.1482) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.40854537 0.6929615 ]
INFO:root:Epoch 2     loss=0.4085 [168.6 s]	 dev=(HR@5:0.2587,NDCG@5:0.1664) test=(HR@5:0.2238,NDCG@5:0.1494) [41.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.33072823 0.6924647 ]
INFO:root:Epoch 3     loss=0.3307 [145.7 s]	 dev=(HR@5:0.4104,NDCG@5:0.2785) test=(HR@5:0.3563,NDCG@5:0.2396) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2772274  0.68996716]
INFO:root:Epoch 4     loss=0.2772 [134.0 s]	 dev=(HR@5:0.4486,NDCG@5:0.3154) test=(HR@5:0.4168,NDCG@5:0.2845) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23886849 0.6852182 ]
INFO:root:Epoch 5     loss=0.2389 [152.0 s]	 dev=(HR@5:0.4146,NDCG@5:0.2982) test=(HR@5:0.3860,NDCG@5:0.2609) [42.3 s] 
INFO:root:all_losses: [0.22016956 0.67905456]
INFO:root:Epoch 6     loss=0.2202 [152.8 s]	 dev=(HR@5:0.4804,NDCG@5:0.3340) test=(HR@5:0.4496,NDCG@5:0.3016) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21332635 0.6732998 ]
INFO:root:Epoch 7     loss=0.2133 [152.4 s]	 dev=(HR@5:0.4825,NDCG@5:0.3290) test=(HR@5:0.4348,NDCG@5:0.2858) [42.9 s] 
INFO:root:all_losses: [0.20875403 0.6679455 ]
INFO:root:Epoch 8     loss=0.2088 [151.3 s]	 dev=(HR@5:0.4963,NDCG@5:0.3499) test=(HR@5:0.4655,NDCG@5:0.3130) [42.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20483847 0.66516113]
INFO:root:Epoch 9     loss=0.2048 [151.4 s]	 dev=(HR@5:0.5101,NDCG@5:0.3571) test=(HR@5:0.4634,NDCG@5:0.3162) [42.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20280905 0.6601081 ]
INFO:root:Epoch 10    loss=0.2028 [151.4 s]	 dev=(HR@5:0.5239,NDCG@5:0.3613) test=(HR@5:0.4772,NDCG@5:0.3263) [42.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19711299 0.6551299 ]
INFO:root:Epoch 11    loss=0.1971 [151.9 s]	 dev=(HR@5:0.5133,NDCG@5:0.3536) test=(HR@5:0.4496,NDCG@5:0.3078) [42.7 s] 
INFO:root:all_losses: [0.18932834 0.6521811 ]
INFO:root:Epoch 12    loss=0.1893 [152.1 s]	 dev=(HR@5:0.5217,NDCG@5:0.3583) test=(HR@5:0.4793,NDCG@5:0.3205) [43.1 s] 
INFO:root:all_losses: [0.19012868 0.64780384]
INFO:root:Epoch 13    loss=0.1901 [152.9 s]	 dev=(HR@5:0.5366,NDCG@5:0.3737) test=(HR@5:0.4867,NDCG@5:0.3319) [43.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18521914 0.64363116]
INFO:root:Epoch 14    loss=0.1852 [160.4 s]	 dev=(HR@5:0.5419,NDCG@5:0.3739) test=(HR@5:0.4783,NDCG@5:0.3307) [43.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18533993 0.6390959 ]
INFO:root:Epoch 15    loss=0.1853 [163.3 s]	 dev=(HR@5:0.5578,NDCG@5:0.3841) test=(HR@5:0.4889,NDCG@5:0.3390) [43.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17941125 0.63412863]
INFO:root:Epoch 16    loss=0.1794 [161.6 s]	 dev=(HR@5:0.5504,NDCG@5:0.3831) test=(HR@5:0.4899,NDCG@5:0.3335) [43.2 s] 
INFO:root:all_losses: [0.17696758 0.6288798 ]
INFO:root:Epoch 17    loss=0.1770 [153.3 s]	 dev=(HR@5:0.5281,NDCG@5:0.3763) test=(HR@5:0.5048,NDCG@5:0.3482) [41.7 s] 
INFO:root:all_losses: [0.17413852 0.6252177 ]
INFO:root:Epoch 18    loss=0.1741 [152.2 s]	 dev=(HR@5:0.5429,NDCG@5:0.3816) test=(HR@5:0.4963,NDCG@5:0.3469) [42.5 s] 
INFO:root:all_losses: [0.17167716 0.62057227]
INFO:root:Epoch 19    loss=0.1717 [151.9 s]	 dev=(HR@5:0.5663,NDCG@5:0.3969) test=(HR@5:0.5143,NDCG@5:0.3600) [42.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16992584 0.6137371 ]
INFO:root:Epoch 20    loss=0.1699 [151.8 s]	 dev=(HR@5:0.5567,NDCG@5:0.3988) test=(HR@5:0.5027,NDCG@5:0.3565) [42.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1684673  0.60826045]
INFO:root:Epoch 21    loss=0.1685 [151.8 s]	 dev=(HR@5:0.5334,NDCG@5:0.3791) test=(HR@5:0.4920,NDCG@5:0.3459) [42.6 s] 
INFO:root:all_losses: [0.161756   0.60293305]
INFO:root:Epoch 22    loss=0.1618 [151.6 s]	 dev=(HR@5:0.5705,NDCG@5:0.4049) test=(HR@5:0.5207,NDCG@5:0.3663) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16456968 0.5975356 ]
INFO:root:Epoch 23    loss=0.1646 [150.9 s]	 dev=(HR@5:0.5557,NDCG@5:0.4016) test=(HR@5:0.5260,NDCG@5:0.3628) [42.4 s] 
INFO:root:all_losses: [0.15882507 0.59260154]
INFO:root:Epoch 24    loss=0.1588 [130.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.3999) test=(HR@5:0.5154,NDCG@5:0.3602) [40.9 s] 
INFO:root:all_losses: [0.15894881 0.58570665]
INFO:root:Epoch 25    loss=0.1589 [136.8 s]	 dev=(HR@5:0.5663,NDCG@5:0.4096) test=(HR@5:0.5027,NDCG@5:0.3551) [40.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15486479 0.5812652 ]
INFO:root:Epoch 26    loss=0.1549 [144.1 s]	 dev=(HR@5:0.5461,NDCG@5:0.3927) test=(HR@5:0.4931,NDCG@5:0.3457) [40.2 s] 
INFO:root:all_losses: [0.15267044 0.5757226 ]
INFO:root:Epoch 27    loss=0.1527 [144.6 s]	 dev=(HR@5:0.5620,NDCG@5:0.3998) test=(HR@5:0.5175,NDCG@5:0.3682) [41.8 s] 
INFO:root:all_losses: [0.15232664 0.57135177]
INFO:root:Epoch 28    loss=0.1523 [133.8 s]	 dev=(HR@5:0.5684,NDCG@5:0.4077) test=(HR@5:0.5207,NDCG@5:0.3650) [42.4 s] 
INFO:root:all_losses: [0.14873144 0.5650185 ]
INFO:root:Epoch 29    loss=0.1487 [135.5 s]	 dev=(HR@5:0.5758,NDCG@5:0.4141) test=(HR@5:0.5175,NDCG@5:0.3651) [39.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1500614 0.5588756]
INFO:root:Epoch 30    loss=0.1501 [113.3 s]	 dev=(HR@5:0.5896,NDCG@5:0.4211) test=(HR@5:0.5323,NDCG@5:0.3754) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14864922 0.5543408 ]
INFO:root:Epoch 31    loss=0.1486 [285.1 s]	 dev=(HR@5:0.5673,NDCG@5:0.4102) test=(HR@5:0.5302,NDCG@5:0.3684) [71.8 s] 
INFO:root:all_losses: [0.14430419 0.5471136 ]
INFO:root:Epoch 32    loss=0.1443 [304.4 s]	 dev=(HR@5:0.5822,NDCG@5:0.4176) test=(HR@5:0.5313,NDCG@5:0.3735) [71.3 s] 
INFO:root:all_losses: [0.14189579 0.5426809 ]
INFO:root:Epoch 33    loss=0.1419 [174.4 s]	 dev=(HR@5:0.5695,NDCG@5:0.4043) test=(HR@5:0.5260,NDCG@5:0.3726) [40.7 s] 
INFO:root:all_losses: [0.14451052 0.5349264 ]
INFO:root:Epoch 34    loss=0.1445 [139.3 s]	 dev=(HR@5:0.5631,NDCG@5:0.3980) test=(HR@5:0.5101,NDCG@5:0.3574) [41.2 s] 
INFO:root:all_losses: [0.1413327  0.53003293]
INFO:root:Epoch 35    loss=0.1413 [143.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.4071) test=(HR@5:0.5249,NDCG@5:0.3666) [41.2 s] 
INFO:root:all_losses: [0.14067565 0.5243252 ]
INFO:root:Epoch 36    loss=0.1407 [143.9 s]	 dev=(HR@5:0.5822,NDCG@5:0.4125) test=(HR@5:0.5376,NDCG@5:0.3764) [41.3 s] 
INFO:root:all_losses: [0.13721551 0.51912206]
INFO:root:Epoch 37    loss=0.1372 [142.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4063) test=(HR@5:0.5302,NDCG@5:0.3819) [41.0 s] 
INFO:root:all_losses: [0.1391637  0.51203316]
INFO:root:Epoch 38    loss=0.1392 [141.5 s]	 dev=(HR@5:0.5843,NDCG@5:0.4131) test=(HR@5:0.5281,NDCG@5:0.3740) [41.1 s] 
INFO:root:all_losses: [0.13412327 0.5079521 ]
INFO:root:Epoch 39    loss=0.1341 [144.1 s]	 dev=(HR@5:0.5726,NDCG@5:0.4014) test=(HR@5:0.5260,NDCG@5:0.3749) [41.0 s] 
INFO:root:all_losses: [0.13313565 0.5001522 ]
INFO:root:Epoch 40    loss=0.1331 [143.2 s]	 dev=(HR@5:0.5811,NDCG@5:0.4073) test=(HR@5:0.5217,NDCG@5:0.3684) [41.5 s] 
INFO:root:all_losses: [0.13494587 0.49385926]
INFO:root:Epoch 41    loss=0.1349 [140.5 s]	 dev=(HR@5:0.5737,NDCG@5:0.4082) test=(HR@5:0.5186,NDCG@5:0.3641) [41.0 s] 
INFO:root:all_losses: [0.13349988 0.49085352]
INFO:root:Epoch 42    loss=0.1335 [143.1 s]	 dev=(HR@5:0.5726,NDCG@5:0.4169) test=(HR@5:0.5281,NDCG@5:0.3784) [40.8 s] 
INFO:root:all_losses: [0.13090521 0.48243025]
INFO:root:Epoch 43    loss=0.1309 [144.6 s]	 dev=(HR@5:0.5875,NDCG@5:0.4204) test=(HR@5:0.5239,NDCG@5:0.3668) [41.0 s] 
INFO:root:all_losses: [0.13080508 0.47694513]
INFO:root:Epoch 44    loss=0.1308 [142.5 s]	 dev=(HR@5:0.5695,NDCG@5:0.4083) test=(HR@5:0.5249,NDCG@5:0.3686) [41.1 s] 
INFO:root:all_losses: [0.12844926 0.47202292]
INFO:root:Epoch 45    loss=0.1284 [144.1 s]	 dev=(HR@5:0.5525,NDCG@5:0.4007) test=(HR@5:0.5376,NDCG@5:0.3766) [41.3 s] 
INFO:root:all_losses: [0.1277319 0.466496 ]
INFO:root:Epoch 46    loss=0.1277 [142.3 s]	 dev=(HR@5:0.5631,NDCG@5:0.4123) test=(HR@5:0.5196,NDCG@5:0.3685) [41.0 s] 
INFO:root:all_losses: [0.12743527 0.461372  ]
INFO:root:Epoch 47    loss=0.1274 [142.8 s]	 dev=(HR@5:0.5769,NDCG@5:0.4128) test=(HR@5:0.5408,NDCG@5:0.3767) [41.0 s] 
INFO:root:all_losses: [0.12356718 0.45775115]
INFO:root:Epoch 48    loss=0.1236 [142.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.4126) test=(HR@5:0.5313,NDCG@5:0.3808) [40.9 s] 
INFO:root:all_losses: [0.1259269  0.45202684]
INFO:root:Epoch 49    loss=0.1259 [143.6 s]	 dev=(HR@5:0.5726,NDCG@5:0.4107) test=(HR@5:0.5313,NDCG@5:0.3830) [41.3 s] 
INFO:root:all_losses: [0.12214147 0.44863194]
INFO:root:Epoch 50    loss=0.1221 [144.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4152) test=(HR@5:0.5376,NDCG@5:0.3834) [41.1 s] 
INFO:root:Early stop at 50 based on dev result.
INFO:root:
Best Iter(dev)=   30	 dev=(HR@5:0.5896,NDCG@5:0.4211) test=(HR@5:0.5323,NDCG@5:0.3754) [9755.4 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7105,HR@5:0.5323,HR@50:0.9661,NDCG@10:0.4330,NDCG@5:0.3754,NDCG@50:0.4918)
INFO:root:
--------------------------------------------- END: 2025-01-04 16:41:35 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-04 17:58:11 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.4595798  0.69309926]
INFO:root:Epoch 1     loss=0.4596 [157.2 s]	 dev=(HR@5:0.2227,NDCG@5:0.1434) test=(HR@5:0.2153,NDCG@5:0.1480) [49.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4096544 0.6929353]
INFO:root:Epoch 2     loss=0.4097 [301.6 s]	 dev=(HR@5:0.2460,NDCG@5:0.1625) test=(HR@5:0.2280,NDCG@5:0.1503) [58.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34653455 0.6924835 ]
INFO:root:Epoch 3     loss=0.3465 [297.5 s]	 dev=(HR@5:0.3372,NDCG@5:0.2253) test=(HR@5:0.2895,NDCG@5:0.1922) [47.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2845901  0.69033355]
INFO:root:Epoch 4     loss=0.2846 [228.7 s]	 dev=(HR@5:0.4528,NDCG@5:0.3171) test=(HR@5:0.4062,NDCG@5:0.2675) [77.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23825765 0.68598044]
INFO:root:Epoch 5     loss=0.2383 [316.1 s]	 dev=(HR@5:0.4210,NDCG@5:0.2984) test=(HR@5:0.3913,NDCG@5:0.2640) [78.4 s] 
INFO:root:all_losses: [0.21920113 0.6807665 ]
INFO:root:Epoch 6     loss=0.2192 [317.2 s]	 dev=(HR@5:0.4804,NDCG@5:0.3413) test=(HR@5:0.4475,NDCG@5:0.3048) [77.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2104015 0.675461 ]
INFO:root:Epoch 7     loss=0.2104 [309.4 s]	 dev=(HR@5:0.4963,NDCG@5:0.3417) test=(HR@5:0.4422,NDCG@5:0.2969) [77.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20530857 0.6700463 ]
INFO:root:Epoch 8     loss=0.2053 [281.8 s]	 dev=(HR@5:0.5101,NDCG@5:0.3590) test=(HR@5:0.4783,NDCG@5:0.3276) [76.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19962326 0.66662574]
INFO:root:Epoch 9     loss=0.1996 [299.3 s]	 dev=(HR@5:0.5281,NDCG@5:0.3669) test=(HR@5:0.4751,NDCG@5:0.3298) [76.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19741155 0.6608853 ]
INFO:root:Epoch 10    loss=0.1974 [305.8 s]	 dev=(HR@5:0.5111,NDCG@5:0.3575) test=(HR@5:0.4814,NDCG@5:0.3297) [76.8 s] 
INFO:root:all_losses: [0.19091165 0.65529186]
INFO:root:Epoch 11    loss=0.1909 [302.4 s]	 dev=(HR@5:0.5196,NDCG@5:0.3599) test=(HR@5:0.4528,NDCG@5:0.3095) [76.5 s] 
INFO:root:all_losses: [0.18388045 0.65183294]
INFO:root:Epoch 12    loss=0.1839 [300.3 s]	 dev=(HR@5:0.5196,NDCG@5:0.3655) test=(HR@5:0.4973,NDCG@5:0.3368) [76.7 s] 
INFO:root:all_losses: [0.18457404 0.64672   ]
INFO:root:Epoch 13    loss=0.1846 [302.1 s]	 dev=(HR@5:0.5419,NDCG@5:0.3778) test=(HR@5:0.4920,NDCG@5:0.3440) [76.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17891225 0.6423489 ]
INFO:root:Epoch 14    loss=0.1789 [305.0 s]	 dev=(HR@5:0.5472,NDCG@5:0.3750) test=(HR@5:0.5090,NDCG@5:0.3552) [75.9 s] 
INFO:root:all_losses: [0.1768726  0.63715434]
INFO:root:Epoch 15    loss=0.1769 [306.7 s]	 dev=(HR@5:0.5589,NDCG@5:0.3907) test=(HR@5:0.5154,NDCG@5:0.3577) [76.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17093146 0.6310941 ]
INFO:root:Epoch 16    loss=0.1709 [305.6 s]	 dev=(HR@5:0.5493,NDCG@5:0.3920) test=(HR@5:0.5217,NDCG@5:0.3600) [76.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16773607 0.62511265]
INFO:root:Epoch 17    loss=0.1677 [305.1 s]	 dev=(HR@5:0.5705,NDCG@5:0.4008) test=(HR@5:0.5239,NDCG@5:0.3735) [75.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16436733 0.62019646]
INFO:root:Epoch 18    loss=0.1644 [306.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.4059) test=(HR@5:0.5281,NDCG@5:0.3712) [75.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16060229 0.6148494 ]
INFO:root:Epoch 19    loss=0.1606 [307.0 s]	 dev=(HR@5:0.5514,NDCG@5:0.3947) test=(HR@5:0.5292,NDCG@5:0.3824) [75.2 s] 
INFO:root:all_losses: [0.16010672 0.6077974 ]
INFO:root:Epoch 20    loss=0.1601 [295.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.4019) test=(HR@5:0.5175,NDCG@5:0.3748) [75.2 s] 
INFO:root:all_losses: [0.15761618 0.6021519 ]
INFO:root:Epoch 21    loss=0.1576 [306.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.4026) test=(HR@5:0.5143,NDCG@5:0.3713) [74.4 s] 
INFO:root:all_losses: [0.15073752 0.5964408 ]
INFO:root:Epoch 22    loss=0.1507 [309.8 s]	 dev=(HR@5:0.5705,NDCG@5:0.4107) test=(HR@5:0.5313,NDCG@5:0.3761) [73.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15361436 0.5906049 ]
INFO:root:Epoch 23    loss=0.1536 [309.6 s]	 dev=(HR@5:0.5631,NDCG@5:0.4066) test=(HR@5:0.5281,NDCG@5:0.3755) [73.4 s] 
INFO:root:all_losses: [0.1486368 0.5858314]
INFO:root:Epoch 24    loss=0.1486 [299.6 s]	 dev=(HR@5:0.5790,NDCG@5:0.4093) test=(HR@5:0.5196,NDCG@5:0.3635) [72.6 s] 
INFO:root:all_losses: [0.14872754 0.5783625 ]
INFO:root:Epoch 25    loss=0.1487 [309.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4152) test=(HR@5:0.5292,NDCG@5:0.3692) [73.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14424442 0.574131  ]
INFO:root:Epoch 26    loss=0.1442 [311.1 s]	 dev=(HR@5:0.5748,NDCG@5:0.4097) test=(HR@5:0.5281,NDCG@5:0.3748) [72.4 s] 
INFO:root:all_losses: [0.14122316 0.5688866 ]
INFO:root:Epoch 27    loss=0.1412 [318.1 s]	 dev=(HR@5:0.5769,NDCG@5:0.4135) test=(HR@5:0.5323,NDCG@5:0.3804) [73.8 s] 
INFO:root:all_losses: [0.1403707 0.5641528]
INFO:root:Epoch 28    loss=0.1404 [321.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.4065) test=(HR@5:0.5122,NDCG@5:0.3738) [75.8 s] 
INFO:root:all_losses: [0.1375108  0.55631155]
INFO:root:Epoch 29    loss=0.1375 [325.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4181) test=(HR@5:0.5260,NDCG@5:0.3771) [74.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1389102  0.55050504]
INFO:root:Epoch 30    loss=0.1389 [337.8 s]	 dev=(HR@5:0.5949,NDCG@5:0.4221) test=(HR@5:0.5313,NDCG@5:0.3820) [74.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13739999 0.5451221 ]
INFO:root:Epoch 31    loss=0.1374 [338.8 s]	 dev=(HR@5:0.5631,NDCG@5:0.4018) test=(HR@5:0.5270,NDCG@5:0.3782) [73.4 s] 
INFO:root:all_losses: [0.13374844 0.5373658 ]
INFO:root:Epoch 32    loss=0.1337 [335.3 s]	 dev=(HR@5:0.5832,NDCG@5:0.4136) test=(HR@5:0.5408,NDCG@5:0.3881) [74.4 s] 
INFO:root:all_losses: [0.13063653 0.53161085]
INFO:root:Epoch 33    loss=0.1306 [341.2 s]	 dev=(HR@5:0.5896,NDCG@5:0.4228) test=(HR@5:0.5345,NDCG@5:0.3788) [71.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13273011 0.52337086]
INFO:root:Epoch 34    loss=0.1327 [322.0 s]	 dev=(HR@5:0.5758,NDCG@5:0.4155) test=(HR@5:0.5323,NDCG@5:0.3776) [75.8 s] 
INFO:root:all_losses: [0.1295194 0.5171761]
INFO:root:Epoch 35    loss=0.1295 [331.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4227) test=(HR@5:0.5239,NDCG@5:0.3726) [73.2 s] 
INFO:root:all_losses: [0.12681587 0.50980586]
INFO:root:Epoch 36    loss=0.1268 [329.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4286) test=(HR@5:0.5429,NDCG@5:0.3814) [73.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12479468 0.50200516]
INFO:root:Epoch 37    loss=0.1248 [320.7 s]	 dev=(HR@5:0.5917,NDCG@5:0.4237) test=(HR@5:0.5366,NDCG@5:0.3817) [72.9 s] 
INFO:root:all_losses: [0.12602162 0.49451676]
INFO:root:Epoch 38    loss=0.1260 [312.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4182) test=(HR@5:0.5387,NDCG@5:0.3781) [75.8 s] 
INFO:root:all_losses: [0.1221841  0.48700365]
INFO:root:Epoch 39    loss=0.1222 [342.7 s]	 dev=(HR@5:0.5663,NDCG@5:0.4069) test=(HR@5:0.5376,NDCG@5:0.3806) [93.1 s] 
INFO:root:all_losses: [0.118413   0.47723785]
INFO:root:Epoch 40    loss=0.1184 [410.7 s]	 dev=(HR@5:0.5801,NDCG@5:0.4194) test=(HR@5:0.5376,NDCG@5:0.3786) [91.6 s] 
INFO:root:all_losses: [0.12183919 0.46899885]
INFO:root:Epoch 41    loss=0.1218 [410.0 s]	 dev=(HR@5:0.5716,NDCG@5:0.4148) test=(HR@5:0.5186,NDCG@5:0.3753) [90.7 s] 
INFO:root:all_losses: [0.11893352 0.46419576]
INFO:root:Epoch 42    loss=0.1189 [408.8 s]	 dev=(HR@5:0.5748,NDCG@5:0.4257) test=(HR@5:0.5366,NDCG@5:0.3835) [91.7 s] 
INFO:root:all_losses: [0.11616674 0.45542192]
INFO:root:Epoch 43    loss=0.1162 [407.3 s]	 dev=(HR@5:0.5960,NDCG@5:0.4352) test=(HR@5:0.5366,NDCG@5:0.3825) [91.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11608788 0.44537792]
INFO:root:Epoch 44    loss=0.1161 [410.8 s]	 dev=(HR@5:0.5801,NDCG@5:0.4222) test=(HR@5:0.5239,NDCG@5:0.3785) [91.2 s] 
INFO:root:all_losses: [0.11259008 0.4376269 ]
INFO:root:Epoch 45    loss=0.1126 [408.1 s]	 dev=(HR@5:0.5801,NDCG@5:0.4288) test=(HR@5:0.5302,NDCG@5:0.3820) [90.2 s] 
INFO:root:all_losses: [0.11281054 0.4320696 ]
INFO:root:Epoch 46    loss=0.1128 [410.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4229) test=(HR@5:0.5366,NDCG@5:0.3848) [91.9 s] 
INFO:root:all_losses: [0.11218406 0.42163152]
INFO:root:Epoch 47    loss=0.1122 [406.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4306) test=(HR@5:0.5334,NDCG@5:0.3810) [89.2 s] 
INFO:root:all_losses: [0.10851406 0.41554284]
INFO:root:Epoch 48    loss=0.1085 [409.4 s]	 dev=(HR@5:0.5949,NDCG@5:0.4303) test=(HR@5:0.5345,NDCG@5:0.3732) [89.7 s] 
INFO:root:all_losses: [0.11100537 0.40840146]
INFO:root:Epoch 49    loss=0.1110 [410.0 s]	 dev=(HR@5:0.5992,NDCG@5:0.4325) test=(HR@5:0.5429,NDCG@5:0.3867) [88.3 s] 
INFO:root:all_losses: [0.10666766 0.40254888]
INFO:root:Epoch 50    loss=0.1067 [408.8 s]	 dev=(HR@5:0.5970,NDCG@5:0.4411) test=(HR@5:0.5514,NDCG@5:0.3917) [87.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10870932 0.3951504 ]
INFO:root:Epoch 51    loss=0.1087 [409.6 s]	 dev=(HR@5:0.5769,NDCG@5:0.4240) test=(HR@5:0.5525,NDCG@5:0.3973) [88.4 s] 
INFO:root:all_losses: [0.10698542 0.38766047]
INFO:root:Epoch 52    loss=0.1070 [407.9 s]	 dev=(HR@5:0.6098,NDCG@5:0.4348) test=(HR@5:0.5376,NDCG@5:0.3881) [86.7 s] 
INFO:root:all_losses: [0.10513183 0.38174033]
INFO:root:Epoch 53    loss=0.1051 [409.7 s]	 dev=(HR@5:0.6172,NDCG@5:0.4478) test=(HR@5:0.5514,NDCG@5:0.3970) [88.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10198002 0.37285724]
INFO:root:Epoch 54    loss=0.1020 [423.6 s]	 dev=(HR@5:0.5885,NDCG@5:0.4356) test=(HR@5:0.5525,NDCG@5:0.3884) [87.8 s] 
INFO:root:all_losses: [0.10273412 0.36770833]
INFO:root:Epoch 55    loss=0.1027 [434.2 s]	 dev=(HR@5:0.6013,NDCG@5:0.4347) test=(HR@5:0.5557,NDCG@5:0.4010) [87.8 s] 
INFO:root:all_losses: [0.1037612  0.36245254]
INFO:root:Epoch 56    loss=0.1038 [447.3 s]	 dev=(HR@5:0.6034,NDCG@5:0.4408) test=(HR@5:0.5578,NDCG@5:0.3961) [88.4 s] 
INFO:root:all_losses: [0.10030118 0.35763663]
INFO:root:Epoch 57    loss=0.1003 [446.0 s]	 dev=(HR@5:0.6034,NDCG@5:0.4348) test=(HR@5:0.5451,NDCG@5:0.3868) [89.3 s] 
INFO:root:all_losses: [0.09800023 0.3514843 ]
INFO:root:Epoch 58    loss=0.0980 [450.4 s]	 dev=(HR@5:0.5970,NDCG@5:0.4306) test=(HR@5:0.5302,NDCG@5:0.3764) [90.7 s] 
INFO:root:all_losses: [0.09807028 0.3467745 ]
INFO:root:Epoch 59    loss=0.0981 [449.5 s]	 dev=(HR@5:0.5938,NDCG@5:0.4402) test=(HR@5:0.5472,NDCG@5:0.3935) [90.3 s] 
INFO:root:all_losses: [0.0981963  0.34085593]
INFO:root:Epoch 60    loss=0.0982 [452.4 s]	 dev=(HR@5:0.5907,NDCG@5:0.4292) test=(HR@5:0.5376,NDCG@5:0.3836) [92.5 s] 
INFO:root:all_losses: [0.09761037 0.33704665]
INFO:root:Epoch 61    loss=0.0976 [452.8 s]	 dev=(HR@5:0.5960,NDCG@5:0.4323) test=(HR@5:0.5504,NDCG@5:0.3941) [92.3 s] 
INFO:root:all_losses: [0.0958291  0.33150312]
INFO:root:Epoch 62    loss=0.0958 [451.7 s]	 dev=(HR@5:0.5875,NDCG@5:0.4252) test=(HR@5:0.5567,NDCG@5:0.3971) [92.3 s] 
INFO:root:all_losses: [0.0963987  0.32856128]
INFO:root:Epoch 63    loss=0.0964 [468.7 s]	 dev=(HR@5:0.5843,NDCG@5:0.4209) test=(HR@5:0.5472,NDCG@5:0.3940) [91.9 s] 
INFO:root:all_losses: [0.09467534 0.32478368]
INFO:root:Epoch 64    loss=0.0947 [471.0 s]	 dev=(HR@5:0.5981,NDCG@5:0.4299) test=(HR@5:0.5599,NDCG@5:0.3985) [92.3 s] 
INFO:root:all_losses: [0.09420229 0.32384562]
INFO:root:Epoch 65    loss=0.0942 [473.5 s]	 dev=(HR@5:0.5832,NDCG@5:0.4275) test=(HR@5:0.5525,NDCG@5:0.3940) [93.1 s] 
INFO:root:all_losses: [0.09330103 0.32083347]
INFO:root:Epoch 66    loss=0.0933 [472.3 s]	 dev=(HR@5:0.5917,NDCG@5:0.4279) test=(HR@5:0.5514,NDCG@5:0.3958) [93.0 s] 
INFO:root:all_losses: [0.09177004 0.3142787 ]
INFO:root:Epoch 67    loss=0.0918 [473.1 s]	 dev=(HR@5:0.6066,NDCG@5:0.4374) test=(HR@5:0.5536,NDCG@5:0.3966) [92.2 s] 
INFO:root:all_losses: [0.0926217  0.31234378]
INFO:root:Epoch 68    loss=0.0926 [467.5 s]	 dev=(HR@5:0.5981,NDCG@5:0.4301) test=(HR@5:0.5483,NDCG@5:0.3978) [92.8 s] 
INFO:root:all_losses: [0.09137758 0.3109113 ]
INFO:root:Epoch 69    loss=0.0914 [467.7 s]	 dev=(HR@5:0.5949,NDCG@5:0.4349) test=(HR@5:0.5514,NDCG@5:0.3923) [92.2 s] 
INFO:root:all_losses: [0.09196401 0.3049531 ]
INFO:root:Epoch 70    loss=0.0920 [468.2 s]	 dev=(HR@5:0.5885,NDCG@5:0.4294) test=(HR@5:0.5461,NDCG@5:0.3912) [92.1 s] 
INFO:root:all_losses: [0.09155405 0.30356634]
INFO:root:Epoch 71    loss=0.0916 [473.1 s]	 dev=(HR@5:0.5981,NDCG@5:0.4331) test=(HR@5:0.5514,NDCG@5:0.3906) [93.2 s] 
INFO:root:all_losses: [0.09117322 0.3024345 ]
INFO:root:Epoch 72    loss=0.0912 [475.4 s]	 dev=(HR@5:0.6066,NDCG@5:0.4361) test=(HR@5:0.5323,NDCG@5:0.3896) [91.7 s] 
INFO:root:all_losses: [0.09105264 0.29837772]
INFO:root:Epoch 73    loss=0.0911 [469.7 s]	 dev=(HR@5:0.5907,NDCG@5:0.4229) test=(HR@5:0.5461,NDCG@5:0.3956) [92.5 s] 
INFO:root:Early stop at 73 based on dev result.
INFO:root:
Best Iter(dev)=   53	 dev=(HR@5:0.6172,NDCG@5:0.4478) test=(HR@5:0.5514,NDCG@5:0.3970) [32853.3 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7211,HR@5:0.5514,HR@50:0.9661,NDCG@10:0.4524,NDCG@5:0.3970,NDCG@50:0.5089)
INFO:root:
--------------------------------------------- END: 2025-01-05 03:06:46 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-06 21:51:10 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46003973 0.69309986]
INFO:root:Epoch 1     loss=0.4600 [102.6 s]	 dev=(HR@5:0.2269,NDCG@5:0.1457) test=(HR@5:0.2163,NDCG@5:0.1487) [35.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.41062444 0.6929315 ]
INFO:root:Epoch 2     loss=0.4106 [116.4 s]	 dev=(HR@5:0.2566,NDCG@5:0.1641) test=(HR@5:0.2333,NDCG@5:0.1549) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.33291277 0.6923654 ]
INFO:root:Epoch 3     loss=0.3329 [119.7 s]	 dev=(HR@5:0.3966,NDCG@5:0.2747) test=(HR@5:0.3552,NDCG@5:0.2380) [35.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2752218 0.6899181]
INFO:root:Epoch 4     loss=0.2752 [114.1 s]	 dev=(HR@5:0.4571,NDCG@5:0.3197) test=(HR@5:0.4380,NDCG@5:0.2888) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23601203 0.6853115 ]
INFO:root:Epoch 5     loss=0.2360 [127.2 s]	 dev=(HR@5:0.4221,NDCG@5:0.2982) test=(HR@5:0.3934,NDCG@5:0.2625) [39.4 s] 
INFO:root:all_losses: [0.22000603 0.6802691 ]
INFO:root:Epoch 6     loss=0.2200 [127.3 s]	 dev=(HR@5:0.4740,NDCG@5:0.3333) test=(HR@5:0.4443,NDCG@5:0.2987) [39.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21332657 0.675373  ]
INFO:root:Epoch 7     loss=0.2133 [127.0 s]	 dev=(HR@5:0.4857,NDCG@5:0.3377) test=(HR@5:0.4433,NDCG@5:0.2909) [39.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2090051 0.6706916]
INFO:root:Epoch 8     loss=0.2090 [126.8 s]	 dev=(HR@5:0.4920,NDCG@5:0.3488) test=(HR@5:0.4698,NDCG@5:0.3138) [39.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20462775 0.6680877 ]
INFO:root:Epoch 9     loss=0.2046 [127.5 s]	 dev=(HR@5:0.5016,NDCG@5:0.3588) test=(HR@5:0.4645,NDCG@5:0.3178) [39.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20312472 0.66345686]
INFO:root:Epoch 10    loss=0.2031 [126.6 s]	 dev=(HR@5:0.5196,NDCG@5:0.3609) test=(HR@5:0.4761,NDCG@5:0.3216) [39.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19690903 0.6585878 ]
INFO:root:Epoch 11    loss=0.1969 [128.4 s]	 dev=(HR@5:0.5058,NDCG@5:0.3527) test=(HR@5:0.4517,NDCG@5:0.3077) [39.5 s] 
INFO:root:all_losses: [0.1891514 0.6557193]
INFO:root:Epoch 12    loss=0.1892 [128.2 s]	 dev=(HR@5:0.5217,NDCG@5:0.3630) test=(HR@5:0.4825,NDCG@5:0.3225) [39.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18959513 0.6511892 ]
INFO:root:Epoch 13    loss=0.1896 [127.1 s]	 dev=(HR@5:0.5270,NDCG@5:0.3704) test=(HR@5:0.4910,NDCG@5:0.3343) [39.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18471968 0.6469717 ]
INFO:root:Epoch 14    loss=0.1847 [127.1 s]	 dev=(HR@5:0.5366,NDCG@5:0.3701) test=(HR@5:0.4889,NDCG@5:0.3368) [39.7 s] 
INFO:root:all_losses: [0.18325235 0.6422854 ]
INFO:root:Epoch 15    loss=0.1833 [126.5 s]	 dev=(HR@5:0.5525,NDCG@5:0.3837) test=(HR@5:0.5080,NDCG@5:0.3512) [39.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17795712 0.6375027 ]
INFO:root:Epoch 16    loss=0.1780 [127.7 s]	 dev=(HR@5:0.5504,NDCG@5:0.3841) test=(HR@5:0.4814,NDCG@5:0.3324) [39.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1754038 0.6320704]
INFO:root:Epoch 17    loss=0.1754 [125.9 s]	 dev=(HR@5:0.5536,NDCG@5:0.3915) test=(HR@5:0.5122,NDCG@5:0.3564) [39.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17277142 0.6285839 ]
INFO:root:Epoch 18    loss=0.1728 [126.9 s]	 dev=(HR@5:0.5408,NDCG@5:0.3834) test=(HR@5:0.5207,NDCG@5:0.3558) [39.5 s] 
INFO:root:all_losses: [0.17012559 0.6237241 ]
INFO:root:Epoch 19    loss=0.1701 [126.9 s]	 dev=(HR@5:0.5493,NDCG@5:0.3874) test=(HR@5:0.5281,NDCG@5:0.3619) [39.2 s] 
INFO:root:all_losses: [0.16802351 0.61670333]
INFO:root:Epoch 20    loss=0.1680 [126.9 s]	 dev=(HR@5:0.5589,NDCG@5:0.3943) test=(HR@5:0.4942,NDCG@5:0.3506) [39.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16737331 0.6114812 ]
INFO:root:Epoch 21    loss=0.1674 [127.8 s]	 dev=(HR@5:0.5376,NDCG@5:0.3822) test=(HR@5:0.4825,NDCG@5:0.3450) [39.1 s] 
INFO:root:all_losses: [0.16069491 0.60628647]
INFO:root:Epoch 22    loss=0.1607 [126.4 s]	 dev=(HR@5:0.5578,NDCG@5:0.4031) test=(HR@5:0.5058,NDCG@5:0.3569) [46.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16344804 0.60089445]
INFO:root:Epoch 23    loss=0.1634 [135.5 s]	 dev=(HR@5:0.5525,NDCG@5:0.3996) test=(HR@5:0.5143,NDCG@5:0.3537) [39.3 s] 
INFO:root:all_losses: [0.15776183 0.59606993]
INFO:root:Epoch 24    loss=0.1578 [127.1 s]	 dev=(HR@5:0.5673,NDCG@5:0.4111) test=(HR@5:0.5175,NDCG@5:0.3561) [39.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15788102 0.5890116 ]
INFO:root:Epoch 25    loss=0.1579 [127.2 s]	 dev=(HR@5:0.5737,NDCG@5:0.4073) test=(HR@5:0.5080,NDCG@5:0.3590) [39.1 s] 
INFO:root:all_losses: [0.1542434  0.58318555]
INFO:root:Epoch 26    loss=0.1542 [127.2 s]	 dev=(HR@5:0.5557,NDCG@5:0.3942) test=(HR@5:0.5090,NDCG@5:0.3553) [39.0 s] 
INFO:root:all_losses: [0.15131862 0.57695556]
INFO:root:Epoch 27    loss=0.1513 [127.6 s]	 dev=(HR@5:0.5525,NDCG@5:0.4003) test=(HR@5:0.5270,NDCG@5:0.3731) [39.1 s] 
INFO:root:all_losses: [0.15177664 0.5709068 ]
INFO:root:Epoch 28    loss=0.1518 [127.3 s]	 dev=(HR@5:0.5769,NDCG@5:0.4025) test=(HR@5:0.5122,NDCG@5:0.3608) [38.9 s] 
INFO:root:all_losses: [0.14765339 0.5634157 ]
INFO:root:Epoch 29    loss=0.1477 [127.6 s]	 dev=(HR@5:0.5938,NDCG@5:0.4227) test=(HR@5:0.5228,NDCG@5:0.3628) [39.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14956392 0.5556894 ]
INFO:root:Epoch 30    loss=0.1496 [129.6 s]	 dev=(HR@5:0.5907,NDCG@5:0.4219) test=(HR@5:0.5398,NDCG@5:0.3791) [39.2 s] 
INFO:root:all_losses: [0.14854053 0.5481326 ]
INFO:root:Epoch 31    loss=0.1485 [129.4 s]	 dev=(HR@5:0.5716,NDCG@5:0.4124) test=(HR@5:0.5334,NDCG@5:0.3678) [38.7 s] 
INFO:root:all_losses: [0.14455062 0.53857607]
INFO:root:Epoch 32    loss=0.1446 [129.2 s]	 dev=(HR@5:0.5907,NDCG@5:0.4172) test=(HR@5:0.5461,NDCG@5:0.3774) [38.8 s] 
INFO:root:all_losses: [0.1414446 0.5304041]
INFO:root:Epoch 33    loss=0.1414 [129.7 s]	 dev=(HR@5:0.5811,NDCG@5:0.4096) test=(HR@5:0.5323,NDCG@5:0.3705) [38.9 s] 
INFO:root:all_losses: [0.14343794 0.52031887]
INFO:root:Epoch 34    loss=0.1434 [129.6 s]	 dev=(HR@5:0.5695,NDCG@5:0.4100) test=(HR@5:0.5207,NDCG@5:0.3631) [38.7 s] 
INFO:root:all_losses: [0.14063932 0.5123632 ]
INFO:root:Epoch 35    loss=0.1406 [129.8 s]	 dev=(HR@5:0.5949,NDCG@5:0.4257) test=(HR@5:0.5461,NDCG@5:0.3834) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13881318 0.5047405 ]
INFO:root:Epoch 36    loss=0.1388 [129.3 s]	 dev=(HR@5:0.5758,NDCG@5:0.4144) test=(HR@5:0.5440,NDCG@5:0.3794) [39.2 s] 
INFO:root:all_losses: [0.13669306 0.49415237]
INFO:root:Epoch 37    loss=0.1367 [129.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4187) test=(HR@5:0.5345,NDCG@5:0.3796) [38.5 s] 
INFO:root:all_losses: [0.13699207 0.48744115]
INFO:root:Epoch 38    loss=0.1370 [129.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.4103) test=(HR@5:0.5111,NDCG@5:0.3630) [38.7 s] 
INFO:root:all_losses: [0.13289529 0.48100466]
INFO:root:Epoch 39    loss=0.1329 [130.5 s]	 dev=(HR@5:0.5832,NDCG@5:0.4120) test=(HR@5:0.5270,NDCG@5:0.3769) [38.7 s] 
INFO:root:all_losses: [0.13175026 0.4724772 ]
INFO:root:Epoch 40    loss=0.1318 [130.3 s]	 dev=(HR@5:0.5822,NDCG@5:0.4197) test=(HR@5:0.5323,NDCG@5:0.3772) [38.3 s] 
INFO:root:all_losses: [0.13418004 0.46418765]
INFO:root:Epoch 41    loss=0.1342 [129.8 s]	 dev=(HR@5:0.5811,NDCG@5:0.4174) test=(HR@5:0.5143,NDCG@5:0.3612) [38.3 s] 
INFO:root:all_losses: [0.13114215 0.4590255 ]
INFO:root:Epoch 42    loss=0.1311 [129.4 s]	 dev=(HR@5:0.5663,NDCG@5:0.4244) test=(HR@5:0.5334,NDCG@5:0.3830) [38.6 s] 
INFO:root:all_losses: [0.12971303 0.45049307]
INFO:root:Epoch 43    loss=0.1297 [128.6 s]	 dev=(HR@5:0.5907,NDCG@5:0.4255) test=(HR@5:0.5292,NDCG@5:0.3697) [38.6 s] 
INFO:root:all_losses: [0.13009372 0.44552737]
INFO:root:Epoch 44    loss=0.1301 [129.4 s]	 dev=(HR@5:0.5695,NDCG@5:0.4161) test=(HR@5:0.5334,NDCG@5:0.3743) [38.6 s] 
INFO:root:all_losses: [0.12665673 0.44016886]
INFO:root:Epoch 45    loss=0.1267 [129.7 s]	 dev=(HR@5:0.5748,NDCG@5:0.4131) test=(HR@5:0.5493,NDCG@5:0.3869) [38.5 s] 
INFO:root:all_losses: [0.1257209  0.43395725]
INFO:root:Epoch 46    loss=0.1257 [129.5 s]	 dev=(HR@5:0.5885,NDCG@5:0.4256) test=(HR@5:0.5355,NDCG@5:0.3796) [38.7 s] 
INFO:root:all_losses: [0.12755725 0.4264522 ]
INFO:root:Epoch 47    loss=0.1276 [129.2 s]	 dev=(HR@5:0.5790,NDCG@5:0.4181) test=(HR@5:0.5334,NDCG@5:0.3762) [38.5 s] 
INFO:root:all_losses: [0.12177409 0.42097664]
INFO:root:Epoch 48    loss=0.1218 [128.9 s]	 dev=(HR@5:0.5779,NDCG@5:0.4142) test=(HR@5:0.5387,NDCG@5:0.3739) [38.4 s] 
INFO:root:all_losses: [0.12445571 0.41610184]
INFO:root:Epoch 49    loss=0.1245 [129.2 s]	 dev=(HR@5:0.5907,NDCG@5:0.4279) test=(HR@5:0.5461,NDCG@5:0.3822) [38.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12040942 0.4104092 ]
INFO:root:Epoch 50    loss=0.1204 [128.3 s]	 dev=(HR@5:0.5801,NDCG@5:0.4231) test=(HR@5:0.5525,NDCG@5:0.3816) [38.1 s] 
INFO:root:all_losses: [0.12177601 0.40410045]
INFO:root:Epoch 51    loss=0.1218 [127.2 s]	 dev=(HR@5:0.5854,NDCG@5:0.4144) test=(HR@5:0.5451,NDCG@5:0.3856) [38.2 s] 
INFO:root:all_losses: [0.12167498 0.3993216 ]
INFO:root:Epoch 52    loss=0.1217 [128.9 s]	 dev=(HR@5:0.5992,NDCG@5:0.4242) test=(HR@5:0.5408,NDCG@5:0.3843) [38.4 s] 
INFO:root:all_losses: [0.11873103 0.39294335]
INFO:root:Epoch 53    loss=0.1187 [129.0 s]	 dev=(HR@5:0.6045,NDCG@5:0.4282) test=(HR@5:0.5376,NDCG@5:0.3758) [38.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11670349 0.38810435]
INFO:root:Epoch 54    loss=0.1167 [128.7 s]	 dev=(HR@5:0.6002,NDCG@5:0.4354) test=(HR@5:0.5493,NDCG@5:0.3825) [38.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11802209 0.38187277]
INFO:root:Epoch 55    loss=0.1180 [128.8 s]	 dev=(HR@5:0.5875,NDCG@5:0.4260) test=(HR@5:0.5483,NDCG@5:0.3827) [38.6 s] 
INFO:root:all_losses: [0.11664575 0.3775939 ]
INFO:root:Epoch 56    loss=0.1166 [128.4 s]	 dev=(HR@5:0.5907,NDCG@5:0.4306) test=(HR@5:0.5525,NDCG@5:0.3877) [38.3 s] 
INFO:root:all_losses: [0.11501183 0.37223226]
INFO:root:Epoch 57    loss=0.1150 [128.2 s]	 dev=(HR@5:0.6045,NDCG@5:0.4308) test=(HR@5:0.5493,NDCG@5:0.3825) [38.1 s] 
INFO:root:all_losses: [0.11172549 0.36610794]
INFO:root:Epoch 58    loss=0.1117 [128.8 s]	 dev=(HR@5:0.5705,NDCG@5:0.4115) test=(HR@5:0.5323,NDCG@5:0.3763) [38.4 s] 
INFO:root:all_losses: [0.11293119 0.36125624]
INFO:root:Epoch 59    loss=0.1129 [126.1 s]	 dev=(HR@5:0.5758,NDCG@5:0.4228) test=(HR@5:0.5345,NDCG@5:0.3829) [38.1 s] 
INFO:root:all_losses: [0.11363447 0.35291716]
INFO:root:Epoch 60    loss=0.1136 [128.5 s]	 dev=(HR@5:0.5758,NDCG@5:0.4118) test=(HR@5:0.5334,NDCG@5:0.3816) [38.2 s] 
INFO:root:all_losses: [0.11293388 0.35247874]
INFO:root:Epoch 61    loss=0.1129 [127.9 s]	 dev=(HR@5:0.5938,NDCG@5:0.4282) test=(HR@5:0.5483,NDCG@5:0.3876) [38.0 s] 
INFO:root:all_losses: [0.11101585 0.34629473]
INFO:root:Epoch 62    loss=0.1110 [128.6 s]	 dev=(HR@5:0.5970,NDCG@5:0.4262) test=(HR@5:0.5461,NDCG@5:0.3875) [38.1 s] 
INFO:root:all_losses: [0.11101956 0.3426059 ]
INFO:root:Epoch 63    loss=0.1110 [128.2 s]	 dev=(HR@5:0.5790,NDCG@5:0.4166) test=(HR@5:0.5387,NDCG@5:0.3806) [38.0 s] 
INFO:root:all_losses: [0.10863344 0.3360717 ]
INFO:root:Epoch 64    loss=0.1086 [126.8 s]	 dev=(HR@5:0.6002,NDCG@5:0.4255) test=(HR@5:0.5429,NDCG@5:0.3868) [38.3 s] 
INFO:root:all_losses: [0.10878784 0.33399376]
INFO:root:Epoch 65    loss=0.1088 [128.1 s]	 dev=(HR@5:0.5843,NDCG@5:0.4254) test=(HR@5:0.5366,NDCG@5:0.3790) [38.0 s] 
INFO:root:all_losses: [0.1076182  0.33128616]
INFO:root:Epoch 66    loss=0.1076 [127.2 s]	 dev=(HR@5:0.5938,NDCG@5:0.4269) test=(HR@5:0.5408,NDCG@5:0.3834) [38.2 s] 
INFO:root:all_losses: [0.10700494 0.32447624]
INFO:root:Epoch 67    loss=0.1070 [128.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4235) test=(HR@5:0.5345,NDCG@5:0.3769) [38.0 s] 
INFO:root:all_losses: [0.10781306 0.31989625]
INFO:root:Epoch 68    loss=0.1078 [128.2 s]	 dev=(HR@5:0.5811,NDCG@5:0.4244) test=(HR@5:0.5355,NDCG@5:0.3903) [38.3 s] 
INFO:root:all_losses: [0.10588268 0.3191337 ]
INFO:root:Epoch 69    loss=0.1059 [129.2 s]	 dev=(HR@5:0.5875,NDCG@5:0.4209) test=(HR@5:0.5249,NDCG@5:0.3784) [38.2 s] 
INFO:root:all_losses: [0.10662838 0.31158832]
INFO:root:Epoch 70    loss=0.1066 [128.2 s]	 dev=(HR@5:0.5928,NDCG@5:0.4237) test=(HR@5:0.5260,NDCG@5:0.3744) [38.3 s] 
INFO:root:all_losses: [0.10648704 0.30918384]
INFO:root:Epoch 71    loss=0.1065 [128.3 s]	 dev=(HR@5:0.5960,NDCG@5:0.4335) test=(HR@5:0.5345,NDCG@5:0.3743) [38.5 s] 
INFO:root:all_losses: [0.10426011 0.3054706 ]
INFO:root:Epoch 72    loss=0.1043 [128.6 s]	 dev=(HR@5:0.5896,NDCG@5:0.4227) test=(HR@5:0.5345,NDCG@5:0.3793) [38.3 s] 
INFO:root:all_losses: [0.10491084 0.30306965]
INFO:root:Epoch 73    loss=0.1049 [129.0 s]	 dev=(HR@5:0.5917,NDCG@5:0.4220) test=(HR@5:0.5398,NDCG@5:0.3844) [37.9 s] 
INFO:root:all_losses: [0.10358633 0.3005321 ]
INFO:root:Epoch 74    loss=0.1036 [129.7 s]	 dev=(HR@5:0.5885,NDCG@5:0.4284) test=(HR@5:0.5366,NDCG@5:0.3812) [38.6 s] 
INFO:root:Early stop at 74 based on dev result.
INFO:root:
Best Iter(dev)=   54	 dev=(HR@5:0.6002,NDCG@5:0.4354) test=(HR@5:0.5493,NDCG@5:0.3825) [12305.4 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7317,HR@5:0.5493,HR@50:0.9576,NDCG@10:0.4415,NDCG@5:0.3825,NDCG@50:0.4939)
INFO:root:
--------------------------------------------- END: 2025-01-07 01:16:53 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-07 19:50:53 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 1            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45984215 0.6930997 ]
INFO:root:Epoch 1     loss=0.4598 [118.2 s]	 dev=(HR@5:0.2206,NDCG@5:0.1426) test=(HR@5:0.2153,NDCG@5:0.1484) [37.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.41430628 0.692934  ]
INFO:root:Epoch 2     loss=0.4143 [122.8 s]	 dev=(HR@5:0.2481,NDCG@5:0.1607) test=(HR@5:0.2259,NDCG@5:0.1514) [37.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34108502 0.6925076 ]
INFO:root:Epoch 3     loss=0.3411 [119.3 s]	 dev=(HR@5:0.4337,NDCG@5:0.3015) test=(HR@5:0.4051,NDCG@5:0.2761) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2512626 0.6891083]
INFO:root:Epoch 4     loss=0.2513 [131.7 s]	 dev=(HR@5:0.4920,NDCG@5:0.3402) test=(HR@5:0.4464,NDCG@5:0.2978) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22493327 0.6838892 ]
INFO:root:Epoch 5     loss=0.2249 [149.8 s]	 dev=(HR@5:0.4592,NDCG@5:0.3238) test=(HR@5:0.4051,NDCG@5:0.2733) [42.1 s] 
INFO:root:all_losses: [0.2129944 0.6782509]
INFO:root:Epoch 6     loss=0.2130 [150.3 s]	 dev=(HR@5:0.4952,NDCG@5:0.3520) test=(HR@5:0.4560,NDCG@5:0.3122) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2038771  0.67265284]
INFO:root:Epoch 7     loss=0.2039 [149.3 s]	 dev=(HR@5:0.5175,NDCG@5:0.3577) test=(HR@5:0.4730,NDCG@5:0.3188) [42.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20020847 0.66688913]
INFO:root:Epoch 8     loss=0.2002 [149.2 s]	 dev=(HR@5:0.5249,NDCG@5:0.3656) test=(HR@5:0.4825,NDCG@5:0.3323) [41.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19475108 0.66364306]
INFO:root:Epoch 9     loss=0.1948 [150.2 s]	 dev=(HR@5:0.5366,NDCG@5:0.3759) test=(HR@5:0.4920,NDCG@5:0.3435) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19322245 0.65793455]
INFO:root:Epoch 10    loss=0.1932 [150.2 s]	 dev=(HR@5:0.5281,NDCG@5:0.3711) test=(HR@5:0.4995,NDCG@5:0.3464) [41.9 s] 
INFO:root:all_losses: [0.18668938 0.6525296 ]
INFO:root:Epoch 11    loss=0.1867 [150.8 s]	 dev=(HR@5:0.5281,NDCG@5:0.3772) test=(HR@5:0.4687,NDCG@5:0.3255) [42.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17967062 0.64926153]
INFO:root:Epoch 12    loss=0.1797 [150.5 s]	 dev=(HR@5:0.5525,NDCG@5:0.3830) test=(HR@5:0.5058,NDCG@5:0.3521) [42.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18030542 0.6445817 ]
INFO:root:Epoch 13    loss=0.1803 [150.5 s]	 dev=(HR@5:0.5493,NDCG@5:0.3853) test=(HR@5:0.4899,NDCG@5:0.3488) [41.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17532958 0.6408651 ]
INFO:root:Epoch 14    loss=0.1753 [150.4 s]	 dev=(HR@5:0.5589,NDCG@5:0.3912) test=(HR@5:0.5037,NDCG@5:0.3581) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17414224 0.6361889 ]
INFO:root:Epoch 15    loss=0.1741 [150.3 s]	 dev=(HR@5:0.5631,NDCG@5:0.3951) test=(HR@5:0.5281,NDCG@5:0.3651) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16863117 0.6311792 ]
INFO:root:Epoch 16    loss=0.1686 [150.7 s]	 dev=(HR@5:0.5557,NDCG@5:0.4007) test=(HR@5:0.5069,NDCG@5:0.3529) [41.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16577427 0.6266845 ]
INFO:root:Epoch 17    loss=0.1658 [150.8 s]	 dev=(HR@5:0.5737,NDCG@5:0.3996) test=(HR@5:0.5143,NDCG@5:0.3631) [41.8 s] 
INFO:root:all_losses: [0.16431564 0.62283665]
INFO:root:Epoch 18    loss=0.1643 [150.3 s]	 dev=(HR@5:0.5461,NDCG@5:0.3967) test=(HR@5:0.5175,NDCG@5:0.3678) [41.7 s] 
INFO:root:all_losses: [0.16110839 0.6192675 ]
INFO:root:Epoch 19    loss=0.1611 [150.7 s]	 dev=(HR@5:0.5567,NDCG@5:0.3939) test=(HR@5:0.5270,NDCG@5:0.3794) [41.7 s] 
INFO:root:all_losses: [0.16046795 0.6137915 ]
INFO:root:Epoch 20    loss=0.1605 [150.8 s]	 dev=(HR@5:0.5748,NDCG@5:0.4077) test=(HR@5:0.5164,NDCG@5:0.3743) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15930256 0.6092414 ]
INFO:root:Epoch 21    loss=0.1593 [150.5 s]	 dev=(HR@5:0.5461,NDCG@5:0.3925) test=(HR@5:0.5027,NDCG@5:0.3611) [41.4 s] 
INFO:root:all_losses: [0.15191601 0.60475594]
INFO:root:Epoch 22    loss=0.1519 [150.4 s]	 dev=(HR@5:0.5673,NDCG@5:0.4098) test=(HR@5:0.5239,NDCG@5:0.3708) [41.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15541579 0.6001323 ]
INFO:root:Epoch 23    loss=0.1554 [149.9 s]	 dev=(HR@5:0.5801,NDCG@5:0.4105) test=(HR@5:0.5472,NDCG@5:0.3845) [41.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15086262 0.59658116]
INFO:root:Epoch 24    loss=0.1509 [150.0 s]	 dev=(HR@5:0.5811,NDCG@5:0.4143) test=(HR@5:0.5249,NDCG@5:0.3664) [41.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15064749 0.590747  ]
INFO:root:Epoch 25    loss=0.1506 [150.5 s]	 dev=(HR@5:0.5695,NDCG@5:0.4095) test=(HR@5:0.5260,NDCG@5:0.3726) [41.4 s] 
INFO:root:all_losses: [0.14748658 0.5873646 ]
INFO:root:Epoch 26    loss=0.1475 [151.1 s]	 dev=(HR@5:0.5525,NDCG@5:0.3919) test=(HR@5:0.5154,NDCG@5:0.3638) [41.5 s] 
INFO:root:all_losses: [0.14491428 0.5828026 ]
INFO:root:Epoch 27    loss=0.1449 [151.4 s]	 dev=(HR@5:0.5610,NDCG@5:0.4007) test=(HR@5:0.5260,NDCG@5:0.3768) [41.3 s] 
INFO:root:all_losses: [0.14391775 0.58019435]
INFO:root:Epoch 28    loss=0.1439 [151.9 s]	 dev=(HR@5:0.5790,NDCG@5:0.4111) test=(HR@5:0.5398,NDCG@5:0.3807) [41.4 s] 
INFO:root:all_losses: [0.1414715  0.57533246]
INFO:root:Epoch 29    loss=0.1415 [152.3 s]	 dev=(HR@5:0.5970,NDCG@5:0.4264) test=(HR@5:0.5228,NDCG@5:0.3751) [41.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1432033 0.5707254]
INFO:root:Epoch 30    loss=0.1432 [155.3 s]	 dev=(HR@5:0.6002,NDCG@5:0.4233) test=(HR@5:0.5493,NDCG@5:0.3881) [41.3 s] 
INFO:root:all_losses: [0.14241979 0.5666763 ]
INFO:root:Epoch 31    loss=0.1424 [155.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4074) test=(HR@5:0.5196,NDCG@5:0.3718) [41.9 s] 
INFO:root:all_losses: [0.138544  0.5603866]
INFO:root:Epoch 32    loss=0.1385 [154.6 s]	 dev=(HR@5:0.5885,NDCG@5:0.4228) test=(HR@5:0.5451,NDCG@5:0.3888) [41.7 s] 
INFO:root:all_losses: [0.13587713 0.5561055 ]
INFO:root:Epoch 33    loss=0.1359 [156.1 s]	 dev=(HR@5:0.5652,NDCG@5:0.4109) test=(HR@5:0.5228,NDCG@5:0.3692) [41.7 s] 
INFO:root:all_losses: [0.1382014 0.5504823]
INFO:root:Epoch 34    loss=0.1382 [159.6 s]	 dev=(HR@5:0.5472,NDCG@5:0.3950) test=(HR@5:0.5249,NDCG@5:0.3704) [41.4 s] 
INFO:root:all_losses: [0.13466062 0.54598814]
INFO:root:Epoch 35    loss=0.1347 [163.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4213) test=(HR@5:0.5281,NDCG@5:0.3744) [42.7 s] 
INFO:root:all_losses: [0.13376957 0.5394096 ]
INFO:root:Epoch 36    loss=0.1338 [162.2 s]	 dev=(HR@5:0.6002,NDCG@5:0.4310) test=(HR@5:0.5525,NDCG@5:0.3857) [42.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13089652 0.53448653]
INFO:root:Epoch 37    loss=0.1309 [163.0 s]	 dev=(HR@5:0.5917,NDCG@5:0.4191) test=(HR@5:0.5440,NDCG@5:0.3824) [42.3 s] 
INFO:root:all_losses: [0.13181803 0.52761143]
INFO:root:Epoch 38    loss=0.1318 [162.7 s]	 dev=(HR@5:0.5822,NDCG@5:0.4143) test=(HR@5:0.5440,NDCG@5:0.3875) [42.1 s] 
INFO:root:all_losses: [0.12834801 0.5223139 ]
INFO:root:Epoch 39    loss=0.1283 [162.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4154) test=(HR@5:0.5429,NDCG@5:0.3821) [42.3 s] 
INFO:root:all_losses: [0.1263881  0.51435655]
INFO:root:Epoch 40    loss=0.1264 [161.9 s]	 dev=(HR@5:0.5854,NDCG@5:0.4216) test=(HR@5:0.5440,NDCG@5:0.3822) [42.0 s] 
INFO:root:all_losses: [0.12904283 0.50655884]
INFO:root:Epoch 41    loss=0.1290 [163.5 s]	 dev=(HR@5:0.5832,NDCG@5:0.4199) test=(HR@5:0.5027,NDCG@5:0.3608) [42.7 s] 
INFO:root:all_losses: [0.12638    0.50329113]
INFO:root:Epoch 42    loss=0.1264 [155.1 s]	 dev=(HR@5:0.5769,NDCG@5:0.4190) test=(HR@5:0.5355,NDCG@5:0.3830) [38.7 s] 
INFO:root:all_losses: [0.12465939 0.49303308]
INFO:root:Epoch 43    loss=0.1247 [131.2 s]	 dev=(HR@5:0.5875,NDCG@5:0.4246) test=(HR@5:0.5270,NDCG@5:0.3771) [39.3 s] 
INFO:root:all_losses: [0.12400411 0.4855091 ]
INFO:root:Epoch 44    loss=0.1240 [131.1 s]	 dev=(HR@5:0.5769,NDCG@5:0.4145) test=(HR@5:0.5302,NDCG@5:0.3751) [39.0 s] 
INFO:root:all_losses: [0.12080212 0.47805077]
INFO:root:Epoch 45    loss=0.1208 [132.0 s]	 dev=(HR@5:0.5854,NDCG@5:0.4201) test=(HR@5:0.5366,NDCG@5:0.3857) [38.6 s] 
INFO:root:all_losses: [0.12080295 0.47136965]
INFO:root:Epoch 46    loss=0.1208 [132.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4177) test=(HR@5:0.5143,NDCG@5:0.3691) [38.9 s] 
INFO:root:all_losses: [0.12214605 0.46330208]
INFO:root:Epoch 47    loss=0.1221 [131.3 s]	 dev=(HR@5:0.5907,NDCG@5:0.4204) test=(HR@5:0.5440,NDCG@5:0.3856) [38.7 s] 
INFO:root:all_losses: [0.11743419 0.4588954 ]
INFO:root:Epoch 48    loss=0.1174 [131.8 s]	 dev=(HR@5:0.5938,NDCG@5:0.4229) test=(HR@5:0.5408,NDCG@5:0.3847) [39.0 s] 
INFO:root:all_losses: [0.11922347 0.45419455]
INFO:root:Epoch 49    loss=0.1192 [131.9 s]	 dev=(HR@5:0.5938,NDCG@5:0.4222) test=(HR@5:0.5419,NDCG@5:0.3837) [39.1 s] 
INFO:root:all_losses: [0.11520914 0.44880876]
INFO:root:Epoch 50    loss=0.1152 [130.8 s]	 dev=(HR@5:0.5981,NDCG@5:0.4293) test=(HR@5:0.5461,NDCG@5:0.3807) [38.9 s] 
INFO:root:all_losses: [0.11767869 0.44227734]
INFO:root:Epoch 51    loss=0.1177 [131.8 s]	 dev=(HR@5:0.6108,NDCG@5:0.4324) test=(HR@5:0.5620,NDCG@5:0.3957) [38.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11557657 0.437777  ]
INFO:root:Epoch 52    loss=0.1156 [131.9 s]	 dev=(HR@5:0.5854,NDCG@5:0.4171) test=(HR@5:0.5387,NDCG@5:0.3798) [38.8 s] 
INFO:root:all_losses: [0.113501  0.4332655]
INFO:root:Epoch 53    loss=0.1135 [131.3 s]	 dev=(HR@5:0.6066,NDCG@5:0.4352) test=(HR@5:0.5440,NDCG@5:0.3894) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11086797 0.4282774 ]
INFO:root:Epoch 54    loss=0.1109 [131.1 s]	 dev=(HR@5:0.5917,NDCG@5:0.4299) test=(HR@5:0.5334,NDCG@5:0.3775) [38.6 s] 
INFO:root:all_losses: [0.1130676  0.42400354]
INFO:root:Epoch 55    loss=0.1131 [130.7 s]	 dev=(HR@5:0.5832,NDCG@5:0.4219) test=(HR@5:0.5483,NDCG@5:0.3877) [38.7 s] 
INFO:root:all_losses: [0.11284646 0.4216469 ]
INFO:root:Epoch 56    loss=0.1128 [131.0 s]	 dev=(HR@5:0.5832,NDCG@5:0.4260) test=(HR@5:0.5451,NDCG@5:0.3888) [39.0 s] 
INFO:root:all_losses: [0.11096118 0.41819856]
INFO:root:Epoch 57    loss=0.1110 [131.0 s]	 dev=(HR@5:0.5992,NDCG@5:0.4390) test=(HR@5:0.5536,NDCG@5:0.3885) [38.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10630281 0.4140493 ]
INFO:root:Epoch 58    loss=0.1063 [131.4 s]	 dev=(HR@5:0.5854,NDCG@5:0.4254) test=(HR@5:0.5302,NDCG@5:0.3730) [38.9 s] 
INFO:root:all_losses: [0.10859203 0.41084763]
INFO:root:Epoch 59    loss=0.1086 [130.7 s]	 dev=(HR@5:0.5970,NDCG@5:0.4299) test=(HR@5:0.5599,NDCG@5:0.4000) [38.7 s] 
INFO:root:all_losses: [0.10949549 0.40462124]
INFO:root:Epoch 60    loss=0.1095 [131.6 s]	 dev=(HR@5:0.6013,NDCG@5:0.4268) test=(HR@5:0.5610,NDCG@5:0.3946) [38.4 s] 
INFO:root:all_losses: [0.10763564 0.40135342]
INFO:root:Epoch 61    loss=0.1076 [131.1 s]	 dev=(HR@5:0.5769,NDCG@5:0.4134) test=(HR@5:0.5461,NDCG@5:0.3869) [39.0 s] 
INFO:root:all_losses: [0.10657906 0.39889336]
INFO:root:Epoch 62    loss=0.1066 [131.0 s]	 dev=(HR@5:0.5896,NDCG@5:0.4198) test=(HR@5:0.5578,NDCG@5:0.3951) [38.8 s] 
INFO:root:all_losses: [0.10637227 0.39501154]
INFO:root:Epoch 63    loss=0.1064 [131.0 s]	 dev=(HR@5:0.5907,NDCG@5:0.4180) test=(HR@5:0.5398,NDCG@5:0.3765) [38.8 s] 
INFO:root:all_losses: [0.10449406 0.390947  ]
INFO:root:Epoch 64    loss=0.1045 [130.8 s]	 dev=(HR@5:0.5875,NDCG@5:0.4262) test=(HR@5:0.5483,NDCG@5:0.3903) [38.7 s] 
INFO:root:all_losses: [0.10382622 0.38857967]
INFO:root:Epoch 65    loss=0.1038 [131.0 s]	 dev=(HR@5:0.5811,NDCG@5:0.4239) test=(HR@5:0.5292,NDCG@5:0.3785) [38.6 s] 
INFO:root:all_losses: [0.1037074  0.38596913]
INFO:root:Epoch 66    loss=0.1037 [131.3 s]	 dev=(HR@5:0.5843,NDCG@5:0.4267) test=(HR@5:0.5398,NDCG@5:0.3815) [38.6 s] 
INFO:root:all_losses: [0.10289313 0.38115242]
INFO:root:Epoch 67    loss=0.1029 [131.3 s]	 dev=(HR@5:0.5769,NDCG@5:0.4182) test=(HR@5:0.5260,NDCG@5:0.3733) [38.6 s] 
INFO:root:all_losses: [0.10354275 0.37698004]
INFO:root:Epoch 68    loss=0.1035 [131.4 s]	 dev=(HR@5:0.5832,NDCG@5:0.4214) test=(HR@5:0.5345,NDCG@5:0.3797) [38.6 s] 
INFO:root:all_losses: [0.10041127 0.37544534]
INFO:root:Epoch 69    loss=0.1004 [132.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.4162) test=(HR@5:0.5345,NDCG@5:0.3820) [38.6 s] 
INFO:root:all_losses: [0.10134055 0.36976203]
INFO:root:Epoch 70    loss=0.1013 [131.7 s]	 dev=(HR@5:0.5896,NDCG@5:0.4199) test=(HR@5:0.5493,NDCG@5:0.3810) [38.5 s] 
INFO:root:all_losses: [0.1027424 0.3670598]
INFO:root:Epoch 71    loss=0.1027 [131.5 s]	 dev=(HR@5:0.5917,NDCG@5:0.4255) test=(HR@5:0.5292,NDCG@5:0.3761) [38.3 s] 
INFO:root:all_losses: [0.10062028 0.36279467]
INFO:root:Epoch 72    loss=0.1006 [131.2 s]	 dev=(HR@5:0.5960,NDCG@5:0.4306) test=(HR@5:0.5440,NDCG@5:0.3861) [38.7 s] 
INFO:root:all_losses: [0.1022758 0.360455 ]
INFO:root:Epoch 73    loss=0.1023 [131.0 s]	 dev=(HR@5:0.5875,NDCG@5:0.4232) test=(HR@5:0.5461,NDCG@5:0.3916) [38.9 s] 
INFO:root:all_losses: [0.09900226 0.35839486]
INFO:root:Epoch 74    loss=0.0990 [130.8 s]	 dev=(HR@5:0.5779,NDCG@5:0.4223) test=(HR@5:0.5461,NDCG@5:0.3875) [38.7 s] 
INFO:root:all_losses: [0.0968741 0.3545455]
INFO:root:Epoch 75    loss=0.0969 [130.9 s]	 dev=(HR@5:0.5928,NDCG@5:0.4288) test=(HR@5:0.5387,NDCG@5:0.3908) [38.8 s] 
INFO:root:all_losses: [0.0989116 0.3494876]
INFO:root:Epoch 76    loss=0.0989 [131.7 s]	 dev=(HR@5:0.5896,NDCG@5:0.4225) test=(HR@5:0.5239,NDCG@5:0.3780) [38.7 s] 
INFO:root:all_losses: [0.09702819 0.34821787]
INFO:root:Epoch 77    loss=0.0970 [131.4 s]	 dev=(HR@5:0.5748,NDCG@5:0.4082) test=(HR@5:0.5281,NDCG@5:0.3846) [38.7 s] 
INFO:root:Early stop at 77 based on dev result.
INFO:root:
Best Iter(dev)=   57	 dev=(HR@5:0.5992,NDCG@5:0.4390) test=(HR@5:0.5536,NDCG@5:0.3885) [14022.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7190,HR@5:0.5536,HR@50:0.9618,NDCG@10:0.4415,NDCG@5:0.3886,NDCG@50:0.4963)
INFO:root:
--------------------------------------------- END: 2025-01-07 23:45:15 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-10 10:53:52 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45981896 0.69309956]
INFO:root:Epoch 1     loss=0.4598 [91.0 s]	 dev=(HR@5:0.2248,NDCG@5:0.1444) test=(HR@5:0.2153,NDCG@5:0.1487) [27.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4154231 0.6929319]
INFO:root:Epoch 2     loss=0.4154 [108.5 s]	 dev=(HR@5:0.2344,NDCG@5:0.1527) test=(HR@5:0.2185,NDCG@5:0.1455) [27.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3552106 0.6925478]
INFO:root:Epoch 3     loss=0.3552 [90.8 s]	 dev=(HR@5:0.4072,NDCG@5:0.2761) test=(HR@5:0.3542,NDCG@5:0.2408) [30.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.26605764 0.69016814]
INFO:root:Epoch 4     loss=0.2661 [97.4 s]	 dev=(HR@5:0.4751,NDCG@5:0.3303) test=(HR@5:0.4178,NDCG@5:0.2784) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23584381 0.68616515]
INFO:root:Epoch 5     loss=0.2358 [118.8 s]	 dev=(HR@5:0.4348,NDCG@5:0.3083) test=(HR@5:0.3955,NDCG@5:0.2678) [31.7 s] 
INFO:root:all_losses: [0.21910842 0.6813363 ]
INFO:root:Epoch 6     loss=0.2191 [119.1 s]	 dev=(HR@5:0.4857,NDCG@5:0.3381) test=(HR@5:0.4528,NDCG@5:0.3070) [31.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20874226 0.6765673 ]
INFO:root:Epoch 7     loss=0.2087 [120.3 s]	 dev=(HR@5:0.5048,NDCG@5:0.3496) test=(HR@5:0.4517,NDCG@5:0.3073) [32.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2018667 0.6718584]
INFO:root:Epoch 8     loss=0.2019 [119.5 s]	 dev=(HR@5:0.5281,NDCG@5:0.3669) test=(HR@5:0.4804,NDCG@5:0.3246) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1941122  0.66904384]
INFO:root:Epoch 9     loss=0.1941 [119.3 s]	 dev=(HR@5:0.5281,NDCG@5:0.3715) test=(HR@5:0.4867,NDCG@5:0.3356) [31.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1929922 0.6643397]
INFO:root:Epoch 10    loss=0.1930 [119.4 s]	 dev=(HR@5:0.5440,NDCG@5:0.3789) test=(HR@5:0.4920,NDCG@5:0.3435) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1858478  0.65978825]
INFO:root:Epoch 11    loss=0.1858 [119.2 s]	 dev=(HR@5:0.5398,NDCG@5:0.3776) test=(HR@5:0.4708,NDCG@5:0.3292) [32.0 s] 
INFO:root:all_losses: [0.17925368 0.65697414]
INFO:root:Epoch 12    loss=0.1793 [119.5 s]	 dev=(HR@5:0.5567,NDCG@5:0.3868) test=(HR@5:0.5111,NDCG@5:0.3495) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17872426 0.65232414]
INFO:root:Epoch 13    loss=0.1787 [118.9 s]	 dev=(HR@5:0.5663,NDCG@5:0.3951) test=(HR@5:0.5069,NDCG@5:0.3582) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17299357 0.648569  ]
INFO:root:Epoch 14    loss=0.1730 [119.5 s]	 dev=(HR@5:0.5705,NDCG@5:0.3935) test=(HR@5:0.5207,NDCG@5:0.3659) [31.4 s] 
INFO:root:all_losses: [0.17319494 0.64415777]
INFO:root:Epoch 15    loss=0.1732 [119.0 s]	 dev=(HR@5:0.5726,NDCG@5:0.4131) test=(HR@5:0.5323,NDCG@5:0.3714) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16685927 0.63938093]
INFO:root:Epoch 16    loss=0.1669 [119.0 s]	 dev=(HR@5:0.5790,NDCG@5:0.4096) test=(HR@5:0.5217,NDCG@5:0.3640) [31.4 s] 
INFO:root:all_losses: [0.16444418 0.63505167]
INFO:root:Epoch 17    loss=0.1644 [118.9 s]	 dev=(HR@5:0.5832,NDCG@5:0.4176) test=(HR@5:0.5186,NDCG@5:0.3718) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16135453 0.6305457 ]
INFO:root:Epoch 18    loss=0.1614 [118.8 s]	 dev=(HR@5:0.5631,NDCG@5:0.4058) test=(HR@5:0.5345,NDCG@5:0.3772) [31.3 s] 
INFO:root:all_losses: [0.15891775 0.6274035 ]
INFO:root:Epoch 19    loss=0.1589 [118.8 s]	 dev=(HR@5:0.5663,NDCG@5:0.4053) test=(HR@5:0.5366,NDCG@5:0.3832) [31.3 s] 
INFO:root:all_losses: [0.15794058 0.6223671 ]
INFO:root:Epoch 20    loss=0.1579 [118.8 s]	 dev=(HR@5:0.5726,NDCG@5:0.4105) test=(HR@5:0.5387,NDCG@5:0.3856) [31.3 s] 
INFO:root:all_losses: [0.15654744 0.6181621 ]
INFO:root:Epoch 21    loss=0.1565 [118.6 s]	 dev=(HR@5:0.5451,NDCG@5:0.4055) test=(HR@5:0.5154,NDCG@5:0.3734) [31.4 s] 
INFO:root:all_losses: [0.15039045 0.61437476]
INFO:root:Epoch 22    loss=0.1504 [118.5 s]	 dev=(HR@5:0.5864,NDCG@5:0.4210) test=(HR@5:0.5228,NDCG@5:0.3681) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15463431 0.6097975 ]
INFO:root:Epoch 23    loss=0.1546 [118.6 s]	 dev=(HR@5:0.5822,NDCG@5:0.4231) test=(HR@5:0.5334,NDCG@5:0.3782) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14826097 0.60718286]
INFO:root:Epoch 24    loss=0.1483 [118.6 s]	 dev=(HR@5:0.5832,NDCG@5:0.4223) test=(HR@5:0.5366,NDCG@5:0.3739) [31.4 s] 
INFO:root:all_losses: [0.14824879 0.60152227]
INFO:root:Epoch 25    loss=0.1482 [119.2 s]	 dev=(HR@5:0.5832,NDCG@5:0.4237) test=(HR@5:0.5239,NDCG@5:0.3681) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14404885 0.59902257]
INFO:root:Epoch 26    loss=0.1440 [119.0 s]	 dev=(HR@5:0.5854,NDCG@5:0.4179) test=(HR@5:0.5260,NDCG@5:0.3721) [31.2 s] 
INFO:root:all_losses: [0.14196338 0.5942564 ]
INFO:root:Epoch 27    loss=0.1420 [119.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4191) test=(HR@5:0.5387,NDCG@5:0.3797) [31.2 s] 
INFO:root:all_losses: [0.14127904 0.5930969 ]
INFO:root:Epoch 28    loss=0.1413 [119.1 s]	 dev=(HR@5:0.5811,NDCG@5:0.4126) test=(HR@5:0.5366,NDCG@5:0.3722) [30.9 s] 
INFO:root:all_losses: [0.13860203 0.5875593 ]
INFO:root:Epoch 29    loss=0.1386 [119.4 s]	 dev=(HR@5:0.5917,NDCG@5:0.4201) test=(HR@5:0.5186,NDCG@5:0.3681) [31.1 s] 
INFO:root:all_losses: [0.14000367 0.58398175]
INFO:root:Epoch 30    loss=0.1400 [121.7 s]	 dev=(HR@5:0.5960,NDCG@5:0.4275) test=(HR@5:0.5355,NDCG@5:0.3783) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13881566 0.58108366]
INFO:root:Epoch 31    loss=0.1388 [122.1 s]	 dev=(HR@5:0.6013,NDCG@5:0.4314) test=(HR@5:0.5207,NDCG@5:0.3627) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13504592 0.5762353 ]
INFO:root:Epoch 32    loss=0.1350 [122.0 s]	 dev=(HR@5:0.6087,NDCG@5:0.4327) test=(HR@5:0.5398,NDCG@5:0.3834) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1327865  0.57201725]
INFO:root:Epoch 33    loss=0.1328 [122.0 s]	 dev=(HR@5:0.5960,NDCG@5:0.4203) test=(HR@5:0.5429,NDCG@5:0.3751) [31.2 s] 
INFO:root:all_losses: [0.13528214 0.56799406]
INFO:root:Epoch 34    loss=0.1353 [121.3 s]	 dev=(HR@5:0.5854,NDCG@5:0.4086) test=(HR@5:0.5260,NDCG@5:0.3718) [31.0 s] 
INFO:root:all_losses: [0.13092868 0.565351  ]
INFO:root:Epoch 35    loss=0.1309 [121.4 s]	 dev=(HR@5:0.6023,NDCG@5:0.4266) test=(HR@5:0.5366,NDCG@5:0.3804) [31.3 s] 
INFO:root:all_losses: [0.12971948 0.5605095 ]
INFO:root:Epoch 36    loss=0.1297 [121.5 s]	 dev=(HR@5:0.6034,NDCG@5:0.4329) test=(HR@5:0.5493,NDCG@5:0.3849) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12745443 0.55665934]
INFO:root:Epoch 37    loss=0.1275 [121.5 s]	 dev=(HR@5:0.5960,NDCG@5:0.4203) test=(HR@5:0.5440,NDCG@5:0.3843) [31.1 s] 
INFO:root:all_losses: [0.12844901 0.5526703 ]
INFO:root:Epoch 38    loss=0.1284 [121.1 s]	 dev=(HR@5:0.6034,NDCG@5:0.4351) test=(HR@5:0.5408,NDCG@5:0.3823) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1245427  0.55033743]
INFO:root:Epoch 39    loss=0.1245 [121.2 s]	 dev=(HR@5:0.5885,NDCG@5:0.4186) test=(HR@5:0.5387,NDCG@5:0.3793) [31.1 s] 
INFO:root:all_losses: [0.12273209 0.5434795 ]
INFO:root:Epoch 40    loss=0.1227 [121.0 s]	 dev=(HR@5:0.5938,NDCG@5:0.4226) test=(HR@5:0.5366,NDCG@5:0.3759) [31.1 s] 
INFO:root:all_losses: [0.12400798 0.53937465]
INFO:root:Epoch 41    loss=0.1240 [120.9 s]	 dev=(HR@5:0.6045,NDCG@5:0.4330) test=(HR@5:0.5493,NDCG@5:0.3884) [30.9 s] 
INFO:root:all_losses: [0.12254483 0.5373107 ]
INFO:root:Epoch 42    loss=0.1225 [120.9 s]	 dev=(HR@5:0.5896,NDCG@5:0.4344) test=(HR@5:0.5589,NDCG@5:0.3927) [31.2 s] 
INFO:root:all_losses: [0.1204197 0.5311783]
INFO:root:Epoch 43    loss=0.1204 [121.0 s]	 dev=(HR@5:0.5928,NDCG@5:0.4314) test=(HR@5:0.5323,NDCG@5:0.3782) [30.8 s] 
INFO:root:all_losses: [0.11998606 0.5252202 ]
INFO:root:Epoch 44    loss=0.1200 [120.8 s]	 dev=(HR@5:0.5949,NDCG@5:0.4327) test=(HR@5:0.5323,NDCG@5:0.3879) [31.1 s] 
INFO:root:all_losses: [0.11699112 0.52172136]
INFO:root:Epoch 45    loss=0.1170 [121.0 s]	 dev=(HR@5:0.5811,NDCG@5:0.4208) test=(HR@5:0.5663,NDCG@5:0.3972) [31.1 s] 
INFO:root:all_losses: [0.11632174 0.5163697 ]
INFO:root:Epoch 46    loss=0.1163 [121.1 s]	 dev=(HR@5:0.5928,NDCG@5:0.4252) test=(HR@5:0.5483,NDCG@5:0.3931) [31.2 s] 
INFO:root:all_losses: [0.11759403 0.5101503 ]
INFO:root:Epoch 47    loss=0.1176 [121.1 s]	 dev=(HR@5:0.5716,NDCG@5:0.4117) test=(HR@5:0.5302,NDCG@5:0.3769) [31.0 s] 
INFO:root:all_losses: [0.11327837 0.50796956]
INFO:root:Epoch 48    loss=0.1133 [120.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4219) test=(HR@5:0.5504,NDCG@5:0.3888) [30.7 s] 
INFO:root:all_losses: [0.11498827 0.50227374]
INFO:root:Epoch 49    loss=0.1150 [120.9 s]	 dev=(HR@5:0.6076,NDCG@5:0.4282) test=(HR@5:0.5525,NDCG@5:0.3797) [30.7 s] 
INFO:root:all_losses: [0.11221766 0.49774453]
INFO:root:Epoch 50    loss=0.1122 [120.9 s]	 dev=(HR@5:0.5917,NDCG@5:0.4282) test=(HR@5:0.5419,NDCG@5:0.3770) [30.8 s] 
INFO:root:all_losses: [0.11332858 0.49243513]
INFO:root:Epoch 51    loss=0.1133 [121.2 s]	 dev=(HR@5:0.5843,NDCG@5:0.4251) test=(HR@5:0.5525,NDCG@5:0.3933) [30.9 s] 
INFO:root:all_losses: [0.11176316 0.486725  ]
INFO:root:Epoch 52    loss=0.1118 [120.9 s]	 dev=(HR@5:0.5960,NDCG@5:0.4278) test=(HR@5:0.5525,NDCG@5:0.3891) [31.0 s] 
INFO:root:all_losses: [0.11066534 0.4828934 ]
INFO:root:Epoch 53    loss=0.1107 [120.7 s]	 dev=(HR@5:0.6172,NDCG@5:0.4372) test=(HR@5:0.5408,NDCG@5:0.3879) [31.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10831391 0.47904202]
INFO:root:Epoch 54    loss=0.1083 [120.9 s]	 dev=(HR@5:0.5992,NDCG@5:0.4346) test=(HR@5:0.5408,NDCG@5:0.3906) [31.1 s] 
INFO:root:all_losses: [0.10681941 0.4729715 ]
INFO:root:Epoch 55    loss=0.1068 [121.0 s]	 dev=(HR@5:0.5896,NDCG@5:0.4277) test=(HR@5:0.5461,NDCG@5:0.3904) [30.5 s] 
INFO:root:all_losses: [0.10810117 0.46872306]
INFO:root:Epoch 56    loss=0.1081 [120.9 s]	 dev=(HR@5:0.5896,NDCG@5:0.4286) test=(HR@5:0.5440,NDCG@5:0.3877) [30.8 s] 
INFO:root:all_losses: [0.10534967 0.4654668 ]
INFO:root:Epoch 57    loss=0.1053 [121.1 s]	 dev=(HR@5:0.6045,NDCG@5:0.4372) test=(HR@5:0.5451,NDCG@5:0.3906) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10379934 0.46213287]
INFO:root:Epoch 58    loss=0.1038 [121.1 s]	 dev=(HR@5:0.5864,NDCG@5:0.4231) test=(HR@5:0.5228,NDCG@5:0.3718) [30.9 s] 
INFO:root:all_losses: [0.10382557 0.45795432]
INFO:root:Epoch 59    loss=0.1038 [121.1 s]	 dev=(HR@5:0.6066,NDCG@5:0.4374) test=(HR@5:0.5451,NDCG@5:0.3947) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10403682 0.45201948]
INFO:root:Epoch 60    loss=0.1040 [121.1 s]	 dev=(HR@5:0.5885,NDCG@5:0.4191) test=(HR@5:0.5387,NDCG@5:0.3873) [30.5 s] 
INFO:root:all_losses: [0.10422334 0.4491213 ]
INFO:root:Epoch 61    loss=0.1042 [121.2 s]	 dev=(HR@5:0.5960,NDCG@5:0.4289) test=(HR@5:0.5323,NDCG@5:0.3791) [30.9 s] 
INFO:root:all_losses: [0.10198879 0.44351584]
INFO:root:Epoch 62    loss=0.1020 [121.1 s]	 dev=(HR@5:0.5907,NDCG@5:0.4165) test=(HR@5:0.5398,NDCG@5:0.3905) [30.9 s] 
INFO:root:all_losses: [0.1011747 0.441575 ]
INFO:root:Epoch 63    loss=0.1012 [121.1 s]	 dev=(HR@5:0.6013,NDCG@5:0.4205) test=(HR@5:0.5419,NDCG@5:0.3922) [30.9 s] 
INFO:root:all_losses: [0.09980689 0.4371584 ]
INFO:root:Epoch 64    loss=0.0998 [121.0 s]	 dev=(HR@5:0.6161,NDCG@5:0.4358) test=(HR@5:0.5504,NDCG@5:0.3892) [31.2 s] 
INFO:root:all_losses: [0.1004735  0.43600592]
INFO:root:Epoch 65    loss=0.1005 [121.1 s]	 dev=(HR@5:0.6066,NDCG@5:0.4336) test=(HR@5:0.5557,NDCG@5:0.3931) [30.9 s] 
INFO:root:all_losses: [0.09952335 0.4312897 ]
INFO:root:Epoch 66    loss=0.0995 [121.0 s]	 dev=(HR@5:0.5917,NDCG@5:0.4289) test=(HR@5:0.5472,NDCG@5:0.3890) [30.5 s] 
INFO:root:all_losses: [0.09710947 0.42851228]
INFO:root:Epoch 67    loss=0.0971 [120.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4235) test=(HR@5:0.5345,NDCG@5:0.3825) [30.7 s] 
INFO:root:all_losses: [0.09931177 0.424893  ]
INFO:root:Epoch 68    loss=0.0993 [121.0 s]	 dev=(HR@5:0.6013,NDCG@5:0.4258) test=(HR@5:0.5514,NDCG@5:0.3958) [30.8 s] 
INFO:root:all_losses: [0.0970268  0.42373624]
INFO:root:Epoch 69    loss=0.0970 [121.2 s]	 dev=(HR@5:0.5949,NDCG@5:0.4264) test=(HR@5:0.5557,NDCG@5:0.3930) [30.8 s] 
INFO:root:all_losses: [0.09844479 0.41444054]
INFO:root:Epoch 70    loss=0.0984 [121.1 s]	 dev=(HR@5:0.5928,NDCG@5:0.4241) test=(HR@5:0.5302,NDCG@5:0.3886) [31.0 s] 
INFO:root:all_losses: [0.09744778 0.41356638]
INFO:root:Epoch 71    loss=0.0974 [121.3 s]	 dev=(HR@5:0.5949,NDCG@5:0.4228) test=(HR@5:0.5376,NDCG@5:0.3832) [30.8 s] 
INFO:root:all_losses: [0.09637589 0.4114821 ]
INFO:root:Epoch 72    loss=0.0964 [121.0 s]	 dev=(HR@5:0.5843,NDCG@5:0.4255) test=(HR@5:0.5281,NDCG@5:0.3847) [30.6 s] 
INFO:root:all_losses: [0.09712508 0.406748  ]
INFO:root:Epoch 73    loss=0.0971 [121.6 s]	 dev=(HR@5:0.5938,NDCG@5:0.4235) test=(HR@5:0.5398,NDCG@5:0.3877) [30.7 s] 
INFO:root:all_losses: [0.09487759 0.40524063]
INFO:root:Epoch 74    loss=0.0949 [121.5 s]	 dev=(HR@5:0.5832,NDCG@5:0.4211) test=(HR@5:0.5292,NDCG@5:0.3863) [31.1 s] 
INFO:root:all_losses: [0.09386387 0.3994433 ]
INFO:root:Epoch 75    loss=0.0939 [121.1 s]	 dev=(HR@5:0.6013,NDCG@5:0.4235) test=(HR@5:0.5239,NDCG@5:0.3824) [30.6 s] 
INFO:root:all_losses: [0.09313425 0.3956698 ]
INFO:root:Epoch 76    loss=0.0931 [121.4 s]	 dev=(HR@5:0.5917,NDCG@5:0.4255) test=(HR@5:0.5493,NDCG@5:0.3925) [30.7 s] 
INFO:root:all_losses: [0.0929647  0.39304042]
INFO:root:Epoch 77    loss=0.0930 [121.3 s]	 dev=(HR@5:0.5992,NDCG@5:0.4329) test=(HR@5:0.5270,NDCG@5:0.3830) [30.7 s] 
INFO:root:all_losses: [0.09247512 0.3905436 ]
INFO:root:Epoch 78    loss=0.0925 [121.3 s]	 dev=(HR@5:0.6013,NDCG@5:0.4308) test=(HR@5:0.5302,NDCG@5:0.3745) [30.9 s] 
INFO:root:all_losses: [0.09275959 0.38598803]
INFO:root:Epoch 79    loss=0.0928 [121.0 s]	 dev=(HR@5:0.5854,NDCG@5:0.4196) test=(HR@5:0.5440,NDCG@5:0.3873) [30.9 s] 
INFO:root:Early stop at 79 based on dev result.
INFO:root:
Best Iter(dev)=   59	 dev=(HR@5:0.6066,NDCG@5:0.4374) test=(HR@5:0.5451,NDCG@5:0.3947) [11870.3 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7169,HR@5:0.5451,HR@50:0.9629,NDCG@10:0.4510,NDCG@5:0.3947,NDCG@50:0.5074)
INFO:root:
--------------------------------------------- END: 2025-01-10 14:12:12 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-01-13 19:52:37 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 175153
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.0785,HR@5:0.0392,HR@50:0.4910,NDCG@10:0.0374,NDCG@5:0.0249,NDCG@50:0.1236)
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-02-27 17:17:10 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 208433
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (lstm): LSTM(64, 64, batch_first=True)
)
INFO:root:Test Before Training: (HR@10:0.1135,HR@5:0.0530,HR@50:0.4857,NDCG@10:0.0504,NDCG@5:0.0314,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.457941  0.6930971]
INFO:root:Epoch 1     loss=0.4579 [125.5 s]	 dev=(HR@5:0.2291,NDCG@5:0.1496) test=(HR@5:0.2153,NDCG@5:0.1452) [29.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.41412595 0.6929577 ]
INFO:root:Epoch 2     loss=0.4141 [166.1 s]	 dev=(HR@5:0.2641,NDCG@5:0.1758) test=(HR@5:0.2280,NDCG@5:0.1527) [32.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.37266144 0.6926338 ]
INFO:root:Epoch 3     loss=0.3727 [171.7 s]	 dev=(HR@5:0.2948,NDCG@5:0.1921) test=(HR@5:0.2471,NDCG@5:0.1636) [31.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.29850847 0.6910692 ]
INFO:root:Epoch 4     loss=0.2985 [172.7 s]	 dev=(HR@5:0.4560,NDCG@5:0.3138) test=(HR@5:0.4040,NDCG@5:0.2667) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23931958 0.6861932 ]
INFO:root:Epoch 5     loss=0.2393 [169.4 s]	 dev=(HR@5:0.4560,NDCG@5:0.3202) test=(HR@5:0.4040,NDCG@5:0.2731) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22114207 0.68024796]
INFO:root:Epoch 6     loss=0.2211 [168.8 s]	 dev=(HR@5:0.4942,NDCG@5:0.3484) test=(HR@5:0.4401,NDCG@5:0.2972) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21166055 0.67485934]
INFO:root:Epoch 7     loss=0.2117 [169.4 s]	 dev=(HR@5:0.4952,NDCG@5:0.3429) test=(HR@5:0.4571,NDCG@5:0.3104) [34.6 s] 
INFO:root:all_losses: [0.20997998 0.6696569 ]
INFO:root:Epoch 8     loss=0.2100 [169.5 s]	 dev=(HR@5:0.4899,NDCG@5:0.3419) test=(HR@5:0.4390,NDCG@5:0.2998) [34.4 s] 
INFO:root:all_losses: [0.20342696 0.66633   ]
INFO:root:Epoch 9     loss=0.2034 [169.8 s]	 dev=(HR@5:0.5270,NDCG@5:0.3690) test=(HR@5:0.4857,NDCG@5:0.3324) [34.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20017439 0.6607016 ]
INFO:root:Epoch 10    loss=0.2002 [169.1 s]	 dev=(HR@5:0.5207,NDCG@5:0.3567) test=(HR@5:0.4602,NDCG@5:0.3199) [34.6 s] 
INFO:root:all_losses: [0.19491641 0.6558728 ]
INFO:root:Epoch 11    loss=0.1949 [169.0 s]	 dev=(HR@5:0.5387,NDCG@5:0.3795) test=(HR@5:0.4677,NDCG@5:0.3309) [34.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18781501 0.6527149 ]
INFO:root:Epoch 12    loss=0.1878 [169.6 s]	 dev=(HR@5:0.5345,NDCG@5:0.3779) test=(HR@5:0.4995,NDCG@5:0.3368) [34.4 s] 
INFO:root:all_losses: [0.18818757 0.6479262 ]
INFO:root:Epoch 13    loss=0.1882 [170.0 s]	 dev=(HR@5:0.5355,NDCG@5:0.3843) test=(HR@5:0.4867,NDCG@5:0.3364) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18275715 0.64427686]
INFO:root:Epoch 14    loss=0.1828 [170.4 s]	 dev=(HR@5:0.5472,NDCG@5:0.3853) test=(HR@5:0.4973,NDCG@5:0.3509) [34.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18085971 0.63974667]
INFO:root:Epoch 15    loss=0.1809 [170.2 s]	 dev=(HR@5:0.5599,NDCG@5:0.3999) test=(HR@5:0.5101,NDCG@5:0.3552) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17463227 0.63516986]
INFO:root:Epoch 16    loss=0.1746 [170.8 s]	 dev=(HR@5:0.5599,NDCG@5:0.3970) test=(HR@5:0.4942,NDCG@5:0.3480) [34.2 s] 
INFO:root:all_losses: [0.17114168 0.6303263 ]
INFO:root:Epoch 17    loss=0.1711 [170.1 s]	 dev=(HR@5:0.5758,NDCG@5:0.4083) test=(HR@5:0.5143,NDCG@5:0.3596) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16776189 0.62621254]
INFO:root:Epoch 18    loss=0.1678 [170.3 s]	 dev=(HR@5:0.5705,NDCG@5:0.4121) test=(HR@5:0.5175,NDCG@5:0.3654) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16521809 0.6222574 ]
INFO:root:Epoch 19    loss=0.1652 [170.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.3981) test=(HR@5:0.5027,NDCG@5:0.3600) [34.5 s] 
INFO:root:all_losses: [0.16323128 0.6168645 ]
INFO:root:Epoch 20    loss=0.1632 [171.6 s]	 dev=(HR@5:0.5748,NDCG@5:0.4113) test=(HR@5:0.5186,NDCG@5:0.3785) [34.6 s] 
INFO:root:all_losses: [0.16101752 0.6128196 ]
INFO:root:Epoch 21    loss=0.1610 [173.0 s]	 dev=(HR@5:0.5589,NDCG@5:0.3998) test=(HR@5:0.5143,NDCG@5:0.3724) [34.3 s] 
INFO:root:all_losses: [0.15485217 0.60856545]
INFO:root:Epoch 22    loss=0.1549 [173.4 s]	 dev=(HR@5:0.5726,NDCG@5:0.4130) test=(HR@5:0.5440,NDCG@5:0.3827) [34.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15816541 0.60407436]
INFO:root:Epoch 23    loss=0.1582 [173.0 s]	 dev=(HR@5:0.5801,NDCG@5:0.4215) test=(HR@5:0.5345,NDCG@5:0.3793) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15290497 0.60097337]
INFO:root:Epoch 24    loss=0.1529 [172.7 s]	 dev=(HR@5:0.5896,NDCG@5:0.4277) test=(HR@5:0.5419,NDCG@5:0.3881) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15301691 0.5951611 ]
INFO:root:Epoch 25    loss=0.1530 [171.8 s]	 dev=(HR@5:0.5758,NDCG@5:0.4160) test=(HR@5:0.5355,NDCG@5:0.3776) [34.4 s] 
INFO:root:all_losses: [0.1487369  0.59230727]
INFO:root:Epoch 26    loss=0.1487 [172.6 s]	 dev=(HR@5:0.5695,NDCG@5:0.4094) test=(HR@5:0.5122,NDCG@5:0.3649) [34.3 s] 
INFO:root:all_losses: [0.14599356 0.5884691 ]
INFO:root:Epoch 27    loss=0.1460 [171.9 s]	 dev=(HR@5:0.5758,NDCG@5:0.4161) test=(HR@5:0.5504,NDCG@5:0.3903) [34.1 s] 
INFO:root:all_losses: [0.14544861 0.5863813 ]
INFO:root:Epoch 28    loss=0.1454 [171.9 s]	 dev=(HR@5:0.5695,NDCG@5:0.4145) test=(HR@5:0.5302,NDCG@5:0.3775) [34.2 s] 
INFO:root:all_losses: [0.14301597 0.58214444]
INFO:root:Epoch 29    loss=0.1430 [172.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4186) test=(HR@5:0.5302,NDCG@5:0.3746) [34.0 s] 
INFO:root:all_losses: [0.14520398 0.57773876]
INFO:root:Epoch 30    loss=0.1452 [173.1 s]	 dev=(HR@5:0.5843,NDCG@5:0.4177) test=(HR@5:0.5228,NDCG@5:0.3722) [34.0 s] 
INFO:root:all_losses: [0.14434671 0.5748642 ]
INFO:root:Epoch 31    loss=0.1443 [171.5 s]	 dev=(HR@5:0.6066,NDCG@5:0.4307) test=(HR@5:0.5557,NDCG@5:0.3974) [34.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14118229 0.569576  ]
INFO:root:Epoch 32    loss=0.1412 [171.7 s]	 dev=(HR@5:0.5758,NDCG@5:0.4200) test=(HR@5:0.5270,NDCG@5:0.3796) [34.4 s] 
INFO:root:all_losses: [0.13848706 0.56639636]
INFO:root:Epoch 33    loss=0.1385 [172.6 s]	 dev=(HR@5:0.5875,NDCG@5:0.4252) test=(HR@5:0.5536,NDCG@5:0.3956) [34.4 s] 
INFO:root:all_losses: [0.14076461 0.5620041 ]
INFO:root:Epoch 34    loss=0.1408 [172.4 s]	 dev=(HR@5:0.5811,NDCG@5:0.4200) test=(HR@5:0.5355,NDCG@5:0.3865) [33.9 s] 
INFO:root:all_losses: [0.13738716 0.5588658 ]
INFO:root:Epoch 35    loss=0.1374 [172.1 s]	 dev=(HR@5:0.5875,NDCG@5:0.4242) test=(HR@5:0.5461,NDCG@5:0.3848) [33.9 s] 
INFO:root:all_losses: [0.136368   0.55478495]
INFO:root:Epoch 36    loss=0.1364 [172.3 s]	 dev=(HR@5:0.5907,NDCG@5:0.4251) test=(HR@5:0.5451,NDCG@5:0.3865) [34.2 s] 
INFO:root:all_losses: [0.13441293 0.5510051 ]
INFO:root:Epoch 37    loss=0.1344 [172.3 s]	 dev=(HR@5:0.6013,NDCG@5:0.4249) test=(HR@5:0.5483,NDCG@5:0.3850) [34.4 s] 
INFO:root:all_losses: [0.13574256 0.54577863]
INFO:root:Epoch 38    loss=0.1357 [172.1 s]	 dev=(HR@5:0.5938,NDCG@5:0.4203) test=(HR@5:0.5514,NDCG@5:0.3890) [33.9 s] 
INFO:root:all_losses: [0.13152613 0.5429923 ]
INFO:root:Epoch 39    loss=0.1315 [177.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.4095) test=(HR@5:0.5514,NDCG@5:0.3854) [34.3 s] 
INFO:root:all_losses: [0.12982841 0.5377328 ]
INFO:root:Epoch 40    loss=0.1298 [172.9 s]	 dev=(HR@5:0.6002,NDCG@5:0.4288) test=(HR@5:0.5546,NDCG@5:0.3959) [33.8 s] 
INFO:root:all_losses: [0.13152787 0.5328956 ]
INFO:root:Epoch 41    loss=0.1315 [172.5 s]	 dev=(HR@5:0.5875,NDCG@5:0.4217) test=(HR@5:0.5493,NDCG@5:0.3899) [34.4 s] 
INFO:root:all_losses: [0.12817585 0.52949816]
INFO:root:Epoch 42    loss=0.1282 [172.2 s]	 dev=(HR@5:0.5748,NDCG@5:0.4174) test=(HR@5:0.5408,NDCG@5:0.3861) [33.8 s] 
INFO:root:all_losses: [0.12913153 0.52338237]
INFO:root:Epoch 43    loss=0.1291 [172.0 s]	 dev=(HR@5:0.5843,NDCG@5:0.4238) test=(HR@5:0.5451,NDCG@5:0.3877) [34.2 s] 
INFO:root:all_losses: [0.12821513 0.5180926 ]
INFO:root:Epoch 44    loss=0.1282 [172.5 s]	 dev=(HR@5:0.5843,NDCG@5:0.4197) test=(HR@5:0.5589,NDCG@5:0.4030) [33.8 s] 
INFO:root:all_losses: [0.12557416 0.513645  ]
INFO:root:Epoch 45    loss=0.1256 [171.6 s]	 dev=(HR@5:0.5832,NDCG@5:0.4222) test=(HR@5:0.5578,NDCG@5:0.3896) [34.3 s] 
INFO:root:all_losses: [0.12355106 0.50843817]
INFO:root:Epoch 46    loss=0.1236 [171.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4232) test=(HR@5:0.5302,NDCG@5:0.3787) [33.8 s] 
INFO:root:all_losses: [0.12480023 0.50236744]
INFO:root:Epoch 47    loss=0.1248 [172.1 s]	 dev=(HR@5:0.5695,NDCG@5:0.4093) test=(HR@5:0.5323,NDCG@5:0.3751) [33.9 s] 
INFO:root:all_losses: [0.12188565 0.49838853]
INFO:root:Epoch 48    loss=0.1219 [171.3 s]	 dev=(HR@5:0.5801,NDCG@5:0.4222) test=(HR@5:0.5472,NDCG@5:0.3841) [33.8 s] 
INFO:root:all_losses: [0.12189761 0.49409974]
INFO:root:Epoch 49    loss=0.1219 [171.9 s]	 dev=(HR@5:0.5769,NDCG@5:0.4212) test=(HR@5:0.5461,NDCG@5:0.3861) [34.0 s] 
INFO:root:all_losses: [0.11894865 0.48834983]
INFO:root:Epoch 50    loss=0.1189 [172.5 s]	 dev=(HR@5:0.5758,NDCG@5:0.4160) test=(HR@5:0.5376,NDCG@5:0.3757) [33.9 s] 
INFO:root:all_losses: [0.12102119 0.48411822]
INFO:root:Epoch 51    loss=0.1210 [171.8 s]	 dev=(HR@5:0.5737,NDCG@5:0.4203) test=(HR@5:0.5292,NDCG@5:0.3812) [34.0 s] 
INFO:root:Early stop at 51 based on dev result.
INFO:root:
Best Iter(dev)=   31	 dev=(HR@5:0.6066,NDCG@5:0.4307) test=(HR@5:0.5557,NDCG@5:0.3974) [10435.0 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7211,HR@5:0.5557,HR@50:0.9639,NDCG@10:0.4512,NDCG@5:0.3974,NDCG@50:0.5076)
INFO:root:
--------------------------------------------- END: 2025-02-27 20:11:38 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-02-27 20:59:38 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 208433
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (lstm): LSTM(64, 64, batch_first=True)
)
INFO:root:Test Before Training: (HR@10:0.1135,HR@5:0.0530,HR@50:0.4857,NDCG@10:0.0504,NDCG@5:0.0314,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46096137 0.69309765]
INFO:root:Epoch 1     loss=0.4610 [140.2 s]	 dev=(HR@5:0.2216,NDCG@5:0.1414) test=(HR@5:0.2078,NDCG@5:0.1391) [29.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.41897196 0.6929859 ]
INFO:root:Epoch 2     loss=0.4190 [180.2 s]	 dev=(HR@5:0.2481,NDCG@5:0.1619) test=(HR@5:0.2206,NDCG@5:0.1459) [32.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.37824607 0.69271827]
INFO:root:Epoch 3     loss=0.3782 [191.2 s]	 dev=(HR@5:0.2810,NDCG@5:0.1838) test=(HR@5:0.2534,NDCG@5:0.1702) [29.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3156061 0.6913791]
INFO:root:Epoch 4     loss=0.3156 [338.4 s]	 dev=(HR@5:0.4369,NDCG@5:0.3089) test=(HR@5:0.4072,NDCG@5:0.2765) [42.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.25355715 0.6871987 ]
INFO:root:Epoch 5     loss=0.2536 [191.8 s]	 dev=(HR@5:0.4645,NDCG@5:0.3215) test=(HR@5:0.4136,NDCG@5:0.2786) [34.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22866945 0.68171114]
INFO:root:Epoch 6     loss=0.2287 [183.1 s]	 dev=(HR@5:0.4772,NDCG@5:0.3304) test=(HR@5:0.4517,NDCG@5:0.2993) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21736737 0.67649186]
INFO:root:Epoch 7     loss=0.2174 [182.6 s]	 dev=(HR@5:0.4783,NDCG@5:0.3293) test=(HR@5:0.4613,NDCG@5:0.3131) [34.6 s] 
INFO:root:all_losses: [0.21307164 0.6713425 ]
INFO:root:Epoch 8     loss=0.2131 [183.0 s]	 dev=(HR@5:0.4857,NDCG@5:0.3323) test=(HR@5:0.4242,NDCG@5:0.2896) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20610483 0.6683758 ]
INFO:root:Epoch 9     loss=0.2061 [183.3 s]	 dev=(HR@5:0.5164,NDCG@5:0.3544) test=(HR@5:0.4857,NDCG@5:0.3358) [35.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20393987 0.6631676 ]
INFO:root:Epoch 10    loss=0.2039 [177.8 s]	 dev=(HR@5:0.5175,NDCG@5:0.3524) test=(HR@5:0.4783,NDCG@5:0.3225) [33.7 s] 
INFO:root:all_losses: [0.196449   0.65875226]
INFO:root:Epoch 11    loss=0.1964 [178.2 s]	 dev=(HR@5:0.5281,NDCG@5:0.3702) test=(HR@5:0.4920,NDCG@5:0.3381) [33.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18925327 0.655436  ]
INFO:root:Epoch 12    loss=0.1893 [178.3 s]	 dev=(HR@5:0.5355,NDCG@5:0.3717) test=(HR@5:0.5111,NDCG@5:0.3471) [34.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1889939  0.65047896]
INFO:root:Epoch 13    loss=0.1890 [185.2 s]	 dev=(HR@5:0.5376,NDCG@5:0.3819) test=(HR@5:0.4857,NDCG@5:0.3452) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18320876 0.6461434 ]
INFO:root:Epoch 14    loss=0.1832 [183.9 s]	 dev=(HR@5:0.5514,NDCG@5:0.3883) test=(HR@5:0.5164,NDCG@5:0.3564) [34.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18225831 0.6409028 ]
INFO:root:Epoch 15    loss=0.1823 [187.9 s]	 dev=(HR@5:0.5652,NDCG@5:0.3980) test=(HR@5:0.5228,NDCG@5:0.3682) [35.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17591198 0.6361062 ]
INFO:root:Epoch 16    loss=0.1759 [195.8 s]	 dev=(HR@5:0.5493,NDCG@5:0.3869) test=(HR@5:0.5037,NDCG@5:0.3520) [35.1 s] 
INFO:root:all_losses: [0.17297113 0.6307916 ]
INFO:root:Epoch 17    loss=0.1730 [197.2 s]	 dev=(HR@5:0.5705,NDCG@5:0.4061) test=(HR@5:0.5217,NDCG@5:0.3638) [35.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17102128 0.6269016 ]
INFO:root:Epoch 18    loss=0.1710 [197.2 s]	 dev=(HR@5:0.5610,NDCG@5:0.4073) test=(HR@5:0.5175,NDCG@5:0.3614) [35.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1690958 0.6219383]
INFO:root:Epoch 19    loss=0.1691 [198.3 s]	 dev=(HR@5:0.5451,NDCG@5:0.3919) test=(HR@5:0.4910,NDCG@5:0.3490) [35.7 s] 
INFO:root:all_losses: [0.16744857 0.61615175]
INFO:root:Epoch 20    loss=0.1674 [198.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.4109) test=(HR@5:0.5133,NDCG@5:0.3662) [36.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16557147 0.611017  ]
INFO:root:Epoch 21    loss=0.1656 [199.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.4042) test=(HR@5:0.5101,NDCG@5:0.3595) [35.1 s] 
INFO:root:all_losses: [0.15861218 0.60612106]
INFO:root:Epoch 22    loss=0.1586 [197.1 s]	 dev=(HR@5:0.5567,NDCG@5:0.4010) test=(HR@5:0.5292,NDCG@5:0.3710) [35.7 s] 
INFO:root:all_losses: [0.16200846 0.6011293 ]
INFO:root:Epoch 23    loss=0.1620 [199.0 s]	 dev=(HR@5:0.5726,NDCG@5:0.4072) test=(HR@5:0.5133,NDCG@5:0.3613) [34.9 s] 
INFO:root:all_losses: [0.1572315  0.59754145]
INFO:root:Epoch 24    loss=0.1572 [198.9 s]	 dev=(HR@5:0.5801,NDCG@5:0.4177) test=(HR@5:0.5461,NDCG@5:0.3831) [35.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15666938 0.5903308 ]
INFO:root:Epoch 25    loss=0.1567 [198.2 s]	 dev=(HR@5:0.5737,NDCG@5:0.4149) test=(HR@5:0.5260,NDCG@5:0.3717) [36.3 s] 
INFO:root:all_losses: [0.15278283 0.5864665 ]
INFO:root:Epoch 26    loss=0.1528 [199.2 s]	 dev=(HR@5:0.5832,NDCG@5:0.4150) test=(HR@5:0.5101,NDCG@5:0.3558) [35.8 s] 
INFO:root:all_losses: [0.14985937 0.581584  ]
INFO:root:Epoch 27    loss=0.1499 [198.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4163) test=(HR@5:0.5345,NDCG@5:0.3838) [35.0 s] 
INFO:root:all_losses: [0.15024428 0.5777488 ]
INFO:root:Epoch 28    loss=0.1502 [199.1 s]	 dev=(HR@5:0.5843,NDCG@5:0.4210) test=(HR@5:0.5334,NDCG@5:0.3783) [35.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1475564 0.5716796]
INFO:root:Epoch 29    loss=0.1476 [197.8 s]	 dev=(HR@5:0.5875,NDCG@5:0.4205) test=(HR@5:0.5217,NDCG@5:0.3696) [35.4 s] 
INFO:root:all_losses: [0.1490115 0.5648684]
INFO:root:Epoch 30    loss=0.1490 [197.9 s]	 dev=(HR@5:0.5652,NDCG@5:0.4036) test=(HR@5:0.5122,NDCG@5:0.3672) [36.3 s] 
INFO:root:all_losses: [0.14802109 0.5608435 ]
INFO:root:Epoch 31    loss=0.1480 [197.9 s]	 dev=(HR@5:0.5716,NDCG@5:0.4147) test=(HR@5:0.5270,NDCG@5:0.3838) [36.5 s] 
INFO:root:all_losses: [0.14512074 0.5545336 ]
INFO:root:Epoch 32    loss=0.1451 [198.6 s]	 dev=(HR@5:0.5896,NDCG@5:0.4234) test=(HR@5:0.5355,NDCG@5:0.3851) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14129236 0.546806  ]
INFO:root:Epoch 33    loss=0.1413 [197.5 s]	 dev=(HR@5:0.5854,NDCG@5:0.4181) test=(HR@5:0.5408,NDCG@5:0.3761) [36.3 s] 
INFO:root:all_losses: [0.14462167 0.53930295]
INFO:root:Epoch 34    loss=0.1446 [199.6 s]	 dev=(HR@5:0.5801,NDCG@5:0.4136) test=(HR@5:0.5196,NDCG@5:0.3675) [35.2 s] 
INFO:root:all_losses: [0.14013492 0.5334477 ]
INFO:root:Epoch 35    loss=0.1401 [198.9 s]	 dev=(HR@5:0.5928,NDCG@5:0.4236) test=(HR@5:0.5207,NDCG@5:0.3713) [35.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13918275 0.52786803]
INFO:root:Epoch 36    loss=0.1392 [197.8 s]	 dev=(HR@5:0.5875,NDCG@5:0.4265) test=(HR@5:0.5514,NDCG@5:0.3871) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13692299 0.51817334]
INFO:root:Epoch 37    loss=0.1369 [198.0 s]	 dev=(HR@5:0.5907,NDCG@5:0.4245) test=(HR@5:0.5249,NDCG@5:0.3727) [35.2 s] 
INFO:root:all_losses: [0.13803825 0.5111165 ]
INFO:root:Epoch 38    loss=0.1380 [197.9 s]	 dev=(HR@5:0.5981,NDCG@5:0.4216) test=(HR@5:0.5323,NDCG@5:0.3732) [36.3 s] 
INFO:root:all_losses: [0.13382849 0.50304836]
INFO:root:Epoch 39    loss=0.1338 [198.2 s]	 dev=(HR@5:0.5832,NDCG@5:0.4184) test=(HR@5:0.5493,NDCG@5:0.3907) [35.7 s] 
INFO:root:all_losses: [0.13193949 0.49248025]
INFO:root:Epoch 40    loss=0.1319 [198.9 s]	 dev=(HR@5:0.5970,NDCG@5:0.4331) test=(HR@5:0.5387,NDCG@5:0.3873) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13326901 0.48602128]
INFO:root:Epoch 41    loss=0.1333 [198.9 s]	 dev=(HR@5:0.5843,NDCG@5:0.4210) test=(HR@5:0.5281,NDCG@5:0.3686) [34.7 s] 
INFO:root:all_losses: [0.13103803 0.4803398 ]
INFO:root:Epoch 42    loss=0.1310 [197.7 s]	 dev=(HR@5:0.5801,NDCG@5:0.4194) test=(HR@5:0.5313,NDCG@5:0.3749) [36.4 s] 
INFO:root:all_losses: [0.1306326  0.46915635]
INFO:root:Epoch 43    loss=0.1306 [197.6 s]	 dev=(HR@5:0.5748,NDCG@5:0.4218) test=(HR@5:0.5408,NDCG@5:0.3870) [36.5 s] 
INFO:root:all_losses: [0.12984072 0.46264455]
INFO:root:Epoch 44    loss=0.1298 [199.0 s]	 dev=(HR@5:0.5854,NDCG@5:0.4254) test=(HR@5:0.5472,NDCG@5:0.3937) [35.3 s] 
INFO:root:all_losses: [0.12615612 0.4558171 ]
INFO:root:Epoch 45    loss=0.1262 [198.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.4114) test=(HR@5:0.5504,NDCG@5:0.3891) [34.8 s] 
INFO:root:all_losses: [0.12537321 0.45022196]
INFO:root:Epoch 46    loss=0.1254 [199.0 s]	 dev=(HR@5:0.5695,NDCG@5:0.4197) test=(HR@5:0.5355,NDCG@5:0.3901) [35.2 s] 
INFO:root:all_losses: [0.12685525 0.4438422 ]
INFO:root:Epoch 47    loss=0.1269 [200.2 s]	 dev=(HR@5:0.5801,NDCG@5:0.4226) test=(HR@5:0.5239,NDCG@5:0.3671) [34.7 s] 
INFO:root:all_losses: [0.12308209 0.43727392]
INFO:root:Epoch 48    loss=0.1231 [198.2 s]	 dev=(HR@5:0.6055,NDCG@5:0.4324) test=(HR@5:0.5440,NDCG@5:0.3827) [34.6 s] 
INFO:root:all_losses: [0.12411816 0.43244225]
INFO:root:Epoch 49    loss=0.1241 [198.7 s]	 dev=(HR@5:0.5811,NDCG@5:0.4230) test=(HR@5:0.5239,NDCG@5:0.3764) [35.7 s] 
INFO:root:all_losses: [0.12143205 0.42810857]
INFO:root:Epoch 50    loss=0.1214 [198.3 s]	 dev=(HR@5:0.5843,NDCG@5:0.4215) test=(HR@5:0.5228,NDCG@5:0.3740) [35.3 s] 
INFO:root:all_losses: [0.12206337 0.42272022]
INFO:root:Epoch 51    loss=0.1221 [198.9 s]	 dev=(HR@5:0.5832,NDCG@5:0.4184) test=(HR@5:0.5408,NDCG@5:0.3900) [35.4 s] 
INFO:root:all_losses: [0.12055713 0.4177399 ]
INFO:root:Epoch 52    loss=0.1206 [197.8 s]	 dev=(HR@5:0.5779,NDCG@5:0.4167) test=(HR@5:0.5175,NDCG@5:0.3679) [35.2 s] 
INFO:root:Early stop at 52 based on dev result.
INFO:root:
Best Iter(dev)=   40	 dev=(HR@5:0.5970,NDCG@5:0.4331) test=(HR@5:0.5387,NDCG@5:0.3873) [12029.1 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7253,HR@5:0.5387,HR@50:0.9629,NDCG@10:0.4485,NDCG@5:0.3873,NDCG@50:0.5033)
INFO:root:
--------------------------------------------- END: 2025-02-28 00:20:40 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-01 20:41:48 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 208433
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (lstm): LSTM(64, 64, batch_first=True)
)
INFO:root:Test Before Training: (HR@10:0.1135,HR@5:0.0530,HR@50:0.4857,NDCG@10:0.0504,NDCG@5:0.0314,NDCG@50:0.1287)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.4597715 0.693097 ]
INFO:root:Epoch 1     loss=0.4598 [135.8 s]	 dev=(HR@5:0.2259,NDCG@5:0.1469) test=(HR@5:0.2163,NDCG@5:0.1465) [28.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.42334288 0.69293547]
INFO:root:Epoch 2     loss=0.4233 [180.7 s]	 dev=(HR@5:0.2566,NDCG@5:0.1678) test=(HR@5:0.2216,NDCG@5:0.1477) [32.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.37228265 0.6926786 ]
INFO:root:Epoch 3     loss=0.3723 [185.2 s]	 dev=(HR@5:0.2842,NDCG@5:0.1872) test=(HR@5:0.2365,NDCG@5:0.1579) [28.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3120343  0.69142735]
INFO:root:Epoch 4     loss=0.3120 [230.1 s]	 dev=(HR@5:0.4104,NDCG@5:0.2825) test=(HR@5:0.3775,NDCG@5:0.2492) [34.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2593492 0.6877268]
INFO:root:Epoch 5     loss=0.2593 [176.8 s]	 dev=(HR@5:0.4263,NDCG@5:0.3003) test=(HR@5:0.3807,NDCG@5:0.2518) [34.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22767502 0.6818669 ]
INFO:root:Epoch 6     loss=0.2277 [175.3 s]	 dev=(HR@5:0.4984,NDCG@5:0.3437) test=(HR@5:0.4507,NDCG@5:0.3029) [34.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21681492 0.67611325]
INFO:root:Epoch 7     loss=0.2168 [174.9 s]	 dev=(HR@5:0.4825,NDCG@5:0.3291) test=(HR@5:0.4507,NDCG@5:0.3036) [33.8 s] 
INFO:root:all_losses: [0.2139893 0.6711119]
INFO:root:Epoch 8     loss=0.2140 [175.0 s]	 dev=(HR@5:0.4814,NDCG@5:0.3355) test=(HR@5:0.4316,NDCG@5:0.2932) [33.6 s] 
INFO:root:all_losses: [0.20830165 0.66837347]
INFO:root:Epoch 9     loss=0.2083 [174.3 s]	 dev=(HR@5:0.5133,NDCG@5:0.3540) test=(HR@5:0.4571,NDCG@5:0.3141) [34.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20571195 0.6631395 ]
INFO:root:Epoch 10    loss=0.2057 [175.0 s]	 dev=(HR@5:0.5133,NDCG@5:0.3494) test=(HR@5:0.4422,NDCG@5:0.3066) [34.2 s] 
INFO:root:all_losses: [0.19884518 0.65883434]
INFO:root:Epoch 11    loss=0.1988 [173.6 s]	 dev=(HR@5:0.5345,NDCG@5:0.3679) test=(HR@5:0.4761,NDCG@5:0.3260) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19074465 0.6557111 ]
INFO:root:Epoch 12    loss=0.1907 [174.5 s]	 dev=(HR@5:0.5334,NDCG@5:0.3714) test=(HR@5:0.5027,NDCG@5:0.3406) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19081779 0.6511997 ]
INFO:root:Epoch 13    loss=0.1908 [175.7 s]	 dev=(HR@5:0.5334,NDCG@5:0.3717) test=(HR@5:0.4825,NDCG@5:0.3321) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18482271 0.64722735]
INFO:root:Epoch 14    loss=0.1848 [174.1 s]	 dev=(HR@5:0.5419,NDCG@5:0.3743) test=(HR@5:0.4973,NDCG@5:0.3451) [34.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18329027 0.64255726]
INFO:root:Epoch 15    loss=0.1833 [173.5 s]	 dev=(HR@5:0.5557,NDCG@5:0.3888) test=(HR@5:0.5016,NDCG@5:0.3475) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17776175 0.6381518 ]
INFO:root:Epoch 16    loss=0.1778 [173.8 s]	 dev=(HR@5:0.5376,NDCG@5:0.3816) test=(HR@5:0.4931,NDCG@5:0.3463) [33.7 s] 
INFO:root:all_losses: [0.17475161 0.6332069 ]
INFO:root:Epoch 17    loss=0.1748 [175.9 s]	 dev=(HR@5:0.5536,NDCG@5:0.3928) test=(HR@5:0.5143,NDCG@5:0.3580) [33.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17336729 0.6301641 ]
INFO:root:Epoch 18    loss=0.1734 [173.7 s]	 dev=(HR@5:0.5514,NDCG@5:0.3934) test=(HR@5:0.4963,NDCG@5:0.3506) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17077845 0.62599957]
INFO:root:Epoch 19    loss=0.1708 [173.5 s]	 dev=(HR@5:0.5334,NDCG@5:0.3819) test=(HR@5:0.4931,NDCG@5:0.3465) [34.1 s] 
INFO:root:all_losses: [0.16860843 0.62063444]
INFO:root:Epoch 20    loss=0.1686 [173.1 s]	 dev=(HR@5:0.5758,NDCG@5:0.4100) test=(HR@5:0.5080,NDCG@5:0.3618) [33.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1666589  0.61619693]
INFO:root:Epoch 21    loss=0.1667 [174.1 s]	 dev=(HR@5:0.5419,NDCG@5:0.3879) test=(HR@5:0.5164,NDCG@5:0.3642) [33.4 s] 
INFO:root:all_losses: [0.16067326 0.61237764]
INFO:root:Epoch 22    loss=0.1607 [173.7 s]	 dev=(HR@5:0.5610,NDCG@5:0.3963) test=(HR@5:0.5270,NDCG@5:0.3743) [33.9 s] 
INFO:root:all_losses: [0.16319604 0.6075458 ]
INFO:root:Epoch 23    loss=0.1632 [173.3 s]	 dev=(HR@5:0.5631,NDCG@5:0.3998) test=(HR@5:0.5186,NDCG@5:0.3631) [33.4 s] 
INFO:root:all_losses: [0.15722494 0.60463613]
INFO:root:Epoch 24    loss=0.1572 [173.2 s]	 dev=(HR@5:0.5716,NDCG@5:0.4057) test=(HR@5:0.5376,NDCG@5:0.3716) [33.3 s] 
INFO:root:all_losses: [0.15763865 0.5983513 ]
INFO:root:Epoch 25    loss=0.1576 [174.6 s]	 dev=(HR@5:0.5769,NDCG@5:0.4126) test=(HR@5:0.5122,NDCG@5:0.3565) [33.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1538927 0.5952666]
INFO:root:Epoch 26    loss=0.1539 [172.6 s]	 dev=(HR@5:0.5695,NDCG@5:0.4123) test=(HR@5:0.5101,NDCG@5:0.3533) [33.7 s] 
INFO:root:all_losses: [0.15094405 0.59115213]
INFO:root:Epoch 27    loss=0.1509 [172.5 s]	 dev=(HR@5:0.5875,NDCG@5:0.4224) test=(HR@5:0.5355,NDCG@5:0.3789) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15019159 0.5884309 ]
INFO:root:Epoch 28    loss=0.1502 [174.1 s]	 dev=(HR@5:0.5737,NDCG@5:0.4074) test=(HR@5:0.5239,NDCG@5:0.3691) [33.5 s] 
INFO:root:all_losses: [0.14727092 0.58416265]
INFO:root:Epoch 29    loss=0.1473 [172.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4180) test=(HR@5:0.5387,NDCG@5:0.3726) [33.2 s] 
INFO:root:all_losses: [0.14907433 0.5793301 ]
INFO:root:Epoch 30    loss=0.1491 [172.1 s]	 dev=(HR@5:0.5429,NDCG@5:0.3884) test=(HR@5:0.4931,NDCG@5:0.3515) [33.3 s] 
INFO:root:all_losses: [0.1475594  0.57587343]
INFO:root:Epoch 31    loss=0.1476 [173.1 s]	 dev=(HR@5:0.5748,NDCG@5:0.4119) test=(HR@5:0.5217,NDCG@5:0.3742) [33.3 s] 
INFO:root:all_losses: [0.14491528 0.5715308 ]
INFO:root:Epoch 32    loss=0.1449 [173.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4114) test=(HR@5:0.5408,NDCG@5:0.3793) [33.4 s] 
INFO:root:all_losses: [0.14042705 0.5673013 ]
INFO:root:Epoch 33    loss=0.1404 [171.6 s]	 dev=(HR@5:0.5864,NDCG@5:0.4166) test=(HR@5:0.5387,NDCG@5:0.3789) [33.8 s] 
INFO:root:all_losses: [0.14486946 0.562817  ]
INFO:root:Epoch 34    loss=0.1449 [172.4 s]	 dev=(HR@5:0.5546,NDCG@5:0.4046) test=(HR@5:0.5058,NDCG@5:0.3522) [33.2 s] 
INFO:root:all_losses: [0.14032727 0.5603343 ]
INFO:root:Epoch 35    loss=0.1403 [174.3 s]	 dev=(HR@5:0.5843,NDCG@5:0.4168) test=(HR@5:0.5058,NDCG@5:0.3591) [33.2 s] 
INFO:root:all_losses: [0.13912037 0.556123  ]
INFO:root:Epoch 36    loss=0.1391 [172.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4259) test=(HR@5:0.5546,NDCG@5:0.3802) [33.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1373142 0.5516595]
INFO:root:Epoch 37    loss=0.1373 [171.8 s]	 dev=(HR@5:0.5864,NDCG@5:0.4168) test=(HR@5:0.5334,NDCG@5:0.3683) [33.5 s] 
INFO:root:all_losses: [0.13781099 0.54716814]
INFO:root:Epoch 38    loss=0.1378 [171.5 s]	 dev=(HR@5:0.5938,NDCG@5:0.4253) test=(HR@5:0.5355,NDCG@5:0.3796) [33.3 s] 
INFO:root:all_losses: [0.13397092 0.54351026]
INFO:root:Epoch 39    loss=0.1340 [173.0 s]	 dev=(HR@5:0.5726,NDCG@5:0.4113) test=(HR@5:0.5292,NDCG@5:0.3794) [33.7 s] 
INFO:root:all_losses: [0.13304307 0.53791326]
INFO:root:Epoch 40    loss=0.1330 [172.4 s]	 dev=(HR@5:0.5779,NDCG@5:0.4170) test=(HR@5:0.5376,NDCG@5:0.3778) [33.1 s] 
INFO:root:all_losses: [0.13402858 0.5313891 ]
INFO:root:Epoch 41    loss=0.1340 [171.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4225) test=(HR@5:0.5281,NDCG@5:0.3731) [33.5 s] 
INFO:root:all_losses: [0.1320915 0.5303901]
INFO:root:Epoch 42    loss=0.1321 [173.6 s]	 dev=(HR@5:0.5716,NDCG@5:0.4144) test=(HR@5:0.5249,NDCG@5:0.3693) [33.1 s] 
INFO:root:all_losses: [0.13153131 0.52224344]
INFO:root:Epoch 43    loss=0.1315 [172.1 s]	 dev=(HR@5:0.5885,NDCG@5:0.4283) test=(HR@5:0.5334,NDCG@5:0.3783) [33.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13069616 0.5193084 ]
INFO:root:Epoch 44    loss=0.1307 [171.5 s]	 dev=(HR@5:0.5737,NDCG@5:0.4097) test=(HR@5:0.5313,NDCG@5:0.3875) [33.0 s] 
INFO:root:all_losses: [0.1273191  0.51446223]
INFO:root:Epoch 45    loss=0.1273 [171.7 s]	 dev=(HR@5:0.5737,NDCG@5:0.4092) test=(HR@5:0.5514,NDCG@5:0.3905) [32.4 s] 
INFO:root:all_losses: [0.12662388 0.5096297 ]
INFO:root:Epoch 46    loss=0.1266 [172.4 s]	 dev=(HR@5:0.5832,NDCG@5:0.4184) test=(HR@5:0.5323,NDCG@5:0.3835) [32.8 s] 
INFO:root:all_losses: [0.12710027 0.50364053]
INFO:root:Epoch 47    loss=0.1271 [171.5 s]	 dev=(HR@5:0.5599,NDCG@5:0.3978) test=(HR@5:0.5122,NDCG@5:0.3580) [32.8 s] 
INFO:root:all_losses: [0.12363592 0.49977577]
INFO:root:Epoch 48    loss=0.1236 [171.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4153) test=(HR@5:0.5249,NDCG@5:0.3640) [33.0 s] 
INFO:root:all_losses: [0.12582912 0.49514893]
INFO:root:Epoch 49    loss=0.1258 [172.2 s]	 dev=(HR@5:0.5843,NDCG@5:0.4180) test=(HR@5:0.5323,NDCG@5:0.3776) [32.7 s] 
INFO:root:all_losses: [0.12311313 0.49059248]
INFO:root:Epoch 50    loss=0.1231 [171.8 s]	 dev=(HR@5:0.5652,NDCG@5:0.4175) test=(HR@5:0.5228,NDCG@5:0.3669) [33.0 s] 
INFO:root:all_losses: [0.12369707 0.484556  ]
INFO:root:Epoch 51    loss=0.1237 [171.8 s]	 dev=(HR@5:0.5748,NDCG@5:0.4173) test=(HR@5:0.5323,NDCG@5:0.3837) [32.6 s] 
INFO:root:all_losses: [0.12260988 0.4792208 ]
INFO:root:Epoch 52    loss=0.1226 [171.6 s]	 dev=(HR@5:0.5822,NDCG@5:0.4196) test=(HR@5:0.5196,NDCG@5:0.3709) [32.9 s] 
INFO:root:all_losses: [0.12126558 0.4742399 ]
INFO:root:Epoch 53    loss=0.1213 [171.8 s]	 dev=(HR@5:0.5790,NDCG@5:0.4111) test=(HR@5:0.5292,NDCG@5:0.3709) [32.5 s] 
INFO:root:all_losses: [0.11860705 0.468104  ]
INFO:root:Epoch 54    loss=0.1186 [171.2 s]	 dev=(HR@5:0.5960,NDCG@5:0.4227) test=(HR@5:0.5567,NDCG@5:0.3974) [32.6 s] 
INFO:root:all_losses: [0.11823005 0.46247783]
INFO:root:Epoch 55    loss=0.1182 [171.4 s]	 dev=(HR@5:0.5779,NDCG@5:0.4144) test=(HR@5:0.5376,NDCG@5:0.3864) [32.8 s] 
INFO:root:all_losses: [0.11927771 0.45876566]
INFO:root:Epoch 56    loss=0.1193 [172.1 s]	 dev=(HR@5:0.5684,NDCG@5:0.4077) test=(HR@5:0.5483,NDCG@5:0.3869) [32.6 s] 
INFO:root:all_losses: [0.11650405 0.45397082]
INFO:root:Epoch 57    loss=0.1165 [171.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4173) test=(HR@5:0.5376,NDCG@5:0.3817) [32.4 s] 
INFO:root:all_losses: [0.11283354 0.4491293 ]
INFO:root:Epoch 58    loss=0.1128 [171.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.4145) test=(HR@5:0.5345,NDCG@5:0.3799) [32.6 s] 
INFO:root:all_losses: [0.11429413 0.44269723]
INFO:root:Epoch 59    loss=0.1143 [172.5 s]	 dev=(HR@5:0.5854,NDCG@5:0.4220) test=(HR@5:0.5345,NDCG@5:0.3829) [32.7 s] 
INFO:root:all_losses: [0.11755436 0.43539575]
INFO:root:Epoch 60    loss=0.1176 [170.9 s]	 dev=(HR@5:0.5705,NDCG@5:0.4083) test=(HR@5:0.5451,NDCG@5:0.3912) [32.6 s] 
INFO:root:all_losses: [0.11428899 0.43315157]
INFO:root:Epoch 61    loss=0.1143 [171.5 s]	 dev=(HR@5:0.5705,NDCG@5:0.4010) test=(HR@5:0.5366,NDCG@5:0.3833) [32.5 s] 
INFO:root:all_losses: [0.112372   0.42821112]
INFO:root:Epoch 62    loss=0.1124 [171.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4140) test=(HR@5:0.5366,NDCG@5:0.3764) [32.6 s] 
INFO:root:all_losses: [0.11290336 0.42404738]
INFO:root:Epoch 63    loss=0.1129 [172.0 s]	 dev=(HR@5:0.5684,NDCG@5:0.4151) test=(HR@5:0.5302,NDCG@5:0.3731) [32.3 s] 
INFO:root:Early stop at 63 based on dev result.
INFO:root:
Best Iter(dev)=   43	 dev=(HR@5:0.5885,NDCG@5:0.4283) test=(HR@5:0.5334,NDCG@5:0.3783) [13024.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6978,HR@5:0.5334,HR@50:0.9629,NDCG@10:0.4316,NDCG@5:0.3783,NDCG@50:0.4933)
INFO:root:
--------------------------------------------- END: 2025-03-02 00:19:24 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-16 13:05:03 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: True
INFO:root:# cuda devices: 1
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:1.0000,HR@5:1.0000,HR@50:1.0000,NDCG@10:1.0000,NDCG@5:1.0000,NDCG@50:1.0000)
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-16 13:16:45 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: True
INFO:root:# cuda devices: 1
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:1.0000,HR@5:1.0000,HR@50:1.0000,NDCG@10:1.0000,NDCG@5:1.0000,NDCG@50:1.0000)
INFO:root:Optimizer: Adam
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-16 13:38:24 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46009585 0.693092  ]
INFO:root:Epoch 1     loss=0.4601 [174.6 s]	 dev=(HR@5:0.2185,NDCG@5:0.1394) test=(HR@5:0.2047,NDCG@5:0.1384) [38.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.42682573 0.69290775]
INFO:root:Epoch 2     loss=0.4268 [536.7 s]	 dev=(HR@5:0.2407,NDCG@5:0.1590) test=(HR@5:0.2238,NDCG@5:0.1477) [45.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34159222 0.69225764]
INFO:root:Epoch 3     loss=0.3416 [408.1 s]	 dev=(HR@5:0.3393,NDCG@5:0.2372) test=(HR@5:0.3075,NDCG@5:0.2102) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.26847282 0.68905973]
INFO:root:Epoch 4     loss=0.2685 [249.6 s]	 dev=(HR@5:0.4793,NDCG@5:0.3397) test=(HR@5:0.4252,NDCG@5:0.2833) [64.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22635308 0.6832251 ]
INFO:root:Epoch 5     loss=0.2264 [333.5 s]	 dev=(HR@5:0.4581,NDCG@5:0.3253) test=(HR@5:0.4136,NDCG@5:0.2819) [64.9 s] 
INFO:root:all_losses: [0.21116818 0.6768314 ]
INFO:root:Epoch 6     loss=0.2112 [321.5 s]	 dev=(HR@5:0.5143,NDCG@5:0.3638) test=(HR@5:0.4846,NDCG@5:0.3299) [64.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20232782 0.671023  ]
INFO:root:Epoch 7     loss=0.2023 [330.9 s]	 dev=(HR@5:0.5164,NDCG@5:0.3584) test=(HR@5:0.4687,NDCG@5:0.3187) [64.1 s] 
INFO:root:all_losses: [0.19899215 0.6652925 ]
INFO:root:Epoch 8     loss=0.1990 [329.9 s]	 dev=(HR@5:0.5186,NDCG@5:0.3657) test=(HR@5:0.4963,NDCG@5:0.3343) [63.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19342941 0.66221374]
INFO:root:Epoch 9     loss=0.1934 [329.6 s]	 dev=(HR@5:0.5451,NDCG@5:0.3771) test=(HR@5:0.4857,NDCG@5:0.3441) [63.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19204263 0.6561803 ]
INFO:root:Epoch 10    loss=0.1920 [329.1 s]	 dev=(HR@5:0.5387,NDCG@5:0.3835) test=(HR@5:0.4793,NDCG@5:0.3418) [62.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18518102 0.65075433]
INFO:root:Epoch 11    loss=0.1852 [328.3 s]	 dev=(HR@5:0.5461,NDCG@5:0.3810) test=(HR@5:0.5196,NDCG@5:0.3649) [63.6 s] 
INFO:root:all_losses: [0.17751634 0.6467229 ]
INFO:root:Epoch 12    loss=0.1775 [328.6 s]	 dev=(HR@5:0.5620,NDCG@5:0.3888) test=(HR@5:0.5228,NDCG@5:0.3590) [62.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17728549 0.6416999 ]
INFO:root:Epoch 13    loss=0.1773 [328.9 s]	 dev=(HR@5:0.5716,NDCG@5:0.3943) test=(HR@5:0.4920,NDCG@5:0.3468) [62.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17209692 0.63703966]
INFO:root:Epoch 14    loss=0.1721 [315.3 s]	 dev=(HR@5:0.5599,NDCG@5:0.3866) test=(HR@5:0.5175,NDCG@5:0.3631) [62.7 s] 
INFO:root:all_losses: [0.17115045 0.63207144]
INFO:root:Epoch 15    loss=0.1712 [336.3 s]	 dev=(HR@5:0.5737,NDCG@5:0.3975) test=(HR@5:0.5122,NDCG@5:0.3595) [61.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16514733 0.6266354 ]
INFO:root:Epoch 16    loss=0.1651 [335.4 s]	 dev=(HR@5:0.5536,NDCG@5:0.3947) test=(HR@5:0.5027,NDCG@5:0.3507) [61.8 s] 
INFO:root:all_losses: [0.1622971 0.6218806]
INFO:root:Epoch 17    loss=0.1623 [336.3 s]	 dev=(HR@5:0.5695,NDCG@5:0.4054) test=(HR@5:0.5133,NDCG@5:0.3665) [62.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16075407 0.61830825]
INFO:root:Epoch 18    loss=0.1608 [336.1 s]	 dev=(HR@5:0.5599,NDCG@5:0.4057) test=(HR@5:0.5260,NDCG@5:0.3721) [61.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15725726 0.6150192 ]
INFO:root:Epoch 19    loss=0.1573 [335.1 s]	 dev=(HR@5:0.5737,NDCG@5:0.4013) test=(HR@5:0.5292,NDCG@5:0.3738) [61.3 s] 
INFO:root:all_losses: [0.15781698 0.60964024]
INFO:root:Epoch 20    loss=0.1578 [335.4 s]	 dev=(HR@5:0.5716,NDCG@5:0.4086) test=(HR@5:0.5451,NDCG@5:0.3869) [61.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15581098 0.6058783 ]
INFO:root:Epoch 21    loss=0.1558 [335.3 s]	 dev=(HR@5:0.5546,NDCG@5:0.3937) test=(HR@5:0.5387,NDCG@5:0.3861) [61.1 s] 
INFO:root:all_losses: [0.1499614 0.6015808]
INFO:root:Epoch 22    loss=0.1500 [334.7 s]	 dev=(HR@5:0.5705,NDCG@5:0.4091) test=(HR@5:0.5355,NDCG@5:0.3813) [60.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.153479  0.5973577]
INFO:root:Epoch 23    loss=0.1535 [335.1 s]	 dev=(HR@5:0.5811,NDCG@5:0.4132) test=(HR@5:0.5408,NDCG@5:0.3786) [60.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14822875 0.5932877 ]
INFO:root:Epoch 24    loss=0.1482 [324.2 s]	 dev=(HR@5:0.5801,NDCG@5:0.4112) test=(HR@5:0.5143,NDCG@5:0.3752) [60.6 s] 
INFO:root:all_losses: [0.14767958 0.58784276]
INFO:root:Epoch 25    loss=0.1477 [334.7 s]	 dev=(HR@5:0.5705,NDCG@5:0.4124) test=(HR@5:0.5493,NDCG@5:0.3816) [60.4 s] 
INFO:root:all_losses: [0.14477833 0.5843474 ]
INFO:root:Epoch 26    loss=0.1448 [334.4 s]	 dev=(HR@5:0.5885,NDCG@5:0.4130) test=(HR@5:0.5313,NDCG@5:0.3718) [60.1 s] 
INFO:root:all_losses: [0.14262685 0.58005726]
INFO:root:Epoch 27    loss=0.1426 [334.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4151) test=(HR@5:0.5313,NDCG@5:0.3759) [59.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14216043 0.57616895]
INFO:root:Epoch 28    loss=0.1422 [334.1 s]	 dev=(HR@5:0.5949,NDCG@5:0.4184) test=(HR@5:0.5387,NDCG@5:0.3781) [60.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13922031 0.57087743]
INFO:root:Epoch 29    loss=0.1392 [334.1 s]	 dev=(HR@5:0.6013,NDCG@5:0.4228) test=(HR@5:0.5398,NDCG@5:0.3783) [59.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14049678 0.5643796 ]
INFO:root:Epoch 30    loss=0.1405 [198.3 s]	 dev=(HR@5:0.6066,NDCG@5:0.4215) test=(HR@5:0.5366,NDCG@5:0.3792) [31.3 s] 
INFO:root:all_losses: [0.14066392 0.5598628 ]
INFO:root:Epoch 31    loss=0.1407 [208.2 s]	 dev=(HR@5:0.6002,NDCG@5:0.4234) test=(HR@5:0.5419,NDCG@5:0.3903) [60.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13680303 0.5533954 ]
INFO:root:Epoch 32    loss=0.1368 [334.6 s]	 dev=(HR@5:0.6013,NDCG@5:0.4326) test=(HR@5:0.5429,NDCG@5:0.3883) [59.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13418381 0.5477155 ]
INFO:root:Epoch 33    loss=0.1342 [334.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4119) test=(HR@5:0.5334,NDCG@5:0.3720) [59.3 s] 
INFO:root:all_losses: [0.13609643 0.5414487 ]
INFO:root:Epoch 34    loss=0.1361 [320.2 s]	 dev=(HR@5:0.5949,NDCG@5:0.4260) test=(HR@5:0.5451,NDCG@5:0.3806) [59.4 s] 
INFO:root:all_losses: [0.13356328 0.5369642 ]
INFO:root:Epoch 35    loss=0.1336 [333.9 s]	 dev=(HR@5:0.6013,NDCG@5:0.4317) test=(HR@5:0.5366,NDCG@5:0.3779) [59.2 s] 
INFO:root:all_losses: [0.13135427 0.5315183 ]
INFO:root:Epoch 36    loss=0.1314 [334.2 s]	 dev=(HR@5:0.5811,NDCG@5:0.4145) test=(HR@5:0.5440,NDCG@5:0.3776) [59.6 s] 
INFO:root:all_losses: [0.12961043 0.5247045 ]
INFO:root:Epoch 37    loss=0.1296 [334.6 s]	 dev=(HR@5:0.6108,NDCG@5:0.4372) test=(HR@5:0.5345,NDCG@5:0.3783) [59.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12971453 0.5205931 ]
INFO:root:Epoch 38    loss=0.1297 [333.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4245) test=(HR@5:0.5578,NDCG@5:0.3928) [59.1 s] 
INFO:root:all_losses: [0.12567805 0.51544505]
INFO:root:Epoch 39    loss=0.1257 [322.3 s]	 dev=(HR@5:0.5854,NDCG@5:0.4206) test=(HR@5:0.5408,NDCG@5:0.3808) [58.9 s] 
INFO:root:all_losses: [0.12453529 0.5092054 ]
INFO:root:Epoch 40    loss=0.1245 [333.7 s]	 dev=(HR@5:0.5960,NDCG@5:0.4259) test=(HR@5:0.5387,NDCG@5:0.3870) [59.3 s] 
INFO:root:all_losses: [0.12664562 0.5051931 ]
INFO:root:Epoch 41    loss=0.1266 [333.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4273) test=(HR@5:0.5451,NDCG@5:0.3839) [58.9 s] 
INFO:root:all_losses: [0.12457984 0.49958798]
INFO:root:Epoch 42    loss=0.1246 [333.9 s]	 dev=(HR@5:0.5620,NDCG@5:0.4153) test=(HR@5:0.5228,NDCG@5:0.3811) [58.6 s] 
INFO:root:all_losses: [0.12292571 0.49338165]
INFO:root:Epoch 43    loss=0.1229 [333.2 s]	 dev=(HR@5:0.5843,NDCG@5:0.4216) test=(HR@5:0.5260,NDCG@5:0.3805) [58.7 s] 
INFO:root:all_losses: [0.12329634 0.4906473 ]
INFO:root:Epoch 44    loss=0.1233 [333.2 s]	 dev=(HR@5:0.5748,NDCG@5:0.4127) test=(HR@5:0.5472,NDCG@5:0.3903) [58.5 s] 
INFO:root:all_losses: [0.11986841 0.4857007 ]
INFO:root:Epoch 45    loss=0.1199 [333.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4212) test=(HR@5:0.5483,NDCG@5:0.3919) [58.4 s] 
INFO:root:all_losses: [0.12033796 0.48204538]
INFO:root:Epoch 46    loss=0.1203 [333.0 s]	 dev=(HR@5:0.5758,NDCG@5:0.4122) test=(HR@5:0.5323,NDCG@5:0.3821) [58.4 s] 
INFO:root:all_losses: [0.12069966 0.47647893]
INFO:root:Epoch 47    loss=0.1207 [332.9 s]	 dev=(HR@5:0.5779,NDCG@5:0.4138) test=(HR@5:0.5302,NDCG@5:0.3682) [58.1 s] 
INFO:root:all_losses: [0.11619348 0.4712816 ]
INFO:root:Epoch 48    loss=0.1162 [332.7 s]	 dev=(HR@5:0.5790,NDCG@5:0.4161) test=(HR@5:0.5419,NDCG@5:0.3825) [58.1 s] 
INFO:root:all_losses: [0.11748711 0.46669093]
INFO:root:Epoch 49    loss=0.1175 [332.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4093) test=(HR@5:0.5323,NDCG@5:0.3770) [58.4 s] 
INFO:root:all_losses: [0.11500711 0.46437258]
INFO:root:Epoch 50    loss=0.1150 [332.9 s]	 dev=(HR@5:0.5801,NDCG@5:0.4116) test=(HR@5:0.5292,NDCG@5:0.3730) [58.0 s] 
INFO:root:all_losses: [0.11590971 0.4596833 ]
INFO:root:Epoch 51    loss=0.1159 [333.3 s]	 dev=(HR@5:0.5938,NDCG@5:0.4264) test=(HR@5:0.5408,NDCG@5:0.3830) [58.1 s] 
INFO:root:all_losses: [0.11611842 0.45676216]
INFO:root:Epoch 52    loss=0.1161 [333.4 s]	 dev=(HR@5:0.6002,NDCG@5:0.4228) test=(HR@5:0.5419,NDCG@5:0.3791) [57.6 s] 
INFO:root:all_losses: [0.11382862 0.4515713 ]
INFO:root:Epoch 53    loss=0.1138 [334.9 s]	 dev=(HR@5:0.5822,NDCG@5:0.4172) test=(HR@5:0.5143,NDCG@5:0.3651) [57.5 s] 
INFO:root:all_losses: [0.11274547 0.4474344 ]
INFO:root:Epoch 54    loss=0.1127 [339.7 s]	 dev=(HR@5:0.5938,NDCG@5:0.4233) test=(HR@5:0.5122,NDCG@5:0.3626) [57.4 s] 
INFO:root:all_losses: [0.11215001 0.44250715]
INFO:root:Epoch 55    loss=0.1122 [350.4 s]	 dev=(HR@5:0.5896,NDCG@5:0.4120) test=(HR@5:0.5313,NDCG@5:0.3769) [58.1 s] 
INFO:root:all_losses: [0.11153203 0.43880603]
INFO:root:Epoch 56    loss=0.1115 [356.4 s]	 dev=(HR@5:0.5938,NDCG@5:0.4235) test=(HR@5:0.5302,NDCG@5:0.3809) [57.7 s] 
INFO:root:all_losses: [0.11074594 0.43666676]
INFO:root:Epoch 57    loss=0.1107 [356.5 s]	 dev=(HR@5:0.6076,NDCG@5:0.4359) test=(HR@5:0.5260,NDCG@5:0.3762) [57.5 s] 
INFO:root:Early stop at 57 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.6108,NDCG@5:0.4372) test=(HR@5:0.5345,NDCG@5:0.3783) [22133.1 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7211,HR@5:0.5345,HR@50:0.9639,NDCG@10:0.4389,NDCG@5:0.3783,NDCG@50:0.4954)
INFO:root:
--------------------------------------------- END: 2025-03-16 19:48:03 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-18 21:45:25 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46009585 0.693092  ]
INFO:root:Epoch 1     loss=0.4601 [106.1 s]	 dev=(HR@5:0.2185,NDCG@5:0.1394) test=(HR@5:0.2047,NDCG@5:0.1384) [27.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.42682573 0.69290775]
INFO:root:Epoch 2     loss=0.4268 [151.2 s]	 dev=(HR@5:0.2407,NDCG@5:0.1590) test=(HR@5:0.2238,NDCG@5:0.1477) [28.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34159222 0.69225764]
INFO:root:Epoch 3     loss=0.3416 [136.1 s]	 dev=(HR@5:0.3393,NDCG@5:0.2372) test=(HR@5:0.3075,NDCG@5:0.2102) [27.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.26847282 0.68905973]
INFO:root:Epoch 4     loss=0.2685 [119.5 s]	 dev=(HR@5:0.4793,NDCG@5:0.3397) test=(HR@5:0.4252,NDCG@5:0.2833) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22635308 0.6832251 ]
INFO:root:Epoch 5     loss=0.2264 [132.5 s]	 dev=(HR@5:0.4581,NDCG@5:0.3253) test=(HR@5:0.4136,NDCG@5:0.2819) [31.0 s] 
INFO:root:all_losses: [0.21116818 0.6768314 ]
INFO:root:Epoch 6     loss=0.2112 [132.4 s]	 dev=(HR@5:0.5143,NDCG@5:0.3638) test=(HR@5:0.4846,NDCG@5:0.3299) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20232782 0.671023  ]
INFO:root:Epoch 7     loss=0.2023 [132.3 s]	 dev=(HR@5:0.5164,NDCG@5:0.3584) test=(HR@5:0.4687,NDCG@5:0.3187) [30.8 s] 
INFO:root:all_losses: [0.19899215 0.6652925 ]
INFO:root:Epoch 8     loss=0.1990 [132.7 s]	 dev=(HR@5:0.5186,NDCG@5:0.3657) test=(HR@5:0.4963,NDCG@5:0.3343) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19342941 0.66221374]
INFO:root:Epoch 9     loss=0.1934 [132.0 s]	 dev=(HR@5:0.5451,NDCG@5:0.3771) test=(HR@5:0.4857,NDCG@5:0.3441) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19204263 0.6561803 ]
INFO:root:Epoch 10    loss=0.1920 [131.8 s]	 dev=(HR@5:0.5387,NDCG@5:0.3835) test=(HR@5:0.4793,NDCG@5:0.3418) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18518102 0.65075433]
INFO:root:Epoch 11    loss=0.1852 [132.6 s]	 dev=(HR@5:0.5461,NDCG@5:0.3810) test=(HR@5:0.5196,NDCG@5:0.3649) [31.2 s] 
INFO:root:all_losses: [0.17751634 0.6467229 ]
INFO:root:Epoch 12    loss=0.1775 [132.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.3888) test=(HR@5:0.5228,NDCG@5:0.3590) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17728549 0.6416999 ]
INFO:root:Epoch 13    loss=0.1773 [132.0 s]	 dev=(HR@5:0.5716,NDCG@5:0.3943) test=(HR@5:0.4920,NDCG@5:0.3468) [31.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17209692 0.63703966]
INFO:root:Epoch 14    loss=0.1721 [132.6 s]	 dev=(HR@5:0.5599,NDCG@5:0.3866) test=(HR@5:0.5175,NDCG@5:0.3631) [30.8 s] 
INFO:root:all_losses: [0.17115045 0.63207144]
INFO:root:Epoch 15    loss=0.1712 [131.7 s]	 dev=(HR@5:0.5737,NDCG@5:0.3975) test=(HR@5:0.5122,NDCG@5:0.3595) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16514733 0.6266354 ]
INFO:root:Epoch 16    loss=0.1651 [132.6 s]	 dev=(HR@5:0.5536,NDCG@5:0.3947) test=(HR@5:0.5027,NDCG@5:0.3507) [30.6 s] 
INFO:root:all_losses: [0.1622971 0.6218806]
INFO:root:Epoch 17    loss=0.1623 [131.9 s]	 dev=(HR@5:0.5695,NDCG@5:0.4054) test=(HR@5:0.5133,NDCG@5:0.3665) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16075407 0.61830825]
INFO:root:Epoch 18    loss=0.1608 [132.2 s]	 dev=(HR@5:0.5599,NDCG@5:0.4057) test=(HR@5:0.5260,NDCG@5:0.3721) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15725726 0.6150192 ]
INFO:root:Epoch 19    loss=0.1573 [131.9 s]	 dev=(HR@5:0.5737,NDCG@5:0.4013) test=(HR@5:0.5292,NDCG@5:0.3738) [30.5 s] 
INFO:root:all_losses: [0.15781698 0.60964024]
INFO:root:Epoch 20    loss=0.1578 [132.1 s]	 dev=(HR@5:0.5716,NDCG@5:0.4086) test=(HR@5:0.5451,NDCG@5:0.3869) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15581098 0.6058783 ]
INFO:root:Epoch 21    loss=0.1558 [132.1 s]	 dev=(HR@5:0.5546,NDCG@5:0.3937) test=(HR@5:0.5387,NDCG@5:0.3861) [30.5 s] 
INFO:root:all_losses: [0.1499614 0.6015808]
INFO:root:Epoch 22    loss=0.1500 [132.9 s]	 dev=(HR@5:0.5705,NDCG@5:0.4091) test=(HR@5:0.5355,NDCG@5:0.3813) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.153479  0.5973577]
INFO:root:Epoch 23    loss=0.1535 [131.9 s]	 dev=(HR@5:0.5811,NDCG@5:0.4132) test=(HR@5:0.5408,NDCG@5:0.3786) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14822875 0.5932877 ]
INFO:root:Epoch 24    loss=0.1482 [132.2 s]	 dev=(HR@5:0.5801,NDCG@5:0.4112) test=(HR@5:0.5143,NDCG@5:0.3752) [30.6 s] 
INFO:root:all_losses: [0.14767958 0.58784276]
INFO:root:Epoch 25    loss=0.1477 [132.5 s]	 dev=(HR@5:0.5705,NDCG@5:0.4124) test=(HR@5:0.5493,NDCG@5:0.3816) [30.4 s] 
INFO:root:all_losses: [0.14477833 0.5843474 ]
INFO:root:Epoch 26    loss=0.1448 [132.2 s]	 dev=(HR@5:0.5885,NDCG@5:0.4130) test=(HR@5:0.5313,NDCG@5:0.3718) [30.8 s] 
INFO:root:all_losses: [0.14262685 0.58005726]
INFO:root:Epoch 27    loss=0.1426 [132.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4151) test=(HR@5:0.5313,NDCG@5:0.3759) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14216043 0.57616895]
INFO:root:Epoch 28    loss=0.1422 [132.5 s]	 dev=(HR@5:0.5949,NDCG@5:0.4184) test=(HR@5:0.5387,NDCG@5:0.3781) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13922031 0.57087743]
INFO:root:Epoch 29    loss=0.1392 [132.2 s]	 dev=(HR@5:0.6013,NDCG@5:0.4228) test=(HR@5:0.5398,NDCG@5:0.3783) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14049678 0.5643796 ]
INFO:root:Epoch 30    loss=0.1405 [132.6 s]	 dev=(HR@5:0.6066,NDCG@5:0.4215) test=(HR@5:0.5366,NDCG@5:0.3792) [30.6 s] 
INFO:root:all_losses: [0.14066392 0.5598628 ]
INFO:root:Epoch 31    loss=0.1407 [132.2 s]	 dev=(HR@5:0.6002,NDCG@5:0.4234) test=(HR@5:0.5419,NDCG@5:0.3903) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13680303 0.5533954 ]
INFO:root:Epoch 32    loss=0.1368 [132.3 s]	 dev=(HR@5:0.6013,NDCG@5:0.4326) test=(HR@5:0.5429,NDCG@5:0.3883) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13418381 0.5477155 ]
INFO:root:Epoch 33    loss=0.1342 [132.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4119) test=(HR@5:0.5334,NDCG@5:0.3720) [30.5 s] 
INFO:root:all_losses: [0.13609643 0.5414487 ]
INFO:root:Epoch 34    loss=0.1361 [132.2 s]	 dev=(HR@5:0.5949,NDCG@5:0.4260) test=(HR@5:0.5451,NDCG@5:0.3806) [30.5 s] 
INFO:root:all_losses: [0.13356328 0.5369642 ]
INFO:root:Epoch 35    loss=0.1336 [132.0 s]	 dev=(HR@5:0.6013,NDCG@5:0.4317) test=(HR@5:0.5366,NDCG@5:0.3779) [30.5 s] 
INFO:root:all_losses: [0.13135427 0.5315183 ]
INFO:root:Epoch 36    loss=0.1314 [132.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4145) test=(HR@5:0.5440,NDCG@5:0.3776) [30.5 s] 
INFO:root:all_losses: [0.12961043 0.5247045 ]
INFO:root:Epoch 37    loss=0.1296 [131.9 s]	 dev=(HR@5:0.6108,NDCG@5:0.4372) test=(HR@5:0.5345,NDCG@5:0.3783) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12971453 0.5205931 ]
INFO:root:Epoch 38    loss=0.1297 [132.2 s]	 dev=(HR@5:0.5885,NDCG@5:0.4245) test=(HR@5:0.5578,NDCG@5:0.3928) [30.6 s] 
INFO:root:all_losses: [0.12567805 0.51544505]
INFO:root:Epoch 39    loss=0.1257 [132.4 s]	 dev=(HR@5:0.5854,NDCG@5:0.4206) test=(HR@5:0.5408,NDCG@5:0.3808) [30.5 s] 
INFO:root:all_losses: [0.12453529 0.5092054 ]
INFO:root:Epoch 40    loss=0.1245 [132.1 s]	 dev=(HR@5:0.5960,NDCG@5:0.4259) test=(HR@5:0.5387,NDCG@5:0.3870) [30.5 s] 
INFO:root:all_losses: [0.12664562 0.5051931 ]
INFO:root:Epoch 41    loss=0.1266 [131.7 s]	 dev=(HR@5:0.5885,NDCG@5:0.4273) test=(HR@5:0.5451,NDCG@5:0.3839) [30.7 s] 
INFO:root:all_losses: [0.12457984 0.49958798]
INFO:root:Epoch 42    loss=0.1246 [132.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.4153) test=(HR@5:0.5228,NDCG@5:0.3811) [30.3 s] 
INFO:root:all_losses: [0.12292571 0.49338165]
INFO:root:Epoch 43    loss=0.1229 [132.0 s]	 dev=(HR@5:0.5843,NDCG@5:0.4216) test=(HR@5:0.5260,NDCG@5:0.3805) [30.4 s] 
INFO:root:all_losses: [0.12329634 0.4906473 ]
INFO:root:Epoch 44    loss=0.1233 [132.2 s]	 dev=(HR@5:0.5748,NDCG@5:0.4127) test=(HR@5:0.5472,NDCG@5:0.3903) [30.2 s] 
INFO:root:all_losses: [0.11986841 0.4857007 ]
INFO:root:Epoch 45    loss=0.1199 [132.0 s]	 dev=(HR@5:0.5779,NDCG@5:0.4212) test=(HR@5:0.5483,NDCG@5:0.3919) [30.2 s] 
INFO:root:all_losses: [0.12033796 0.48204538]
INFO:root:Epoch 46    loss=0.1203 [132.1 s]	 dev=(HR@5:0.5758,NDCG@5:0.4122) test=(HR@5:0.5323,NDCG@5:0.3821) [30.6 s] 
INFO:root:all_losses: [0.12069966 0.47647893]
INFO:root:Epoch 47    loss=0.1207 [133.5 s]	 dev=(HR@5:0.5779,NDCG@5:0.4138) test=(HR@5:0.5302,NDCG@5:0.3682) [32.2 s] 
INFO:root:all_losses: [0.11619348 0.4712816 ]
INFO:root:Epoch 48    loss=0.1162 [131.8 s]	 dev=(HR@5:0.5790,NDCG@5:0.4161) test=(HR@5:0.5419,NDCG@5:0.3825) [30.3 s] 
INFO:root:all_losses: [0.11748711 0.46669093]
INFO:root:Epoch 49    loss=0.1175 [132.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4093) test=(HR@5:0.5323,NDCG@5:0.3770) [30.6 s] 
INFO:root:all_losses: [0.11500711 0.46437258]
INFO:root:Epoch 50    loss=0.1150 [132.3 s]	 dev=(HR@5:0.5801,NDCG@5:0.4116) test=(HR@5:0.5292,NDCG@5:0.3730) [30.3 s] 
INFO:root:all_losses: [0.11590971 0.4596833 ]
INFO:root:Epoch 51    loss=0.1159 [131.9 s]	 dev=(HR@5:0.5938,NDCG@5:0.4264) test=(HR@5:0.5408,NDCG@5:0.3830) [30.4 s] 
INFO:root:all_losses: [0.11611842 0.45676216]
INFO:root:Epoch 52    loss=0.1161 [132.0 s]	 dev=(HR@5:0.6002,NDCG@5:0.4228) test=(HR@5:0.5419,NDCG@5:0.3791) [30.5 s] 
INFO:root:all_losses: [0.11382862 0.4515713 ]
INFO:root:Epoch 53    loss=0.1138 [132.5 s]	 dev=(HR@5:0.5822,NDCG@5:0.4172) test=(HR@5:0.5143,NDCG@5:0.3651) [30.1 s] 
INFO:root:all_losses: [0.11274547 0.4474344 ]
INFO:root:Epoch 54    loss=0.1127 [133.2 s]	 dev=(HR@5:0.5938,NDCG@5:0.4233) test=(HR@5:0.5122,NDCG@5:0.3626) [30.3 s] 
INFO:root:all_losses: [0.11215001 0.44250715]
INFO:root:Epoch 55    loss=0.1122 [134.3 s]	 dev=(HR@5:0.5896,NDCG@5:0.4120) test=(HR@5:0.5313,NDCG@5:0.3769) [30.2 s] 
INFO:root:all_losses: [0.11153203 0.43880603]
INFO:root:Epoch 56    loss=0.1115 [135.8 s]	 dev=(HR@5:0.5938,NDCG@5:0.4235) test=(HR@5:0.5302,NDCG@5:0.3809) [30.3 s] 
INFO:root:all_losses: [0.11074594 0.43666676]
INFO:root:Epoch 57    loss=0.1107 [135.7 s]	 dev=(HR@5:0.6076,NDCG@5:0.4359) test=(HR@5:0.5260,NDCG@5:0.3762) [30.2 s] 
INFO:root:Early stop at 57 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.6108,NDCG@5:0.4372) test=(HR@5:0.5345,NDCG@5:0.3783) [9268.7 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7211,HR@5:0.5345,HR@50:0.9639,NDCG@10:0.4389,NDCG@5:0.3783,NDCG@50:0.4954)
INFO:root:
--------------------------------------------- END: 2025-03-19 00:20:23 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-23 20:38:45 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45964807 0.6930926 ]
INFO:root:Epoch 1     loss=0.4596 [120.3 s]	 dev=(HR@5:0.2163,NDCG@5:0.1375) test=(HR@5:0.2025,NDCG@5:0.1385) [29.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4102566 0.6929123]
INFO:root:Epoch 2     loss=0.4103 [140.8 s]	 dev=(HR@5:0.2513,NDCG@5:0.1625) test=(HR@5:0.2291,NDCG@5:0.1441) [33.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34972376 0.69245404]
INFO:root:Epoch 3     loss=0.3497 [139.7 s]	 dev=(HR@5:0.3510,NDCG@5:0.2338) test=(HR@5:0.2916,NDCG@5:0.1986) [38.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.291822 0.690259]
INFO:root:Epoch 4     loss=0.2918 [159.1 s]	 dev=(HR@5:0.4210,NDCG@5:0.2901) test=(HR@5:0.3902,NDCG@5:0.2605) [32.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2647651  0.68611354]
INFO:root:Epoch 5     loss=0.2648 [149.4 s]	 dev=(HR@5:0.4274,NDCG@5:0.2970) test=(HR@5:0.3871,NDCG@5:0.2555) [32.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23024067 0.6796506 ]
INFO:root:Epoch 6     loss=0.2302 [150.4 s]	 dev=(HR@5:0.4920,NDCG@5:0.3384) test=(HR@5:0.4560,NDCG@5:0.3031) [32.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2173655 0.6727265]
INFO:root:Epoch 7     loss=0.2174 [149.5 s]	 dev=(HR@5:0.4952,NDCG@5:0.3353) test=(HR@5:0.4560,NDCG@5:0.3029) [32.6 s] 
INFO:root:all_losses: [0.21338686 0.666357  ]
INFO:root:Epoch 8     loss=0.2134 [150.6 s]	 dev=(HR@5:0.4920,NDCG@5:0.3431) test=(HR@5:0.4655,NDCG@5:0.3051) [32.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20899077 0.6631687 ]
INFO:root:Epoch 9     loss=0.2090 [149.6 s]	 dev=(HR@5:0.5175,NDCG@5:0.3586) test=(HR@5:0.4677,NDCG@5:0.3205) [32.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2081977  0.65746814]
INFO:root:Epoch 10    loss=0.2082 [149.5 s]	 dev=(HR@5:0.4783,NDCG@5:0.3326) test=(HR@5:0.4178,NDCG@5:0.2840) [32.2 s] 
INFO:root:all_losses: [0.20252211 0.65315604]
INFO:root:Epoch 11    loss=0.2025 [149.6 s]	 dev=(HR@5:0.5122,NDCG@5:0.3577) test=(HR@5:0.4666,NDCG@5:0.3201) [32.4 s] 
INFO:root:all_losses: [0.19476783 0.6499709 ]
INFO:root:Epoch 12    loss=0.1948 [149.4 s]	 dev=(HR@5:0.5111,NDCG@5:0.3592) test=(HR@5:0.4825,NDCG@5:0.3206) [32.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19558331 0.64563394]
INFO:root:Epoch 13    loss=0.1956 [149.2 s]	 dev=(HR@5:0.5260,NDCG@5:0.3606) test=(HR@5:0.4740,NDCG@5:0.3248) [32.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19071984 0.6412757 ]
INFO:root:Epoch 14    loss=0.1907 [149.1 s]	 dev=(HR@5:0.5260,NDCG@5:0.3596) test=(HR@5:0.4793,NDCG@5:0.3293) [32.2 s] 
INFO:root:all_losses: [0.18942584 0.63734543]
INFO:root:Epoch 15    loss=0.1894 [149.6 s]	 dev=(HR@5:0.5260,NDCG@5:0.3636) test=(HR@5:0.4761,NDCG@5:0.3272) [32.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18534765 0.6327651 ]
INFO:root:Epoch 16    loss=0.1853 [149.1 s]	 dev=(HR@5:0.5239,NDCG@5:0.3599) test=(HR@5:0.4507,NDCG@5:0.3135) [32.0 s] 
INFO:root:all_losses: [0.18339713 0.62786806]
INFO:root:Epoch 17    loss=0.1834 [149.2 s]	 dev=(HR@5:0.5461,NDCG@5:0.3829) test=(HR@5:0.4920,NDCG@5:0.3421) [32.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18053742 0.62430674]
INFO:root:Epoch 18    loss=0.1805 [148.8 s]	 dev=(HR@5:0.5292,NDCG@5:0.3682) test=(HR@5:0.4889,NDCG@5:0.3387) [31.9 s] 
INFO:root:all_losses: [0.17993397 0.6210155 ]
INFO:root:Epoch 19    loss=0.1799 [149.9 s]	 dev=(HR@5:0.5429,NDCG@5:0.3790) test=(HR@5:0.4931,NDCG@5:0.3427) [32.2 s] 
INFO:root:all_losses: [0.17794625 0.6151164 ]
INFO:root:Epoch 20    loss=0.1779 [149.1 s]	 dev=(HR@5:0.5408,NDCG@5:0.3821) test=(HR@5:0.5069,NDCG@5:0.3609) [32.0 s] 
INFO:root:all_losses: [0.177286   0.61046773]
INFO:root:Epoch 21    loss=0.1773 [149.2 s]	 dev=(HR@5:0.5196,NDCG@5:0.3753) test=(HR@5:0.5069,NDCG@5:0.3528) [31.8 s] 
INFO:root:all_losses: [0.17026165 0.6051886 ]
INFO:root:Epoch 22    loss=0.1703 [149.2 s]	 dev=(HR@5:0.5313,NDCG@5:0.3806) test=(HR@5:0.4910,NDCG@5:0.3489) [31.8 s] 
INFO:root:all_losses: [0.17380531 0.59936947]
INFO:root:Epoch 23    loss=0.1738 [149.7 s]	 dev=(HR@5:0.5461,NDCG@5:0.3884) test=(HR@5:0.4984,NDCG@5:0.3489) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16919291 0.5946788 ]
INFO:root:Epoch 24    loss=0.1692 [149.3 s]	 dev=(HR@5:0.5525,NDCG@5:0.3980) test=(HR@5:0.5154,NDCG@5:0.3582) [32.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16723882 0.5875188 ]
INFO:root:Epoch 25    loss=0.1672 [148.8 s]	 dev=(HR@5:0.5620,NDCG@5:0.3968) test=(HR@5:0.5080,NDCG@5:0.3542) [31.9 s] 
INFO:root:all_losses: [0.16400157 0.58256865]
INFO:root:Epoch 26    loss=0.1640 [149.3 s]	 dev=(HR@5:0.5504,NDCG@5:0.3906) test=(HR@5:0.5027,NDCG@5:0.3471) [31.7 s] 
INFO:root:all_losses: [0.16190208 0.5771592 ]
INFO:root:Epoch 27    loss=0.1619 [149.7 s]	 dev=(HR@5:0.5504,NDCG@5:0.3953) test=(HR@5:0.5048,NDCG@5:0.3455) [31.5 s] 
INFO:root:all_losses: [0.16145453 0.572361  ]
INFO:root:Epoch 28    loss=0.1615 [149.0 s]	 dev=(HR@5:0.5493,NDCG@5:0.3916) test=(HR@5:0.5260,NDCG@5:0.3594) [31.9 s] 
INFO:root:all_losses: [0.15864827 0.5652167 ]
INFO:root:Epoch 29    loss=0.1586 [149.8 s]	 dev=(HR@5:0.5451,NDCG@5:0.3897) test=(HR@5:0.4963,NDCG@5:0.3493) [31.8 s] 
INFO:root:all_losses: [0.15958497 0.5586525 ]
INFO:root:Epoch 30    loss=0.1596 [148.8 s]	 dev=(HR@5:0.5695,NDCG@5:0.4032) test=(HR@5:0.5217,NDCG@5:0.3680) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15826912 0.5527401 ]
INFO:root:Epoch 31    loss=0.1583 [149.9 s]	 dev=(HR@5:0.5440,NDCG@5:0.3861) test=(HR@5:0.4973,NDCG@5:0.3465) [31.5 s] 
INFO:root:all_losses: [0.15503632 0.544083  ]
INFO:root:Epoch 32    loss=0.1550 [149.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.4108) test=(HR@5:0.5133,NDCG@5:0.3597) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15240665 0.53667074]
INFO:root:Epoch 33    loss=0.1524 [150.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.3972) test=(HR@5:0.5048,NDCG@5:0.3570) [31.6 s] 
INFO:root:all_losses: [0.15427296 0.52765405]
INFO:root:Epoch 34    loss=0.1543 [148.8 s]	 dev=(HR@5:0.5557,NDCG@5:0.4033) test=(HR@5:0.5154,NDCG@5:0.3608) [31.5 s] 
INFO:root:all_losses: [0.15058324 0.52205366]
INFO:root:Epoch 35    loss=0.1506 [150.3 s]	 dev=(HR@5:0.5748,NDCG@5:0.4107) test=(HR@5:0.5207,NDCG@5:0.3682) [31.9 s] 
INFO:root:all_losses: [0.1499328  0.51205474]
INFO:root:Epoch 36    loss=0.1499 [149.9 s]	 dev=(HR@5:0.5387,NDCG@5:0.3849) test=(HR@5:0.4783,NDCG@5:0.3391) [31.7 s] 
INFO:root:all_losses: [0.14704947 0.50225276]
INFO:root:Epoch 37    loss=0.1470 [150.5 s]	 dev=(HR@5:0.5610,NDCG@5:0.4016) test=(HR@5:0.5175,NDCG@5:0.3597) [31.9 s] 
INFO:root:all_losses: [0.14761132 0.49518254]
INFO:root:Epoch 38    loss=0.1476 [149.9 s]	 dev=(HR@5:0.5631,NDCG@5:0.4066) test=(HR@5:0.5249,NDCG@5:0.3763) [31.9 s] 
INFO:root:all_losses: [0.14354143 0.48654968]
INFO:root:Epoch 39    loss=0.1435 [150.9 s]	 dev=(HR@5:0.5652,NDCG@5:0.4035) test=(HR@5:0.5440,NDCG@5:0.3770) [31.8 s] 
INFO:root:all_losses: [0.1418332  0.47513393]
INFO:root:Epoch 40    loss=0.1418 [149.6 s]	 dev=(HR@5:0.5695,NDCG@5:0.4029) test=(HR@5:0.5228,NDCG@5:0.3679) [31.7 s] 
INFO:root:all_losses: [0.14304806 0.46491542]
INFO:root:Epoch 41    loss=0.1430 [150.8 s]	 dev=(HR@5:0.5525,NDCG@5:0.3958) test=(HR@5:0.5069,NDCG@5:0.3532) [31.5 s] 
INFO:root:all_losses: [0.14123197 0.4583519 ]
INFO:root:Epoch 42    loss=0.1412 [150.1 s]	 dev=(HR@5:0.5483,NDCG@5:0.3875) test=(HR@5:0.5260,NDCG@5:0.3648) [31.5 s] 
INFO:root:Early stop at 42 based on dev result.
INFO:root:
Best Iter(dev)=   32	 dev=(HR@5:0.5737,NDCG@5:0.4108) test=(HR@5:0.5133,NDCG@5:0.3597) [7592.0 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6957,HR@5:0.5133,HR@50:0.9618,NDCG@10:0.4185,NDCG@5:0.3597,NDCG@50:0.4795)
INFO:root:
--------------------------------------------- END: 2025-03-23 22:45:48 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-24 10:06:44 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45964807 0.6930926 ]
INFO:root:Epoch 1     loss=0.4596 [110.6 s]	 dev=(HR@5:0.2163,NDCG@5:0.1375) test=(HR@5:0.2025,NDCG@5:0.1385) [28.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4102566 0.6929123]
INFO:root:Epoch 2     loss=0.4103 [128.1 s]	 dev=(HR@5:0.2513,NDCG@5:0.1625) test=(HR@5:0.2291,NDCG@5:0.1441) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34972376 0.69245404]
INFO:root:Epoch 3     loss=0.3497 [127.9 s]	 dev=(HR@5:0.3510,NDCG@5:0.2338) test=(HR@5:0.2916,NDCG@5:0.1986) [37.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.291822 0.690259]
INFO:root:Epoch 4     loss=0.2918 [144.5 s]	 dev=(HR@5:0.4210,NDCG@5:0.2901) test=(HR@5:0.3902,NDCG@5:0.2605) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2647651  0.68611354]
INFO:root:Epoch 5     loss=0.2648 [136.8 s]	 dev=(HR@5:0.4274,NDCG@5:0.2970) test=(HR@5:0.3871,NDCG@5:0.2555) [31.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23024067 0.6796506 ]
INFO:root:Epoch 6     loss=0.2302 [137.1 s]	 dev=(HR@5:0.4920,NDCG@5:0.3384) test=(HR@5:0.4560,NDCG@5:0.3031) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2173655 0.6727265]
INFO:root:Epoch 7     loss=0.2174 [136.5 s]	 dev=(HR@5:0.4952,NDCG@5:0.3353) test=(HR@5:0.4560,NDCG@5:0.3029) [31.5 s] 
INFO:root:all_losses: [0.21338686 0.666357  ]
INFO:root:Epoch 8     loss=0.2134 [136.3 s]	 dev=(HR@5:0.4920,NDCG@5:0.3431) test=(HR@5:0.4655,NDCG@5:0.3051) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20899077 0.6631687 ]
INFO:root:Epoch 9     loss=0.2090 [137.0 s]	 dev=(HR@5:0.5175,NDCG@5:0.3586) test=(HR@5:0.4677,NDCG@5:0.3205) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2081977  0.65746814]
INFO:root:Epoch 10    loss=0.2082 [136.0 s]	 dev=(HR@5:0.4783,NDCG@5:0.3326) test=(HR@5:0.4178,NDCG@5:0.2840) [31.2 s] 
INFO:root:all_losses: [0.20252211 0.65315604]
INFO:root:Epoch 11    loss=0.2025 [136.9 s]	 dev=(HR@5:0.5122,NDCG@5:0.3577) test=(HR@5:0.4666,NDCG@5:0.3201) [31.2 s] 
INFO:root:all_losses: [0.19476783 0.6499709 ]
INFO:root:Epoch 12    loss=0.1948 [136.3 s]	 dev=(HR@5:0.5111,NDCG@5:0.3592) test=(HR@5:0.4825,NDCG@5:0.3206) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19558331 0.64563394]
INFO:root:Epoch 13    loss=0.1956 [135.9 s]	 dev=(HR@5:0.5260,NDCG@5:0.3606) test=(HR@5:0.4740,NDCG@5:0.3248) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19071984 0.6412757 ]
INFO:root:Epoch 14    loss=0.1907 [137.0 s]	 dev=(HR@5:0.5260,NDCG@5:0.3596) test=(HR@5:0.4793,NDCG@5:0.3293) [31.3 s] 
INFO:root:all_losses: [0.18942584 0.63734543]
INFO:root:Epoch 15    loss=0.1894 [136.4 s]	 dev=(HR@5:0.5260,NDCG@5:0.3636) test=(HR@5:0.4761,NDCG@5:0.3272) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18534765 0.6327651 ]
INFO:root:Epoch 16    loss=0.1853 [136.8 s]	 dev=(HR@5:0.5239,NDCG@5:0.3599) test=(HR@5:0.4507,NDCG@5:0.3135) [31.4 s] 
INFO:root:all_losses: [0.18339713 0.62786806]
INFO:root:Epoch 17    loss=0.1834 [136.3 s]	 dev=(HR@5:0.5461,NDCG@5:0.3829) test=(HR@5:0.4920,NDCG@5:0.3421) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18053742 0.62430674]
INFO:root:Epoch 18    loss=0.1805 [136.1 s]	 dev=(HR@5:0.5292,NDCG@5:0.3682) test=(HR@5:0.4889,NDCG@5:0.3387) [30.8 s] 
INFO:root:all_losses: [0.17993397 0.6210155 ]
INFO:root:Epoch 19    loss=0.1799 [137.1 s]	 dev=(HR@5:0.5429,NDCG@5:0.3790) test=(HR@5:0.4931,NDCG@5:0.3427) [31.0 s] 
INFO:root:all_losses: [0.17794625 0.6151164 ]
INFO:root:Epoch 20    loss=0.1779 [135.7 s]	 dev=(HR@5:0.5408,NDCG@5:0.3821) test=(HR@5:0.5069,NDCG@5:0.3609) [31.3 s] 
INFO:root:all_losses: [0.177286   0.61046773]
INFO:root:Epoch 21    loss=0.1773 [136.5 s]	 dev=(HR@5:0.5196,NDCG@5:0.3753) test=(HR@5:0.5069,NDCG@5:0.3528) [31.1 s] 
INFO:root:all_losses: [0.17026165 0.6051886 ]
INFO:root:Epoch 22    loss=0.1703 [135.7 s]	 dev=(HR@5:0.5313,NDCG@5:0.3806) test=(HR@5:0.4910,NDCG@5:0.3489) [31.1 s] 
INFO:root:all_losses: [0.17380531 0.59936947]
INFO:root:Epoch 23    loss=0.1738 [135.4 s]	 dev=(HR@5:0.5461,NDCG@5:0.3884) test=(HR@5:0.4984,NDCG@5:0.3489) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16919291 0.5946788 ]
INFO:root:Epoch 24    loss=0.1692 [136.2 s]	 dev=(HR@5:0.5525,NDCG@5:0.3980) test=(HR@5:0.5154,NDCG@5:0.3582) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16723882 0.5875188 ]
INFO:root:Epoch 25    loss=0.1672 [135.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.3968) test=(HR@5:0.5080,NDCG@5:0.3542) [30.9 s] 
INFO:root:all_losses: [0.16400157 0.58256865]
INFO:root:Epoch 26    loss=0.1640 [135.9 s]	 dev=(HR@5:0.5504,NDCG@5:0.3906) test=(HR@5:0.5027,NDCG@5:0.3471) [33.8 s] 
INFO:root:all_losses: [0.16190208 0.5771592 ]
INFO:root:Epoch 27    loss=0.1619 [268.6 s]	 dev=(HR@5:0.5504,NDCG@5:0.3953) test=(HR@5:0.5048,NDCG@5:0.3455) [59.9 s] 
INFO:root:all_losses: [0.16145453 0.572361  ]
INFO:root:Epoch 28    loss=0.1615 [304.7 s]	 dev=(HR@5:0.5493,NDCG@5:0.3916) test=(HR@5:0.5260,NDCG@5:0.3594) [55.8 s] 
INFO:root:all_losses: [0.15864827 0.5652167 ]
INFO:root:Epoch 29    loss=0.1586 [313.7 s]	 dev=(HR@5:0.5451,NDCG@5:0.3897) test=(HR@5:0.4963,NDCG@5:0.3493) [55.3 s] 
INFO:root:all_losses: [0.15958497 0.5586525 ]
INFO:root:Epoch 30    loss=0.1596 [311.3 s]	 dev=(HR@5:0.5695,NDCG@5:0.4032) test=(HR@5:0.5217,NDCG@5:0.3680) [55.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15826912 0.5527401 ]
INFO:root:Epoch 31    loss=0.1583 [310.3 s]	 dev=(HR@5:0.5440,NDCG@5:0.3861) test=(HR@5:0.4973,NDCG@5:0.3465) [55.3 s] 
INFO:root:all_losses: [0.15503632 0.544083  ]
INFO:root:Epoch 32    loss=0.1550 [320.3 s]	 dev=(HR@5:0.5737,NDCG@5:0.4108) test=(HR@5:0.5133,NDCG@5:0.3597) [55.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15240665 0.53667074]
INFO:root:Epoch 33    loss=0.1524 [319.9 s]	 dev=(HR@5:0.5620,NDCG@5:0.3972) test=(HR@5:0.5048,NDCG@5:0.3570) [55.1 s] 
INFO:root:all_losses: [0.15427296 0.52765405]
INFO:root:Epoch 34    loss=0.1543 [319.8 s]	 dev=(HR@5:0.5557,NDCG@5:0.4033) test=(HR@5:0.5154,NDCG@5:0.3608) [55.4 s] 
INFO:root:all_losses: [0.15058324 0.52205366]
INFO:root:Epoch 35    loss=0.1506 [319.7 s]	 dev=(HR@5:0.5748,NDCG@5:0.4107) test=(HR@5:0.5207,NDCG@5:0.3682) [55.1 s] 
INFO:root:all_losses: [0.1499328  0.51205474]
INFO:root:Epoch 36    loss=0.1499 [319.6 s]	 dev=(HR@5:0.5387,NDCG@5:0.3849) test=(HR@5:0.4783,NDCG@5:0.3391) [55.1 s] 
INFO:root:all_losses: [0.14704947 0.50225276]
INFO:root:Epoch 37    loss=0.1470 [319.4 s]	 dev=(HR@5:0.5610,NDCG@5:0.4016) test=(HR@5:0.5175,NDCG@5:0.3597) [54.9 s] 
INFO:root:all_losses: [0.14761132 0.49518254]
INFO:root:Epoch 38    loss=0.1476 [319.4 s]	 dev=(HR@5:0.5631,NDCG@5:0.4066) test=(HR@5:0.5249,NDCG@5:0.3763) [54.5 s] 
INFO:root:all_losses: [0.14354143 0.48654968]
INFO:root:Epoch 39    loss=0.1435 [319.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.4035) test=(HR@5:0.5440,NDCG@5:0.3770) [54.5 s] 
INFO:root:all_losses: [0.1418332  0.47513393]
INFO:root:Epoch 40    loss=0.1418 [318.8 s]	 dev=(HR@5:0.5695,NDCG@5:0.4029) test=(HR@5:0.5228,NDCG@5:0.3679) [54.3 s] 
INFO:root:all_losses: [0.14304806 0.46491542]
INFO:root:Epoch 41    loss=0.1430 [318.9 s]	 dev=(HR@5:0.5525,NDCG@5:0.3958) test=(HR@5:0.5069,NDCG@5:0.3532) [54.4 s] 
INFO:root:all_losses: [0.14123197 0.4583519 ]
INFO:root:Epoch 42    loss=0.1412 [318.6 s]	 dev=(HR@5:0.5483,NDCG@5:0.3875) test=(HR@5:0.5260,NDCG@5:0.3648) [54.3 s] 
INFO:root:Early stop at 42 based on dev result.
INFO:root:
Best Iter(dev)=   32	 dev=(HR@5:0.5737,NDCG@5:0.4108) test=(HR@5:0.5133,NDCG@5:0.3597) [10235.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6957,HR@5:0.5133,HR@50:0.9618,NDCG@10:0.4185,NDCG@5:0.3597,NDCG@50:0.4795)
INFO:root:
--------------------------------------------- END: 2025-03-24 12:58:02 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-26 14:48:16 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46009585 0.693092  ]
INFO:root:Epoch 1     loss=0.4601 [111.8 s]	 dev=(HR@5:0.2185,NDCG@5:0.1394) test=(HR@5:0.2047,NDCG@5:0.1384) [28.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.42682573 0.69290775]
INFO:root:Epoch 2     loss=0.4268 [154.5 s]	 dev=(HR@5:0.2407,NDCG@5:0.1590) test=(HR@5:0.2238,NDCG@5:0.1477) [29.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34159222 0.69225764]
INFO:root:Epoch 3     loss=0.3416 [140.5 s]	 dev=(HR@5:0.3393,NDCG@5:0.2372) test=(HR@5:0.3075,NDCG@5:0.2102) [28.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.26847282 0.68905973]
INFO:root:Epoch 4     loss=0.2685 [125.6 s]	 dev=(HR@5:0.4793,NDCG@5:0.3397) test=(HR@5:0.4252,NDCG@5:0.2833) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22635308 0.6832251 ]
INFO:root:Epoch 5     loss=0.2264 [136.9 s]	 dev=(HR@5:0.4581,NDCG@5:0.3253) test=(HR@5:0.4136,NDCG@5:0.2819) [32.1 s] 
INFO:root:all_losses: [0.21116818 0.6768314 ]
INFO:root:Epoch 6     loss=0.2112 [136.3 s]	 dev=(HR@5:0.5143,NDCG@5:0.3638) test=(HR@5:0.4846,NDCG@5:0.3299) [31.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20232782 0.671023  ]
INFO:root:Epoch 7     loss=0.2023 [137.2 s]	 dev=(HR@5:0.5164,NDCG@5:0.3584) test=(HR@5:0.4687,NDCG@5:0.3187) [31.6 s] 
INFO:root:all_losses: [0.19899215 0.6652925 ]
INFO:root:Epoch 8     loss=0.1990 [136.5 s]	 dev=(HR@5:0.5186,NDCG@5:0.3657) test=(HR@5:0.4963,NDCG@5:0.3343) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19342941 0.66221374]
INFO:root:Epoch 9     loss=0.1934 [136.6 s]	 dev=(HR@5:0.5451,NDCG@5:0.3771) test=(HR@5:0.4857,NDCG@5:0.3441) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19204263 0.6561803 ]
INFO:root:Epoch 10    loss=0.1920 [136.8 s]	 dev=(HR@5:0.5387,NDCG@5:0.3835) test=(HR@5:0.4793,NDCG@5:0.3418) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18518102 0.65075433]
INFO:root:Epoch 11    loss=0.1852 [136.3 s]	 dev=(HR@5:0.5461,NDCG@5:0.3810) test=(HR@5:0.5196,NDCG@5:0.3649) [31.7 s] 
INFO:root:all_losses: [0.17751634 0.6467229 ]
INFO:root:Epoch 12    loss=0.1775 [137.6 s]	 dev=(HR@5:0.5620,NDCG@5:0.3888) test=(HR@5:0.5228,NDCG@5:0.3590) [31.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17728549 0.6416999 ]
INFO:root:Epoch 13    loss=0.1773 [136.9 s]	 dev=(HR@5:0.5716,NDCG@5:0.3943) test=(HR@5:0.4920,NDCG@5:0.3468) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17209692 0.63703966]
INFO:root:Epoch 14    loss=0.1721 [137.5 s]	 dev=(HR@5:0.5599,NDCG@5:0.3866) test=(HR@5:0.5175,NDCG@5:0.3631) [31.4 s] 
INFO:root:all_losses: [0.17115045 0.63207144]
INFO:root:Epoch 15    loss=0.1712 [137.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.3975) test=(HR@5:0.5122,NDCG@5:0.3595) [31.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16514733 0.6266354 ]
INFO:root:Epoch 16    loss=0.1651 [136.8 s]	 dev=(HR@5:0.5536,NDCG@5:0.3947) test=(HR@5:0.5027,NDCG@5:0.3507) [31.4 s] 
INFO:root:all_losses: [0.1622971 0.6218806]
INFO:root:Epoch 17    loss=0.1623 [137.8 s]	 dev=(HR@5:0.5695,NDCG@5:0.4054) test=(HR@5:0.5133,NDCG@5:0.3665) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16075407 0.61830825]
INFO:root:Epoch 18    loss=0.1608 [136.8 s]	 dev=(HR@5:0.5599,NDCG@5:0.4057) test=(HR@5:0.5260,NDCG@5:0.3721) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15725726 0.6150192 ]
INFO:root:Epoch 19    loss=0.1573 [137.8 s]	 dev=(HR@5:0.5737,NDCG@5:0.4013) test=(HR@5:0.5292,NDCG@5:0.3738) [31.3 s] 
INFO:root:all_losses: [0.15781698 0.60964024]
INFO:root:Epoch 20    loss=0.1578 [137.5 s]	 dev=(HR@5:0.5716,NDCG@5:0.4086) test=(HR@5:0.5451,NDCG@5:0.3869) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15581098 0.6058783 ]
INFO:root:Epoch 21    loss=0.1558 [137.2 s]	 dev=(HR@5:0.5546,NDCG@5:0.3937) test=(HR@5:0.5387,NDCG@5:0.3861) [31.4 s] 
INFO:root:all_losses: [0.1499614 0.6015808]
INFO:root:Epoch 22    loss=0.1500 [137.4 s]	 dev=(HR@5:0.5705,NDCG@5:0.4091) test=(HR@5:0.5355,NDCG@5:0.3813) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.153479  0.5973577]
INFO:root:Epoch 23    loss=0.1535 [137.8 s]	 dev=(HR@5:0.5811,NDCG@5:0.4132) test=(HR@5:0.5408,NDCG@5:0.3786) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14822875 0.5932877 ]
INFO:root:Epoch 24    loss=0.1482 [139.8 s]	 dev=(HR@5:0.5801,NDCG@5:0.4112) test=(HR@5:0.5143,NDCG@5:0.3752) [32.9 s] 
INFO:root:all_losses: [0.14767958 0.58784276]
INFO:root:Epoch 25    loss=0.1477 [137.8 s]	 dev=(HR@5:0.5705,NDCG@5:0.4124) test=(HR@5:0.5493,NDCG@5:0.3816) [31.4 s] 
INFO:root:all_losses: [0.14477833 0.5843474 ]
INFO:root:Epoch 26    loss=0.1448 [138.0 s]	 dev=(HR@5:0.5885,NDCG@5:0.4130) test=(HR@5:0.5313,NDCG@5:0.3718) [31.3 s] 
INFO:root:all_losses: [0.14262685 0.58005726]
INFO:root:Epoch 27    loss=0.1426 [138.6 s]	 dev=(HR@5:0.5854,NDCG@5:0.4151) test=(HR@5:0.5313,NDCG@5:0.3759) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14216043 0.57616895]
INFO:root:Epoch 28    loss=0.1422 [137.8 s]	 dev=(HR@5:0.5949,NDCG@5:0.4184) test=(HR@5:0.5387,NDCG@5:0.3781) [31.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13922031 0.57087743]
INFO:root:Epoch 29    loss=0.1392 [138.2 s]	 dev=(HR@5:0.6013,NDCG@5:0.4228) test=(HR@5:0.5398,NDCG@5:0.3783) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14049678 0.5643796 ]
INFO:root:Epoch 30    loss=0.1405 [138.0 s]	 dev=(HR@5:0.6066,NDCG@5:0.4215) test=(HR@5:0.5366,NDCG@5:0.3792) [31.7 s] 
INFO:root:all_losses: [0.14066392 0.5598628 ]
INFO:root:Epoch 31    loss=0.1407 [137.8 s]	 dev=(HR@5:0.6002,NDCG@5:0.4234) test=(HR@5:0.5419,NDCG@5:0.3903) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13680303 0.5533954 ]
INFO:root:Epoch 32    loss=0.1368 [138.3 s]	 dev=(HR@5:0.6013,NDCG@5:0.4326) test=(HR@5:0.5429,NDCG@5:0.3883) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13418381 0.5477155 ]
INFO:root:Epoch 33    loss=0.1342 [137.9 s]	 dev=(HR@5:0.5779,NDCG@5:0.4119) test=(HR@5:0.5334,NDCG@5:0.3720) [31.5 s] 
INFO:root:all_losses: [0.13609643 0.5414487 ]
INFO:root:Epoch 34    loss=0.1361 [138.3 s]	 dev=(HR@5:0.5949,NDCG@5:0.4260) test=(HR@5:0.5451,NDCG@5:0.3806) [31.4 s] 
INFO:root:all_losses: [0.13356328 0.5369642 ]
INFO:root:Epoch 35    loss=0.1336 [137.7 s]	 dev=(HR@5:0.6013,NDCG@5:0.4317) test=(HR@5:0.5366,NDCG@5:0.3779) [31.4 s] 
INFO:root:all_losses: [0.13135427 0.5315183 ]
INFO:root:Epoch 36    loss=0.1314 [138.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4145) test=(HR@5:0.5440,NDCG@5:0.3776) [31.7 s] 
INFO:root:all_losses: [0.12961043 0.5247045 ]
INFO:root:Epoch 37    loss=0.1296 [137.9 s]	 dev=(HR@5:0.6108,NDCG@5:0.4372) test=(HR@5:0.5345,NDCG@5:0.3783) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12971453 0.5205931 ]
INFO:root:Epoch 38    loss=0.1297 [137.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4245) test=(HR@5:0.5578,NDCG@5:0.3928) [31.2 s] 
INFO:root:all_losses: [0.12567805 0.51544505]
INFO:root:Epoch 39    loss=0.1257 [138.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4206) test=(HR@5:0.5408,NDCG@5:0.3808) [31.5 s] 
INFO:root:all_losses: [0.12453529 0.5092054 ]
INFO:root:Epoch 40    loss=0.1245 [137.4 s]	 dev=(HR@5:0.5960,NDCG@5:0.4259) test=(HR@5:0.5387,NDCG@5:0.3870) [31.5 s] 
INFO:root:all_losses: [0.12664562 0.5051931 ]
INFO:root:Epoch 41    loss=0.1266 [137.9 s]	 dev=(HR@5:0.5885,NDCG@5:0.4273) test=(HR@5:0.5451,NDCG@5:0.3839) [31.4 s] 
INFO:root:all_losses: [0.12457984 0.49958798]
INFO:root:Epoch 42    loss=0.1246 [137.9 s]	 dev=(HR@5:0.5620,NDCG@5:0.4153) test=(HR@5:0.5228,NDCG@5:0.3811) [31.2 s] 
INFO:root:all_losses: [0.12292571 0.49338165]
INFO:root:Epoch 43    loss=0.1229 [137.8 s]	 dev=(HR@5:0.5843,NDCG@5:0.4216) test=(HR@5:0.5260,NDCG@5:0.3805) [31.3 s] 
INFO:root:all_losses: [0.12329634 0.4906473 ]
INFO:root:Epoch 44    loss=0.1233 [138.5 s]	 dev=(HR@5:0.5748,NDCG@5:0.4127) test=(HR@5:0.5472,NDCG@5:0.3903) [31.4 s] 
INFO:root:all_losses: [0.11986841 0.4857007 ]
INFO:root:Epoch 45    loss=0.1199 [284.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4212) test=(HR@5:0.5483,NDCG@5:0.3919) [58.9 s] 
INFO:root:all_losses: [0.12033796 0.48204538]
INFO:root:Epoch 46    loss=0.1203 [322.6 s]	 dev=(HR@5:0.5758,NDCG@5:0.4122) test=(HR@5:0.5323,NDCG@5:0.3821) [58.9 s] 
INFO:root:all_losses: [0.12069966 0.47647893]
INFO:root:Epoch 47    loss=0.1207 [322.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4138) test=(HR@5:0.5302,NDCG@5:0.3682) [58.8 s] 
INFO:root:all_losses: [0.11619348 0.4712816 ]
INFO:root:Epoch 48    loss=0.1162 [322.6 s]	 dev=(HR@5:0.5790,NDCG@5:0.4161) test=(HR@5:0.5419,NDCG@5:0.3825) [58.7 s] 
INFO:root:all_losses: [0.11748711 0.46669093]
INFO:root:Epoch 49    loss=0.1175 [323.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4093) test=(HR@5:0.5323,NDCG@5:0.3770) [58.8 s] 
INFO:root:all_losses: [0.11500711 0.46437258]
INFO:root:Epoch 50    loss=0.1150 [323.4 s]	 dev=(HR@5:0.5801,NDCG@5:0.4116) test=(HR@5:0.5292,NDCG@5:0.3730) [58.6 s] 
INFO:root:all_losses: [0.11590971 0.4596833 ]
INFO:root:Epoch 51    loss=0.1159 [323.4 s]	 dev=(HR@5:0.5938,NDCG@5:0.4264) test=(HR@5:0.5408,NDCG@5:0.3830) [58.7 s] 
INFO:root:all_losses: [0.11611842 0.45676216]
INFO:root:Epoch 52    loss=0.1161 [322.5 s]	 dev=(HR@5:0.6002,NDCG@5:0.4228) test=(HR@5:0.5419,NDCG@5:0.3791) [58.3 s] 
INFO:root:all_losses: [0.11382862 0.4515713 ]
INFO:root:Epoch 53    loss=0.1138 [325.9 s]	 dev=(HR@5:0.5822,NDCG@5:0.4172) test=(HR@5:0.5143,NDCG@5:0.3651) [58.1 s] 
INFO:root:all_losses: [0.11274547 0.4474344 ]
INFO:root:Epoch 54    loss=0.1127 [331.7 s]	 dev=(HR@5:0.5938,NDCG@5:0.4233) test=(HR@5:0.5122,NDCG@5:0.3626) [58.2 s] 
INFO:root:all_losses: [0.11215001 0.44250715]
INFO:root:Epoch 55    loss=0.1122 [343.7 s]	 dev=(HR@5:0.5896,NDCG@5:0.4120) test=(HR@5:0.5313,NDCG@5:0.3769) [58.5 s] 
INFO:root:all_losses: [0.11153203 0.43880603]
INFO:root:Epoch 56    loss=0.1115 [349.8 s]	 dev=(HR@5:0.5938,NDCG@5:0.4235) test=(HR@5:0.5302,NDCG@5:0.3809) [58.4 s] 
INFO:root:all_losses: [0.11074594 0.43666676]
INFO:root:Epoch 57    loss=0.1107 [349.9 s]	 dev=(HR@5:0.6076,NDCG@5:0.4359) test=(HR@5:0.5260,NDCG@5:0.3762) [58.1 s] 
INFO:root:Early stop at 57 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.6108,NDCG@5:0.4372) test=(HR@5:0.5345,NDCG@5:0.3783) [12423.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7211,HR@5:0.5345,HR@50:0.9639,NDCG@10:0.4389,NDCG@5:0.3783,NDCG@50:0.4954)
INFO:root:
--------------------------------------------- END: 2025-03-26 18:16:05 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-30 16:55:22 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46005833 0.6930924 ]
INFO:root:Epoch 1     loss=0.4601 [118.8 s]	 dev=(HR@5:0.2153,NDCG@5:0.1383) test=(HR@5:0.2025,NDCG@5:0.1385) [28.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.42363182 0.69291943]
INFO:root:Epoch 2     loss=0.4236 [137.7 s]	 dev=(HR@5:0.2630,NDCG@5:0.1750) test=(HR@5:0.2291,NDCG@5:0.1561) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34158126 0.69229764]
INFO:root:Epoch 3     loss=0.3416 [130.8 s]	 dev=(HR@5:0.4528,NDCG@5:0.3130) test=(HR@5:0.4030,NDCG@5:0.2702) [28.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23866814 0.6882639 ]
INFO:root:Epoch 4     loss=0.2387 [130.4 s]	 dev=(HR@5:0.4952,NDCG@5:0.3437) test=(HR@5:0.4231,NDCG@5:0.2814) [32.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2204388 0.683586 ]
INFO:root:Epoch 5     loss=0.2204 [145.6 s]	 dev=(HR@5:0.4592,NDCG@5:0.3197) test=(HR@5:0.4146,NDCG@5:0.2749) [32.5 s] 
INFO:root:all_losses: [0.20841995 0.6792309 ]
INFO:root:Epoch 6     loss=0.2084 [146.5 s]	 dev=(HR@5:0.5154,NDCG@5:0.3643) test=(HR@5:0.4772,NDCG@5:0.3250) [32.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20070185 0.67537254]
INFO:root:Epoch 7     loss=0.2007 [145.4 s]	 dev=(HR@5:0.5196,NDCG@5:0.3606) test=(HR@5:0.4698,NDCG@5:0.3197) [32.4 s] 
INFO:root:all_losses: [0.19840012 0.6709932 ]
INFO:root:Epoch 8     loss=0.1984 [146.2 s]	 dev=(HR@5:0.5345,NDCG@5:0.3780) test=(HR@5:0.4984,NDCG@5:0.3371) [32.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19196075 0.66831684]
INFO:root:Epoch 9     loss=0.1920 [146.7 s]	 dev=(HR@5:0.5514,NDCG@5:0.3849) test=(HR@5:0.5090,NDCG@5:0.3503) [33.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19098997 0.663454  ]
INFO:root:Epoch 10    loss=0.1910 [146.1 s]	 dev=(HR@5:0.5387,NDCG@5:0.3765) test=(HR@5:0.4666,NDCG@5:0.3308) [32.4 s] 
INFO:root:all_losses: [0.18437359 0.6591741 ]
INFO:root:Epoch 11    loss=0.1844 [145.2 s]	 dev=(HR@5:0.5440,NDCG@5:0.3837) test=(HR@5:0.4942,NDCG@5:0.3435) [32.6 s] 
INFO:root:all_losses: [0.177935  0.6560667]
INFO:root:Epoch 12    loss=0.1779 [145.8 s]	 dev=(HR@5:0.5567,NDCG@5:0.3936) test=(HR@5:0.5207,NDCG@5:0.3555) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17722206 0.6517211 ]
INFO:root:Epoch 13    loss=0.1772 [145.7 s]	 dev=(HR@5:0.5811,NDCG@5:0.4034) test=(HR@5:0.5016,NDCG@5:0.3502) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17218524 0.6480537 ]
INFO:root:Epoch 14    loss=0.1722 [145.2 s]	 dev=(HR@5:0.5705,NDCG@5:0.3966) test=(HR@5:0.5080,NDCG@5:0.3581) [31.9 s] 
INFO:root:all_losses: [0.17117722 0.6436671 ]
INFO:root:Epoch 15    loss=0.1712 [145.0 s]	 dev=(HR@5:0.5695,NDCG@5:0.4012) test=(HR@5:0.5048,NDCG@5:0.3558) [32.1 s] 
INFO:root:all_losses: [0.16611065 0.6392626 ]
INFO:root:Epoch 16    loss=0.1661 [145.8 s]	 dev=(HR@5:0.5652,NDCG@5:0.4015) test=(HR@5:0.5069,NDCG@5:0.3510) [31.9 s] 
INFO:root:all_losses: [0.16336834 0.63498574]
INFO:root:Epoch 17    loss=0.1634 [145.4 s]	 dev=(HR@5:0.5885,NDCG@5:0.4204) test=(HR@5:0.5249,NDCG@5:0.3692) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16179313 0.6316176 ]
INFO:root:Epoch 18    loss=0.1618 [144.4 s]	 dev=(HR@5:0.5642,NDCG@5:0.4005) test=(HR@5:0.4942,NDCG@5:0.3478) [31.8 s] 
INFO:root:all_losses: [0.15881874 0.6288161 ]
INFO:root:Epoch 19    loss=0.1588 [144.9 s]	 dev=(HR@5:0.5843,NDCG@5:0.4118) test=(HR@5:0.5334,NDCG@5:0.3771) [31.6 s] 
INFO:root:all_losses: [0.15878506 0.6240029 ]
INFO:root:Epoch 20    loss=0.1588 [145.1 s]	 dev=(HR@5:0.5960,NDCG@5:0.4327) test=(HR@5:0.5313,NDCG@5:0.3912) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15698083 0.6212653 ]
INFO:root:Epoch 21    loss=0.1570 [144.4 s]	 dev=(HR@5:0.5663,NDCG@5:0.4043) test=(HR@5:0.5398,NDCG@5:0.3859) [31.7 s] 
INFO:root:all_losses: [0.15052497 0.6181754 ]
INFO:root:Epoch 22    loss=0.1505 [144.4 s]	 dev=(HR@5:0.5801,NDCG@5:0.4184) test=(HR@5:0.5133,NDCG@5:0.3726) [31.7 s] 
INFO:root:all_losses: [0.15460461 0.6142961 ]
INFO:root:Epoch 23    loss=0.1546 [144.7 s]	 dev=(HR@5:0.5907,NDCG@5:0.4258) test=(HR@5:0.5313,NDCG@5:0.3813) [31.5 s] 
INFO:root:all_losses: [0.14937042 0.61208206]
INFO:root:Epoch 24    loss=0.1494 [140.6 s]	 dev=(HR@5:0.5970,NDCG@5:0.4277) test=(HR@5:0.5313,NDCG@5:0.3851) [31.4 s] 
INFO:root:all_losses: [0.14837863 0.6074373 ]
INFO:root:Epoch 25    loss=0.1484 [141.1 s]	 dev=(HR@5:0.6034,NDCG@5:0.4269) test=(HR@5:0.5270,NDCG@5:0.3785) [31.7 s] 
INFO:root:all_losses: [0.14488874 0.6042746 ]
INFO:root:Epoch 26    loss=0.1449 [140.1 s]	 dev=(HR@5:0.6023,NDCG@5:0.4271) test=(HR@5:0.5408,NDCG@5:0.3845) [31.3 s] 
INFO:root:all_losses: [0.14273567 0.6012038 ]
INFO:root:Epoch 27    loss=0.1427 [140.7 s]	 dev=(HR@5:0.6013,NDCG@5:0.4204) test=(HR@5:0.5451,NDCG@5:0.3842) [31.4 s] 
INFO:root:all_losses: [0.14309174 0.59999293]
INFO:root:Epoch 28    loss=0.1431 [140.4 s]	 dev=(HR@5:0.5949,NDCG@5:0.4259) test=(HR@5:0.5323,NDCG@5:0.3821) [31.6 s] 
INFO:root:all_losses: [0.14007303 0.59532285]
INFO:root:Epoch 29    loss=0.1401 [140.0 s]	 dev=(HR@5:0.6034,NDCG@5:0.4328) test=(HR@5:0.5366,NDCG@5:0.3877) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14188428 0.5910806 ]
INFO:root:Epoch 30    loss=0.1419 [140.7 s]	 dev=(HR@5:0.6066,NDCG@5:0.4304) test=(HR@5:0.5493,NDCG@5:0.3915) [31.4 s] 
INFO:root:all_losses: [0.14055893 0.58896214]
INFO:root:Epoch 31    loss=0.1406 [139.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4226) test=(HR@5:0.5260,NDCG@5:0.3762) [31.3 s] 
INFO:root:all_losses: [0.13793676 0.5844134 ]
INFO:root:Epoch 32    loss=0.1379 [140.8 s]	 dev=(HR@5:0.6034,NDCG@5:0.4327) test=(HR@5:0.5334,NDCG@5:0.3784) [31.2 s] 
INFO:root:all_losses: [0.13507321 0.5812689 ]
INFO:root:Epoch 33    loss=0.1351 [140.2 s]	 dev=(HR@5:0.5801,NDCG@5:0.4175) test=(HR@5:0.5249,NDCG@5:0.3791) [31.1 s] 
INFO:root:all_losses: [0.13771407 0.57809025]
INFO:root:Epoch 34    loss=0.1377 [140.3 s]	 dev=(HR@5:0.6013,NDCG@5:0.4250) test=(HR@5:0.5376,NDCG@5:0.3908) [31.1 s] 
INFO:root:all_losses: [0.13407554 0.5751448 ]
INFO:root:Epoch 35    loss=0.1341 [140.0 s]	 dev=(HR@5:0.5875,NDCG@5:0.4186) test=(HR@5:0.5461,NDCG@5:0.3884) [31.0 s] 
INFO:root:all_losses: [0.13299663 0.57095623]
INFO:root:Epoch 36    loss=0.1330 [139.9 s]	 dev=(HR@5:0.5864,NDCG@5:0.4213) test=(HR@5:0.5313,NDCG@5:0.3768) [31.3 s] 
INFO:root:all_losses: [0.13030444 0.56822884]
INFO:root:Epoch 37    loss=0.1303 [140.5 s]	 dev=(HR@5:0.6098,NDCG@5:0.4350) test=(HR@5:0.5451,NDCG@5:0.3843) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13311097 0.5635704 ]
INFO:root:Epoch 38    loss=0.1331 [139.7 s]	 dev=(HR@5:0.5960,NDCG@5:0.4187) test=(HR@5:0.5536,NDCG@5:0.4073) [30.6 s] 
INFO:root:all_losses: [0.12808053 0.56052697]
INFO:root:Epoch 39    loss=0.1281 [140.2 s]	 dev=(HR@5:0.5896,NDCG@5:0.4284) test=(HR@5:0.5451,NDCG@5:0.3878) [31.1 s] 
INFO:root:all_losses: [0.12574165 0.55585134]
INFO:root:Epoch 40    loss=0.1257 [139.6 s]	 dev=(HR@5:0.6034,NDCG@5:0.4275) test=(HR@5:0.5557,NDCG@5:0.3951) [30.9 s] 
INFO:root:all_losses: [0.12861699 0.55172557]
INFO:root:Epoch 41    loss=0.1286 [140.0 s]	 dev=(HR@5:0.5960,NDCG@5:0.4256) test=(HR@5:0.5504,NDCG@5:0.3941) [31.0 s] 
INFO:root:all_losses: [0.12630585 0.5503242 ]
INFO:root:Epoch 42    loss=0.1263 [140.1 s]	 dev=(HR@5:0.5811,NDCG@5:0.4232) test=(HR@5:0.5578,NDCG@5:0.4091) [30.8 s] 
INFO:root:all_losses: [0.12489415 0.54481214]
INFO:root:Epoch 43    loss=0.1249 [139.6 s]	 dev=(HR@5:0.5854,NDCG@5:0.4205) test=(HR@5:0.5398,NDCG@5:0.3884) [31.0 s] 
INFO:root:Early stop at 43 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.6098,NDCG@5:0.4350) test=(HR@5:0.5451,NDCG@5:0.3843) [7437.8 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7179,HR@5:0.5451,HR@50:0.9629,NDCG@10:0.4398,NDCG@5:0.3843,NDCG@50:0.4970)
INFO:root:
--------------------------------------------- END: 2025-03-30 18:59:50 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-30 19:12:06 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.4600358 0.6930921]
INFO:root:Epoch 1     loss=0.4600 [117.0 s]	 dev=(HR@5:0.2163,NDCG@5:0.1388) test=(HR@5:0.2036,NDCG@5:0.1389) [28.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43722588 0.69292015]
INFO:root:Epoch 2     loss=0.4372 [162.6 s]	 dev=(HR@5:0.2216,NDCG@5:0.1443) test=(HR@5:0.2142,NDCG@5:0.1448) [29.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3890272  0.69269574]
INFO:root:Epoch 3     loss=0.3890 [126.7 s]	 dev=(HR@5:0.2842,NDCG@5:0.1968) test=(HR@5:0.2609,NDCG@5:0.1758) [28.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.29715392 0.6908273 ]
INFO:root:Epoch 4     loss=0.2972 [125.1 s]	 dev=(HR@5:0.4687,NDCG@5:0.3374) test=(HR@5:0.4316,NDCG@5:0.2866) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23272954 0.6848961 ]
INFO:root:Epoch 5     loss=0.2327 [143.2 s]	 dev=(HR@5:0.4507,NDCG@5:0.3153) test=(HR@5:0.4072,NDCG@5:0.2753) [32.0 s] 
INFO:root:all_losses: [0.21336322 0.67782056]
INFO:root:Epoch 6     loss=0.2134 [144.4 s]	 dev=(HR@5:0.5122,NDCG@5:0.3630) test=(HR@5:0.4783,NDCG@5:0.3278) [31.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20348978 0.67160845]
INFO:root:Epoch 7     loss=0.2035 [144.0 s]	 dev=(HR@5:0.5164,NDCG@5:0.3585) test=(HR@5:0.4740,NDCG@5:0.3209) [31.9 s] 
INFO:root:all_losses: [0.19920257 0.6654669 ]
INFO:root:Epoch 8     loss=0.1992 [143.9 s]	 dev=(HR@5:0.5292,NDCG@5:0.3750) test=(HR@5:0.5027,NDCG@5:0.3404) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19286162 0.66172564]
INFO:root:Epoch 9     loss=0.1929 [144.4 s]	 dev=(HR@5:0.5483,NDCG@5:0.3767) test=(HR@5:0.4963,NDCG@5:0.3496) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19138479 0.655645  ]
INFO:root:Epoch 10    loss=0.1914 [144.1 s]	 dev=(HR@5:0.5461,NDCG@5:0.3756) test=(HR@5:0.4687,NDCG@5:0.3330) [31.4 s] 
INFO:root:all_losses: [0.18447779 0.65041655]
INFO:root:Epoch 11    loss=0.1845 [144.0 s]	 dev=(HR@5:0.5567,NDCG@5:0.3913) test=(HR@5:0.5313,NDCG@5:0.3700) [31.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17742133 0.6464087 ]
INFO:root:Epoch 12    loss=0.1774 [144.6 s]	 dev=(HR@5:0.5567,NDCG@5:0.3909) test=(HR@5:0.5239,NDCG@5:0.3602) [31.3 s] 
INFO:root:all_losses: [0.17695956 0.6416373 ]
INFO:root:Epoch 13    loss=0.1770 [143.6 s]	 dev=(HR@5:0.5652,NDCG@5:0.3936) test=(HR@5:0.4931,NDCG@5:0.3488) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17106065 0.63748634]
INFO:root:Epoch 14    loss=0.1711 [144.0 s]	 dev=(HR@5:0.5599,NDCG@5:0.3875) test=(HR@5:0.5154,NDCG@5:0.3609) [31.1 s] 
INFO:root:all_losses: [0.17107648 0.63249844]
INFO:root:Epoch 15    loss=0.1711 [143.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.4028) test=(HR@5:0.5249,NDCG@5:0.3690) [32.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16526556 0.6275991 ]
INFO:root:Epoch 16    loss=0.1653 [144.1 s]	 dev=(HR@5:0.5536,NDCG@5:0.3972) test=(HR@5:0.5048,NDCG@5:0.3540) [31.4 s] 
INFO:root:all_losses: [0.16243389 0.62331015]
INFO:root:Epoch 17    loss=0.1624 [143.7 s]	 dev=(HR@5:0.5737,NDCG@5:0.4109) test=(HR@5:0.5175,NDCG@5:0.3748) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16096911 0.61921126]
INFO:root:Epoch 18    loss=0.1610 [144.0 s]	 dev=(HR@5:0.5801,NDCG@5:0.4100) test=(HR@5:0.5334,NDCG@5:0.3831) [31.3 s] 
INFO:root:all_losses: [0.15777813 0.6162203 ]
INFO:root:Epoch 19    loss=0.1578 [143.4 s]	 dev=(HR@5:0.5790,NDCG@5:0.4067) test=(HR@5:0.5302,NDCG@5:0.3755) [31.1 s] 
INFO:root:all_losses: [0.15776092 0.6104998 ]
INFO:root:Epoch 20    loss=0.1578 [144.2 s]	 dev=(HR@5:0.5864,NDCG@5:0.4193) test=(HR@5:0.5440,NDCG@5:0.3881) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15650876 0.6069024 ]
INFO:root:Epoch 21    loss=0.1565 [143.8 s]	 dev=(HR@5:0.5567,NDCG@5:0.3975) test=(HR@5:0.5281,NDCG@5:0.3848) [31.3 s] 
INFO:root:all_losses: [0.15006413 0.6033308 ]
INFO:root:Epoch 22    loss=0.1501 [143.6 s]	 dev=(HR@5:0.5620,NDCG@5:0.4065) test=(HR@5:0.5302,NDCG@5:0.3778) [31.2 s] 
INFO:root:all_losses: [0.1541487 0.598403 ]
INFO:root:Epoch 23    loss=0.1541 [143.5 s]	 dev=(HR@5:0.5769,NDCG@5:0.4175) test=(HR@5:0.5366,NDCG@5:0.3854) [31.1 s] 
INFO:root:all_losses: [0.14840369 0.596042  ]
INFO:root:Epoch 24    loss=0.1484 [144.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4174) test=(HR@5:0.5302,NDCG@5:0.3837) [31.0 s] 
INFO:root:all_losses: [0.14909306 0.5911055 ]
INFO:root:Epoch 25    loss=0.1491 [143.6 s]	 dev=(HR@5:0.5843,NDCG@5:0.4143) test=(HR@5:0.5536,NDCG@5:0.3897) [30.9 s] 
INFO:root:all_losses: [0.14547239 0.5890959 ]
INFO:root:Epoch 26    loss=0.1455 [143.0 s]	 dev=(HR@5:0.5875,NDCG@5:0.4176) test=(HR@5:0.5376,NDCG@5:0.3831) [31.0 s] 
INFO:root:all_losses: [0.14280589 0.5850967 ]
INFO:root:Epoch 27    loss=0.1428 [143.9 s]	 dev=(HR@5:0.5695,NDCG@5:0.4047) test=(HR@5:0.5355,NDCG@5:0.3795) [31.2 s] 
INFO:root:all_losses: [0.14335088 0.58354396]
INFO:root:Epoch 28    loss=0.1434 [143.6 s]	 dev=(HR@5:0.5885,NDCG@5:0.4252) test=(HR@5:0.5525,NDCG@5:0.3908) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14080834 0.5794431 ]
INFO:root:Epoch 29    loss=0.1408 [143.6 s]	 dev=(HR@5:0.5992,NDCG@5:0.4261) test=(HR@5:0.5366,NDCG@5:0.3785) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1419626 0.5745176]
INFO:root:Epoch 30    loss=0.1420 [143.2 s]	 dev=(HR@5:0.5938,NDCG@5:0.4209) test=(HR@5:0.5398,NDCG@5:0.3845) [30.7 s] 
INFO:root:all_losses: [0.14037904 0.5722711 ]
INFO:root:Epoch 31    loss=0.1404 [143.6 s]	 dev=(HR@5:0.5726,NDCG@5:0.4109) test=(HR@5:0.5387,NDCG@5:0.3804) [30.5 s] 
INFO:root:all_losses: [0.13841312 0.5675272 ]
INFO:root:Epoch 32    loss=0.1384 [143.2 s]	 dev=(HR@5:0.5970,NDCG@5:0.4309) test=(HR@5:0.5451,NDCG@5:0.3929) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13499707 0.56466645]
INFO:root:Epoch 33    loss=0.1350 [143.2 s]	 dev=(HR@5:0.5663,NDCG@5:0.4149) test=(HR@5:0.5249,NDCG@5:0.3776) [30.9 s] 
INFO:root:all_losses: [0.13810635 0.56075305]
INFO:root:Epoch 34    loss=0.1381 [143.3 s]	 dev=(HR@5:0.5726,NDCG@5:0.4147) test=(HR@5:0.5514,NDCG@5:0.3933) [30.4 s] 
INFO:root:all_losses: [0.13491419 0.5575736 ]
INFO:root:Epoch 35    loss=0.1349 [143.6 s]	 dev=(HR@5:0.5938,NDCG@5:0.4314) test=(HR@5:0.5483,NDCG@5:0.3901) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13266346 0.5543463 ]
INFO:root:Epoch 36    loss=0.1327 [144.0 s]	 dev=(HR@5:0.5811,NDCG@5:0.4185) test=(HR@5:0.5260,NDCG@5:0.3737) [30.8 s] 
INFO:root:all_losses: [0.13141082 0.55060554]
INFO:root:Epoch 37    loss=0.1314 [138.5 s]	 dev=(HR@5:0.5864,NDCG@5:0.4222) test=(HR@5:0.5292,NDCG@5:0.3736) [30.7 s] 
INFO:root:all_losses: [0.13132693 0.54841316]
INFO:root:Epoch 38    loss=0.1313 [139.5 s]	 dev=(HR@5:0.5811,NDCG@5:0.4234) test=(HR@5:0.5451,NDCG@5:0.3938) [30.7 s] 
INFO:root:all_losses: [0.1282229  0.54548174]
INFO:root:Epoch 39    loss=0.1282 [138.3 s]	 dev=(HR@5:0.5992,NDCG@5:0.4243) test=(HR@5:0.5578,NDCG@5:0.3959) [30.4 s] 
INFO:root:all_losses: [0.12679844 0.54061216]
INFO:root:Epoch 40    loss=0.1268 [139.8 s]	 dev=(HR@5:0.5970,NDCG@5:0.4305) test=(HR@5:0.5557,NDCG@5:0.3909) [30.4 s] 
INFO:root:all_losses: [0.12959814 0.537033  ]
INFO:root:Epoch 41    loss=0.1296 [138.5 s]	 dev=(HR@5:0.5896,NDCG@5:0.4233) test=(HR@5:0.5398,NDCG@5:0.3845) [30.5 s] 
INFO:root:all_losses: [0.12628633 0.5339921 ]
INFO:root:Epoch 42    loss=0.1263 [137.9 s]	 dev=(HR@5:0.5726,NDCG@5:0.4186) test=(HR@5:0.5472,NDCG@5:0.3862) [30.8 s] 
INFO:root:all_losses: [0.12465435 0.52712786]
INFO:root:Epoch 43    loss=0.1247 [139.3 s]	 dev=(HR@5:0.5811,NDCG@5:0.4177) test=(HR@5:0.5578,NDCG@5:0.3966) [30.4 s] 
INFO:root:all_losses: [0.12558989 0.5243847 ]
INFO:root:Epoch 44    loss=0.1256 [138.5 s]	 dev=(HR@5:0.5769,NDCG@5:0.4141) test=(HR@5:0.5620,NDCG@5:0.4010) [30.5 s] 
INFO:root:Early stop at 44 based on dev result.
INFO:root:
Best Iter(dev)=   35	 dev=(HR@5:0.5938,NDCG@5:0.4314) test=(HR@5:0.5483,NDCG@5:0.3901) [7601.6 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7296,HR@5:0.5483,HR@50:0.9639,NDCG@10:0.4488,NDCG@5:0.3901,NDCG@50:0.5025)
INFO:root:
--------------------------------------------- END: 2025-03-30 21:19:18 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-30 22:09:12 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45954105 0.6930926 ]
INFO:root:Epoch 1     loss=0.4595 [116.1 s]	 dev=(HR@5:0.2174,NDCG@5:0.1382) test=(HR@5:0.2036,NDCG@5:0.1389) [28.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.40922138 0.69294214]
INFO:root:Epoch 2     loss=0.4092 [119.8 s]	 dev=(HR@5:0.2460,NDCG@5:0.1612) test=(HR@5:0.2206,NDCG@5:0.1454) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.35614908 0.6925601 ]
INFO:root:Epoch 3     loss=0.3561 [132.1 s]	 dev=(HR@5:0.3086,NDCG@5:0.2060) test=(HR@5:0.2683,NDCG@5:0.1779) [36.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.30295888 0.6908655 ]
INFO:root:Epoch 4     loss=0.3030 [208.2 s]	 dev=(HR@5:0.4030,NDCG@5:0.2796) test=(HR@5:0.3552,NDCG@5:0.2366) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.27641085 0.6875764 ]
INFO:root:Epoch 5     loss=0.2764 [329.7 s]	 dev=(HR@5:0.4104,NDCG@5:0.2841) test=(HR@5:0.3690,NDCG@5:0.2461) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23718679 0.6819494 ]
INFO:root:Epoch 6     loss=0.2372 [217.2 s]	 dev=(HR@5:0.4836,NDCG@5:0.3387) test=(HR@5:0.4581,NDCG@5:0.3058) [31.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21919905 0.6753475 ]
INFO:root:Epoch 7     loss=0.2192 [142.8 s]	 dev=(HR@5:0.4920,NDCG@5:0.3346) test=(HR@5:0.4624,NDCG@5:0.3021) [31.2 s] 
INFO:root:all_losses: [0.21454602 0.66946566]
INFO:root:Epoch 8     loss=0.2145 [143.1 s]	 dev=(HR@5:0.4878,NDCG@5:0.3411) test=(HR@5:0.4624,NDCG@5:0.3083) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2109959 0.666321 ]
INFO:root:Epoch 9     loss=0.2110 [143.5 s]	 dev=(HR@5:0.5133,NDCG@5:0.3558) test=(HR@5:0.4613,NDCG@5:0.3115) [31.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2102451 0.6607892]
INFO:root:Epoch 10    loss=0.2102 [143.2 s]	 dev=(HR@5:0.4878,NDCG@5:0.3396) test=(HR@5:0.4295,NDCG@5:0.2916) [31.0 s] 
INFO:root:all_losses: [0.20582338 0.6565776 ]
INFO:root:Epoch 11    loss=0.2058 [142.6 s]	 dev=(HR@5:0.5027,NDCG@5:0.3491) test=(HR@5:0.4517,NDCG@5:0.3080) [31.0 s] 
INFO:root:all_losses: [0.19870958 0.65336335]
INFO:root:Epoch 12    loss=0.1987 [142.8 s]	 dev=(HR@5:0.5080,NDCG@5:0.3556) test=(HR@5:0.4655,NDCG@5:0.3127) [30.8 s] 
INFO:root:all_losses: [0.19951235 0.6490463 ]
INFO:root:Epoch 13    loss=0.1995 [143.4 s]	 dev=(HR@5:0.5058,NDCG@5:0.3565) test=(HR@5:0.4528,NDCG@5:0.3155) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19531131 0.64465994]
INFO:root:Epoch 14    loss=0.1953 [143.0 s]	 dev=(HR@5:0.5037,NDCG@5:0.3508) test=(HR@5:0.4624,NDCG@5:0.3151) [30.9 s] 
INFO:root:all_losses: [0.1932862  0.64046246]
INFO:root:Epoch 15    loss=0.1933 [142.7 s]	 dev=(HR@5:0.5164,NDCG@5:0.3597) test=(HR@5:0.4772,NDCG@5:0.3247) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18762478 0.63529515]
INFO:root:Epoch 16    loss=0.1876 [143.2 s]	 dev=(HR@5:0.5186,NDCG@5:0.3594) test=(HR@5:0.4624,NDCG@5:0.3207) [30.8 s] 
INFO:root:all_losses: [0.18524536 0.6300393 ]
INFO:root:Epoch 17    loss=0.1852 [142.6 s]	 dev=(HR@5:0.5398,NDCG@5:0.3819) test=(HR@5:0.4772,NDCG@5:0.3319) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1826464 0.6259738]
INFO:root:Epoch 18    loss=0.1826 [143.3 s]	 dev=(HR@5:0.5398,NDCG@5:0.3741) test=(HR@5:0.4772,NDCG@5:0.3331) [30.8 s] 
INFO:root:all_losses: [0.18058461 0.62244236]
INFO:root:Epoch 19    loss=0.1806 [142.9 s]	 dev=(HR@5:0.5514,NDCG@5:0.3849) test=(HR@5:0.4878,NDCG@5:0.3405) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17903477 0.61557853]
INFO:root:Epoch 20    loss=0.1790 [143.2 s]	 dev=(HR@5:0.5366,NDCG@5:0.3818) test=(HR@5:0.4846,NDCG@5:0.3489) [30.7 s] 
INFO:root:all_losses: [0.17789273 0.610366  ]
INFO:root:Epoch 21    loss=0.1779 [142.9 s]	 dev=(HR@5:0.5270,NDCG@5:0.3717) test=(HR@5:0.4846,NDCG@5:0.3426) [30.8 s] 
INFO:root:all_losses: [0.1714533 0.6046442]
INFO:root:Epoch 22    loss=0.1715 [142.6 s]	 dev=(HR@5:0.5302,NDCG@5:0.3790) test=(HR@5:0.4942,NDCG@5:0.3507) [31.0 s] 
INFO:root:all_losses: [0.17471856 0.5989044 ]
INFO:root:Epoch 23    loss=0.1747 [143.3 s]	 dev=(HR@5:0.5451,NDCG@5:0.3823) test=(HR@5:0.4984,NDCG@5:0.3477) [30.9 s] 
INFO:root:all_losses: [0.16914397 0.59403366]
INFO:root:Epoch 24    loss=0.1691 [142.5 s]	 dev=(HR@5:0.5355,NDCG@5:0.3814) test=(HR@5:0.5037,NDCG@5:0.3511) [30.8 s] 
INFO:root:all_losses: [0.16850825 0.586677  ]
INFO:root:Epoch 25    loss=0.1685 [143.2 s]	 dev=(HR@5:0.5514,NDCG@5:0.3912) test=(HR@5:0.4995,NDCG@5:0.3506) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16499387 0.5812041 ]
INFO:root:Epoch 26    loss=0.1650 [142.7 s]	 dev=(HR@5:0.5440,NDCG@5:0.3811) test=(HR@5:0.4942,NDCG@5:0.3454) [30.4 s] 
INFO:root:all_losses: [0.16290696 0.5761101 ]
INFO:root:Epoch 27    loss=0.1629 [143.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3940) test=(HR@5:0.5016,NDCG@5:0.3533) [30.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16191979 0.5715599 ]
INFO:root:Epoch 28    loss=0.1619 [142.6 s]	 dev=(HR@5:0.5483,NDCG@5:0.3850) test=(HR@5:0.5143,NDCG@5:0.3566) [30.5 s] 
INFO:root:all_losses: [0.15922011 0.5635527 ]
INFO:root:Epoch 29    loss=0.1592 [143.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3888) test=(HR@5:0.4963,NDCG@5:0.3492) [30.2 s] 
INFO:root:all_losses: [0.15990573 0.5578405 ]
INFO:root:Epoch 30    loss=0.1599 [142.9 s]	 dev=(HR@5:0.5642,NDCG@5:0.3973) test=(HR@5:0.5260,NDCG@5:0.3696) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15864147 0.5522022 ]
INFO:root:Epoch 31    loss=0.1586 [142.4 s]	 dev=(HR@5:0.5536,NDCG@5:0.3879) test=(HR@5:0.4995,NDCG@5:0.3562) [30.5 s] 
INFO:root:all_losses: [0.15538037 0.5443584 ]
INFO:root:Epoch 32    loss=0.1554 [143.1 s]	 dev=(HR@5:0.5610,NDCG@5:0.4040) test=(HR@5:0.5186,NDCG@5:0.3596) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15320851 0.53742033]
INFO:root:Epoch 33    loss=0.1532 [142.5 s]	 dev=(HR@5:0.5599,NDCG@5:0.3949) test=(HR@5:0.5101,NDCG@5:0.3613) [30.4 s] 
INFO:root:all_losses: [0.154688   0.52961254]
INFO:root:Epoch 34    loss=0.1547 [143.2 s]	 dev=(HR@5:0.5546,NDCG@5:0.4003) test=(HR@5:0.5133,NDCG@5:0.3572) [30.4 s] 
INFO:root:all_losses: [0.15152171 0.5231526 ]
INFO:root:Epoch 35    loss=0.1515 [142.2 s]	 dev=(HR@5:0.5663,NDCG@5:0.4041) test=(HR@5:0.5196,NDCG@5:0.3666) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15051685 0.5151505 ]
INFO:root:Epoch 36    loss=0.1505 [142.7 s]	 dev=(HR@5:0.5440,NDCG@5:0.3894) test=(HR@5:0.5005,NDCG@5:0.3469) [30.4 s] 
INFO:root:all_losses: [0.1483715  0.50629437]
INFO:root:Epoch 37    loss=0.1484 [142.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.4015) test=(HR@5:0.5175,NDCG@5:0.3621) [30.0 s] 
INFO:root:all_losses: [0.1485786  0.49907896]
INFO:root:Epoch 38    loss=0.1486 [142.7 s]	 dev=(HR@5:0.5589,NDCG@5:0.3970) test=(HR@5:0.5302,NDCG@5:0.3740) [30.3 s] 
INFO:root:all_losses: [0.1458299  0.49139148]
INFO:root:Epoch 39    loss=0.1458 [142.4 s]	 dev=(HR@5:0.5610,NDCG@5:0.3957) test=(HR@5:0.5366,NDCG@5:0.3774) [30.0 s] 
INFO:root:all_losses: [0.14305545 0.4815045 ]
INFO:root:Epoch 40    loss=0.1431 [142.4 s]	 dev=(HR@5:0.5578,NDCG@5:0.3946) test=(HR@5:0.5164,NDCG@5:0.3661) [30.3 s] 
INFO:root:all_losses: [0.14438353 0.47278354]
INFO:root:Epoch 41    loss=0.1444 [142.9 s]	 dev=(HR@5:0.5408,NDCG@5:0.3876) test=(HR@5:0.5196,NDCG@5:0.3606) [30.3 s] 
INFO:root:Early stop at 41 based on dev result.
INFO:root:
Best Iter(dev)=   35	 dev=(HR@5:0.5663,NDCG@5:0.4041) test=(HR@5:0.5196,NDCG@5:0.3666) [7385.3 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.6882,HR@5:0.5196,HR@50:0.9639,NDCG@10:0.4221,NDCG@5:0.3666,NDCG@50:0.4860)
INFO:root:
--------------------------------------------- END: 2025-03-31 00:12:47 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-31 15:30:35 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46010834 0.6930924 ]
INFO:root:Epoch 1     loss=0.4601 [218.4 s]	 dev=(HR@5:0.2195,NDCG@5:0.1397) test=(HR@5:0.2057,NDCG@5:0.1404) [51.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4289708 0.6929041]
INFO:root:Epoch 2     loss=0.4290 [241.1 s]	 dev=(HR@5:0.2471,NDCG@5:0.1588) test=(HR@5:0.2259,NDCG@5:0.1532) [51.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.33755612 0.6921927 ]
INFO:root:Epoch 3     loss=0.3376 [216.0 s]	 dev=(HR@5:0.4083,NDCG@5:0.2883) test=(HR@5:0.3733,NDCG@5:0.2529) [51.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23867834 0.68758017]
INFO:root:Epoch 4     loss=0.2387 [224.0 s]	 dev=(HR@5:0.4984,NDCG@5:0.3514) test=(HR@5:0.4560,NDCG@5:0.3053) [54.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21691546 0.68156517]
INFO:root:Epoch 5     loss=0.2169 [234.6 s]	 dev=(HR@5:0.4910,NDCG@5:0.3454) test=(HR@5:0.4401,NDCG@5:0.2967) [54.1 s] 
INFO:root:all_losses: [0.2041018 0.6755939]
INFO:root:Epoch 6     loss=0.2041 [235.0 s]	 dev=(HR@5:0.5323,NDCG@5:0.3729) test=(HR@5:0.4719,NDCG@5:0.3291) [54.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19589408 0.6704954 ]
INFO:root:Epoch 7     loss=0.1959 [233.8 s]	 dev=(HR@5:0.5398,NDCG@5:0.3766) test=(HR@5:0.4952,NDCG@5:0.3414) [54.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19228005 0.6655359 ]
INFO:root:Epoch 8     loss=0.1923 [235.1 s]	 dev=(HR@5:0.5557,NDCG@5:0.3861) test=(HR@5:0.5111,NDCG@5:0.3537) [54.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18468024 0.662406  ]
INFO:root:Epoch 9     loss=0.1847 [234.2 s]	 dev=(HR@5:0.5652,NDCG@5:0.3950) test=(HR@5:0.5186,NDCG@5:0.3721) [54.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18376766 0.6566342 ]
INFO:root:Epoch 10    loss=0.1838 [234.4 s]	 dev=(HR@5:0.5461,NDCG@5:0.3854) test=(HR@5:0.4899,NDCG@5:0.3469) [54.6 s] 
INFO:root:all_losses: [0.17672372 0.65260106]
INFO:root:Epoch 11    loss=0.1767 [235.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.4047) test=(HR@5:0.5270,NDCG@5:0.3751) [54.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17047186 0.64950544]
INFO:root:Epoch 12    loss=0.1705 [233.4 s]	 dev=(HR@5:0.5779,NDCG@5:0.4056) test=(HR@5:0.5472,NDCG@5:0.3782) [53.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17037264 0.6458669 ]
INFO:root:Epoch 13    loss=0.1704 [235.1 s]	 dev=(HR@5:0.5801,NDCG@5:0.4027) test=(HR@5:0.5175,NDCG@5:0.3657) [53.9 s] 
INFO:root:all_losses: [0.16462152 0.6423719 ]
INFO:root:Epoch 14    loss=0.1646 [234.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.3976) test=(HR@5:0.5090,NDCG@5:0.3596) [53.8 s] 
INFO:root:all_losses: [0.16541968 0.6389328 ]
INFO:root:Epoch 15    loss=0.1654 [234.0 s]	 dev=(HR@5:0.5663,NDCG@5:0.4033) test=(HR@5:0.5366,NDCG@5:0.3841) [53.6 s] 
INFO:root:all_losses: [0.15907733 0.63501287]
INFO:root:Epoch 16    loss=0.1591 [235.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.4015) test=(HR@5:0.5228,NDCG@5:0.3711) [54.1 s] 
INFO:root:all_losses: [0.1578429 0.6314967]
INFO:root:Epoch 17    loss=0.1578 [233.0 s]	 dev=(HR@5:0.5684,NDCG@5:0.4042) test=(HR@5:0.5228,NDCG@5:0.3758) [53.9 s] 
INFO:root:all_losses: [0.15635377 0.6290407 ]
INFO:root:Epoch 18    loss=0.1564 [237.2 s]	 dev=(HR@5:0.5716,NDCG@5:0.4080) test=(HR@5:0.5345,NDCG@5:0.3860) [53.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15327913 0.62695336]
INFO:root:Epoch 19    loss=0.1533 [234.6 s]	 dev=(HR@5:0.5684,NDCG@5:0.4023) test=(HR@5:0.5249,NDCG@5:0.3776) [53.9 s] 
INFO:root:all_losses: [0.15263881 0.62289166]
INFO:root:Epoch 20    loss=0.1526 [234.2 s]	 dev=(HR@5:0.5949,NDCG@5:0.4219) test=(HR@5:0.5483,NDCG@5:0.3956) [54.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15057838 0.6203225 ]
INFO:root:Epoch 21    loss=0.1506 [235.2 s]	 dev=(HR@5:0.5663,NDCG@5:0.4046) test=(HR@5:0.5313,NDCG@5:0.3865) [54.1 s] 
INFO:root:all_losses: [0.14599615 0.61766714]
INFO:root:Epoch 22    loss=0.1460 [234.6 s]	 dev=(HR@5:0.5705,NDCG@5:0.4157) test=(HR@5:0.5323,NDCG@5:0.3924) [54.5 s] 
INFO:root:all_losses: [0.14990309 0.6148792 ]
INFO:root:Epoch 23    loss=0.1499 [234.4 s]	 dev=(HR@5:0.5938,NDCG@5:0.4256) test=(HR@5:0.5345,NDCG@5:0.3881) [54.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1438905 0.6121762]
INFO:root:Epoch 24    loss=0.1439 [233.6 s]	 dev=(HR@5:0.5801,NDCG@5:0.4224) test=(HR@5:0.5504,NDCG@5:0.3949) [53.6 s] 
INFO:root:all_losses: [0.14374907 0.60891324]
INFO:root:Epoch 25    loss=0.1437 [234.4 s]	 dev=(HR@5:0.5854,NDCG@5:0.4204) test=(HR@5:0.5419,NDCG@5:0.3859) [53.9 s] 
INFO:root:all_losses: [0.1408834 0.6076035]
INFO:root:Epoch 26    loss=0.1409 [237.4 s]	 dev=(HR@5:0.5960,NDCG@5:0.4197) test=(HR@5:0.5578,NDCG@5:0.3936) [53.8 s] 
INFO:root:all_losses: [0.13805607 0.60487974]
INFO:root:Epoch 27    loss=0.1381 [233.9 s]	 dev=(HR@5:0.5758,NDCG@5:0.4134) test=(HR@5:0.5355,NDCG@5:0.3795) [53.8 s] 
INFO:root:Early stop at 27 based on dev result.
INFO:root:
Best Iter(dev)=   23	 dev=(HR@5:0.5938,NDCG@5:0.4256) test=(HR@5:0.5345,NDCG@5:0.3881) [7746.4 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7147,HR@5:0.5345,HR@50:0.9661,NDCG@10:0.4471,NDCG@5:0.3881,NDCG@50:0.5049)
INFO:root:
--------------------------------------------- END: 2025-03-31 17:40:35 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-03-31 17:47:45 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46004432 0.6930919 ]
INFO:root:Epoch 1     loss=0.4600 [216.9 s]	 dev=(HR@5:0.2153,NDCG@5:0.1392) test=(HR@5:0.2057,NDCG@5:0.1395) [51.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4385382 0.6929222]
INFO:root:Epoch 2     loss=0.4385 [243.0 s]	 dev=(HR@5:0.2238,NDCG@5:0.1460) test=(HR@5:0.2131,NDCG@5:0.1428) [53.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43875775 0.69275177]
INFO:root:Epoch 3     loss=0.4388 [247.4 s]	 dev=(HR@5:0.2227,NDCG@5:0.1510) test=(HR@5:0.2068,NDCG@5:0.1378) [51.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4341528  0.69262195]
INFO:root:Epoch 4     loss=0.4342 [262.6 s]	 dev=(HR@5:0.2344,NDCG@5:0.1542) test=(HR@5:0.2068,NDCG@5:0.1408) [67.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.4346508  0.69258505]
INFO:root:Epoch 5     loss=0.4347 [249.6 s]	 dev=(HR@5:0.2312,NDCG@5:0.1502) test=(HR@5:0.2047,NDCG@5:0.1388) [68.5 s] 
INFO:root:all_losses: [0.43317816 0.6923093 ]
INFO:root:Epoch 6     loss=0.4332 [250.2 s]	 dev=(HR@5:0.2291,NDCG@5:0.1526) test=(HR@5:0.2153,NDCG@5:0.1448) [68.0 s] 
INFO:root:all_losses: [0.4322297 0.6921853]
INFO:root:Epoch 7     loss=0.4322 [251.5 s]	 dev=(HR@5:0.2301,NDCG@5:0.1524) test=(HR@5:0.2142,NDCG@5:0.1444) [68.0 s] 
INFO:root:all_losses: [0.4327457  0.69206357]
INFO:root:Epoch 8     loss=0.4327 [250.7 s]	 dev=(HR@5:0.2333,NDCG@5:0.1535) test=(HR@5:0.2131,NDCG@5:0.1449) [68.5 s] 
INFO:root:all_losses: [0.43060872 0.6920642 ]
INFO:root:Epoch 9     loss=0.4306 [250.2 s]	 dev=(HR@5:0.2375,NDCG@5:0.1519) test=(HR@5:0.2121,NDCG@5:0.1450) [67.9 s] 
INFO:root:all_losses: [0.43300825 0.6919604 ]
INFO:root:Epoch 10    loss=0.4330 [250.9 s]	 dev=(HR@5:0.2291,NDCG@5:0.1484) test=(HR@5:0.2142,NDCG@5:0.1440) [68.3 s] 
INFO:root:all_losses: [0.43204165 0.69176406]
INFO:root:Epoch 11    loss=0.4320 [252.1 s]	 dev=(HR@5:0.2386,NDCG@5:0.1559) test=(HR@5:0.2121,NDCG@5:0.1427) [68.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.42880565 0.69153535]
INFO:root:Epoch 12    loss=0.4288 [251.8 s]	 dev=(HR@5:0.2407,NDCG@5:0.1572) test=(HR@5:0.2163,NDCG@5:0.1422) [69.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43028986 0.69172406]
INFO:root:Epoch 13    loss=0.4303 [251.7 s]	 dev=(HR@5:0.2344,NDCG@5:0.1539) test=(HR@5:0.2131,NDCG@5:0.1449) [68.6 s] 
INFO:root:all_losses: [0.43135694 0.6914393 ]
INFO:root:Epoch 14    loss=0.4314 [252.1 s]	 dev=(HR@5:0.2344,NDCG@5:0.1512) test=(HR@5:0.2036,NDCG@5:0.1413) [69.5 s] 
INFO:root:all_losses: [0.4280368  0.69140315]
INFO:root:Epoch 15    loss=0.4280 [252.7 s]	 dev=(HR@5:0.2375,NDCG@5:0.1538) test=(HR@5:0.2047,NDCG@5:0.1385) [68.8 s] 
INFO:root:all_losses: [0.42890012 0.6911124 ]
INFO:root:Epoch 16    loss=0.4289 [254.0 s]	 dev=(HR@5:0.2344,NDCG@5:0.1546) test=(HR@5:0.1941,NDCG@5:0.1365) [70.1 s] 
INFO:root:all_losses: [0.42946157 0.6906828 ]
INFO:root:Epoch 17    loss=0.4295 [254.2 s]	 dev=(HR@5:0.2418,NDCG@5:0.1562) test=(HR@5:0.2089,NDCG@5:0.1419) [70.3 s] 
INFO:root:all_losses: [0.42831817 0.69074285]
INFO:root:Epoch 18    loss=0.4283 [253.9 s]	 dev=(HR@5:0.2365,NDCG@5:0.1552) test=(HR@5:0.2068,NDCG@5:0.1396) [70.9 s] 
INFO:root:all_losses: [0.43140748 0.69049156]
INFO:root:Epoch 19    loss=0.4314 [253.1 s]	 dev=(HR@5:0.2301,NDCG@5:0.1523) test=(HR@5:0.2100,NDCG@5:0.1447) [69.4 s] 
INFO:root:all_losses: [0.42970443 0.6900703 ]
INFO:root:Epoch 20    loss=0.4297 [254.9 s]	 dev=(HR@5:0.2428,NDCG@5:0.1573) test=(HR@5:0.2185,NDCG@5:0.1469) [70.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43031523 0.69020027]
INFO:root:Epoch 21    loss=0.4303 [254.4 s]	 dev=(HR@5:0.2269,NDCG@5:0.1498) test=(HR@5:0.2110,NDCG@5:0.1424) [69.9 s] 
INFO:root:all_losses: [0.4288405  0.69027424]
INFO:root:Epoch 22    loss=0.4288 [251.1 s]	 dev=(HR@5:0.2333,NDCG@5:0.1512) test=(HR@5:0.2216,NDCG@5:0.1449) [68.7 s] 
INFO:root:all_losses: [0.42929754 0.6898219 ]
INFO:root:Epoch 23    loss=0.4293 [248.0 s]	 dev=(HR@5:0.2418,NDCG@5:0.1549) test=(HR@5:0.2100,NDCG@5:0.1407) [64.0 s] 
INFO:root:all_losses: [0.42877573 0.68946683]
INFO:root:Epoch 24    loss=0.4288 [244.3 s]	 dev=(HR@5:0.2428,NDCG@5:0.1565) test=(HR@5:0.2089,NDCG@5:0.1419) [63.7 s] 
INFO:root:all_losses: [0.4307453 0.6890351]
INFO:root:Epoch 25    loss=0.4307 [240.3 s]	 dev=(HR@5:0.2365,NDCG@5:0.1549) test=(HR@5:0.2089,NDCG@5:0.1431) [61.4 s] 
INFO:root:all_losses: [0.42826444 0.68924266]
INFO:root:Epoch 26    loss=0.4283 [240.5 s]	 dev=(HR@5:0.2354,NDCG@5:0.1567) test=(HR@5:0.2131,NDCG@5:0.1452) [59.5 s] 
INFO:root:all_losses: [0.4273221  0.68843764]
INFO:root:Epoch 27    loss=0.4273 [239.2 s]	 dev=(HR@5:0.2280,NDCG@5:0.1487) test=(HR@5:0.2131,NDCG@5:0.1455) [60.2 s] 
INFO:root:all_losses: [0.42821136 0.6880672 ]
INFO:root:Epoch 28    loss=0.4282 [241.4 s]	 dev=(HR@5:0.2248,NDCG@5:0.1473) test=(HR@5:0.2100,NDCG@5:0.1400) [60.3 s] 
INFO:root:all_losses: [0.42465043 0.68674344]
INFO:root:Epoch 29    loss=0.4247 [239.4 s]	 dev=(HR@5:0.2354,NDCG@5:0.1502) test=(HR@5:0.2110,NDCG@5:0.1417) [60.7 s] 
INFO:root:all_losses: [0.42796192 0.68460035]
INFO:root:Epoch 30    loss=0.4280 [241.3 s]	 dev=(HR@5:0.2354,NDCG@5:0.1529) test=(HR@5:0.2068,NDCG@5:0.1399) [60.4 s] 
INFO:root:all_losses: [0.4276895  0.68205744]
INFO:root:Epoch 31    loss=0.4277 [239.6 s]	 dev=(HR@5:0.2354,NDCG@5:0.1532) test=(HR@5:0.2153,NDCG@5:0.1439) [59.9 s] 
INFO:root:all_losses: [0.42885482 0.67821515]
INFO:root:Epoch 32    loss=0.4289 [241.3 s]	 dev=(HR@5:0.2407,NDCG@5:0.1525) test=(HR@5:0.2131,NDCG@5:0.1441) [60.3 s] 
INFO:root:all_losses: [0.4263882 0.6713629]
INFO:root:Epoch 33    loss=0.4264 [240.2 s]	 dev=(HR@5:0.2259,NDCG@5:0.1482) test=(HR@5:0.2068,NDCG@5:0.1417) [61.5 s] 
INFO:root:all_losses: [0.42761526 0.6628469 ]
INFO:root:Epoch 34    loss=0.4276 [241.6 s]	 dev=(HR@5:0.2291,NDCG@5:0.1527) test=(HR@5:0.2078,NDCG@5:0.1418) [61.1 s] 
INFO:root:all_losses: [0.4257683 0.6505395]
INFO:root:Epoch 35    loss=0.4258 [240.3 s]	 dev=(HR@5:0.2333,NDCG@5:0.1551) test=(HR@5:0.2131,NDCG@5:0.1441) [60.7 s] 
INFO:root:all_losses: [0.42602345 0.63532495]
INFO:root:Epoch 36    loss=0.4260 [241.6 s]	 dev=(HR@5:0.2439,NDCG@5:0.1566) test=(HR@5:0.2185,NDCG@5:0.1459) [63.5 s] 
INFO:root:all_losses: [0.42293903 0.6172989 ]
INFO:root:Epoch 37    loss=0.4229 [243.3 s]	 dev=(HR@5:0.2407,NDCG@5:0.1572) test=(HR@5:0.2100,NDCG@5:0.1427) [66.8 s] 
INFO:root:all_losses: [0.4237526  0.59258646]
INFO:root:Epoch 38    loss=0.4238 [242.5 s]	 dev=(HR@5:0.2428,NDCG@5:0.1545) test=(HR@5:0.2238,NDCG@5:0.1517) [64.2 s] 
INFO:root:all_losses: [0.4229402 0.565674 ]
INFO:root:Epoch 39    loss=0.4229 [243.2 s]	 dev=(HR@5:0.2259,NDCG@5:0.1501) test=(HR@5:0.2068,NDCG@5:0.1432) [67.0 s] 
INFO:root:all_losses: [0.41952273 0.5359181 ]
INFO:root:Epoch 40    loss=0.4195 [246.0 s]	 dev=(HR@5:0.2386,NDCG@5:0.1524) test=(HR@5:0.2153,NDCG@5:0.1451) [67.0 s] 
INFO:root:Early stop at 40 based on dev result.
INFO:root:
Best Iter(dev)=   20	 dev=(HR@5:0.2428,NDCG@5:0.1573) test=(HR@5:0.2185,NDCG@5:0.1469) [12453.0 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.3393,HR@5:0.2185,HR@50:0.8314,NDCG@10:0.1861,NDCG@5:0.1469,NDCG@50:0.2943)
INFO:root:
--------------------------------------------- END: 2025-03-31 21:16:20 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-01 11:40:31 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46000782 0.6930921 ]
INFO:root:Epoch 1     loss=0.4600 [179.9 s]	 dev=(HR@5:0.2185,NDCG@5:0.1426) test=(HR@5:0.1983,NDCG@5:0.1367) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43840453 0.69292325]
INFO:root:Epoch 2     loss=0.4384 [563.9 s]	 dev=(HR@5:0.2312,NDCG@5:0.1494) test=(HR@5:0.2142,NDCG@5:0.1472) [61.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.40832055 0.6927404 ]
INFO:root:Epoch 3     loss=0.4083 [481.2 s]	 dev=(HR@5:0.3086,NDCG@5:0.2086) test=(HR@5:0.2641,NDCG@5:0.1780) [37.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2924655 0.6910295]
INFO:root:Epoch 4     loss=0.2925 [256.3 s]	 dev=(HR@5:0.4549,NDCG@5:0.3207) test=(HR@5:0.3924,NDCG@5:0.2595) [67.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23090963 0.6850372 ]
INFO:root:Epoch 5     loss=0.2309 [343.3 s]	 dev=(HR@5:0.4358,NDCG@5:0.3034) test=(HR@5:0.3913,NDCG@5:0.2649) [67.6 s] 
INFO:root:all_losses: [0.2125603  0.67781085]
INFO:root:Epoch 6     loss=0.2126 [343.4 s]	 dev=(HR@5:0.5164,NDCG@5:0.3609) test=(HR@5:0.4666,NDCG@5:0.3181) [67.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20206654 0.6712428 ]
INFO:root:Epoch 7     loss=0.2021 [342.9 s]	 dev=(HR@5:0.5090,NDCG@5:0.3513) test=(HR@5:0.4655,NDCG@5:0.3116) [68.0 s] 
INFO:root:all_losses: [0.19735739 0.6647443 ]
INFO:root:Epoch 8     loss=0.1974 [342.6 s]	 dev=(HR@5:0.5355,NDCG@5:0.3721) test=(HR@5:0.5016,NDCG@5:0.3413) [67.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18975174 0.66087824]
INFO:root:Epoch 9     loss=0.1898 [342.4 s]	 dev=(HR@5:0.5472,NDCG@5:0.3830) test=(HR@5:0.4952,NDCG@5:0.3457) [67.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18835275 0.6544372 ]
INFO:root:Epoch 10    loss=0.1884 [342.0 s]	 dev=(HR@5:0.5376,NDCG@5:0.3833) test=(HR@5:0.4761,NDCG@5:0.3356) [67.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18115841 0.6489367 ]
INFO:root:Epoch 11    loss=0.1812 [341.5 s]	 dev=(HR@5:0.5557,NDCG@5:0.3935) test=(HR@5:0.5175,NDCG@5:0.3637) [66.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17446707 0.6453347 ]
INFO:root:Epoch 12    loss=0.1745 [340.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.3976) test=(HR@5:0.5398,NDCG@5:0.3675) [65.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17412063 0.64076537]
INFO:root:Epoch 13    loss=0.1741 [339.7 s]	 dev=(HR@5:0.5620,NDCG@5:0.3929) test=(HR@5:0.4677,NDCG@5:0.3330) [65.7 s] 
INFO:root:all_losses: [0.16827784 0.6366961 ]
INFO:root:Epoch 14    loss=0.1683 [339.6 s]	 dev=(HR@5:0.5673,NDCG@5:0.3896) test=(HR@5:0.5164,NDCG@5:0.3577) [64.7 s] 
INFO:root:all_losses: [0.16801068 0.6324981 ]
INFO:root:Epoch 15    loss=0.1680 [339.8 s]	 dev=(HR@5:0.5801,NDCG@5:0.4006) test=(HR@5:0.5270,NDCG@5:0.3723) [64.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16216788 0.6275851 ]
INFO:root:Epoch 16    loss=0.1622 [339.5 s]	 dev=(HR@5:0.5472,NDCG@5:0.3882) test=(HR@5:0.5037,NDCG@5:0.3496) [64.4 s] 
INFO:root:all_losses: [0.15969974 0.6230889 ]
INFO:root:Epoch 17    loss=0.1597 [339.3 s]	 dev=(HR@5:0.5737,NDCG@5:0.4071) test=(HR@5:0.5207,NDCG@5:0.3748) [64.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15842526 0.61979884]
INFO:root:Epoch 18    loss=0.1584 [338.3 s]	 dev=(HR@5:0.5716,NDCG@5:0.4075) test=(HR@5:0.5270,NDCG@5:0.3736) [64.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15548536 0.6174506 ]
INFO:root:Epoch 19    loss=0.1555 [338.0 s]	 dev=(HR@5:0.5790,NDCG@5:0.4077) test=(HR@5:0.5207,NDCG@5:0.3720) [63.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15444332 0.61242634]
INFO:root:Epoch 20    loss=0.1544 [338.1 s]	 dev=(HR@5:0.5896,NDCG@5:0.4224) test=(HR@5:0.5557,NDCG@5:0.3916) [62.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15304528 0.60969234]
INFO:root:Epoch 21    loss=0.1530 [338.1 s]	 dev=(HR@5:0.5567,NDCG@5:0.3978) test=(HR@5:0.5175,NDCG@5:0.3783) [62.4 s] 
INFO:root:all_losses: [0.1468936 0.6061813]
INFO:root:Epoch 22    loss=0.1469 [337.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4160) test=(HR@5:0.5196,NDCG@5:0.3702) [61.8 s] 
INFO:root:all_losses: [0.1512055 0.6021981]
INFO:root:Epoch 23    loss=0.1512 [336.9 s]	 dev=(HR@5:0.6066,NDCG@5:0.4307) test=(HR@5:0.5483,NDCG@5:0.3867) [61.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14522325 0.59930164]
INFO:root:Epoch 24    loss=0.1452 [326.4 s]	 dev=(HR@5:0.5864,NDCG@5:0.4325) test=(HR@5:0.5461,NDCG@5:0.3871) [62.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14497288 0.5942104 ]
INFO:root:Epoch 25    loss=0.1450 [343.8 s]	 dev=(HR@5:0.5938,NDCG@5:0.4185) test=(HR@5:0.5313,NDCG@5:0.3775) [61.5 s] 
INFO:root:all_losses: [0.14244555 0.59273314]
INFO:root:Epoch 26    loss=0.1424 [338.2 s]	 dev=(HR@5:0.5652,NDCG@5:0.4077) test=(HR@5:0.5249,NDCG@5:0.3694) [61.0 s] 
INFO:root:all_losses: [0.13925412 0.58912814]
INFO:root:Epoch 27    loss=0.1393 [337.9 s]	 dev=(HR@5:0.5695,NDCG@5:0.4119) test=(HR@5:0.5260,NDCG@5:0.3726) [60.7 s] 
INFO:root:all_losses: [0.1394415 0.586909 ]
INFO:root:Epoch 28    loss=0.1394 [337.0 s]	 dev=(HR@5:0.5790,NDCG@5:0.4165) test=(HR@5:0.5345,NDCG@5:0.3819) [60.3 s] 
INFO:root:all_losses: [0.13737418 0.5828183 ]
INFO:root:Epoch 29    loss=0.1374 [336.4 s]	 dev=(HR@5:0.6055,NDCG@5:0.4351) test=(HR@5:0.5387,NDCG@5:0.3838) [60.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1388114  0.57843703]
INFO:root:Epoch 30    loss=0.1388 [336.2 s]	 dev=(HR@5:0.5992,NDCG@5:0.4272) test=(HR@5:0.5461,NDCG@5:0.3890) [60.1 s] 
INFO:root:all_losses: [0.13854688 0.576019  ]
INFO:root:Epoch 31    loss=0.1385 [336.3 s]	 dev=(HR@5:0.5992,NDCG@5:0.4292) test=(HR@5:0.5345,NDCG@5:0.3835) [59.8 s] 
INFO:root:all_losses: [0.1354281 0.5719519]
INFO:root:Epoch 32    loss=0.1354 [335.7 s]	 dev=(HR@5:0.6013,NDCG@5:0.4332) test=(HR@5:0.5610,NDCG@5:0.3995) [59.1 s] 
INFO:root:all_losses: [0.1323634 0.5688432]
INFO:root:Epoch 33    loss=0.1324 [335.6 s]	 dev=(HR@5:0.5960,NDCG@5:0.4219) test=(HR@5:0.5557,NDCG@5:0.3883) [59.0 s] 
INFO:root:all_losses: [0.13484298 0.5644445 ]
INFO:root:Epoch 34    loss=0.1348 [333.6 s]	 dev=(HR@5:0.5843,NDCG@5:0.4200) test=(HR@5:0.5398,NDCG@5:0.3854) [58.8 s] 
INFO:root:all_losses: [0.13149746 0.5614952 ]
INFO:root:Epoch 35    loss=0.1315 [334.7 s]	 dev=(HR@5:0.6055,NDCG@5:0.4364) test=(HR@5:0.5737,NDCG@5:0.4016) [58.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12998359 0.55818236]
INFO:root:Epoch 36    loss=0.1300 [334.4 s]	 dev=(HR@5:0.5705,NDCG@5:0.4170) test=(HR@5:0.5663,NDCG@5:0.3937) [58.3 s] 
INFO:root:all_losses: [0.12818304 0.55398875]
INFO:root:Epoch 37    loss=0.1282 [329.3 s]	 dev=(HR@5:0.6034,NDCG@5:0.4363) test=(HR@5:0.5599,NDCG@5:0.3918) [59.4 s] 
INFO:root:all_losses: [0.12849332 0.5511366 ]
INFO:root:Epoch 38    loss=0.1285 [345.4 s]	 dev=(HR@5:0.6023,NDCG@5:0.4322) test=(HR@5:0.5726,NDCG@5:0.4063) [58.8 s] 
INFO:root:all_losses: [0.12534258 0.5483095 ]
INFO:root:Epoch 39    loss=0.1253 [345.1 s]	 dev=(HR@5:0.6034,NDCG@5:0.4310) test=(HR@5:0.5737,NDCG@5:0.4082) [58.8 s] 
INFO:root:all_losses: [0.12330166 0.54359466]
INFO:root:Epoch 40    loss=0.1233 [345.8 s]	 dev=(HR@5:0.6055,NDCG@5:0.4355) test=(HR@5:0.5726,NDCG@5:0.4042) [58.4 s] 
INFO:root:all_losses: [0.12657002 0.5381411 ]
INFO:root:Epoch 41    loss=0.1266 [263.0 s]	 dev=(HR@5:0.5981,NDCG@5:0.4311) test=(HR@5:0.5610,NDCG@5:0.3949) [31.7 s] 
INFO:root:all_losses: [0.12332471 0.5354234 ]
INFO:root:Epoch 42    loss=0.1233 [155.8 s]	 dev=(HR@5:0.5917,NDCG@5:0.4371) test=(HR@5:0.5631,NDCG@5:0.4044) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12258665 0.5298976 ]
INFO:root:Epoch 43    loss=0.1226 [156.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4293) test=(HR@5:0.5737,NDCG@5:0.3993) [31.6 s] 
INFO:root:all_losses: [0.12116606 0.5259582 ]
INFO:root:Epoch 44    loss=0.1212 [155.2 s]	 dev=(HR@5:0.6045,NDCG@5:0.4370) test=(HR@5:0.5769,NDCG@5:0.4081) [31.6 s] 
INFO:root:all_losses: [0.11882445 0.5225321 ]
INFO:root:Epoch 45    loss=0.1188 [155.4 s]	 dev=(HR@5:0.5822,NDCG@5:0.4245) test=(HR@5:0.5536,NDCG@5:0.3965) [31.4 s] 
INFO:root:all_losses: [0.11890629 0.516881  ]
INFO:root:Epoch 46    loss=0.1189 [155.7 s]	 dev=(HR@5:0.5854,NDCG@5:0.4278) test=(HR@5:0.5599,NDCG@5:0.3969) [31.6 s] 
INFO:root:all_losses: [0.11960718 0.51000136]
INFO:root:Epoch 47    loss=0.1196 [155.1 s]	 dev=(HR@5:0.5864,NDCG@5:0.4319) test=(HR@5:0.5578,NDCG@5:0.3967) [31.5 s] 
INFO:root:all_losses: [0.11578212 0.5065218 ]
INFO:root:Epoch 48    loss=0.1158 [155.8 s]	 dev=(HR@5:0.5769,NDCG@5:0.4210) test=(HR@5:0.5536,NDCG@5:0.3953) [31.3 s] 
INFO:root:all_losses: [0.11746769 0.5003572 ]
INFO:root:Epoch 49    loss=0.1175 [155.0 s]	 dev=(HR@5:0.5992,NDCG@5:0.4274) test=(HR@5:0.5440,NDCG@5:0.3886) [31.5 s] 
INFO:root:all_losses: [0.11442427 0.49562344]
INFO:root:Epoch 50    loss=0.1144 [155.8 s]	 dev=(HR@5:0.6087,NDCG@5:0.4432) test=(HR@5:0.5567,NDCG@5:0.3975) [31.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11564001 0.48967466]
INFO:root:Epoch 51    loss=0.1156 [155.4 s]	 dev=(HR@5:0.5992,NDCG@5:0.4342) test=(HR@5:0.5705,NDCG@5:0.4042) [31.3 s] 
INFO:root:all_losses: [0.11449048 0.48618445]
INFO:root:Epoch 52    loss=0.1145 [155.7 s]	 dev=(HR@5:0.5758,NDCG@5:0.4208) test=(HR@5:0.5726,NDCG@5:0.4098) [31.5 s] 
INFO:root:all_losses: [0.11396664 0.48129216]
INFO:root:Epoch 53    loss=0.1140 [156.0 s]	 dev=(HR@5:0.5769,NDCG@5:0.4174) test=(HR@5:0.5472,NDCG@5:0.3862) [31.5 s] 
INFO:root:all_losses: [0.11005419 0.47706026]
INFO:root:Epoch 54    loss=0.1101 [161.9 s]	 dev=(HR@5:0.5790,NDCG@5:0.4227) test=(HR@5:0.5504,NDCG@5:0.3861) [56.6 s] 
INFO:root:all_losses: [0.11004898 0.47081974]
INFO:root:Epoch 55    loss=0.1100 [343.7 s]	 dev=(HR@5:0.5854,NDCG@5:0.4255) test=(HR@5:0.5663,NDCG@5:0.4007) [56.0 s] 
INFO:root:all_losses: [0.11111908 0.46817276]
INFO:root:Epoch 56    loss=0.1111 [343.0 s]	 dev=(HR@5:0.5779,NDCG@5:0.4192) test=(HR@5:0.5748,NDCG@5:0.4003) [56.0 s] 
INFO:root:all_losses: [0.10913837 0.46285295]
INFO:root:Epoch 57    loss=0.1091 [344.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4246) test=(HR@5:0.5578,NDCG@5:0.3911) [56.0 s] 
INFO:root:all_losses: [0.1063264  0.46159384]
INFO:root:Epoch 58    loss=0.1063 [342.9 s]	 dev=(HR@5:0.5864,NDCG@5:0.4226) test=(HR@5:0.5514,NDCG@5:0.3893) [56.2 s] 
INFO:root:all_losses: [0.10794451 0.45550206]
INFO:root:Epoch 59    loss=0.1079 [343.2 s]	 dev=(HR@5:0.5854,NDCG@5:0.4273) test=(HR@5:0.5684,NDCG@5:0.4007) [55.7 s] 
INFO:root:all_losses: [0.10814116 0.45040172]
INFO:root:Epoch 60    loss=0.1081 [284.8 s]	 dev=(HR@5:0.5790,NDCG@5:0.4227) test=(HR@5:0.5663,NDCG@5:0.4004) [31.0 s] 
INFO:root:all_losses: [0.10763716 0.4471464 ]
INFO:root:Epoch 61    loss=0.1076 [155.5 s]	 dev=(HR@5:0.5843,NDCG@5:0.4183) test=(HR@5:0.5610,NDCG@5:0.4029) [31.1 s] 
INFO:root:all_losses: [0.10427729 0.4432859 ]
INFO:root:Epoch 62    loss=0.1043 [155.9 s]	 dev=(HR@5:0.5716,NDCG@5:0.4190) test=(HR@5:0.5716,NDCG@5:0.4063) [30.9 s] 
INFO:root:all_losses: [0.1054439  0.43892017]
INFO:root:Epoch 63    loss=0.1054 [155.3 s]	 dev=(HR@5:0.5790,NDCG@5:0.4177) test=(HR@5:0.5599,NDCG@5:0.3894) [31.0 s] 
INFO:root:all_losses: [0.10264584 0.43516695]
INFO:root:Epoch 64    loss=0.1026 [155.9 s]	 dev=(HR@5:0.5875,NDCG@5:0.4199) test=(HR@5:0.5567,NDCG@5:0.3961) [31.3 s] 
INFO:root:all_losses: [0.10428569 0.43195125]
INFO:root:Epoch 65    loss=0.1043 [156.7 s]	 dev=(HR@5:0.5716,NDCG@5:0.4151) test=(HR@5:0.5578,NDCG@5:0.3918) [31.2 s] 
INFO:root:all_losses: [0.10295305 0.42858636]
INFO:root:Epoch 66    loss=0.1030 [156.8 s]	 dev=(HR@5:0.5769,NDCG@5:0.4256) test=(HR@5:0.5483,NDCG@5:0.3819) [31.2 s] 
INFO:root:all_losses: [0.1014764  0.42412513]
INFO:root:Epoch 67    loss=0.1015 [157.9 s]	 dev=(HR@5:0.5790,NDCG@5:0.4202) test=(HR@5:0.5610,NDCG@5:0.4017) [31.0 s] 
INFO:root:all_losses: [0.10304476 0.41925448]
INFO:root:Epoch 68    loss=0.1030 [160.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4220) test=(HR@5:0.5610,NDCG@5:0.4003) [31.3 s] 
INFO:root:all_losses: [0.10173578 0.41850013]
INFO:root:Epoch 69    loss=0.1017 [160.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4146) test=(HR@5:0.5483,NDCG@5:0.3903) [31.0 s] 
INFO:root:all_losses: [0.10123644 0.41098213]
INFO:root:Epoch 70    loss=0.1012 [159.6 s]	 dev=(HR@5:0.5748,NDCG@5:0.4196) test=(HR@5:0.5620,NDCG@5:0.4073) [31.0 s] 
INFO:root:Early stop at 70 based on dev result.
INFO:root:
Best Iter(dev)=   50	 dev=(HR@5:0.6087,NDCG@5:0.4432) test=(HR@5:0.5567,NDCG@5:0.3975) [23090.5 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7158,HR@5:0.5567,HR@50:0.9544,NDCG@10:0.4494,NDCG@5:0.3975,NDCG@50:0.5047)
INFO:root:
--------------------------------------------- END: 2025-04-01 18:05:53 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-01 20:02:58 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.4600406 0.6930926]
INFO:root:Epoch 1     loss=0.4600 [189.1 s]	 dev=(HR@5:0.2153,NDCG@5:0.1374) test=(HR@5:0.2036,NDCG@5:0.1384) [38.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.42124113 0.69290453]
INFO:root:Epoch 2     loss=0.4212 [318.1 s]	 dev=(HR@5:0.2651,NDCG@5:0.1760) test=(HR@5:0.2227,NDCG@5:0.1493) [61.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.32053673 0.6920111 ]
INFO:root:Epoch 3     loss=0.3205 [330.8 s]	 dev=(HR@5:0.4581,NDCG@5:0.3191) test=(HR@5:0.4136,NDCG@5:0.2742) [38.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2330163 0.6873703]
INFO:root:Epoch 4     loss=0.2330 [270.3 s]	 dev=(HR@5:0.4878,NDCG@5:0.3399) test=(HR@5:0.4316,NDCG@5:0.2851) [68.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21942648 0.6822727 ]
INFO:root:Epoch 5     loss=0.2194 [357.4 s]	 dev=(HR@5:0.4517,NDCG@5:0.3128) test=(HR@5:0.4072,NDCG@5:0.2702) [69.1 s] 
INFO:root:all_losses: [0.20822205 0.6771008 ]
INFO:root:Epoch 6     loss=0.2082 [356.0 s]	 dev=(HR@5:0.5005,NDCG@5:0.3558) test=(HR@5:0.4592,NDCG@5:0.3170) [68.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19949925 0.6726361 ]
INFO:root:Epoch 7     loss=0.1995 [355.5 s]	 dev=(HR@5:0.5133,NDCG@5:0.3564) test=(HR@5:0.4783,NDCG@5:0.3200) [69.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19611917 0.667766  ]
INFO:root:Epoch 8     loss=0.1961 [354.4 s]	 dev=(HR@5:0.5419,NDCG@5:0.3829) test=(HR@5:0.5122,NDCG@5:0.3444) [68.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18931843 0.6649263 ]
INFO:root:Epoch 9     loss=0.1893 [354.8 s]	 dev=(HR@5:0.5334,NDCG@5:0.3781) test=(HR@5:0.5037,NDCG@5:0.3492) [68.0 s] 
INFO:root:all_losses: [0.18943678 0.6597611 ]
INFO:root:Epoch 10    loss=0.1894 [354.9 s]	 dev=(HR@5:0.5451,NDCG@5:0.3874) test=(HR@5:0.4783,NDCG@5:0.3394) [68.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18196169 0.6556883 ]
INFO:root:Epoch 11    loss=0.1820 [355.6 s]	 dev=(HR@5:0.5642,NDCG@5:0.3972) test=(HR@5:0.5154,NDCG@5:0.3610) [69.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1764923  0.65294874]
INFO:root:Epoch 12    loss=0.1765 [355.5 s]	 dev=(HR@5:0.5514,NDCG@5:0.3855) test=(HR@5:0.5154,NDCG@5:0.3508) [68.1 s] 
INFO:root:all_losses: [0.17685378 0.6488432 ]
INFO:root:Epoch 13    loss=0.1769 [354.8 s]	 dev=(HR@5:0.5599,NDCG@5:0.3937) test=(HR@5:0.4889,NDCG@5:0.3484) [67.4 s] 
INFO:root:all_losses: [0.17120343 0.6457936 ]
INFO:root:Epoch 14    loss=0.1712 [355.8 s]	 dev=(HR@5:0.5684,NDCG@5:0.3898) test=(HR@5:0.5037,NDCG@5:0.3525) [68.2 s] 
INFO:root:all_losses: [0.17108639 0.64183146]
INFO:root:Epoch 15    loss=0.1711 [354.1 s]	 dev=(HR@5:0.5790,NDCG@5:0.4064) test=(HR@5:0.5154,NDCG@5:0.3649) [67.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1655586 0.6375208]
INFO:root:Epoch 16    loss=0.1656 [354.0 s]	 dev=(HR@5:0.5726,NDCG@5:0.4058) test=(HR@5:0.5058,NDCG@5:0.3488) [67.3 s] 
INFO:root:all_losses: [0.16284291 0.63321215]
INFO:root:Epoch 17    loss=0.1628 [353.6 s]	 dev=(HR@5:0.5779,NDCG@5:0.4100) test=(HR@5:0.5111,NDCG@5:0.3555) [67.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16049817 0.62987363]
INFO:root:Epoch 18    loss=0.1605 [322.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4131) test=(HR@5:0.5249,NDCG@5:0.3656) [32.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15833123 0.6273403 ]
INFO:root:Epoch 19    loss=0.1583 [157.0 s]	 dev=(HR@5:0.5822,NDCG@5:0.4142) test=(HR@5:0.5164,NDCG@5:0.3599) [32.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15823385 0.62285155]
INFO:root:Epoch 20    loss=0.1582 [156.9 s]	 dev=(HR@5:0.5960,NDCG@5:0.4249) test=(HR@5:0.5345,NDCG@5:0.3882) [32.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1563123 0.6204247]
INFO:root:Epoch 21    loss=0.1563 [157.3 s]	 dev=(HR@5:0.5673,NDCG@5:0.4102) test=(HR@5:0.5143,NDCG@5:0.3703) [32.7 s] 
INFO:root:all_losses: [0.15003783 0.61747473]
INFO:root:Epoch 22    loss=0.1500 [157.0 s]	 dev=(HR@5:0.5684,NDCG@5:0.4177) test=(HR@5:0.5323,NDCG@5:0.3800) [32.3 s] 
INFO:root:all_losses: [0.15340945 0.6137471 ]
INFO:root:Epoch 23    loss=0.1534 [157.4 s]	 dev=(HR@5:0.5938,NDCG@5:0.4270) test=(HR@5:0.5345,NDCG@5:0.3770) [32.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14880529 0.6112592 ]
INFO:root:Epoch 24    loss=0.1488 [156.8 s]	 dev=(HR@5:0.5875,NDCG@5:0.4289) test=(HR@5:0.5525,NDCG@5:0.3921) [32.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14846885 0.60703856]
INFO:root:Epoch 25    loss=0.1485 [157.2 s]	 dev=(HR@5:0.5917,NDCG@5:0.4211) test=(HR@5:0.5313,NDCG@5:0.3743) [32.2 s] 
INFO:root:all_losses: [0.14484559 0.60445994]
INFO:root:Epoch 26    loss=0.1448 [156.3 s]	 dev=(HR@5:0.5981,NDCG@5:0.4243) test=(HR@5:0.5313,NDCG@5:0.3749) [32.2 s] 
INFO:root:all_losses: [0.14225584 0.6010595 ]
INFO:root:Epoch 27    loss=0.1423 [156.9 s]	 dev=(HR@5:0.5907,NDCG@5:0.4174) test=(HR@5:0.5376,NDCG@5:0.3798) [32.0 s] 
INFO:root:all_losses: [0.1429025 0.6000581]
INFO:root:Epoch 28    loss=0.1429 [157.1 s]	 dev=(HR@5:0.5992,NDCG@5:0.4261) test=(HR@5:0.5387,NDCG@5:0.3774) [32.4 s] 
INFO:root:all_losses: [0.13996746 0.5965461 ]
INFO:root:Epoch 29    loss=0.1400 [156.5 s]	 dev=(HR@5:0.5949,NDCG@5:0.4271) test=(HR@5:0.5186,NDCG@5:0.3672) [32.2 s] 
INFO:root:all_losses: [0.14110543 0.59199107]
INFO:root:Epoch 30    loss=0.1411 [157.0 s]	 dev=(HR@5:0.6013,NDCG@5:0.4281) test=(HR@5:0.5345,NDCG@5:0.3907) [32.1 s] 
INFO:root:all_losses: [0.14102857 0.58947265]
INFO:root:Epoch 31    loss=0.1410 [156.2 s]	 dev=(HR@5:0.5938,NDCG@5:0.4288) test=(HR@5:0.5260,NDCG@5:0.3705) [32.4 s] 
INFO:root:all_losses: [0.13802212 0.5857399 ]
INFO:root:Epoch 32    loss=0.1380 [156.3 s]	 dev=(HR@5:0.6002,NDCG@5:0.4292) test=(HR@5:0.5398,NDCG@5:0.3819) [32.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13528313 0.58317125]
INFO:root:Epoch 33    loss=0.1353 [156.9 s]	 dev=(HR@5:0.5695,NDCG@5:0.4101) test=(HR@5:0.5292,NDCG@5:0.3732) [32.0 s] 
INFO:root:all_losses: [0.13738458 0.5797692 ]
INFO:root:Epoch 34    loss=0.1374 [157.0 s]	 dev=(HR@5:0.5843,NDCG@5:0.4226) test=(HR@5:0.5260,NDCG@5:0.3818) [32.2 s] 
INFO:root:all_losses: [0.13454199 0.5774716 ]
INFO:root:Epoch 35    loss=0.1345 [156.5 s]	 dev=(HR@5:0.5875,NDCG@5:0.4281) test=(HR@5:0.5345,NDCG@5:0.3795) [32.3 s] 
INFO:root:all_losses: [0.13200337 0.57355887]
INFO:root:Epoch 36    loss=0.1320 [156.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4247) test=(HR@5:0.5376,NDCG@5:0.3805) [32.0 s] 
INFO:root:all_losses: [0.13097301 0.5688261 ]
INFO:root:Epoch 37    loss=0.1310 [156.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4186) test=(HR@5:0.5376,NDCG@5:0.3783) [32.0 s] 
INFO:root:all_losses: [0.13280949 0.5662217 ]
INFO:root:Epoch 38    loss=0.1328 [156.1 s]	 dev=(HR@5:0.5960,NDCG@5:0.4294) test=(HR@5:0.5451,NDCG@5:0.3933) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12850304 0.5628543 ]
INFO:root:Epoch 39    loss=0.1285 [156.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4110) test=(HR@5:0.5239,NDCG@5:0.3738) [32.2 s] 
INFO:root:all_losses: [0.12706558 0.5580599 ]
INFO:root:Epoch 40    loss=0.1271 [156.6 s]	 dev=(HR@5:0.5960,NDCG@5:0.4229) test=(HR@5:0.5451,NDCG@5:0.3825) [32.1 s] 
INFO:root:all_losses: [0.12921108 0.5532793 ]
INFO:root:Epoch 41    loss=0.1292 [156.8 s]	 dev=(HR@5:0.5917,NDCG@5:0.4183) test=(HR@5:0.5313,NDCG@5:0.3747) [32.0 s] 
INFO:root:all_losses: [0.1260087 0.5507281]
INFO:root:Epoch 42    loss=0.1260 [155.9 s]	 dev=(HR@5:0.5801,NDCG@5:0.4155) test=(HR@5:0.5419,NDCG@5:0.3921) [32.0 s] 
INFO:root:all_losses: [0.12494136 0.5439875 ]
INFO:root:Epoch 43    loss=0.1249 [156.2 s]	 dev=(HR@5:0.6002,NDCG@5:0.4290) test=(HR@5:0.5419,NDCG@5:0.3799) [32.3 s] 
INFO:root:all_losses: [0.12481023 0.54039663]
INFO:root:Epoch 44    loss=0.1248 [157.0 s]	 dev=(HR@5:0.5981,NDCG@5:0.4287) test=(HR@5:0.5483,NDCG@5:0.3906) [32.3 s] 
INFO:root:all_losses: [0.1225983 0.5363285]
INFO:root:Epoch 45    loss=0.1226 [156.2 s]	 dev=(HR@5:0.5758,NDCG@5:0.4170) test=(HR@5:0.5408,NDCG@5:0.3840) [32.0 s] 
INFO:root:all_losses: [0.12215088 0.53152066]
INFO:root:Epoch 46    loss=0.1222 [156.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4233) test=(HR@5:0.5302,NDCG@5:0.3794) [32.2 s] 
INFO:root:all_losses: [0.12210318 0.5273885 ]
INFO:root:Epoch 47    loss=0.1221 [156.9 s]	 dev=(HR@5:0.5705,NDCG@5:0.4095) test=(HR@5:0.5122,NDCG@5:0.3623) [32.0 s] 
INFO:root:all_losses: [0.11871405 0.523704  ]
INFO:root:Epoch 48    loss=0.1187 [156.5 s]	 dev=(HR@5:0.5843,NDCG@5:0.4097) test=(HR@5:0.5207,NDCG@5:0.3648) [32.3 s] 
INFO:root:all_losses: [0.12045597 0.5186548 ]
INFO:root:Epoch 49    loss=0.1205 [156.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4206) test=(HR@5:0.5313,NDCG@5:0.3712) [32.1 s] 
INFO:root:all_losses: [0.11667687 0.51524323]
INFO:root:Epoch 50    loss=0.1167 [156.2 s]	 dev=(HR@5:0.5875,NDCG@5:0.4179) test=(HR@5:0.5249,NDCG@5:0.3690) [31.9 s] 
INFO:root:all_losses: [0.11908174 0.5101746 ]
INFO:root:Epoch 51    loss=0.1191 [156.9 s]	 dev=(HR@5:0.5970,NDCG@5:0.4190) test=(HR@5:0.5292,NDCG@5:0.3737) [32.3 s] 
INFO:root:all_losses: [0.11812541 0.50642794]
INFO:root:Epoch 52    loss=0.1181 [156.1 s]	 dev=(HR@5:0.5737,NDCG@5:0.4149) test=(HR@5:0.5429,NDCG@5:0.3834) [31.8 s] 
INFO:root:all_losses: [0.11705644 0.50327146]
INFO:root:Epoch 53    loss=0.1171 [156.2 s]	 dev=(HR@5:0.5992,NDCG@5:0.4311) test=(HR@5:0.5419,NDCG@5:0.3775) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11332146 0.49740633]
INFO:root:Epoch 54    loss=0.1133 [156.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4195) test=(HR@5:0.5302,NDCG@5:0.3655) [31.8 s] 
INFO:root:all_losses: [0.1142559  0.49573225]
INFO:root:Epoch 55    loss=0.1143 [155.8 s]	 dev=(HR@5:0.5854,NDCG@5:0.4172) test=(HR@5:0.5557,NDCG@5:0.3836) [31.7 s] 
INFO:root:all_losses: [0.11480526 0.4909392 ]
INFO:root:Epoch 56    loss=0.1148 [156.0 s]	 dev=(HR@5:0.5875,NDCG@5:0.4237) test=(HR@5:0.5429,NDCG@5:0.3795) [31.8 s] 
INFO:root:all_losses: [0.11207285 0.48755798]
INFO:root:Epoch 57    loss=0.1121 [155.7 s]	 dev=(HR@5:0.5811,NDCG@5:0.4231) test=(HR@5:0.5313,NDCG@5:0.3771) [31.9 s] 
INFO:root:all_losses: [0.10919921 0.48492908]
INFO:root:Epoch 58    loss=0.1092 [156.6 s]	 dev=(HR@5:0.5938,NDCG@5:0.4257) test=(HR@5:0.5398,NDCG@5:0.3789) [32.0 s] 
INFO:root:all_losses: [0.11148023 0.48071054]
INFO:root:Epoch 59    loss=0.1115 [155.6 s]	 dev=(HR@5:0.5864,NDCG@5:0.4266) test=(HR@5:0.5536,NDCG@5:0.3922) [32.0 s] 
INFO:root:all_losses: [0.11225331 0.4754661 ]
INFO:root:Epoch 60    loss=0.1123 [156.2 s]	 dev=(HR@5:0.5822,NDCG@5:0.4115) test=(HR@5:0.5292,NDCG@5:0.3781) [31.8 s] 
INFO:root:all_losses: [0.11031636 0.47383493]
INFO:root:Epoch 61    loss=0.1103 [156.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4180) test=(HR@5:0.5334,NDCG@5:0.3776) [31.5 s] 
INFO:root:all_losses: [0.10888274 0.4699015 ]
INFO:root:Epoch 62    loss=0.1089 [155.7 s]	 dev=(HR@5:0.5769,NDCG@5:0.4140) test=(HR@5:0.5270,NDCG@5:0.3720) [31.8 s] 
INFO:root:all_losses: [0.10837481 0.46517897]
INFO:root:Epoch 63    loss=0.1084 [156.2 s]	 dev=(HR@5:0.5832,NDCG@5:0.4107) test=(HR@5:0.5334,NDCG@5:0.3720) [31.8 s] 
INFO:root:all_losses: [0.10780399 0.46296453]
INFO:root:Epoch 64    loss=0.1078 [155.7 s]	 dev=(HR@5:0.5885,NDCG@5:0.4219) test=(HR@5:0.5133,NDCG@5:0.3710) [32.0 s] 
INFO:root:all_losses: [0.10722721 0.4616963 ]
INFO:root:Epoch 65    loss=0.1072 [155.9 s]	 dev=(HR@5:0.5779,NDCG@5:0.4161) test=(HR@5:0.5217,NDCG@5:0.3612) [31.7 s] 
INFO:root:all_losses: [0.10620939 0.45923167]
INFO:root:Epoch 66    loss=0.1062 [155.5 s]	 dev=(HR@5:0.5832,NDCG@5:0.4184) test=(HR@5:0.5154,NDCG@5:0.3599) [31.9 s] 
INFO:root:all_losses: [0.10547505 0.4553668 ]
INFO:root:Epoch 67    loss=0.1055 [156.7 s]	 dev=(HR@5:0.5864,NDCG@5:0.4210) test=(HR@5:0.5408,NDCG@5:0.3827) [32.0 s] 
INFO:root:all_losses: [0.10737865 0.44892678]
INFO:root:Epoch 68    loss=0.1074 [155.4 s]	 dev=(HR@5:0.5928,NDCG@5:0.4262) test=(HR@5:0.5578,NDCG@5:0.3934) [31.4 s] 
INFO:root:all_losses: [0.10514472 0.44950265]
INFO:root:Epoch 69    loss=0.1051 [155.9 s]	 dev=(HR@5:0.5854,NDCG@5:0.4244) test=(HR@5:0.5249,NDCG@5:0.3712) [31.7 s] 
INFO:root:all_losses: [0.10564619 0.44719228]
INFO:root:Epoch 70    loss=0.1056 [155.6 s]	 dev=(HR@5:0.5907,NDCG@5:0.4275) test=(HR@5:0.5419,NDCG@5:0.3892) [31.7 s] 
INFO:root:all_losses: [0.10521562 0.44202778]
INFO:root:Epoch 71    loss=0.1052 [155.7 s]	 dev=(HR@5:0.5885,NDCG@5:0.4163) test=(HR@5:0.5387,NDCG@5:0.3848) [32.0 s] 
INFO:root:all_losses: [0.10510592 0.442597  ]
INFO:root:Epoch 72    loss=0.1051 [155.8 s]	 dev=(HR@5:0.5864,NDCG@5:0.4205) test=(HR@5:0.5355,NDCG@5:0.3799) [31.4 s] 
INFO:root:all_losses: [0.10533004 0.44091064]
INFO:root:Epoch 73    loss=0.1053 [156.1 s]	 dev=(HR@5:0.5748,NDCG@5:0.4010) test=(HR@5:0.5027,NDCG@5:0.3673) [31.4 s] 
INFO:root:Early stop at 73 based on dev result.
INFO:root:
Best Iter(dev)=   53	 dev=(HR@5:0.5992,NDCG@5:0.4311) test=(HR@5:0.5419,NDCG@5:0.3775) [17536.0 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7116,HR@5:0.5419,HR@50:0.9661,NDCG@10:0.4324,NDCG@5:0.3775,NDCG@50:0.4909)
INFO:root:
--------------------------------------------- END: 2025-04-02 00:55:47 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-02 09:12:43 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.45980498 0.6930926 ]
INFO:root:Epoch 1     loss=0.4598 [188.8 s]	 dev=(HR@5:0.2131,NDCG@5:0.1353) test=(HR@5:0.2036,NDCG@5:0.1387) [38.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.41874108 0.6929536 ]
INFO:root:Epoch 2     loss=0.4187 [212.2 s]	 dev=(HR@5:0.2471,NDCG@5:0.1625) test=(HR@5:0.2121,NDCG@5:0.1414) [38.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.34238103 0.6925056 ]
INFO:root:Epoch 3     loss=0.3424 [184.0 s]	 dev=(HR@5:0.4337,NDCG@5:0.3019) test=(HR@5:0.3871,NDCG@5:0.2534) [37.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.25710112 0.69043267]
INFO:root:Epoch 4     loss=0.2571 [254.7 s]	 dev=(HR@5:0.4783,NDCG@5:0.3307) test=(HR@5:0.4295,NDCG@5:0.2874) [56.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23566522 0.68692553]
INFO:root:Epoch 5     loss=0.2357 [331.0 s]	 dev=(HR@5:0.4358,NDCG@5:0.3099) test=(HR@5:0.3849,NDCG@5:0.2597) [57.1 s] 
INFO:root:all_losses: [0.22081801 0.68226993]
INFO:root:Epoch 6     loss=0.2208 [329.9 s]	 dev=(HR@5:0.4973,NDCG@5:0.3485) test=(HR@5:0.4507,NDCG@5:0.3069) [56.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21116745 0.67719674]
INFO:root:Epoch 7     loss=0.2112 [330.8 s]	 dev=(HR@5:0.4942,NDCG@5:0.3464) test=(HR@5:0.4624,NDCG@5:0.3123) [57.0 s] 
INFO:root:all_losses: [0.20614336 0.6714897 ]
INFO:root:Epoch 8     loss=0.2061 [330.4 s]	 dev=(HR@5:0.5239,NDCG@5:0.3750) test=(HR@5:0.4952,NDCG@5:0.3393) [56.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1990409  0.66805446]
INFO:root:Epoch 9     loss=0.1990 [224.7 s]	 dev=(HR@5:0.5387,NDCG@5:0.3775) test=(HR@5:0.4973,NDCG@5:0.3428) [32.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19776712 0.66260517]
INFO:root:Epoch 10    loss=0.1978 [227.7 s]	 dev=(HR@5:0.5366,NDCG@5:0.3737) test=(HR@5:0.4698,NDCG@5:0.3359) [50.2 s] 
INFO:root:all_losses: [0.19075815 0.65784276]
INFO:root:Epoch 11    loss=0.1908 [240.2 s]	 dev=(HR@5:0.5345,NDCG@5:0.3744) test=(HR@5:0.5058,NDCG@5:0.3485) [52.0 s] 
INFO:root:all_losses: [0.18362261 0.6544087 ]
INFO:root:Epoch 12    loss=0.1836 [242.4 s]	 dev=(HR@5:0.5514,NDCG@5:0.3878) test=(HR@5:0.5154,NDCG@5:0.3599) [53.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18385893 0.6499139 ]
INFO:root:Epoch 13    loss=0.1839 [246.3 s]	 dev=(HR@5:0.5419,NDCG@5:0.3849) test=(HR@5:0.5080,NDCG@5:0.3562) [52.8 s] 
INFO:root:all_losses: [0.17844397 0.6466676 ]
INFO:root:Epoch 14    loss=0.1784 [246.9 s]	 dev=(HR@5:0.5472,NDCG@5:0.3863) test=(HR@5:0.5048,NDCG@5:0.3578) [52.7 s] 
INFO:root:all_losses: [0.17714986 0.64235836]
INFO:root:Epoch 15    loss=0.1771 [247.8 s]	 dev=(HR@5:0.5589,NDCG@5:0.3909) test=(HR@5:0.5175,NDCG@5:0.3722) [52.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17209712 0.6372331 ]
INFO:root:Epoch 16    loss=0.1721 [246.6 s]	 dev=(HR@5:0.5483,NDCG@5:0.3849) test=(HR@5:0.5048,NDCG@5:0.3537) [52.6 s] 
INFO:root:all_losses: [0.16907202 0.63283306]
INFO:root:Epoch 17    loss=0.1691 [247.5 s]	 dev=(HR@5:0.5695,NDCG@5:0.4020) test=(HR@5:0.5016,NDCG@5:0.3591) [52.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16645195 0.62910336]
INFO:root:Epoch 18    loss=0.1665 [247.2 s]	 dev=(HR@5:0.5589,NDCG@5:0.3973) test=(HR@5:0.5122,NDCG@5:0.3667) [53.0 s] 
INFO:root:all_losses: [0.16410571 0.6263375 ]
INFO:root:Epoch 19    loss=0.1641 [250.2 s]	 dev=(HR@5:0.5684,NDCG@5:0.4035) test=(HR@5:0.5228,NDCG@5:0.3671) [53.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16424763 0.62137944]
INFO:root:Epoch 20    loss=0.1642 [244.4 s]	 dev=(HR@5:0.5907,NDCG@5:0.4143) test=(HR@5:0.5355,NDCG@5:0.3862) [52.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16245303 0.6180039 ]
INFO:root:Epoch 21    loss=0.1625 [247.5 s]	 dev=(HR@5:0.5483,NDCG@5:0.3919) test=(HR@5:0.5249,NDCG@5:0.3755) [52.7 s] 
INFO:root:all_losses: [0.15597527 0.6137589 ]
INFO:root:Epoch 22    loss=0.1560 [246.6 s]	 dev=(HR@5:0.5525,NDCG@5:0.3960) test=(HR@5:0.5133,NDCG@5:0.3709) [52.6 s] 
INFO:root:all_losses: [0.16043395 0.61012554]
INFO:root:Epoch 23    loss=0.1604 [247.4 s]	 dev=(HR@5:0.5748,NDCG@5:0.4123) test=(HR@5:0.5175,NDCG@5:0.3690) [52.3 s] 
INFO:root:all_losses: [0.15407997 0.6072619 ]
INFO:root:Epoch 24    loss=0.1541 [246.3 s]	 dev=(HR@5:0.5684,NDCG@5:0.4140) test=(HR@5:0.5334,NDCG@5:0.3796) [52.7 s] 
INFO:root:all_losses: [0.1548153  0.60260564]
INFO:root:Epoch 25    loss=0.1548 [247.8 s]	 dev=(HR@5:0.5716,NDCG@5:0.4105) test=(HR@5:0.5249,NDCG@5:0.3664) [52.3 s] 
INFO:root:all_losses: [0.15135574 0.6005382 ]
INFO:root:Epoch 26    loss=0.1514 [246.5 s]	 dev=(HR@5:0.5790,NDCG@5:0.4114) test=(HR@5:0.5207,NDCG@5:0.3655) [52.4 s] 
INFO:root:all_losses: [0.14837357 0.5973246 ]
INFO:root:Epoch 27    loss=0.1484 [245.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4093) test=(HR@5:0.5281,NDCG@5:0.3677) [51.8 s] 
INFO:root:all_losses: [0.14897798 0.59545463]
INFO:root:Epoch 28    loss=0.1490 [244.2 s]	 dev=(HR@5:0.6013,NDCG@5:0.4252) test=(HR@5:0.5429,NDCG@5:0.3762) [52.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14619316 0.5917419 ]
INFO:root:Epoch 29    loss=0.1462 [245.8 s]	 dev=(HR@5:0.5801,NDCG@5:0.4117) test=(HR@5:0.5186,NDCG@5:0.3677) [52.4 s] 
INFO:root:all_losses: [0.14749973 0.5875058 ]
INFO:root:Epoch 30    loss=0.1475 [245.1 s]	 dev=(HR@5:0.5737,NDCG@5:0.4101) test=(HR@5:0.5154,NDCG@5:0.3674) [52.3 s] 
INFO:root:all_losses: [0.1473845  0.58573186]
INFO:root:Epoch 31    loss=0.1474 [246.0 s]	 dev=(HR@5:0.5716,NDCG@5:0.4077) test=(HR@5:0.5101,NDCG@5:0.3647) [52.2 s] 
INFO:root:all_losses: [0.14370857 0.5826302 ]
INFO:root:Epoch 32    loss=0.1437 [246.8 s]	 dev=(HR@5:0.5907,NDCG@5:0.4222) test=(HR@5:0.5323,NDCG@5:0.3743) [52.1 s] 
INFO:root:all_losses: [0.14224012 0.5799125 ]
INFO:root:Epoch 33    loss=0.1422 [245.9 s]	 dev=(HR@5:0.5769,NDCG@5:0.4117) test=(HR@5:0.5313,NDCG@5:0.3743) [52.6 s] 
INFO:root:all_losses: [0.14371474 0.5751391 ]
INFO:root:Epoch 34    loss=0.1437 [245.5 s]	 dev=(HR@5:0.5832,NDCG@5:0.4153) test=(HR@5:0.5217,NDCG@5:0.3690) [52.3 s] 
INFO:root:all_losses: [0.14133103 0.5743801 ]
INFO:root:Epoch 35    loss=0.1413 [246.6 s]	 dev=(HR@5:0.5769,NDCG@5:0.4123) test=(HR@5:0.5302,NDCG@5:0.3783) [52.2 s] 
INFO:root:all_losses: [0.139366 0.570239]
INFO:root:Epoch 36    loss=0.1394 [245.1 s]	 dev=(HR@5:0.5631,NDCG@5:0.4028) test=(HR@5:0.5270,NDCG@5:0.3691) [52.0 s] 
INFO:root:all_losses: [0.13759623 0.5669863 ]
INFO:root:Epoch 37    loss=0.1376 [245.6 s]	 dev=(HR@5:0.5822,NDCG@5:0.4196) test=(HR@5:0.5345,NDCG@5:0.3764) [52.3 s] 
INFO:root:all_losses: [0.13882326 0.5639803 ]
INFO:root:Epoch 38    loss=0.1388 [245.7 s]	 dev=(HR@5:0.6002,NDCG@5:0.4275) test=(HR@5:0.5408,NDCG@5:0.3892) [52.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13579956 0.5610192 ]
INFO:root:Epoch 39    loss=0.1358 [245.8 s]	 dev=(HR@5:0.5885,NDCG@5:0.4172) test=(HR@5:0.5376,NDCG@5:0.3832) [52.1 s] 
INFO:root:all_losses: [0.1335126 0.5568088]
INFO:root:Epoch 40    loss=0.1335 [246.0 s]	 dev=(HR@5:0.5801,NDCG@5:0.4191) test=(HR@5:0.5419,NDCG@5:0.3782) [52.4 s] 
INFO:root:all_losses: [0.13503149 0.55298173]
INFO:root:Epoch 41    loss=0.1350 [248.0 s]	 dev=(HR@5:0.5864,NDCG@5:0.4185) test=(HR@5:0.5313,NDCG@5:0.3745) [52.3 s] 
INFO:root:all_losses: [0.13311309 0.55115765]
INFO:root:Epoch 42    loss=0.1331 [247.2 s]	 dev=(HR@5:0.5801,NDCG@5:0.4178) test=(HR@5:0.5440,NDCG@5:0.3794) [52.5 s] 
INFO:root:all_losses: [0.13234049 0.5448792 ]
INFO:root:Epoch 43    loss=0.1323 [247.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4213) test=(HR@5:0.5398,NDCG@5:0.3801) [52.7 s] 
INFO:root:all_losses: [0.1328054 0.5409733]
INFO:root:Epoch 44    loss=0.1328 [246.3 s]	 dev=(HR@5:0.5758,NDCG@5:0.4193) test=(HR@5:0.5536,NDCG@5:0.3914) [52.3 s] 
INFO:root:all_losses: [0.12995864 0.5379352 ]
INFO:root:Epoch 45    loss=0.1300 [246.8 s]	 dev=(HR@5:0.5705,NDCG@5:0.4178) test=(HR@5:0.5366,NDCG@5:0.3811) [52.2 s] 
INFO:root:all_losses: [0.12875713 0.5324032 ]
INFO:root:Epoch 46    loss=0.1288 [247.3 s]	 dev=(HR@5:0.5642,NDCG@5:0.4051) test=(HR@5:0.5228,NDCG@5:0.3665) [52.0 s] 
INFO:root:all_losses: [0.13096812 0.5278221 ]
INFO:root:Epoch 47    loss=0.1310 [246.7 s]	 dev=(HR@5:0.5769,NDCG@5:0.4173) test=(HR@5:0.5387,NDCG@5:0.3797) [52.4 s] 
INFO:root:all_losses: [0.12553592 0.52470696]
INFO:root:Epoch 48    loss=0.1255 [246.3 s]	 dev=(HR@5:0.5673,NDCG@5:0.4145) test=(HR@5:0.5217,NDCG@5:0.3712) [52.3 s] 
INFO:root:all_losses: [0.12730856 0.51850086]
INFO:root:Epoch 49    loss=0.1273 [246.6 s]	 dev=(HR@5:0.5938,NDCG@5:0.4191) test=(HR@5:0.5429,NDCG@5:0.3834) [52.3 s] 
INFO:root:all_losses: [0.12415434 0.51360106]
INFO:root:Epoch 50    loss=0.1242 [246.3 s]	 dev=(HR@5:0.5620,NDCG@5:0.4077) test=(HR@5:0.5249,NDCG@5:0.3700) [52.1 s] 
INFO:root:all_losses: [0.12482353 0.50645447]
INFO:root:Epoch 51    loss=0.1248 [248.2 s]	 dev=(HR@5:0.5885,NDCG@5:0.4258) test=(HR@5:0.5493,NDCG@5:0.3923) [52.4 s] 
INFO:root:all_losses: [0.12491535 0.50042695]
INFO:root:Epoch 52    loss=0.1249 [246.8 s]	 dev=(HR@5:0.5801,NDCG@5:0.4177) test=(HR@5:0.5292,NDCG@5:0.3816) [52.4 s] 
INFO:root:all_losses: [0.12400167 0.49600703]
INFO:root:Epoch 53    loss=0.1240 [247.0 s]	 dev=(HR@5:0.5864,NDCG@5:0.4127) test=(HR@5:0.5239,NDCG@5:0.3727) [52.4 s] 
INFO:root:all_losses: [0.12106527 0.48799405]
INFO:root:Epoch 54    loss=0.1211 [718.1 s]	 dev=(HR@5:0.5811,NDCG@5:0.4224) test=(HR@5:0.5355,NDCG@5:0.3833) [108.0 s] 
INFO:root:all_losses: [0.120836   0.48261225]
INFO:root:Epoch 55    loss=0.1208 [1103.6 s]	 dev=(HR@5:0.5832,NDCG@5:0.4163) test=(HR@5:0.5366,NDCG@5:0.3843) [106.8 s] 
INFO:root:all_losses: [0.12244391 0.47884712]
INFO:root:Epoch 56    loss=0.1224 [819.9 s]	 dev=(HR@5:0.5822,NDCG@5:0.4159) test=(HR@5:0.5408,NDCG@5:0.3894) [52.2 s] 
INFO:root:all_losses: [0.11984728 0.47366172]
INFO:root:Epoch 57    loss=0.1198 [244.9 s]	 dev=(HR@5:0.5885,NDCG@5:0.4195) test=(HR@5:0.5323,NDCG@5:0.3800) [51.8 s] 
INFO:root:all_losses: [0.11531915 0.47132975]
INFO:root:Epoch 58    loss=0.1153 [245.5 s]	 dev=(HR@5:0.5801,NDCG@5:0.4215) test=(HR@5:0.5557,NDCG@5:0.3926) [52.3 s] 
INFO:root:Early stop at 58 based on dev result.
INFO:root:
Best Iter(dev)=   38	 dev=(HR@5:0.6002,NDCG@5:0.4275) test=(HR@5:0.5408,NDCG@5:0.3892) [19444.6 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7169,HR@5:0.5408,HR@50:0.9639,NDCG@10:0.4456,NDCG@5:0.3892,NDCG@50:0.5028)
INFO:root:
--------------------------------------------- END: 2025-04-02 14:37:28 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-02 15:30:52 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46006525 0.69309247]
INFO:root:Epoch 1     loss=0.4601 [1049.3 s]	 dev=(HR@5:0.2163,NDCG@5:0.1393) test=(HR@5:0.2036,NDCG@5:0.1385) [89.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43693012 0.6929199 ]
INFO:root:Epoch 2     loss=0.4369 [1496.1 s]	 dev=(HR@5:0.2301,NDCG@5:0.1500) test=(HR@5:0.2142,NDCG@5:0.1467) [108.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:Early stop manually
INFO:root:
--------------------------------------------- END: 2025-04-02 16:21:17 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-02 16:22:27 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: True
INFO:root:# cuda devices: 1
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:1.0000,HR@5:1.0000,HR@50:1.0000,NDCG@10:1.0000,NDCG@5:1.0000,NDCG@50:1.0000)
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:
--------------------------------------------- END: 2025-04-02 16:24:38 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-02 16:26:28 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46006525 0.69309247]
INFO:root:Epoch 1     loss=0.4601 [1022.8 s]	 dev=(HR@5:0.2163,NDCG@5:0.1393) test=(HR@5:0.2036,NDCG@5:0.1385) [89.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43693012 0.6929199 ]
INFO:root:Epoch 2     loss=0.4369 [1490.8 s]	 dev=(HR@5:0.2301,NDCG@5:0.1500) test=(HR@5:0.2142,NDCG@5:0.1467) [108.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3814282 0.6926663]
INFO:root:Epoch 3     loss=0.3814 [1167.0 s]	 dev=(HR@5:0.2990,NDCG@5:0.2017) test=(HR@5:0.2789,NDCG@5:0.1840) [89.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.29221812 0.690575  ]
INFO:root:Epoch 4     loss=0.2922 [1109.0 s]	 dev=(HR@5:0.4857,NDCG@5:0.3430) test=(HR@5:0.4284,NDCG@5:0.2904) [122.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2317446 0.6848099]
INFO:root:Epoch 5     loss=0.2317 [1208.2 s]	 dev=(HR@5:0.4645,NDCG@5:0.3219) test=(HR@5:0.4189,NDCG@5:0.2834) [122.5 s] 
INFO:root:all_losses: [0.2139106 0.677984 ]
INFO:root:Epoch 6     loss=0.2139 [1198.8 s]	 dev=(HR@5:0.5090,NDCG@5:0.3598) test=(HR@5:0.4560,NDCG@5:0.3167) [117.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20311688 0.67205256]
INFO:root:Epoch 7     loss=0.2031 [1197.4 s]	 dev=(HR@5:0.5281,NDCG@5:0.3628) test=(HR@5:0.4687,NDCG@5:0.3219) [117.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19811934 0.6660198 ]
INFO:root:Epoch 8     loss=0.1981 [1196.2 s]	 dev=(HR@5:0.5387,NDCG@5:0.3769) test=(HR@5:0.5016,NDCG@5:0.3472) [120.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19071445 0.6624904 ]
INFO:root:Epoch 9     loss=0.1907 [1196.4 s]	 dev=(HR@5:0.5483,NDCG@5:0.3821) test=(HR@5:0.5005,NDCG@5:0.3555) [118.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18930665 0.6567906 ]
INFO:root:Epoch 10    loss=0.1893 [1194.8 s]	 dev=(HR@5:0.5217,NDCG@5:0.3670) test=(HR@5:0.4433,NDCG@5:0.3123) [119.9 s] 
INFO:root:all_losses: [0.18246068 0.65202266]
INFO:root:Epoch 11    loss=0.1825 [1195.5 s]	 dev=(HR@5:0.5673,NDCG@5:0.3940) test=(HR@5:0.5281,NDCG@5:0.3717) [121.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17520249 0.64873785]
INFO:root:Epoch 12    loss=0.1752 [1200.6 s]	 dev=(HR@5:0.5578,NDCG@5:0.3904) test=(HR@5:0.5313,NDCG@5:0.3597) [120.2 s] 
INFO:root:all_losses: [0.175465  0.6441291]
INFO:root:Epoch 13    loss=0.1755 [1193.9 s]	 dev=(HR@5:0.5663,NDCG@5:0.3936) test=(HR@5:0.5037,NDCG@5:0.3488) [119.0 s] 
INFO:root:all_losses: [0.16952412 0.640609  ]
INFO:root:Epoch 14    loss=0.1695 [1199.0 s]	 dev=(HR@5:0.5737,NDCG@5:0.3957) test=(HR@5:0.5080,NDCG@5:0.3542) [119.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16883717 0.63638353]
INFO:root:Epoch 15    loss=0.1688 [1198.4 s]	 dev=(HR@5:0.5769,NDCG@5:0.4048) test=(HR@5:0.5239,NDCG@5:0.3647) [117.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-03 15:40:59 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46006525 0.69309247]
INFO:root:Epoch 1     loss=0.4601 [180.2 s]	 dev=(HR@5:0.2163,NDCG@5:0.1393) test=(HR@5:0.2036,NDCG@5:0.1385) [38.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43693012 0.6929199 ]
INFO:root:Epoch 2     loss=0.4369 [555.4 s]	 dev=(HR@5:0.2301,NDCG@5:0.1500) test=(HR@5:0.2142,NDCG@5:0.1467) [55.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3814282 0.6926663]
INFO:root:Epoch 3     loss=0.3814 [294.2 s]	 dev=(HR@5:0.2990,NDCG@5:0.2017) test=(HR@5:0.2789,NDCG@5:0.1840) [37.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.29221812 0.690575  ]
INFO:root:Epoch 4     loss=0.2922 [257.3 s]	 dev=(HR@5:0.4857,NDCG@5:0.3430) test=(HR@5:0.4284,NDCG@5:0.2904) [64.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2317446 0.6848099]
INFO:root:Epoch 5     loss=0.2317 [338.0 s]	 dev=(HR@5:0.4645,NDCG@5:0.3219) test=(HR@5:0.4189,NDCG@5:0.2834) [64.5 s] 
INFO:root:all_losses: [0.2139106 0.677984 ]
INFO:root:Epoch 6     loss=0.2139 [337.8 s]	 dev=(HR@5:0.5090,NDCG@5:0.3598) test=(HR@5:0.4560,NDCG@5:0.3167) [64.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20311688 0.67205256]
INFO:root:Epoch 7     loss=0.2031 [337.1 s]	 dev=(HR@5:0.5281,NDCG@5:0.3628) test=(HR@5:0.4687,NDCG@5:0.3219) [64.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19811934 0.6660198 ]
INFO:root:Epoch 8     loss=0.1981 [337.2 s]	 dev=(HR@5:0.5387,NDCG@5:0.3769) test=(HR@5:0.5016,NDCG@5:0.3472) [64.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19071445 0.6624904 ]
INFO:root:Epoch 9     loss=0.1907 [336.6 s]	 dev=(HR@5:0.5483,NDCG@5:0.3821) test=(HR@5:0.5005,NDCG@5:0.3555) [64.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18930665 0.6567906 ]
INFO:root:Epoch 10    loss=0.1893 [336.8 s]	 dev=(HR@5:0.5217,NDCG@5:0.3670) test=(HR@5:0.4433,NDCG@5:0.3123) [63.1 s] 
INFO:root:all_losses: [0.18246068 0.65202266]
INFO:root:Epoch 11    loss=0.1825 [336.2 s]	 dev=(HR@5:0.5673,NDCG@5:0.3940) test=(HR@5:0.5281,NDCG@5:0.3717) [63.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17520249 0.64873785]
INFO:root:Epoch 12    loss=0.1752 [336.0 s]	 dev=(HR@5:0.5578,NDCG@5:0.3904) test=(HR@5:0.5313,NDCG@5:0.3597) [63.3 s] 
INFO:root:all_losses: [0.175465  0.6441291]
INFO:root:Epoch 13    loss=0.1755 [335.6 s]	 dev=(HR@5:0.5663,NDCG@5:0.3936) test=(HR@5:0.5037,NDCG@5:0.3488) [62.7 s] 
INFO:root:all_losses: [0.16952412 0.640609  ]
INFO:root:Epoch 14    loss=0.1695 [335.5 s]	 dev=(HR@5:0.5737,NDCG@5:0.3957) test=(HR@5:0.5080,NDCG@5:0.3542) [62.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16883717 0.63638353]
INFO:root:Epoch 15    loss=0.1688 [335.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4048) test=(HR@5:0.5239,NDCG@5:0.3647) [62.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16253774 0.6318094 ]
INFO:root:Epoch 16    loss=0.1625 [335.2 s]	 dev=(HR@5:0.5758,NDCG@5:0.4093) test=(HR@5:0.5175,NDCG@5:0.3612) [61.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16081418 0.62777036]
INFO:root:Epoch 17    loss=0.1608 [335.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4136) test=(HR@5:0.5175,NDCG@5:0.3749) [62.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15906857 0.6246365 ]
INFO:root:Epoch 18    loss=0.1591 [171.1 s]	 dev=(HR@5:0.5737,NDCG@5:0.4101) test=(HR@5:0.5345,NDCG@5:0.3845) [31.9 s] 
INFO:root:all_losses: [0.15524991 0.62225705]
INFO:root:Epoch 19    loss=0.1552 [148.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4064) test=(HR@5:0.5260,NDCG@5:0.3756) [31.9 s] 
INFO:root:all_losses: [0.15536955 0.61704177]
INFO:root:Epoch 20    loss=0.1554 [148.4 s]	 dev=(HR@5:0.5875,NDCG@5:0.4253) test=(HR@5:0.5398,NDCG@5:0.3908) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15336876 0.6136328 ]
INFO:root:Epoch 21    loss=0.1534 [148.2 s]	 dev=(HR@5:0.5610,NDCG@5:0.3980) test=(HR@5:0.5366,NDCG@5:0.3952) [31.8 s] 
INFO:root:all_losses: [0.14757288 0.6103469 ]
INFO:root:Epoch 22    loss=0.1476 [148.2 s]	 dev=(HR@5:0.5907,NDCG@5:0.4273) test=(HR@5:0.5483,NDCG@5:0.3979) [31.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15145372 0.6065595 ]
INFO:root:Epoch 23    loss=0.1515 [148.2 s]	 dev=(HR@5:0.5843,NDCG@5:0.4272) test=(HR@5:0.5493,NDCG@5:0.3875) [31.7 s] 
INFO:root:all_losses: [0.14561182 0.60357374]
INFO:root:Epoch 24    loss=0.1456 [148.8 s]	 dev=(HR@5:0.5748,NDCG@5:0.4236) test=(HR@5:0.5355,NDCG@5:0.3870) [31.4 s] 
INFO:root:all_losses: [0.14576507 0.59841204]
INFO:root:Epoch 25    loss=0.1458 [148.3 s]	 dev=(HR@5:0.5864,NDCG@5:0.4158) test=(HR@5:0.5461,NDCG@5:0.3833) [31.9 s] 
INFO:root:all_losses: [0.14255475 0.59638804]
INFO:root:Epoch 26    loss=0.1426 [148.5 s]	 dev=(HR@5:0.5864,NDCG@5:0.4217) test=(HR@5:0.5440,NDCG@5:0.3869) [32.0 s] 
INFO:root:all_losses: [0.13947959 0.59254634]
INFO:root:Epoch 27    loss=0.1395 [147.9 s]	 dev=(HR@5:0.5864,NDCG@5:0.4167) test=(HR@5:0.5323,NDCG@5:0.3726) [31.5 s] 
INFO:root:all_losses: [0.13947923 0.5900977 ]
INFO:root:Epoch 28    loss=0.1395 [148.5 s]	 dev=(HR@5:0.5896,NDCG@5:0.4210) test=(HR@5:0.5387,NDCG@5:0.3794) [31.5 s] 
INFO:root:all_losses: [0.13700469 0.5855152 ]
INFO:root:Epoch 29    loss=0.1370 [148.3 s]	 dev=(HR@5:0.5949,NDCG@5:0.4284) test=(HR@5:0.5302,NDCG@5:0.3735) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13817042 0.5803547 ]
INFO:root:Epoch 30    loss=0.1382 [147.7 s]	 dev=(HR@5:0.5864,NDCG@5:0.4250) test=(HR@5:0.5323,NDCG@5:0.3862) [31.5 s] 
INFO:root:all_losses: [0.1366165 0.5778679]
INFO:root:Epoch 31    loss=0.1366 [148.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4156) test=(HR@5:0.5196,NDCG@5:0.3727) [31.7 s] 
INFO:root:all_losses: [0.13418998 0.5726353 ]
INFO:root:Epoch 32    loss=0.1342 [148.6 s]	 dev=(HR@5:0.6066,NDCG@5:0.4409) test=(HR@5:0.5376,NDCG@5:0.3892) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13094962 0.5686878 ]
INFO:root:Epoch 33    loss=0.1309 [148.5 s]	 dev=(HR@5:0.5801,NDCG@5:0.4165) test=(HR@5:0.5292,NDCG@5:0.3749) [31.6 s] 
INFO:root:all_losses: [0.13265637 0.56404334]
INFO:root:Epoch 34    loss=0.1327 [147.9 s]	 dev=(HR@5:0.5716,NDCG@5:0.4143) test=(HR@5:0.5281,NDCG@5:0.3812) [31.3 s] 
INFO:root:all_losses: [0.12986398 0.5606419 ]
INFO:root:Epoch 35    loss=0.1299 [148.0 s]	 dev=(HR@5:0.5822,NDCG@5:0.4234) test=(HR@5:0.5461,NDCG@5:0.3850) [31.4 s] 
INFO:root:all_losses: [0.12849347 0.55736446]
INFO:root:Epoch 36    loss=0.1285 [148.7 s]	 dev=(HR@5:0.5896,NDCG@5:0.4202) test=(HR@5:0.5186,NDCG@5:0.3692) [31.3 s] 
INFO:root:all_losses: [0.12720612 0.55141366]
INFO:root:Epoch 37    loss=0.1272 [148.0 s]	 dev=(HR@5:0.5885,NDCG@5:0.4248) test=(HR@5:0.5366,NDCG@5:0.3815) [31.3 s] 
INFO:root:all_losses: [0.12813915 0.5485524 ]
INFO:root:Epoch 38    loss=0.1281 [148.8 s]	 dev=(HR@5:0.6002,NDCG@5:0.4267) test=(HR@5:0.5483,NDCG@5:0.3930) [31.4 s] 
INFO:root:all_losses: [0.12451836 0.54411095]
INFO:root:Epoch 39    loss=0.1245 [148.1 s]	 dev=(HR@5:0.5928,NDCG@5:0.4336) test=(HR@5:0.5387,NDCG@5:0.3924) [31.8 s] 
INFO:root:all_losses: [0.12285521 0.5385211 ]
INFO:root:Epoch 40    loss=0.1229 [149.1 s]	 dev=(HR@5:0.5917,NDCG@5:0.4317) test=(HR@5:0.5281,NDCG@5:0.3825) [31.6 s] 
INFO:root:all_losses: [0.12465047 0.53374493]
INFO:root:Epoch 41    loss=0.1247 [149.0 s]	 dev=(HR@5:0.5917,NDCG@5:0.4206) test=(HR@5:0.5217,NDCG@5:0.3774) [31.5 s] 
INFO:root:all_losses: [0.12188406 0.52995247]
INFO:root:Epoch 42    loss=0.1219 [148.1 s]	 dev=(HR@5:0.5705,NDCG@5:0.4113) test=(HR@5:0.5451,NDCG@5:0.3958) [31.3 s] 
INFO:root:all_losses: [0.12090315 0.5234341 ]
INFO:root:Epoch 43    loss=0.1209 [148.5 s]	 dev=(HR@5:0.5779,NDCG@5:0.4184) test=(HR@5:0.5196,NDCG@5:0.3811) [31.3 s] 
INFO:root:all_losses: [0.12080138 0.5195158 ]
INFO:root:Epoch 44    loss=0.1208 [148.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4168) test=(HR@5:0.5578,NDCG@5:0.4019) [31.1 s] 
INFO:root:all_losses: [0.11807622 0.5168508 ]
INFO:root:Epoch 45    loss=0.1181 [149.0 s]	 dev=(HR@5:0.5673,NDCG@5:0.4123) test=(HR@5:0.5398,NDCG@5:0.3861) [31.1 s] 
INFO:root:all_losses: [0.11804464 0.5122709 ]
INFO:root:Epoch 46    loss=0.1180 [148.6 s]	 dev=(HR@5:0.5705,NDCG@5:0.4109) test=(HR@5:0.5345,NDCG@5:0.3822) [31.3 s] 
INFO:root:all_losses: [0.11867831 0.5065954 ]
INFO:root:Epoch 47    loss=0.1187 [148.7 s]	 dev=(HR@5:0.5938,NDCG@5:0.4254) test=(HR@5:0.5302,NDCG@5:0.3767) [31.0 s] 
INFO:root:all_losses: [0.11603343 0.5039165 ]
INFO:root:Epoch 48    loss=0.1160 [148.7 s]	 dev=(HR@5:0.5769,NDCG@5:0.4085) test=(HR@5:0.5270,NDCG@5:0.3695) [31.1 s] 
INFO:root:all_losses: [0.11754027 0.49971166]
INFO:root:Epoch 49    loss=0.1175 [148.5 s]	 dev=(HR@5:0.5705,NDCG@5:0.4112) test=(HR@5:0.5472,NDCG@5:0.3860) [31.0 s] 
INFO:root:all_losses: [0.11430128 0.4942636 ]
INFO:root:Epoch 50    loss=0.1143 [148.4 s]	 dev=(HR@5:0.5684,NDCG@5:0.4083) test=(HR@5:0.5408,NDCG@5:0.3802) [31.2 s] 
INFO:root:all_losses: [0.11534233 0.49171585]
INFO:root:Epoch 51    loss=0.1153 [149.0 s]	 dev=(HR@5:0.5758,NDCG@5:0.4183) test=(HR@5:0.5419,NDCG@5:0.3889) [31.2 s] 
INFO:root:all_losses: [0.11468546 0.48659676]
INFO:root:Epoch 52    loss=0.1147 [150.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4133) test=(HR@5:0.5419,NDCG@5:0.3905) [31.5 s] 
INFO:root:Early stop at 52 based on dev result.
INFO:root:
Best Iter(dev)=   32	 dev=(HR@5:0.6066,NDCG@5:0.4409) test=(HR@5:0.5376,NDCG@5:0.3892) [12999.9 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7147,HR@5:0.5376,HR@50:0.9629,NDCG@10:0.4467,NDCG@5:0.3892,NDCG@50:0.5038)
INFO:root:
--------------------------------------------- END: 2025-04-03 19:18:11 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-03 22:07:56 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.4594876 0.6930926]
INFO:root:Epoch 1     loss=0.4595 [185.5 s]	 dev=(HR@5:0.2163,NDCG@5:0.1373) test=(HR@5:0.2025,NDCG@5:0.1387) [37.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.40912342 0.69292355]
INFO:root:Epoch 2     loss=0.4091 [240.4 s]	 dev=(HR@5:0.2545,NDCG@5:0.1674) test=(HR@5:0.2269,NDCG@5:0.1476) [59.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3660188 0.6925281]
INFO:root:Epoch 3     loss=0.3660 [423.7 s]	 dev=(HR@5:0.2778,NDCG@5:0.1843) test=(HR@5:0.2439,NDCG@5:0.1660) [113.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.31689715 0.6913206 ]
INFO:root:Epoch 4     loss=0.3169 [546.0 s]	 dev=(HR@5:0.3722,NDCG@5:0.2565) test=(HR@5:0.3033,NDCG@5:0.2073) [198.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2792699  0.68816686]
INFO:root:Epoch 5     loss=0.2793 [1727.2 s]	 dev=(HR@5:0.4104,NDCG@5:0.2883) test=(HR@5:0.3966,NDCG@5:0.2595) [211.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.23600593 0.68265945]
INFO:root:Epoch 6     loss=0.2360 [1732.7 s]	 dev=(HR@5:0.4836,NDCG@5:0.3307) test=(HR@5:0.4263,NDCG@5:0.2866) [202.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.22030906 0.6772121 ]
INFO:root:Epoch 7     loss=0.2203 [1676.9 s]	 dev=(HR@5:0.4825,NDCG@5:0.3293) test=(HR@5:0.4443,NDCG@5:0.2906) [201.2 s] 
INFO:root:all_losses: [0.21421456 0.67215985]
INFO:root:Epoch 8     loss=0.2142 [1643.5 s]	 dev=(HR@5:0.4899,NDCG@5:0.3412) test=(HR@5:0.4698,NDCG@5:0.3109) [194.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20924468 0.66930497]
INFO:root:Epoch 9     loss=0.2092 [1325.3 s]	 dev=(HR@5:0.5111,NDCG@5:0.3515) test=(HR@5:0.4517,NDCG@5:0.3075) [124.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20708765 0.66433597]
INFO:root:Epoch 10    loss=0.2071 [1200.6 s]	 dev=(HR@5:0.4878,NDCG@5:0.3359) test=(HR@5:0.4210,NDCG@5:0.2874) [118.6 s] 
INFO:root:all_losses: [0.20116793 0.6598931 ]
INFO:root:Epoch 11    loss=0.2012 [1200.7 s]	 dev=(HR@5:0.5154,NDCG@5:0.3582) test=(HR@5:0.4719,NDCG@5:0.3271) [116.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19306444 0.65654886]
INFO:root:Epoch 12    loss=0.1931 [1199.0 s]	 dev=(HR@5:0.5186,NDCG@5:0.3596) test=(HR@5:0.4814,NDCG@5:0.3258) [118.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19393037 0.65221995]
INFO:root:Epoch 13    loss=0.1939 [1196.5 s]	 dev=(HR@5:0.5196,NDCG@5:0.3600) test=(HR@5:0.4581,NDCG@5:0.3154) [115.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19041069 0.64809793]
INFO:root:Epoch 14    loss=0.1904 [1199.3 s]	 dev=(HR@5:0.5239,NDCG@5:0.3611) test=(HR@5:0.4889,NDCG@5:0.3299) [116.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18949252 0.64373785]
INFO:root:Epoch 15    loss=0.1895 [1195.9 s]	 dev=(HR@5:0.5313,NDCG@5:0.3597) test=(HR@5:0.4772,NDCG@5:0.3275) [117.4 s] 
INFO:root:all_losses: [0.18530329 0.6389348 ]
INFO:root:Epoch 16    loss=0.1853 [1195.1 s]	 dev=(HR@5:0.5143,NDCG@5:0.3535) test=(HR@5:0.4602,NDCG@5:0.3193) [116.8 s] 
INFO:root:all_losses: [0.18340263 0.6344349 ]
INFO:root:Epoch 17    loss=0.1834 [1198.4 s]	 dev=(HR@5:0.5249,NDCG@5:0.3730) test=(HR@5:0.4867,NDCG@5:0.3405) [114.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18108903 0.63074154]
INFO:root:Epoch 18    loss=0.1811 [1192.7 s]	 dev=(HR@5:0.5292,NDCG@5:0.3734) test=(HR@5:0.4952,NDCG@5:0.3370) [115.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1808311 0.6268862]
INFO:root:Epoch 19    loss=0.1808 [1195.5 s]	 dev=(HR@5:0.5440,NDCG@5:0.3769) test=(HR@5:0.4783,NDCG@5:0.3322) [115.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17852856 0.6207417 ]
INFO:root:Epoch 20    loss=0.1785 [1192.4 s]	 dev=(HR@5:0.5472,NDCG@5:0.3794) test=(HR@5:0.4878,NDCG@5:0.3438) [107.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1793279 0.6160448]
INFO:root:Epoch 21    loss=0.1793 [1191.4 s]	 dev=(HR@5:0.5249,NDCG@5:0.3713) test=(HR@5:0.4920,NDCG@5:0.3422) [107.6 s] 
INFO:root:all_losses: [0.17279667 0.611169  ]
INFO:root:Epoch 22    loss=0.1728 [1201.3 s]	 dev=(HR@5:0.5440,NDCG@5:0.3844) test=(HR@5:0.4973,NDCG@5:0.3476) [106.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1764409 0.6062141]
INFO:root:Epoch 23    loss=0.1764 [1198.7 s]	 dev=(HR@5:0.5440,NDCG@5:0.3859) test=(HR@5:0.5027,NDCG@5:0.3438) [114.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17202766 0.6018905 ]
INFO:root:Epoch 24    loss=0.1720 [1194.4 s]	 dev=(HR@5:0.5366,NDCG@5:0.3813) test=(HR@5:0.5037,NDCG@5:0.3556) [114.4 s] 
INFO:root:all_losses: [0.17085707 0.59454274]
INFO:root:Epoch 25    loss=0.1709 [1195.3 s]	 dev=(HR@5:0.5536,NDCG@5:0.3841) test=(HR@5:0.4910,NDCG@5:0.3503) [114.2 s] 
INFO:root:all_losses: [0.16829051 0.58964694]
INFO:root:Epoch 26    loss=0.1683 [1195.1 s]	 dev=(HR@5:0.5567,NDCG@5:0.3880) test=(HR@5:0.4973,NDCG@5:0.3480) [113.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16625805 0.5835804 ]
INFO:root:Epoch 27    loss=0.1663 [1190.7 s]	 dev=(HR@5:0.5451,NDCG@5:0.3873) test=(HR@5:0.5080,NDCG@5:0.3585) [111.2 s] 
INFO:root:all_losses: [0.16563733 0.57852405]
INFO:root:Epoch 28    loss=0.1656 [1191.6 s]	 dev=(HR@5:0.5408,NDCG@5:0.3820) test=(HR@5:0.5027,NDCG@5:0.3469) [110.1 s] 
INFO:root:all_losses: [0.16329436 0.5706767 ]
INFO:root:Epoch 29    loss=0.1633 [1191.4 s]	 dev=(HR@5:0.5429,NDCG@5:0.3883) test=(HR@5:0.5058,NDCG@5:0.3544) [110.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16406463 0.56328964]
INFO:root:Epoch 30    loss=0.1641 [1197.1 s]	 dev=(HR@5:0.5525,NDCG@5:0.3875) test=(HR@5:0.5249,NDCG@5:0.3672) [112.3 s] 
INFO:root:all_losses: [0.16355836 0.5580307 ]
INFO:root:Epoch 31    loss=0.1636 [1191.6 s]	 dev=(HR@5:0.5493,NDCG@5:0.3909) test=(HR@5:0.4963,NDCG@5:0.3484) [110.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15989624 0.549395  ]
INFO:root:Epoch 32    loss=0.1599 [1194.8 s]	 dev=(HR@5:0.5652,NDCG@5:0.4074) test=(HR@5:0.5069,NDCG@5:0.3559) [110.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15797746 0.5426444 ]
INFO:root:Epoch 33    loss=0.1580 [1195.1 s]	 dev=(HR@5:0.5514,NDCG@5:0.3891) test=(HR@5:0.5133,NDCG@5:0.3543) [111.4 s] 
INFO:root:all_losses: [0.15895334 0.5342418 ]
INFO:root:Epoch 34    loss=0.1590 [1098.6 s]	 dev=(HR@5:0.5504,NDCG@5:0.3930) test=(HR@5:0.5090,NDCG@5:0.3583) [109.5 s] 
INFO:root:all_losses: [0.15608181 0.52892643]
INFO:root:Epoch 35    loss=0.1561 [966.2 s]	 dev=(HR@5:0.5599,NDCG@5:0.4016) test=(HR@5:0.5143,NDCG@5:0.3625) [52.5 s] 
INFO:root:all_losses: [0.15488048 0.5210595 ]
INFO:root:Epoch 36    loss=0.1549 [247.5 s]	 dev=(HR@5:0.5493,NDCG@5:0.3902) test=(HR@5:0.5143,NDCG@5:0.3549) [52.2 s] 
INFO:root:all_losses: [0.15260911 0.5115849 ]
INFO:root:Epoch 37    loss=0.1526 [248.6 s]	 dev=(HR@5:0.5599,NDCG@5:0.4021) test=(HR@5:0.5217,NDCG@5:0.3635) [52.7 s] 
INFO:root:all_losses: [0.15251638 0.5048735 ]
INFO:root:Epoch 38    loss=0.1525 [245.9 s]	 dev=(HR@5:0.5758,NDCG@5:0.4125) test=(HR@5:0.5408,NDCG@5:0.3830) [52.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.14961089 0.4980446 ]
INFO:root:Epoch 39    loss=0.1496 [247.0 s]	 dev=(HR@5:0.5705,NDCG@5:0.4034) test=(HR@5:0.5387,NDCG@5:0.3836) [52.5 s] 
INFO:root:all_losses: [0.146609   0.48580852]
INFO:root:Epoch 40    loss=0.1466 [247.1 s]	 dev=(HR@5:0.5642,NDCG@5:0.4050) test=(HR@5:0.5323,NDCG@5:0.3687) [52.1 s] 
INFO:root:all_losses: [0.14896272 0.4779392 ]
INFO:root:Epoch 41    loss=0.1490 [246.9 s]	 dev=(HR@5:0.5546,NDCG@5:0.3991) test=(HR@5:0.5101,NDCG@5:0.3553) [52.2 s] 
INFO:root:all_losses: [0.14678998 0.47008592]
INFO:root:Epoch 42    loss=0.1468 [248.2 s]	 dev=(HR@5:0.5673,NDCG@5:0.4069) test=(HR@5:0.5260,NDCG@5:0.3724) [52.4 s] 
INFO:root:all_losses: [0.14509457 0.459708  ]
INFO:root:Epoch 43    loss=0.1451 [248.8 s]	 dev=(HR@5:0.5737,NDCG@5:0.4072) test=(HR@5:0.5154,NDCG@5:0.3619) [52.3 s] 
INFO:root:all_losses: [0.14429486 0.44976482]
INFO:root:Epoch 44    loss=0.1443 [247.8 s]	 dev=(HR@5:0.5546,NDCG@5:0.4046) test=(HR@5:0.5292,NDCG@5:0.3745) [52.3 s] 
INFO:root:all_losses: [0.14238285 0.4423951 ]
INFO:root:Epoch 45    loss=0.1424 [247.1 s]	 dev=(HR@5:0.5801,NDCG@5:0.4115) test=(HR@5:0.5366,NDCG@5:0.3789) [52.3 s] 
INFO:root:all_losses: [0.14073126 0.4341207 ]
INFO:root:Epoch 46    loss=0.1407 [248.6 s]	 dev=(HR@5:0.5875,NDCG@5:0.4179) test=(HR@5:0.5292,NDCG@5:0.3701) [52.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13988721 0.4214282 ]
INFO:root:Epoch 47    loss=0.1399 [247.4 s]	 dev=(HR@5:0.5716,NDCG@5:0.4051) test=(HR@5:0.5175,NDCG@5:0.3681) [52.3 s] 
INFO:root:all_losses: [0.13678847 0.41379505]
INFO:root:Epoch 48    loss=0.1368 [248.6 s]	 dev=(HR@5:0.5726,NDCG@5:0.4071) test=(HR@5:0.5133,NDCG@5:0.3642) [52.4 s] 
INFO:root:all_losses: [0.13855608 0.40429634]
INFO:root:Epoch 49    loss=0.1386 [247.7 s]	 dev=(HR@5:0.5695,NDCG@5:0.4096) test=(HR@5:0.5313,NDCG@5:0.3714) [52.6 s] 
INFO:root:all_losses: [0.13481662 0.39490297]
INFO:root:Epoch 50    loss=0.1348 [248.8 s]	 dev=(HR@5:0.5663,NDCG@5:0.4013) test=(HR@5:0.5196,NDCG@5:0.3631) [52.8 s] 
INFO:root:all_losses: [0.13582532 0.3840425 ]
INFO:root:Epoch 51    loss=0.1358 [247.1 s]	 dev=(HR@5:0.5790,NDCG@5:0.4094) test=(HR@5:0.5196,NDCG@5:0.3699) [52.3 s] 
INFO:root:all_losses: [0.13346958 0.37638628]
INFO:root:Epoch 52    loss=0.1335 [249.0 s]	 dev=(HR@5:0.5684,NDCG@5:0.4035) test=(HR@5:0.5101,NDCG@5:0.3629) [52.3 s] 
INFO:root:all_losses: [0.13255201 0.36624065]
INFO:root:Epoch 53    loss=0.1326 [247.1 s]	 dev=(HR@5:0.5748,NDCG@5:0.4060) test=(HR@5:0.5069,NDCG@5:0.3537) [52.3 s] 
INFO:root:all_losses: [0.12972267 0.3569049 ]
INFO:root:Epoch 54    loss=0.1297 [247.6 s]	 dev=(HR@5:0.5758,NDCG@5:0.4078) test=(HR@5:0.5228,NDCG@5:0.3588) [52.2 s] 
INFO:root:all_losses: [0.1306053 0.3477194]
INFO:root:Epoch 55    loss=0.1306 [248.7 s]	 dev=(HR@5:0.5790,NDCG@5:0.4105) test=(HR@5:0.5302,NDCG@5:0.3721) [52.2 s] 
INFO:root:all_losses: [0.12969264 0.34203842]
INFO:root:Epoch 56    loss=0.1297 [250.3 s]	 dev=(HR@5:0.5737,NDCG@5:0.4064) test=(HR@5:0.5207,NDCG@5:0.3625) [52.6 s] 
INFO:root:all_losses: [0.12798525 0.33452132]
INFO:root:Epoch 57    loss=0.1280 [251.4 s]	 dev=(HR@5:0.5854,NDCG@5:0.4201) test=(HR@5:0.5281,NDCG@5:0.3695) [52.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12406557 0.32587802]
INFO:root:Epoch 58    loss=0.1241 [253.6 s]	 dev=(HR@5:0.5970,NDCG@5:0.4294) test=(HR@5:0.5217,NDCG@5:0.3650) [52.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.12413903 0.3165147 ]
INFO:root:Epoch 59    loss=0.1241 [255.1 s]	 dev=(HR@5:0.5779,NDCG@5:0.4199) test=(HR@5:0.5270,NDCG@5:0.3683) [52.5 s] 
INFO:root:all_losses: [0.1262297  0.31012097]
INFO:root:Epoch 60    loss=0.1262 [255.6 s]	 dev=(HR@5:0.5769,NDCG@5:0.4029) test=(HR@5:0.5111,NDCG@5:0.3624) [52.4 s] 
INFO:root:all_losses: [0.12458933 0.30521467]
INFO:root:Epoch 61    loss=0.1246 [254.2 s]	 dev=(HR@5:0.5769,NDCG@5:0.4075) test=(HR@5:0.5217,NDCG@5:0.3649) [52.8 s] 
INFO:root:all_losses: [0.12278651 0.30027622]
INFO:root:Epoch 62    loss=0.1228 [255.1 s]	 dev=(HR@5:0.5716,NDCG@5:0.4060) test=(HR@5:0.5154,NDCG@5:0.3634) [52.8 s] 
INFO:root:all_losses: [0.12284806 0.2948293 ]
INFO:root:Epoch 63    loss=0.1228 [255.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.4012) test=(HR@5:0.5048,NDCG@5:0.3637) [52.6 s] 
INFO:root:all_losses: [0.11921067 0.28897378]
INFO:root:Epoch 64    loss=0.1192 [254.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4166) test=(HR@5:0.5260,NDCG@5:0.3742) [53.1 s] 
INFO:root:all_losses: [0.119476   0.28405324]
INFO:root:Epoch 65    loss=0.1195 [255.3 s]	 dev=(HR@5:0.5748,NDCG@5:0.4101) test=(HR@5:0.5175,NDCG@5:0.3612) [52.6 s] 
INFO:root:all_losses: [0.11924948 0.28282514]
INFO:root:Epoch 66    loss=0.1192 [254.2 s]	 dev=(HR@5:0.5748,NDCG@5:0.4110) test=(HR@5:0.5270,NDCG@5:0.3647) [52.7 s] 
INFO:root:all_losses: [0.11606126 0.27749604]
INFO:root:Epoch 67    loss=0.1161 [254.3 s]	 dev=(HR@5:0.5832,NDCG@5:0.4172) test=(HR@5:0.5461,NDCG@5:0.3796) [52.7 s] 
INFO:root:all_losses: [0.11743724 0.2730751 ]
INFO:root:Epoch 68    loss=0.1174 [254.5 s]	 dev=(HR@5:0.5779,NDCG@5:0.4258) test=(HR@5:0.5323,NDCG@5:0.3758) [52.8 s] 
INFO:root:all_losses: [0.11496095 0.27105948]
INFO:root:Epoch 69    loss=0.1150 [254.8 s]	 dev=(HR@5:0.5811,NDCG@5:0.4218) test=(HR@5:0.5069,NDCG@5:0.3561) [52.4 s] 
INFO:root:all_losses: [0.11721279 0.26421517]
INFO:root:Epoch 70    loss=0.1172 [254.9 s]	 dev=(HR@5:0.5790,NDCG@5:0.4199) test=(HR@5:0.5196,NDCG@5:0.3646) [52.8 s] 
INFO:root:all_losses: [0.11514711 0.26433557]
INFO:root:Epoch 71    loss=0.1151 [255.2 s]	 dev=(HR@5:0.5960,NDCG@5:0.4191) test=(HR@5:0.5270,NDCG@5:0.3662) [52.8 s] 
INFO:root:all_losses: [0.11460485 0.26202598]
INFO:root:Epoch 72    loss=0.1146 [257.8 s]	 dev=(HR@5:0.5822,NDCG@5:0.4210) test=(HR@5:0.5186,NDCG@5:0.3695) [52.6 s] 
INFO:root:all_losses: [0.11609729 0.26135337]
INFO:root:Epoch 73    loss=0.1161 [245.6 s]	 dev=(HR@5:0.5917,NDCG@5:0.4174) test=(HR@5:0.5058,NDCG@5:0.3577) [53.2 s] 
INFO:root:all_losses: [0.11409651 0.25986984]
INFO:root:Epoch 74    loss=0.1141 [247.7 s]	 dev=(HR@5:0.5896,NDCG@5:0.4233) test=(HR@5:0.5090,NDCG@5:0.3645) [52.8 s] 
INFO:root:all_losses: [0.11017708 0.25295416]
INFO:root:Epoch 75    loss=0.1102 [253.3 s]	 dev=(HR@5:0.5864,NDCG@5:0.4261) test=(HR@5:0.5164,NDCG@5:0.3692) [55.9 s] 
INFO:root:all_losses: [0.11220647 0.25390825]
INFO:root:Epoch 76    loss=0.1122 [250.4 s]	 dev=(HR@5:0.5758,NDCG@5:0.4163) test=(HR@5:0.5175,NDCG@5:0.3682) [52.6 s] 
INFO:root:all_losses: [0.10973018 0.2535378 ]
INFO:root:Epoch 77    loss=0.1097 [250.4 s]	 dev=(HR@5:0.5843,NDCG@5:0.4246) test=(HR@5:0.5355,NDCG@5:0.3777) [52.7 s] 
INFO:root:all_losses: [0.10956537 0.2494096 ]
INFO:root:Epoch 78    loss=0.1096 [250.3 s]	 dev=(HR@5:0.5896,NDCG@5:0.4198) test=(HR@5:0.5249,NDCG@5:0.3714) [52.4 s] 
INFO:root:Early stop at 78 based on dev result.
INFO:root:
Best Iter(dev)=   58	 dev=(HR@5:0.5970,NDCG@5:0.4294) test=(HR@5:0.5217,NDCG@5:0.3650) [57526.8 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7094,HR@5:0.5217,HR@50:0.9639,NDCG@10:0.4259,NDCG@5:0.3650,NDCG@50:0.4847)
INFO:root:
--------------------------------------------- END: 2025-04-04 14:07:23 ---------------------------------------------
INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-04-28 08:33:06 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 1            
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.46006525 0.69309247]
INFO:root:Epoch 1     loss=0.4601 [131.6 s]	 dev=(HR@5:0.2163,NDCG@5:0.1393) test=(HR@5:0.2036,NDCG@5:0.1385) [28.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.43693012 0.6929199 ]
INFO:root:Epoch 2     loss=0.4369 [179.2 s]	 dev=(HR@5:0.2301,NDCG@5:0.1500) test=(HR@5:0.2142,NDCG@5:0.1467) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.3814282 0.6926663]
INFO:root:Epoch 3     loss=0.3814 [145.2 s]	 dev=(HR@5:0.2990,NDCG@5:0.2017) test=(HR@5:0.2789,NDCG@5:0.1840) [28.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.29221812 0.690575  ]
INFO:root:Epoch 4     loss=0.2922 [146.2 s]	 dev=(HR@5:0.4857,NDCG@5:0.3430) test=(HR@5:0.4284,NDCG@5:0.2904) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2317446 0.6848099]
INFO:root:Epoch 5     loss=0.2317 [153.6 s]	 dev=(HR@5:0.4645,NDCG@5:0.3219) test=(HR@5:0.4189,NDCG@5:0.2834) [31.9 s] 
INFO:root:all_losses: [0.2139106 0.677984 ]
INFO:root:Epoch 6     loss=0.2139 [156.3 s]	 dev=(HR@5:0.5090,NDCG@5:0.3598) test=(HR@5:0.4560,NDCG@5:0.3167) [32.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20311688 0.67205256]
INFO:root:Epoch 7     loss=0.2031 [160.5 s]	 dev=(HR@5:0.5281,NDCG@5:0.3628) test=(HR@5:0.4687,NDCG@5:0.3219) [32.4 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19811934 0.6660198 ]
INFO:root:Epoch 8     loss=0.1981 [160.9 s]	 dev=(HR@5:0.5387,NDCG@5:0.3769) test=(HR@5:0.5016,NDCG@5:0.3472) [32.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.19071445 0.6624904 ]
INFO:root:Epoch 9     loss=0.1907 [161.1 s]	 dev=(HR@5:0.5483,NDCG@5:0.3821) test=(HR@5:0.5005,NDCG@5:0.3555) [32.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18930665 0.6567906 ]
INFO:root:Epoch 10    loss=0.1893 [160.8 s]	 dev=(HR@5:0.5217,NDCG@5:0.3670) test=(HR@5:0.4433,NDCG@5:0.3123) [32.1 s] 
INFO:root:all_losses: [0.18246068 0.65202266]
INFO:root:Epoch 11    loss=0.1825 [160.3 s]	 dev=(HR@5:0.5673,NDCG@5:0.3940) test=(HR@5:0.5281,NDCG@5:0.3717) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17520249 0.64873785]
INFO:root:Epoch 12    loss=0.1752 [160.6 s]	 dev=(HR@5:0.5578,NDCG@5:0.3904) test=(HR@5:0.5313,NDCG@5:0.3597) [32.3 s] 
INFO:root:all_losses: [0.175465  0.6441291]
INFO:root:Epoch 13    loss=0.1755 [160.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.3936) test=(HR@5:0.5037,NDCG@5:0.3488) [31.6 s] 
INFO:root:all_losses: [0.16952412 0.640609  ]
INFO:root:Epoch 14    loss=0.1695 [160.9 s]	 dev=(HR@5:0.5737,NDCG@5:0.3957) test=(HR@5:0.5080,NDCG@5:0.3542) [32.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16883717 0.63638353]
INFO:root:Epoch 15    loss=0.1688 [160.1 s]	 dev=(HR@5:0.5769,NDCG@5:0.4048) test=(HR@5:0.5239,NDCG@5:0.3647) [31.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16253774 0.6318094 ]
INFO:root:Epoch 16    loss=0.1625 [160.1 s]	 dev=(HR@5:0.5758,NDCG@5:0.4093) test=(HR@5:0.5175,NDCG@5:0.3612) [31.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.16081418 0.62777036]
INFO:root:Epoch 17    loss=0.1608 [160.8 s]	 dev=(HR@5:0.5769,NDCG@5:0.4136) test=(HR@5:0.5175,NDCG@5:0.3749) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15906857 0.6246365 ]
INFO:root:Epoch 18    loss=0.1591 [160.3 s]	 dev=(HR@5:0.5737,NDCG@5:0.4101) test=(HR@5:0.5345,NDCG@5:0.3845) [31.7 s] 
INFO:root:all_losses: [0.15524991 0.62225705]
INFO:root:Epoch 19    loss=0.1552 [161.0 s]	 dev=(HR@5:0.5779,NDCG@5:0.4064) test=(HR@5:0.5260,NDCG@5:0.3756) [32.0 s] 
INFO:root:all_losses: [0.15536955 0.61704177]
INFO:root:Epoch 20    loss=0.1554 [160.1 s]	 dev=(HR@5:0.5875,NDCG@5:0.4253) test=(HR@5:0.5398,NDCG@5:0.3908) [31.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15336876 0.6136328 ]
INFO:root:Epoch 21    loss=0.1534 [160.0 s]	 dev=(HR@5:0.5610,NDCG@5:0.3980) test=(HR@5:0.5366,NDCG@5:0.3952) [32.0 s] 
INFO:root:all_losses: [0.14757288 0.6103469 ]
INFO:root:Epoch 22    loss=0.1476 [160.8 s]	 dev=(HR@5:0.5907,NDCG@5:0.4273) test=(HR@5:0.5483,NDCG@5:0.3979) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.15145372 0.6065595 ]
INFO:root:Epoch 23    loss=0.1515 [160.4 s]	 dev=(HR@5:0.5843,NDCG@5:0.4272) test=(HR@5:0.5493,NDCG@5:0.3875) [31.6 s] 
INFO:root:all_losses: [0.14561182 0.60357374]
INFO:root:Epoch 24    loss=0.1456 [160.9 s]	 dev=(HR@5:0.5748,NDCG@5:0.4236) test=(HR@5:0.5355,NDCG@5:0.3870) [32.1 s] 
INFO:root:all_losses: [0.14576507 0.59841204]
INFO:root:Epoch 25    loss=0.1458 [160.0 s]	 dev=(HR@5:0.5864,NDCG@5:0.4158) test=(HR@5:0.5461,NDCG@5:0.3833) [32.0 s] 
INFO:root:all_losses: [0.14255475 0.59638804]
INFO:root:Epoch 26    loss=0.1426 [160.6 s]	 dev=(HR@5:0.5864,NDCG@5:0.4217) test=(HR@5:0.5440,NDCG@5:0.3869) [32.2 s] 
INFO:root:all_losses: [0.13947959 0.59254634]
INFO:root:Epoch 27    loss=0.1395 [161.2 s]	 dev=(HR@5:0.5864,NDCG@5:0.4167) test=(HR@5:0.5323,NDCG@5:0.3726) [32.1 s] 
INFO:root:all_losses: [0.13947923 0.5900977 ]
INFO:root:Epoch 28    loss=0.1395 [160.3 s]	 dev=(HR@5:0.5896,NDCG@5:0.4210) test=(HR@5:0.5387,NDCG@5:0.3794) [31.7 s] 
INFO:root:all_losses: [0.13700469 0.5855152 ]
INFO:root:Epoch 29    loss=0.1370 [161.2 s]	 dev=(HR@5:0.5949,NDCG@5:0.4284) test=(HR@5:0.5302,NDCG@5:0.3735) [31.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13817042 0.5803547 ]
INFO:root:Epoch 30    loss=0.1382 [160.1 s]	 dev=(HR@5:0.5864,NDCG@5:0.4250) test=(HR@5:0.5323,NDCG@5:0.3862) [31.9 s] 
INFO:root:all_losses: [0.1366165 0.5778679]
INFO:root:Epoch 31    loss=0.1366 [160.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4156) test=(HR@5:0.5196,NDCG@5:0.3727) [31.8 s] 
INFO:root:all_losses: [0.13418998 0.5726353 ]
INFO:root:Epoch 32    loss=0.1342 [160.8 s]	 dev=(HR@5:0.6066,NDCG@5:0.4409) test=(HR@5:0.5376,NDCG@5:0.3892) [32.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13094962 0.5686878 ]
INFO:root:Epoch 33    loss=0.1309 [160.3 s]	 dev=(HR@5:0.5801,NDCG@5:0.4165) test=(HR@5:0.5292,NDCG@5:0.3749) [31.8 s] 
INFO:root:all_losses: [0.13265637 0.56404334]
INFO:root:Epoch 34    loss=0.1327 [160.8 s]	 dev=(HR@5:0.5716,NDCG@5:0.4143) test=(HR@5:0.5281,NDCG@5:0.3812) [31.9 s] 
INFO:root:all_losses: [0.12986398 0.5606419 ]
INFO:root:Epoch 35    loss=0.1299 [162.4 s]	 dev=(HR@5:0.5822,NDCG@5:0.4234) test=(HR@5:0.5461,NDCG@5:0.3850) [32.0 s] 
INFO:root:all_losses: [0.12849347 0.55736446]
INFO:root:Epoch 36    loss=0.1285 [163.1 s]	 dev=(HR@5:0.5896,NDCG@5:0.4202) test=(HR@5:0.5186,NDCG@5:0.3692) [31.8 s] 
INFO:root:all_losses: [0.12720612 0.55141366]
INFO:root:Epoch 37    loss=0.1272 [165.4 s]	 dev=(HR@5:0.5885,NDCG@5:0.4248) test=(HR@5:0.5366,NDCG@5:0.3815) [33.5 s] 
INFO:root:all_losses: [0.12813915 0.5485524 ]
INFO:root:Epoch 38    loss=0.1281 [170.9 s]	 dev=(HR@5:0.6002,NDCG@5:0.4267) test=(HR@5:0.5483,NDCG@5:0.3930) [32.7 s] 
INFO:root:all_losses: [0.12451836 0.54411095]
INFO:root:Epoch 39    loss=0.1245 [174.6 s]	 dev=(HR@5:0.5928,NDCG@5:0.4336) test=(HR@5:0.5387,NDCG@5:0.3924) [32.9 s] 
INFO:root:all_losses: [0.12285521 0.5385211 ]
INFO:root:Epoch 40    loss=0.1229 [173.8 s]	 dev=(HR@5:0.5917,NDCG@5:0.4317) test=(HR@5:0.5281,NDCG@5:0.3825) [32.5 s] 
INFO:root:all_losses: [0.12465047 0.53374493]
INFO:root:Epoch 41    loss=0.1247 [172.9 s]	 dev=(HR@5:0.5917,NDCG@5:0.4206) test=(HR@5:0.5217,NDCG@5:0.3774) [32.7 s] 
INFO:root:all_losses: [0.12188406 0.52995247]
INFO:root:Epoch 42    loss=0.1219 [173.2 s]	 dev=(HR@5:0.5705,NDCG@5:0.4113) test=(HR@5:0.5451,NDCG@5:0.3958) [32.8 s] 
INFO:root:all_losses: [0.12090315 0.5234341 ]
INFO:root:Epoch 43    loss=0.1209 [169.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4184) test=(HR@5:0.5196,NDCG@5:0.3811) [32.8 s] 
INFO:root:all_losses: [0.12080138 0.5195158 ]
INFO:root:Epoch 44    loss=0.1208 [176.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4168) test=(HR@5:0.5578,NDCG@5:0.4019) [32.9 s] 
INFO:root:all_losses: [0.11807622 0.5168508 ]
INFO:root:Epoch 45    loss=0.1181 [172.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.4123) test=(HR@5:0.5398,NDCG@5:0.3861) [33.4 s] 
INFO:root:all_losses: [0.11804464 0.5122709 ]
INFO:root:Epoch 46    loss=0.1180 [171.4 s]	 dev=(HR@5:0.5705,NDCG@5:0.4109) test=(HR@5:0.5345,NDCG@5:0.3822) [32.1 s] 
INFO:root:all_losses: [0.11867831 0.5065954 ]
INFO:root:Epoch 47    loss=0.1187 [173.6 s]	 dev=(HR@5:0.5938,NDCG@5:0.4254) test=(HR@5:0.5302,NDCG@5:0.3767) [32.6 s] 
INFO:root:all_losses: [0.11603343 0.5039165 ]
INFO:root:Epoch 48    loss=0.1160 [164.6 s]	 dev=(HR@5:0.5769,NDCG@5:0.4085) test=(HR@5:0.5270,NDCG@5:0.3695) [32.1 s] 
INFO:root:all_losses: [0.11754027 0.49971166]
INFO:root:Epoch 49    loss=0.1175 [157.8 s]	 dev=(HR@5:0.5705,NDCG@5:0.4112) test=(HR@5:0.5472,NDCG@5:0.3860) [31.4 s] 
INFO:root:all_losses: [0.11430128 0.4942636 ]
INFO:root:Epoch 50    loss=0.1143 [153.9 s]	 dev=(HR@5:0.5684,NDCG@5:0.4083) test=(HR@5:0.5408,NDCG@5:0.3802) [31.4 s] 
INFO:root:all_losses: [0.11534233 0.49171585]
INFO:root:Epoch 51    loss=0.1153 [153.5 s]	 dev=(HR@5:0.5758,NDCG@5:0.4183) test=(HR@5:0.5419,NDCG@5:0.3889) [31.2 s] 
INFO:root:all_losses: [0.11468546 0.48659676]
INFO:root:Epoch 52    loss=0.1147 [155.3 s]	 dev=(HR@5:0.5779,NDCG@5:0.4133) test=(HR@5:0.5419,NDCG@5:0.3905) [31.6 s] 
INFO:root:Early stop at 52 based on dev result.
INFO:root:
Best Iter(dev)=   32	 dev=(HR@5:0.6066,NDCG@5:0.4409) test=(HR@5:0.5376,NDCG@5:0.3892) [10074.3 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_gamma=-1.0_freq_rand=1_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7147,HR@5:0.5376,HR@50:0.9629,NDCG@10:0.4467,NDCG@5:0.3892,NDCG@50:0.5038)
INFO:root:
--------------------------------------------- END: 2025-04-28 11:21:31 ---------------------------------------------
