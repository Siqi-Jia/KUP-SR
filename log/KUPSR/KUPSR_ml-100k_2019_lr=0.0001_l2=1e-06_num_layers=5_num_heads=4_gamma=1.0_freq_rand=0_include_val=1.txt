INFO:root:Namespace(model_name='KDA')
INFO:root:--------------------------------------------- BEGIN: 2025-07-15 10:20:33 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 freq_rand       | 0            
 gamma           | 1.0          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 metric          | ["NDCG","HR"]
 n_dft           | 64           
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 t_scalar        | 60           
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\DFTReader.pkl
INFO:root:#params: 282737
INFO:root:KDA(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
    (freq_real): Embedding(21, 33)
    (freq_imag): Embedding(21, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
  (blstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (fusion_layer): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@10:0.0944,HR@5:0.0488,HR@50:0.4825,NDCG@10:0.0440,NDCG@5:0.0295,NDCG@50:0.1257)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2396666 0.6931464]
INFO:root:Epoch 1     loss=1.2397 [121.4 s]	 dev=(HR@5:0.2333,NDCG@5:0.1553) test=(HR@5:0.2163,NDCG@5:0.1478) [28.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.1277235 0.6931394]
INFO:root:Epoch 2     loss=1.1277 [120.9 s]	 dev=(HR@5:0.2322,NDCG@5:0.1528) test=(HR@5:0.2110,NDCG@5:0.1442) [28.2 s] 
INFO:root:all_losses: [1.1046159 0.693124 ]
INFO:root:Epoch 3     loss=1.1046 [121.0 s]	 dev=(HR@5:0.2238,NDCG@5:0.1508) test=(HR@5:0.2047,NDCG@5:0.1434) [28.3 s] 
INFO:root:all_losses: [1.0961196 0.6931035]
INFO:root:Epoch 4     loss=1.0961 [120.6 s]	 dev=(HR@5:0.2312,NDCG@5:0.1554) test=(HR@5:0.2089,NDCG@5:0.1439) [27.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.095418   0.69308853]
INFO:root:Epoch 5     loss=1.0954 [121.4 s]	 dev=(HR@5:0.2344,NDCG@5:0.1580) test=(HR@5:0.2089,NDCG@5:0.1421) [28.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.0936215 0.6930601]
INFO:root:Epoch 6     loss=1.0936 [123.0 s]	 dev=(HR@5:0.2407,NDCG@5:0.1597) test=(HR@5:0.2153,NDCG@5:0.1456) [28.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.0928733  0.69304335]
INFO:root:Epoch 7     loss=1.0929 [130.3 s]	 dev=(HR@5:0.2291,NDCG@5:0.1550) test=(HR@5:0.2174,NDCG@5:0.1458) [28.0 s] 
INFO:root:all_losses: [1.0938553  0.69302416]
INFO:root:Epoch 8     loss=1.0939 [144.5 s]	 dev=(HR@5:0.2354,NDCG@5:0.1556) test=(HR@5:0.2110,NDCG@5:0.1455) [28.2 s] 
INFO:root:all_losses: [1.0917917 0.6930146]
INFO:root:Epoch 9     loss=1.0918 [177.7 s]	 dev=(HR@5:0.2333,NDCG@5:0.1543) test=(HR@5:0.2195,NDCG@5:0.1496) [28.0 s] 
INFO:root:all_losses: [1.0946714  0.69300014]
INFO:root:Epoch 10    loss=1.0947 [193.2 s]	 dev=(HR@5:0.2280,NDCG@5:0.1492) test=(HR@5:0.2110,NDCG@5:0.1459) [27.9 s] 
INFO:root:all_losses: [1.0937625  0.69297504]
INFO:root:Epoch 11    loss=1.0938 [192.1 s]	 dev=(HR@5:0.2386,NDCG@5:0.1542) test=(HR@5:0.2163,NDCG@5:0.1465) [28.4 s] 
INFO:root:all_losses: [1.090439  0.6929536]
INFO:root:Epoch 12    loss=1.0904 [181.0 s]	 dev=(HR@5:0.2301,NDCG@5:0.1524) test=(HR@5:0.2131,NDCG@5:0.1438) [29.2 s] 
INFO:root:all_losses: [1.0920883 0.6929613]
INFO:root:Epoch 13    loss=1.0921 [154.1 s]	 dev=(HR@5:0.2397,NDCG@5:0.1572) test=(HR@5:0.2089,NDCG@5:0.1442) [31.5 s] 
INFO:root:all_losses: [1.0927968  0.69292825]
INFO:root:Epoch 14    loss=1.0928 [154.1 s]	 dev=(HR@5:0.2333,NDCG@5:0.1520) test=(HR@5:0.2089,NDCG@5:0.1439) [33.1 s] 
INFO:root:all_losses: [1.0823078  0.69290525]
INFO:root:Epoch 15    loss=1.0823 [162.5 s]	 dev=(HR@5:0.2344,NDCG@5:0.1519) test=(HR@5:0.2068,NDCG@5:0.1400) [38.4 s] 
INFO:root:all_losses: [1.0723859  0.69285506]
INFO:root:Epoch 16    loss=1.0724 [181.0 s]	 dev=(HR@5:0.2418,NDCG@5:0.1594) test=(HR@5:0.2057,NDCG@5:0.1420) [38.5 s] 
INFO:root:all_losses: [1.0624566  0.69276756]
INFO:root:Epoch 17    loss=1.0625 [203.9 s]	 dev=(HR@5:0.2577,NDCG@5:0.1704) test=(HR@5:0.2248,NDCG@5:0.1503) [32.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.0525069  0.69273335]
INFO:root:Epoch 18    loss=1.0525 [317.4 s]	 dev=(HR@5:0.2587,NDCG@5:0.1675) test=(HR@5:0.2216,NDCG@5:0.1482) [28.1 s] 
INFO:root:all_losses: [1.0449638  0.69263256]
INFO:root:Epoch 19    loss=1.0450 [385.1 s]	 dev=(HR@5:0.2704,NDCG@5:0.1750) test=(HR@5:0.2333,NDCG@5:0.1572) [28.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.0282279 0.6925013]
INFO:root:Epoch 20    loss=1.0282 [394.5 s]	 dev=(HR@5:0.3065,NDCG@5:0.2036) test=(HR@5:0.2641,NDCG@5:0.1750) [28.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.0019608 0.6924068]
INFO:root:Epoch 21    loss=1.0020 [395.6 s]	 dev=(HR@5:0.3012,NDCG@5:0.2084) test=(HR@5:0.2683,NDCG@5:0.1823) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.98378867 0.69221866]
INFO:root:Epoch 22    loss=0.9838 [384.2 s]	 dev=(HR@5:0.3627,NDCG@5:0.2526) test=(HR@5:0.3139,NDCG@5:0.2131) [34.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.9737045 0.6919935]
INFO:root:Epoch 23    loss=0.9737 [367.2 s]	 dev=(HR@5:0.4019,NDCG@5:0.2783) test=(HR@5:0.3499,NDCG@5:0.2322) [35.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.95978034 0.6916406 ]
INFO:root:Epoch 24    loss=0.9598 [357.4 s]	 dev=(HR@5:0.4252,NDCG@5:0.2956) test=(HR@5:0.3754,NDCG@5:0.2496) [35.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.94999915 0.6912507 ]
INFO:root:Epoch 25    loss=0.9500 [353.7 s]	 dev=(HR@5:0.4252,NDCG@5:0.2979) test=(HR@5:0.3786,NDCG@5:0.2506) [36.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.9391335 0.6908932]
INFO:root:Epoch 26    loss=0.9391 [350.9 s]	 dev=(HR@5:0.4443,NDCG@5:0.3196) test=(HR@5:0.4040,NDCG@5:0.2684) [36.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.92728096 0.690373  ]
INFO:root:Epoch 27    loss=0.9273 [349.7 s]	 dev=(HR@5:0.4528,NDCG@5:0.3242) test=(HR@5:0.4221,NDCG@5:0.2776) [34.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.91325915 0.68993616]
INFO:root:Epoch 28    loss=0.9133 [374.0 s]	 dev=(HR@5:0.4867,NDCG@5:0.3433) test=(HR@5:0.4602,NDCG@5:0.3051) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.902092  0.6892278]
INFO:root:Epoch 29    loss=0.9021 [388.2 s]	 dev=(HR@5:0.4825,NDCG@5:0.3389) test=(HR@5:0.4358,NDCG@5:0.2928) [31.7 s] 
INFO:root:all_losses: [0.8951723  0.68848246]
INFO:root:Epoch 30    loss=0.8952 [393.4 s]	 dev=(HR@5:0.5027,NDCG@5:0.3540) test=(HR@5:0.4719,NDCG@5:0.3118) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8901379 0.6876779]
INFO:root:Epoch 31    loss=0.8901 [345.3 s]	 dev=(HR@5:0.4878,NDCG@5:0.3490) test=(HR@5:0.4645,NDCG@5:0.3121) [33.9 s] 
INFO:root:all_losses: [0.88310826 0.6869301 ]
INFO:root:Epoch 32    loss=0.8831 [302.1 s]	 dev=(HR@5:0.4995,NDCG@5:0.3528) test=(HR@5:0.4698,NDCG@5:0.3181) [35.7 s] 
INFO:root:all_losses: [0.87742263 0.68608195]
INFO:root:Epoch 33    loss=0.8774 [267.5 s]	 dev=(HR@5:0.4920,NDCG@5:0.3532) test=(HR@5:0.4687,NDCG@5:0.3147) [35.4 s] 
INFO:root:all_losses: [0.8754045 0.6851716]
INFO:root:Epoch 34    loss=0.8754 [268.8 s]	 dev=(HR@5:0.4995,NDCG@5:0.3544) test=(HR@5:0.4814,NDCG@5:0.3212) [33.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8704547  0.68426394]
INFO:root:Epoch 35    loss=0.8705 [255.8 s]	 dev=(HR@5:0.5133,NDCG@5:0.3579) test=(HR@5:0.4899,NDCG@5:0.3290) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.86707824 0.68325055]
INFO:root:Epoch 36    loss=0.8671 [242.1 s]	 dev=(HR@5:0.5164,NDCG@5:0.3661) test=(HR@5:0.4836,NDCG@5:0.3282) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8632164 0.6821683]
INFO:root:Epoch 37    loss=0.8632 [238.1 s]	 dev=(HR@5:0.5186,NDCG@5:0.3656) test=(HR@5:0.4963,NDCG@5:0.3338) [30.9 s] 
INFO:root:all_losses: [0.8613484 0.6810753]
INFO:root:Epoch 38    loss=0.8613 [236.7 s]	 dev=(HR@5:0.5111,NDCG@5:0.3610) test=(HR@5:0.4825,NDCG@5:0.3254) [30.9 s] 
INFO:root:all_losses: [0.85653234 0.67993224]
INFO:root:Epoch 39    loss=0.8565 [217.1 s]	 dev=(HR@5:0.5313,NDCG@5:0.3703) test=(HR@5:0.4963,NDCG@5:0.3377) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.85203093 0.6786997 ]
INFO:root:Epoch 40    loss=0.8520 [183.9 s]	 dev=(HR@5:0.5207,NDCG@5:0.3685) test=(HR@5:0.4836,NDCG@5:0.3351) [32.7 s] 
INFO:root:all_losses: [0.8512981 0.6772202]
INFO:root:Epoch 41    loss=0.8513 [161.5 s]	 dev=(HR@5:0.5164,NDCG@5:0.3580) test=(HR@5:0.4687,NDCG@5:0.3205) [33.9 s] 
INFO:root:all_losses: [0.84770787 0.6760678 ]
INFO:root:Epoch 42    loss=0.8477 [155.1 s]	 dev=(HR@5:0.5292,NDCG@5:0.3669) test=(HR@5:0.4910,NDCG@5:0.3364) [31.0 s] 
INFO:root:all_losses: [0.8436567 0.6743742]
INFO:root:Epoch 43    loss=0.8437 [154.7 s]	 dev=(HR@5:0.5302,NDCG@5:0.3672) test=(HR@5:0.4804,NDCG@5:0.3341) [31.1 s] 
INFO:root:all_losses: [0.84105027 0.6728586 ]
INFO:root:Epoch 44    loss=0.8411 [153.8 s]	 dev=(HR@5:0.5451,NDCG@5:0.3820) test=(HR@5:0.5016,NDCG@5:0.3502) [31.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.83653885 0.6714283 ]
INFO:root:Epoch 45    loss=0.8365 [154.0 s]	 dev=(HR@5:0.5398,NDCG@5:0.3763) test=(HR@5:0.5027,NDCG@5:0.3445) [31.2 s] 
INFO:root:all_losses: [0.8333444  0.66966397]
INFO:root:Epoch 46    loss=0.8333 [154.0 s]	 dev=(HR@5:0.5451,NDCG@5:0.3785) test=(HR@5:0.4942,NDCG@5:0.3436) [30.9 s] 
INFO:root:all_losses: [0.8314284  0.66773546]
INFO:root:Epoch 47    loss=0.8314 [154.7 s]	 dev=(HR@5:0.5408,NDCG@5:0.3761) test=(HR@5:0.4973,NDCG@5:0.3445) [31.1 s] 
INFO:root:all_losses: [0.8268293 0.665942 ]
INFO:root:Epoch 48    loss=0.8268 [153.6 s]	 dev=(HR@5:0.5461,NDCG@5:0.3816) test=(HR@5:0.4899,NDCG@5:0.3426) [31.0 s] 
INFO:root:all_losses: [0.824658  0.6642419]
INFO:root:Epoch 49    loss=0.8247 [154.2 s]	 dev=(HR@5:0.5408,NDCG@5:0.3782) test=(HR@5:0.4867,NDCG@5:0.3419) [31.0 s] 
INFO:root:all_losses: [0.8189754 0.6621349]
INFO:root:Epoch 50    loss=0.8190 [153.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.3883) test=(HR@5:0.5133,NDCG@5:0.3570) [30.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8175236 0.6595724]
INFO:root:Epoch 51    loss=0.8175 [154.3 s]	 dev=(HR@5:0.5536,NDCG@5:0.3918) test=(HR@5:0.5154,NDCG@5:0.3580) [30.9 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8134055  0.65711737]
INFO:root:Epoch 52    loss=0.8134 [153.2 s]	 dev=(HR@5:0.5684,NDCG@5:0.3959) test=(HR@5:0.5154,NDCG@5:0.3600) [31.1 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.80829656 0.65470356]
INFO:root:Epoch 53    loss=0.8083 [154.4 s]	 dev=(HR@5:0.5620,NDCG@5:0.3936) test=(HR@5:0.5090,NDCG@5:0.3545) [30.7 s] 
INFO:root:all_losses: [0.80448836 0.6523912 ]
INFO:root:Epoch 54    loss=0.8045 [152.9 s]	 dev=(HR@5:0.5663,NDCG@5:0.3998) test=(HR@5:0.5143,NDCG@5:0.3612) [30.7 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8006213  0.64983785]
INFO:root:Epoch 55    loss=0.8006 [153.1 s]	 dev=(HR@5:0.5716,NDCG@5:0.3996) test=(HR@5:0.5260,NDCG@5:0.3712) [30.7 s] 
INFO:root:all_losses: [0.80011183 0.6477932 ]
INFO:root:Epoch 56    loss=0.8001 [153.8 s]	 dev=(HR@5:0.5737,NDCG@5:0.4051) test=(HR@5:0.5196,NDCG@5:0.3627) [30.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.7916864 0.6439211]
INFO:root:Epoch 57    loss=0.7917 [153.2 s]	 dev=(HR@5:0.5779,NDCG@5:0.4094) test=(HR@5:0.5292,NDCG@5:0.3718) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.7860153  0.64178956]
INFO:root:Epoch 58    loss=0.7860 [153.3 s]	 dev=(HR@5:0.5726,NDCG@5:0.4061) test=(HR@5:0.5398,NDCG@5:0.3780) [30.5 s] 
INFO:root:all_losses: [0.7831945  0.63818204]
INFO:root:Epoch 59    loss=0.7832 [152.5 s]	 dev=(HR@5:0.5854,NDCG@5:0.4171) test=(HR@5:0.5398,NDCG@5:0.3796) [30.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.7805545 0.6345176]
INFO:root:Epoch 60    loss=0.7806 [153.3 s]	 dev=(HR@5:0.5981,NDCG@5:0.4206) test=(HR@5:0.5525,NDCG@5:0.3876) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.77519166 0.6316662 ]
INFO:root:Epoch 61    loss=0.7752 [153.1 s]	 dev=(HR@5:0.5705,NDCG@5:0.4014) test=(HR@5:0.5260,NDCG@5:0.3704) [30.5 s] 
INFO:root:all_losses: [0.7711456  0.62754154]
INFO:root:Epoch 62    loss=0.7711 [153.9 s]	 dev=(HR@5:0.5769,NDCG@5:0.4132) test=(HR@5:0.5334,NDCG@5:0.3742) [30.2 s] 
INFO:root:all_losses: [0.76618534 0.62366545]
INFO:root:Epoch 63    loss=0.7662 [152.4 s]	 dev=(HR@5:0.5673,NDCG@5:0.4034) test=(HR@5:0.5111,NDCG@5:0.3591) [30.2 s] 
INFO:root:all_losses: [0.7579873 0.6189085]
INFO:root:Epoch 64    loss=0.7580 [153.5 s]	 dev=(HR@5:0.5970,NDCG@5:0.4246) test=(HR@5:0.5398,NDCG@5:0.3849) [30.2 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.7566198  0.61592925]
INFO:root:Epoch 65    loss=0.7566 [152.5 s]	 dev=(HR@5:0.5928,NDCG@5:0.4243) test=(HR@5:0.5302,NDCG@5:0.3753) [30.3 s] 
INFO:root:all_losses: [0.750373  0.6113832]
INFO:root:Epoch 66    loss=0.7504 [154.0 s]	 dev=(HR@5:0.5885,NDCG@5:0.4137) test=(HR@5:0.5334,NDCG@5:0.3781) [30.5 s] 
INFO:root:all_losses: [0.74441725 0.60715497]
INFO:root:Epoch 67    loss=0.7444 [152.5 s]	 dev=(HR@5:0.6098,NDCG@5:0.4354) test=(HR@5:0.5525,NDCG@5:0.3942) [30.3 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.74138665 0.6019912 ]
INFO:root:Epoch 68    loss=0.7414 [153.5 s]	 dev=(HR@5:0.5949,NDCG@5:0.4224) test=(HR@5:0.5355,NDCG@5:0.3793) [30.1 s] 
INFO:root:all_losses: [0.73444104 0.5983609 ]
INFO:root:Epoch 69    loss=0.7344 [152.7 s]	 dev=(HR@5:0.5716,NDCG@5:0.4105) test=(HR@5:0.5101,NDCG@5:0.3650) [30.1 s] 
INFO:root:all_losses: [0.7308746 0.5929771]
INFO:root:Epoch 70    loss=0.7309 [153.0 s]	 dev=(HR@5:0.5960,NDCG@5:0.4283) test=(HR@5:0.5504,NDCG@5:0.3857) [30.2 s] 
INFO:root:all_losses: [0.7244088  0.58677614]
INFO:root:Epoch 71    loss=0.7244 [152.2 s]	 dev=(HR@5:0.5981,NDCG@5:0.4259) test=(HR@5:0.5504,NDCG@5:0.3928) [30.1 s] 
INFO:root:all_losses: [0.7180788 0.5817035]
INFO:root:Epoch 72    loss=0.7181 [152.6 s]	 dev=(HR@5:0.5896,NDCG@5:0.4244) test=(HR@5:0.5398,NDCG@5:0.3887) [30.0 s] 
INFO:root:all_losses: [0.7140033 0.5761499]
INFO:root:Epoch 73    loss=0.7140 [153.3 s]	 dev=(HR@5:0.5885,NDCG@5:0.4165) test=(HR@5:0.5472,NDCG@5:0.3836) [30.2 s] 
INFO:root:all_losses: [0.70603687 0.57144105]
INFO:root:Epoch 74    loss=0.7060 [152.4 s]	 dev=(HR@5:0.5938,NDCG@5:0.4236) test=(HR@5:0.5398,NDCG@5:0.3881) [30.5 s] 
INFO:root:all_losses: [0.69851977 0.5646702 ]
INFO:root:Epoch 75    loss=0.6985 [152.8 s]	 dev=(HR@5:0.5907,NDCG@5:0.4252) test=(HR@5:0.5525,NDCG@5:0.3924) [30.1 s] 
INFO:root:all_losses: [0.69159293 0.5578333 ]
INFO:root:Epoch 76    loss=0.6916 [152.2 s]	 dev=(HR@5:0.6002,NDCG@5:0.4255) test=(HR@5:0.5429,NDCG@5:0.3881) [30.4 s] 
INFO:root:all_losses: [0.6845475  0.55169684]
INFO:root:Epoch 77    loss=0.6845 [153.3 s]	 dev=(HR@5:0.5992,NDCG@5:0.4311) test=(HR@5:0.5557,NDCG@5:0.3978) [30.3 s] 
INFO:root:all_losses: [0.6770003 0.5456201]
INFO:root:Epoch 78    loss=0.6770 [152.7 s]	 dev=(HR@5:0.5885,NDCG@5:0.4232) test=(HR@5:0.5493,NDCG@5:0.3888) [30.1 s] 
INFO:root:all_losses: [0.67178386 0.5392217 ]
INFO:root:Epoch 79    loss=0.6718 [152.6 s]	 dev=(HR@5:0.5992,NDCG@5:0.4289) test=(HR@5:0.5536,NDCG@5:0.3952) [30.2 s] 
INFO:root:all_losses: [0.6621255  0.53146654]
INFO:root:Epoch 80    loss=0.6621 [151.8 s]	 dev=(HR@5:0.6013,NDCG@5:0.4272) test=(HR@5:0.5483,NDCG@5:0.3854) [30.1 s] 
INFO:root:all_losses: [0.6584473  0.52579576]
INFO:root:Epoch 81    loss=0.6584 [152.9 s]	 dev=(HR@5:0.5938,NDCG@5:0.4292) test=(HR@5:0.5408,NDCG@5:0.3836) [30.0 s] 
INFO:root:all_losses: [0.6491347  0.51799583]
INFO:root:Epoch 82    loss=0.6491 [152.2 s]	 dev=(HR@5:0.6013,NDCG@5:0.4337) test=(HR@5:0.5599,NDCG@5:0.3967) [29.9 s] 
INFO:root:all_losses: [0.6423614 0.512085 ]
INFO:root:Epoch 83    loss=0.6424 [153.4 s]	 dev=(HR@5:0.6013,NDCG@5:0.4336) test=(HR@5:0.5567,NDCG@5:0.4009) [30.0 s] 
INFO:root:all_losses: [0.6360988  0.50421655]
INFO:root:Epoch 84    loss=0.6361 [152.3 s]	 dev=(HR@5:0.5907,NDCG@5:0.4306) test=(HR@5:0.5504,NDCG@5:0.3860) [30.2 s] 
INFO:root:all_losses: [0.6284054  0.49770302]
INFO:root:Epoch 85    loss=0.6284 [153.2 s]	 dev=(HR@5:0.5981,NDCG@5:0.4349) test=(HR@5:0.5366,NDCG@5:0.3863) [29.9 s] 
INFO:root:all_losses: [0.62242424 0.49077964]
INFO:root:Epoch 86    loss=0.6224 [152.3 s]	 dev=(HR@5:0.6119,NDCG@5:0.4390) test=(HR@5:0.5567,NDCG@5:0.3972) [30.0 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.6128752 0.4837044]
INFO:root:Epoch 87    loss=0.6129 [153.5 s]	 dev=(HR@5:0.6108,NDCG@5:0.4323) test=(HR@5:0.5461,NDCG@5:0.3902) [30.2 s] 
INFO:root:all_losses: [0.60484207 0.475327  ]
INFO:root:Epoch 88    loss=0.6048 [152.3 s]	 dev=(HR@5:0.5981,NDCG@5:0.4254) test=(HR@5:0.5387,NDCG@5:0.3851) [30.3 s] 
INFO:root:all_losses: [0.5985082  0.46947673]
INFO:root:Epoch 89    loss=0.5985 [153.1 s]	 dev=(HR@5:0.6066,NDCG@5:0.4290) test=(HR@5:0.5652,NDCG@5:0.4023) [29.8 s] 
INFO:root:all_losses: [0.59478825 0.464572  ]
INFO:root:Epoch 90    loss=0.5948 [152.2 s]	 dev=(HR@5:0.6087,NDCG@5:0.4354) test=(HR@5:0.5599,NDCG@5:0.4008) [30.1 s] 
INFO:root:all_losses: [0.5852063 0.4557988]
INFO:root:Epoch 91    loss=0.5852 [153.3 s]	 dev=(HR@5:0.6076,NDCG@5:0.4360) test=(HR@5:0.5610,NDCG@5:0.3982) [30.0 s] 
INFO:root:all_losses: [0.5783525  0.45013028]
INFO:root:Epoch 92    loss=0.5784 [152.3 s]	 dev=(HR@5:0.6076,NDCG@5:0.4324) test=(HR@5:0.5451,NDCG@5:0.3938) [30.0 s] 
INFO:root:all_losses: [0.57161325 0.4433849 ]
INFO:root:Epoch 93    loss=0.5716 [152.6 s]	 dev=(HR@5:0.5938,NDCG@5:0.4297) test=(HR@5:0.5387,NDCG@5:0.3841) [30.1 s] 
INFO:root:all_losses: [0.56470346 0.43652368]
INFO:root:Epoch 94    loss=0.5647 [152.9 s]	 dev=(HR@5:0.6108,NDCG@5:0.4382) test=(HR@5:0.5461,NDCG@5:0.3905) [29.7 s] 
INFO:root:all_losses: [0.5592303  0.43164483]
INFO:root:Epoch 95    loss=0.5592 [152.6 s]	 dev=(HR@5:0.6045,NDCG@5:0.4325) test=(HR@5:0.5366,NDCG@5:0.3912) [30.1 s] 
INFO:root:all_losses: [0.5515958  0.42473856]
INFO:root:Epoch 96    loss=0.5516 [152.3 s]	 dev=(HR@5:0.6055,NDCG@5:0.4369) test=(HR@5:0.5461,NDCG@5:0.3932) [29.7 s] 
INFO:root:all_losses: [0.5462474 0.4200182]
INFO:root:Epoch 97    loss=0.5462 [152.7 s]	 dev=(HR@5:0.6119,NDCG@5:0.4376) test=(HR@5:0.5451,NDCG@5:0.3901) [29.9 s] 
INFO:root:all_losses: [0.54194456 0.41505647]
INFO:root:Epoch 98    loss=0.5419 [153.2 s]	 dev=(HR@5:0.6108,NDCG@5:0.4351) test=(HR@5:0.5599,NDCG@5:0.3987) [29.7 s] 
INFO:root:all_losses: [0.5350898 0.4068076]
INFO:root:Epoch 99    loss=0.5351 [153.0 s]	 dev=(HR@5:0.6013,NDCG@5:0.4291) test=(HR@5:0.5419,NDCG@5:0.3878) [29.8 s] 
INFO:root:all_losses: [0.53009516 0.40327892]
INFO:root:Epoch 100   loss=0.5301 [152.4 s]	 dev=(HR@5:0.5981,NDCG@5:0.4327) test=(HR@5:0.5536,NDCG@5:0.3928) [29.8 s] 
INFO:root:all_losses: [0.5234503  0.39700964]
INFO:root:Epoch 101   loss=0.5235 [152.0 s]	 dev=(HR@5:0.5960,NDCG@5:0.4285) test=(HR@5:0.5376,NDCG@5:0.3830) [29.7 s] 
INFO:root:all_losses: [0.5164901  0.39120013]
INFO:root:Epoch 102   loss=0.5165 [152.8 s]	 dev=(HR@5:0.6140,NDCG@5:0.4379) test=(HR@5:0.5578,NDCG@5:0.3946) [29.8 s] 
INFO:root:all_losses: [0.5091845  0.38500324]
INFO:root:Epoch 103   loss=0.5092 [152.6 s]	 dev=(HR@5:0.6076,NDCG@5:0.4354) test=(HR@5:0.5642,NDCG@5:0.3976) [30.1 s] 
INFO:root:all_losses: [0.50474536 0.38031912]
INFO:root:Epoch 104   loss=0.5047 [153.0 s]	 dev=(HR@5:0.6151,NDCG@5:0.4400) test=(HR@5:0.5546,NDCG@5:0.3929) [29.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.50156003 0.37572235]
INFO:root:Epoch 105   loss=0.5016 [153.7 s]	 dev=(HR@5:0.6151,NDCG@5:0.4416) test=(HR@5:0.5599,NDCG@5:0.4041) [29.8 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.4958713  0.36946827]
INFO:root:Epoch 106   loss=0.4959 [153.1 s]	 dev=(HR@5:0.6098,NDCG@5:0.4412) test=(HR@5:0.5493,NDCG@5:0.3980) [29.5 s] 
INFO:root:all_losses: [0.4900014  0.36479008]
INFO:root:Epoch 107   loss=0.4900 [152.0 s]	 dev=(HR@5:0.6129,NDCG@5:0.4423) test=(HR@5:0.5514,NDCG@5:0.3971) [29.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.4872324  0.36084384]
INFO:root:Epoch 108   loss=0.4872 [153.0 s]	 dev=(HR@5:0.6108,NDCG@5:0.4436) test=(HR@5:0.5525,NDCG@5:0.4009) [29.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.47852328 0.355045  ]
INFO:root:Epoch 109   loss=0.4785 [151.8 s]	 dev=(HR@5:0.6045,NDCG@5:0.4371) test=(HR@5:0.5376,NDCG@5:0.3903) [29.8 s] 
INFO:root:all_losses: [0.47725922 0.35329556]
INFO:root:Epoch 110   loss=0.4773 [153.7 s]	 dev=(HR@5:0.6055,NDCG@5:0.4363) test=(HR@5:0.5557,NDCG@5:0.3940) [29.8 s] 
INFO:root:all_losses: [0.4706746  0.34724283]
INFO:root:Epoch 111   loss=0.4707 [152.0 s]	 dev=(HR@5:0.6151,NDCG@5:0.4394) test=(HR@5:0.5461,NDCG@5:0.3926) [29.6 s] 
INFO:root:all_losses: [0.46361175 0.34222016]
INFO:root:Epoch 112   loss=0.4636 [153.7 s]	 dev=(HR@5:0.6066,NDCG@5:0.4347) test=(HR@5:0.5461,NDCG@5:0.3904) [30.0 s] 
INFO:root:all_losses: [0.45960826 0.33640563]
INFO:root:Epoch 113   loss=0.4596 [152.3 s]	 dev=(HR@5:0.6193,NDCG@5:0.4422) test=(HR@5:0.5589,NDCG@5:0.4026) [29.7 s] 
INFO:root:all_losses: [0.45804343 0.33364442]
INFO:root:Epoch 114   loss=0.4580 [153.2 s]	 dev=(HR@5:0.6151,NDCG@5:0.4391) test=(HR@5:0.5610,NDCG@5:0.4007) [30.2 s] 
INFO:root:all_losses: [0.44917446 0.32770386]
INFO:root:Epoch 115   loss=0.4492 [152.4 s]	 dev=(HR@5:0.6140,NDCG@5:0.4347) test=(HR@5:0.5514,NDCG@5:0.3899) [29.5 s] 
INFO:root:all_losses: [0.44604298 0.32542303]
INFO:root:Epoch 116   loss=0.4460 [152.4 s]	 dev=(HR@5:0.6002,NDCG@5:0.4295) test=(HR@5:0.5387,NDCG@5:0.3861) [30.1 s] 
INFO:root:all_losses: [0.4389106 0.3174117]
INFO:root:Epoch 117   loss=0.4389 [152.8 s]	 dev=(HR@5:0.6151,NDCG@5:0.4410) test=(HR@5:0.5589,NDCG@5:0.4037) [30.0 s] 
INFO:root:all_losses: [0.43585238 0.31408423]
INFO:root:Epoch 118   loss=0.4359 [152.4 s]	 dev=(HR@5:0.6087,NDCG@5:0.4354) test=(HR@5:0.5408,NDCG@5:0.3931) [30.2 s] 
INFO:root:all_losses: [0.43264648 0.31002986]
INFO:root:Epoch 119   loss=0.4326 [152.1 s]	 dev=(HR@5:0.6161,NDCG@5:0.4453) test=(HR@5:0.5461,NDCG@5:0.3915) [29.6 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.42762157 0.30637237]
INFO:root:Epoch 120   loss=0.4276 [152.4 s]	 dev=(HR@5:0.6172,NDCG@5:0.4426) test=(HR@5:0.5419,NDCG@5:0.3905) [29.4 s] 
INFO:root:all_losses: [0.42326707 0.30174574]
INFO:root:Epoch 121   loss=0.4233 [153.1 s]	 dev=(HR@5:0.6225,NDCG@5:0.4441) test=(HR@5:0.5599,NDCG@5:0.3994) [29.7 s] 
INFO:root:all_losses: [0.42133212 0.29901153]
INFO:root:Epoch 122   loss=0.4213 [152.5 s]	 dev=(HR@5:0.6193,NDCG@5:0.4429) test=(HR@5:0.5504,NDCG@5:0.3963) [30.1 s] 
INFO:root:all_losses: [0.41355097 0.29380593]
INFO:root:Epoch 123   loss=0.4136 [152.4 s]	 dev=(HR@5:0.6066,NDCG@5:0.4360) test=(HR@5:0.5514,NDCG@5:0.3990) [29.6 s] 
INFO:root:all_losses: [0.40866947 0.28813627]
INFO:root:Epoch 124   loss=0.4087 [151.8 s]	 dev=(HR@5:0.6119,NDCG@5:0.4363) test=(HR@5:0.5578,NDCG@5:0.3983) [29.8 s] 
INFO:root:all_losses: [0.406426  0.2862333]
INFO:root:Epoch 125   loss=0.4064 [153.1 s]	 dev=(HR@5:0.5981,NDCG@5:0.4258) test=(HR@5:0.5270,NDCG@5:0.3780) [29.5 s] 
INFO:root:all_losses: [0.40319192 0.2827962 ]
INFO:root:Epoch 126   loss=0.4032 [152.5 s]	 dev=(HR@5:0.6151,NDCG@5:0.4371) test=(HR@5:0.5504,NDCG@5:0.3961) [30.0 s] 
INFO:root:all_losses: [0.3980767  0.27818117]
INFO:root:Epoch 127   loss=0.3981 [153.1 s]	 dev=(HR@5:0.6161,NDCG@5:0.4345) test=(HR@5:0.5472,NDCG@5:0.3922) [30.0 s] 
INFO:root:all_losses: [0.39379954 0.27370504]
INFO:root:Epoch 128   loss=0.3938 [152.4 s]	 dev=(HR@5:0.6172,NDCG@5:0.4443) test=(HR@5:0.5589,NDCG@5:0.4017) [29.6 s] 
INFO:root:all_losses: [0.38594586 0.26752186]
INFO:root:Epoch 129   loss=0.3859 [152.9 s]	 dev=(HR@5:0.6193,NDCG@5:0.4429) test=(HR@5:0.5483,NDCG@5:0.3920) [29.9 s] 
INFO:root:all_losses: [0.38646695 0.26696655]
INFO:root:Epoch 130   loss=0.3865 [152.3 s]	 dev=(HR@5:0.6108,NDCG@5:0.4368) test=(HR@5:0.5398,NDCG@5:0.3869) [29.6 s] 
INFO:root:all_losses: [0.38243333 0.26224226]
INFO:root:Epoch 131   loss=0.3824 [153.0 s]	 dev=(HR@5:0.6204,NDCG@5:0.4456) test=(HR@5:0.5578,NDCG@5:0.3970) [29.5 s] 
INFO:root:Save model to ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.37572622 0.25717348]
INFO:root:Epoch 132   loss=0.3757 [151.9 s]	 dev=(HR@5:0.6214,NDCG@5:0.4447) test=(HR@5:0.5631,NDCG@5:0.4016) [29.9 s] 
INFO:root:all_losses: [0.3734836 0.2532033]
INFO:root:Epoch 133   loss=0.3735 [153.0 s]	 dev=(HR@5:0.6161,NDCG@5:0.4428) test=(HR@5:0.5514,NDCG@5:0.3956) [29.7 s] 
INFO:root:all_losses: [0.36696452 0.25020194]
INFO:root:Epoch 134   loss=0.3670 [152.2 s]	 dev=(HR@5:0.6098,NDCG@5:0.4369) test=(HR@5:0.5451,NDCG@5:0.3869) [29.3 s] 
INFO:root:all_losses: [0.36394644 0.24560602]
INFO:root:Epoch 135   loss=0.3639 [153.1 s]	 dev=(HR@5:0.6204,NDCG@5:0.4431) test=(HR@5:0.5514,NDCG@5:0.3940) [29.7 s] 
INFO:root:all_losses: [0.36206657 0.24264401]
INFO:root:Epoch 136   loss=0.3621 [152.0 s]	 dev=(HR@5:0.6108,NDCG@5:0.4431) test=(HR@5:0.5472,NDCG@5:0.3894) [29.7 s] 
INFO:root:all_losses: [0.35820937 0.24161208]
INFO:root:Epoch 137   loss=0.3582 [153.1 s]	 dev=(HR@5:0.6098,NDCG@5:0.4416) test=(HR@5:0.5461,NDCG@5:0.3901) [29.7 s] 
INFO:root:all_losses: [0.3573055  0.23681414]
INFO:root:Epoch 138   loss=0.3573 [151.8 s]	 dev=(HR@5:0.6140,NDCG@5:0.4414) test=(HR@5:0.5366,NDCG@5:0.3836) [29.9 s] 
INFO:root:all_losses: [0.3482873  0.23353185]
INFO:root:Epoch 139   loss=0.3483 [153.1 s]	 dev=(HR@5:0.6076,NDCG@5:0.4355) test=(HR@5:0.5398,NDCG@5:0.3805) [29.7 s] 
INFO:root:Early stop at 139 based on dev result.
INFO:root:
Best Iter(dev)=  131	 dev=(HR@5:0.6204,NDCG@5:0.4456) test=(HR@5:0.5578,NDCG@5:0.3970) [29363.4 s] 
INFO:root:Load model from ../model/KDA/KDA_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=5_num_heads=4_gamma=1.0_freq_rand=0_include_val=1.pt
INFO:root:
Test After Training: (HR@10:0.7370,HR@5:0.5578,HR@50:0.9703,NDCG@10:0.4552,NDCG@5:0.3970,NDCG@50:0.5087)
INFO:root:
--------------------------------------------- END: 2025-07-15 18:30:26 ---------------------------------------------
