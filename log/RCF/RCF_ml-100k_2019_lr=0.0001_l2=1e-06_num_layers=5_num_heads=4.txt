INFO:root:Namespace(model_name='RCF')
INFO:root:--------------------------------------------- BEGIN: 2025-07-10 08:49:36 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gamma           | 0.0          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 message         |              
 metric          | ["NDCG","HR"]
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\KGReader.pkl
INFO:root:#params: 173767
INFO:root:RCF(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.1007,HR@5:0.0530,HR@50:0.5154,NDCG@10:0.0460,NDCG@5:0.0307,NDCG@50:0.1322)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.5523308 0.6931471]
INFO:root:Epoch 1     loss=0.5523 [81.0 s]	 dev=(HR@5:0.2471,NDCG@5:0.1579) test=(HR@5:0.2153,NDCG@5:0.1442) [29.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.41348326 0.6931486 ]
INFO:root:Epoch 2     loss=0.4135 [81.4 s]	 dev=(HR@5:0.3181,NDCG@5:0.2240) test=(HR@5:0.2990,NDCG@5:0.2039) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.34813628 0.693146  ]
INFO:root:Epoch 3     loss=0.3481 [81.9 s]	 dev=(HR@5:0.3680,NDCG@5:0.2568) test=(HR@5:0.3234,NDCG@5:0.2197) [29.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.3125546 0.6931279]
INFO:root:Epoch 4     loss=0.3126 [81.5 s]	 dev=(HR@5:0.3881,NDCG@5:0.2709) test=(HR@5:0.3383,NDCG@5:0.2263) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.28761363 0.6930928 ]
INFO:root:Epoch 5     loss=0.2876 [81.5 s]	 dev=(HR@5:0.3998,NDCG@5:0.2806) test=(HR@5:0.3606,NDCG@5:0.2445) [29.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.26453167 0.6930499 ]
INFO:root:Epoch 6     loss=0.2645 [81.6 s]	 dev=(HR@5:0.4189,NDCG@5:0.2869) test=(HR@5:0.3648,NDCG@5:0.2457) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.25191498 0.6929988 ]
INFO:root:Epoch 7     loss=0.2519 [82.2 s]	 dev=(HR@5:0.4199,NDCG@5:0.2893) test=(HR@5:0.3648,NDCG@5:0.2481) [29.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.23753373 0.6929297 ]
INFO:root:Epoch 8     loss=0.2375 [85.2 s]	 dev=(HR@5:0.4210,NDCG@5:0.2892) test=(HR@5:0.3712,NDCG@5:0.2489) [29.2 s] 
INFO:root:all_losses: [0.22883616 0.69287   ]
INFO:root:Epoch 9     loss=0.2288 [103.0 s]	 dev=(HR@5:0.4221,NDCG@5:0.2932) test=(HR@5:0.3669,NDCG@5:0.2475) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.22314815 0.6927913 ]
INFO:root:Epoch 10    loss=0.2231 [142.3 s]	 dev=(HR@5:0.4284,NDCG@5:0.2974) test=(HR@5:0.3786,NDCG@5:0.2539) [29.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.21391046 0.6926995 ]
INFO:root:Epoch 11    loss=0.2139 [166.0 s]	 dev=(HR@5:0.4348,NDCG@5:0.3004) test=(HR@5:0.3754,NDCG@5:0.2531) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.20871527 0.69263834]
INFO:root:Epoch 12    loss=0.2087 [161.7 s]	 dev=(HR@5:0.4348,NDCG@5:0.3017) test=(HR@5:0.3818,NDCG@5:0.2570) [29.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.20477025 0.69256383]
INFO:root:Epoch 13    loss=0.2048 [137.6 s]	 dev=(HR@5:0.4327,NDCG@5:0.3009) test=(HR@5:0.3818,NDCG@5:0.2573) [30.0 s] 
INFO:root:all_losses: [0.20057972 0.69247705]
INFO:root:Epoch 14    loss=0.2006 [111.6 s]	 dev=(HR@5:0.4411,NDCG@5:0.3053) test=(HR@5:0.4008,NDCG@5:0.2666) [35.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.19864292 0.69238394]
INFO:root:Epoch 15    loss=0.1986 [114.0 s]	 dev=(HR@5:0.4496,NDCG@5:0.3110) test=(HR@5:0.4030,NDCG@5:0.2680) [41.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.19232942 0.6922727 ]
INFO:root:Epoch 16    loss=0.1923 [142.9 s]	 dev=(HR@5:0.4571,NDCG@5:0.3161) test=(HR@5:0.4136,NDCG@5:0.2736) [41.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18877721 0.6922024 ]
INFO:root:Epoch 17    loss=0.1888 [196.2 s]	 dev=(HR@5:0.4730,NDCG@5:0.3247) test=(HR@5:0.4263,NDCG@5:0.2836) [35.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18571201 0.6921013 ]
INFO:root:Epoch 18    loss=0.1857 [262.0 s]	 dev=(HR@5:0.4698,NDCG@5:0.3264) test=(HR@5:0.4305,NDCG@5:0.2852) [30.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18148667 0.69201094]
INFO:root:Epoch 19    loss=0.1815 [322.0 s]	 dev=(HR@5:0.4719,NDCG@5:0.3284) test=(HR@5:0.4295,NDCG@5:0.2842) [29.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.17977254 0.69190764]
INFO:root:Epoch 20    loss=0.1798 [368.5 s]	 dev=(HR@5:0.4719,NDCG@5:0.3284) test=(HR@5:0.4348,NDCG@5:0.2898) [29.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.17573377 0.6918122 ]
INFO:root:Epoch 21    loss=0.1757 [372.4 s]	 dev=(HR@5:0.4772,NDCG@5:0.3323) test=(HR@5:0.4422,NDCG@5:0.2956) [27.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.17172986 0.6917412 ]
INFO:root:Epoch 22    loss=0.1717 [360.6 s]	 dev=(HR@5:0.4910,NDCG@5:0.3394) test=(HR@5:0.4539,NDCG@5:0.3011) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.17027403 0.6916599 ]
INFO:root:Epoch 23    loss=0.1703 [355.5 s]	 dev=(HR@5:0.4931,NDCG@5:0.3400) test=(HR@5:0.4454,NDCG@5:0.3005) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.16814847 0.691602  ]
INFO:root:Epoch 24    loss=0.1681 [341.9 s]	 dev=(HR@5:0.4942,NDCG@5:0.3369) test=(HR@5:0.4475,NDCG@5:0.3028) [27.7 s] 
INFO:root:all_losses: [0.16517237 0.6914246 ]
INFO:root:Epoch 25    loss=0.1652 [333.2 s]	 dev=(HR@5:0.4910,NDCG@5:0.3383) test=(HR@5:0.4486,NDCG@5:0.3006) [28.2 s] 
INFO:root:all_losses: [0.1632796  0.69138974]
INFO:root:Epoch 26    loss=0.1633 [329.0 s]	 dev=(HR@5:0.5058,NDCG@5:0.3483) test=(HR@5:0.4507,NDCG@5:0.3044) [28.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.16013747 0.6912975 ]
INFO:root:Epoch 27    loss=0.1601 [327.1 s]	 dev=(HR@5:0.4995,NDCG@5:0.3437) test=(HR@5:0.4624,NDCG@5:0.3118) [28.4 s] 
INFO:root:all_losses: [0.15920685 0.6911469 ]
INFO:root:Epoch 28    loss=0.1592 [323.8 s]	 dev=(HR@5:0.5101,NDCG@5:0.3502) test=(HR@5:0.4602,NDCG@5:0.3102) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.15643205 0.69111824]
INFO:root:Epoch 29    loss=0.1564 [325.7 s]	 dev=(HR@5:0.5122,NDCG@5:0.3491) test=(HR@5:0.4613,NDCG@5:0.3108) [28.8 s] 
INFO:root:all_losses: [0.15382905 0.6910609 ]
INFO:root:Epoch 30    loss=0.1538 [325.9 s]	 dev=(HR@5:0.5122,NDCG@5:0.3502) test=(HR@5:0.4602,NDCG@5:0.3094) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.15092449 0.69094807]
INFO:root:Epoch 31    loss=0.1509 [325.9 s]	 dev=(HR@5:0.5090,NDCG@5:0.3562) test=(HR@5:0.4602,NDCG@5:0.3117) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.15126269 0.6908339 ]
INFO:root:Epoch 32    loss=0.1513 [326.6 s]	 dev=(HR@5:0.5133,NDCG@5:0.3580) test=(HR@5:0.4571,NDCG@5:0.3102) [29.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.15080181 0.6907566 ]
INFO:root:Epoch 33    loss=0.1508 [327.5 s]	 dev=(HR@5:0.4952,NDCG@5:0.3492) test=(HR@5:0.4560,NDCG@5:0.3089) [29.0 s] 
INFO:root:all_losses: [0.1474877 0.6906604]
INFO:root:Epoch 34    loss=0.1475 [325.2 s]	 dev=(HR@5:0.5164,NDCG@5:0.3569) test=(HR@5:0.4698,NDCG@5:0.3181) [29.5 s] 
INFO:root:all_losses: [0.14703588 0.6905412 ]
INFO:root:Epoch 35    loss=0.1470 [324.4 s]	 dev=(HR@5:0.5111,NDCG@5:0.3555) test=(HR@5:0.4677,NDCG@5:0.3196) [29.2 s] 
INFO:root:all_losses: [0.14583127 0.69057024]
INFO:root:Epoch 36    loss=0.1458 [327.2 s]	 dev=(HR@5:0.5217,NDCG@5:0.3649) test=(HR@5:0.4772,NDCG@5:0.3232) [29.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.14223434 0.69041705]
INFO:root:Epoch 37    loss=0.1422 [322.6 s]	 dev=(HR@5:0.5281,NDCG@5:0.3662) test=(HR@5:0.4793,NDCG@5:0.3241) [30.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.14292262 0.6902577 ]
INFO:root:Epoch 38    loss=0.1429 [320.0 s]	 dev=(HR@5:0.5228,NDCG@5:0.3646) test=(HR@5:0.4761,NDCG@5:0.3267) [29.9 s] 
INFO:root:all_losses: [0.14259076 0.69034374]
INFO:root:Epoch 39    loss=0.1426 [322.4 s]	 dev=(HR@5:0.5249,NDCG@5:0.3661) test=(HR@5:0.4846,NDCG@5:0.3299) [29.9 s] 
INFO:root:all_losses: [0.13854814 0.6902099 ]
INFO:root:Epoch 40    loss=0.1385 [321.8 s]	 dev=(HR@5:0.5334,NDCG@5:0.3663) test=(HR@5:0.4793,NDCG@5:0.3277) [30.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.13865556 0.6900381 ]
INFO:root:Epoch 41    loss=0.1387 [321.5 s]	 dev=(HR@5:0.5239,NDCG@5:0.3607) test=(HR@5:0.4836,NDCG@5:0.3289) [30.8 s] 
INFO:root:all_losses: [0.1364156  0.69004667]
INFO:root:Epoch 42    loss=0.1364 [321.8 s]	 dev=(HR@5:0.5366,NDCG@5:0.3707) test=(HR@5:0.4920,NDCG@5:0.3365) [30.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.13702533 0.6899219 ]
INFO:root:Epoch 43    loss=0.1370 [323.8 s]	 dev=(HR@5:0.5281,NDCG@5:0.3668) test=(HR@5:0.4889,NDCG@5:0.3338) [31.2 s] 
INFO:root:all_losses: [0.13399895 0.6900086 ]
INFO:root:Epoch 44    loss=0.1340 [317.7 s]	 dev=(HR@5:0.5334,NDCG@5:0.3727) test=(HR@5:0.4867,NDCG@5:0.3390) [32.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.13296834 0.68983114]
INFO:root:Epoch 45    loss=0.1330 [314.5 s]	 dev=(HR@5:0.5408,NDCG@5:0.3711) test=(HR@5:0.4899,NDCG@5:0.3337) [32.2 s] 
INFO:root:all_losses: [0.1317084 0.6896182]
INFO:root:Epoch 46    loss=0.1317 [311.6 s]	 dev=(HR@5:0.5334,NDCG@5:0.3709) test=(HR@5:0.4857,NDCG@5:0.3363) [31.9 s] 
INFO:root:all_losses: [0.13300376 0.68964994]
INFO:root:Epoch 47    loss=0.1330 [311.8 s]	 dev=(HR@5:0.5376,NDCG@5:0.3750) test=(HR@5:0.5016,NDCG@5:0.3433) [33.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.13185701 0.68955696]
INFO:root:Epoch 48    loss=0.1319 [310.8 s]	 dev=(HR@5:0.5461,NDCG@5:0.3786) test=(HR@5:0.4931,NDCG@5:0.3396) [33.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.12874368 0.6895365 ]
INFO:root:Epoch 49    loss=0.1287 [311.2 s]	 dev=(HR@5:0.5376,NDCG@5:0.3763) test=(HR@5:0.4910,NDCG@5:0.3380) [34.1 s] 
INFO:root:all_losses: [0.12947889 0.68938595]
INFO:root:Epoch 50    loss=0.1295 [312.0 s]	 dev=(HR@5:0.5429,NDCG@5:0.3799) test=(HR@5:0.4804,NDCG@5:0.3340) [34.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.12855963 0.68942773]
INFO:root:Epoch 51    loss=0.1286 [311.6 s]	 dev=(HR@5:0.5398,NDCG@5:0.3758) test=(HR@5:0.4942,NDCG@5:0.3411) [33.8 s] 
INFO:root:all_losses: [0.126327   0.68934727]
INFO:root:Epoch 52    loss=0.1263 [310.5 s]	 dev=(HR@5:0.5408,NDCG@5:0.3786) test=(HR@5:0.4942,NDCG@5:0.3422) [34.3 s] 
INFO:root:all_losses: [0.12612106 0.68935454]
INFO:root:Epoch 53    loss=0.1261 [309.7 s]	 dev=(HR@5:0.5419,NDCG@5:0.3808) test=(HR@5:0.4931,NDCG@5:0.3433) [34.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.1253727 0.6891297]
INFO:root:Epoch 54    loss=0.1254 [310.7 s]	 dev=(HR@5:0.5419,NDCG@5:0.3834) test=(HR@5:0.4973,NDCG@5:0.3391) [33.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.12248202 0.68919814]
INFO:root:Epoch 55    loss=0.1225 [312.4 s]	 dev=(HR@5:0.5345,NDCG@5:0.3744) test=(HR@5:0.4942,NDCG@5:0.3411) [33.4 s] 
INFO:root:all_losses: [0.12194023 0.6890487 ]
INFO:root:Epoch 56    loss=0.1219 [313.8 s]	 dev=(HR@5:0.5355,NDCG@5:0.3765) test=(HR@5:0.4910,NDCG@5:0.3410) [33.8 s] 
INFO:root:all_losses: [0.12196584 0.6889383 ]
INFO:root:Epoch 57    loss=0.1220 [309.9 s]	 dev=(HR@5:0.5345,NDCG@5:0.3748) test=(HR@5:0.4952,NDCG@5:0.3431) [33.9 s] 
INFO:root:all_losses: [0.12057537 0.6889352 ]
INFO:root:Epoch 58    loss=0.1206 [310.7 s]	 dev=(HR@5:0.5461,NDCG@5:0.3826) test=(HR@5:0.4910,NDCG@5:0.3392) [34.3 s] 
INFO:root:all_losses: [0.12099251 0.68889153]
INFO:root:Epoch 59    loss=0.1210 [311.9 s]	 dev=(HR@5:0.5514,NDCG@5:0.3887) test=(HR@5:0.4889,NDCG@5:0.3448) [34.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.1208289  0.68900937]
INFO:root:Epoch 60    loss=0.1208 [311.1 s]	 dev=(HR@5:0.5440,NDCG@5:0.3848) test=(HR@5:0.5005,NDCG@5:0.3456) [33.5 s] 
INFO:root:all_losses: [0.1184799  0.68874395]
INFO:root:Epoch 61    loss=0.1185 [312.2 s]	 dev=(HR@5:0.5483,NDCG@5:0.3851) test=(HR@5:0.4963,NDCG@5:0.3483) [34.0 s] 
INFO:root:all_losses: [0.11935444 0.6886678 ]
INFO:root:Epoch 62    loss=0.1194 [310.2 s]	 dev=(HR@5:0.5525,NDCG@5:0.3866) test=(HR@5:0.5005,NDCG@5:0.3473) [33.9 s] 
INFO:root:all_losses: [0.11770328 0.6886201 ]
INFO:root:Epoch 63    loss=0.1177 [309.0 s]	 dev=(HR@5:0.5429,NDCG@5:0.3857) test=(HR@5:0.4995,NDCG@5:0.3476) [34.5 s] 
INFO:root:all_losses: [0.11723439 0.6884519 ]
INFO:root:Epoch 64    loss=0.1172 [308.9 s]	 dev=(HR@5:0.5440,NDCG@5:0.3913) test=(HR@5:0.5080,NDCG@5:0.3477) [35.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.11577544 0.68850195]
INFO:root:Epoch 65    loss=0.1158 [307.8 s]	 dev=(HR@5:0.5429,NDCG@5:0.3862) test=(HR@5:0.5037,NDCG@5:0.3438) [35.0 s] 
INFO:root:all_losses: [0.11737461 0.6885304 ]
INFO:root:Epoch 66    loss=0.1174 [310.7 s]	 dev=(HR@5:0.5472,NDCG@5:0.3842) test=(HR@5:0.5069,NDCG@5:0.3463) [35.9 s] 
INFO:root:all_losses: [0.1169661 0.6883844]
INFO:root:Epoch 67    loss=0.1170 [307.6 s]	 dev=(HR@5:0.5536,NDCG@5:0.3926) test=(HR@5:0.5069,NDCG@5:0.3443) [35.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.11611922 0.6883967 ]
INFO:root:Epoch 68    loss=0.1161 [306.3 s]	 dev=(HR@5:0.5451,NDCG@5:0.3856) test=(HR@5:0.4973,NDCG@5:0.3429) [35.7 s] 
INFO:root:all_losses: [0.11388055 0.6884105 ]
INFO:root:Epoch 69    loss=0.1139 [308.9 s]	 dev=(HR@5:0.5461,NDCG@5:0.3861) test=(HR@5:0.5027,NDCG@5:0.3493) [35.9 s] 
INFO:root:all_losses: [0.11443375 0.6882457 ]
INFO:root:Epoch 70    loss=0.1144 [306.3 s]	 dev=(HR@5:0.5472,NDCG@5:0.3862) test=(HR@5:0.5016,NDCG@5:0.3461) [36.0 s] 
INFO:root:all_losses: [0.11082758 0.688211  ]
INFO:root:Epoch 71    loss=0.1108 [302.2 s]	 dev=(HR@5:0.5366,NDCG@5:0.3801) test=(HR@5:0.4952,NDCG@5:0.3423) [35.2 s] 
INFO:root:all_losses: [0.11148161 0.6882771 ]
INFO:root:Epoch 72    loss=0.1115 [302.5 s]	 dev=(HR@5:0.5514,NDCG@5:0.3891) test=(HR@5:0.4963,NDCG@5:0.3456) [36.0 s] 
INFO:root:all_losses: [0.11079466 0.68813974]
INFO:root:Epoch 73    loss=0.1108 [302.0 s]	 dev=(HR@5:0.5461,NDCG@5:0.3884) test=(HR@5:0.4973,NDCG@5:0.3459) [35.7 s] 
INFO:root:all_losses: [0.11085872 0.6880054 ]
INFO:root:Epoch 74    loss=0.1109 [306.5 s]	 dev=(HR@5:0.5536,NDCG@5:0.3926) test=(HR@5:0.5048,NDCG@5:0.3471) [35.3 s] 
INFO:root:all_losses: [0.11045071 0.6879754 ]
INFO:root:Epoch 75    loss=0.1105 [304.1 s]	 dev=(HR@5:0.5557,NDCG@5:0.3978) test=(HR@5:0.5058,NDCG@5:0.3506) [37.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.11005241 0.6879152 ]
INFO:root:Epoch 76    loss=0.1101 [301.7 s]	 dev=(HR@5:0.5525,NDCG@5:0.3912) test=(HR@5:0.5111,NDCG@5:0.3487) [37.2 s] 
INFO:root:all_losses: [0.11013353 0.6877511 ]
INFO:root:Epoch 77    loss=0.1101 [300.5 s]	 dev=(HR@5:0.5557,NDCG@5:0.3941) test=(HR@5:0.5143,NDCG@5:0.3543) [37.3 s] 
INFO:root:all_losses: [0.1086531 0.6879316]
INFO:root:Epoch 78    loss=0.1087 [304.2 s]	 dev=(HR@5:0.5429,NDCG@5:0.3925) test=(HR@5:0.5048,NDCG@5:0.3499) [38.5 s] 
INFO:root:all_losses: [0.10751009 0.6877978 ]
INFO:root:Epoch 79    loss=0.1075 [302.4 s]	 dev=(HR@5:0.5536,NDCG@5:0.3909) test=(HR@5:0.5048,NDCG@5:0.3500) [37.5 s] 
INFO:root:all_losses: [0.1092058  0.68769866]
INFO:root:Epoch 80    loss=0.1092 [307.6 s]	 dev=(HR@5:0.5472,NDCG@5:0.3968) test=(HR@5:0.5143,NDCG@5:0.3575) [34.3 s] 
INFO:root:all_losses: [0.1065468  0.68778884]
INFO:root:Epoch 81    loss=0.1065 [308.6 s]	 dev=(HR@5:0.5536,NDCG@5:0.3932) test=(HR@5:0.5069,NDCG@5:0.3474) [35.4 s] 
INFO:root:all_losses: [0.10645943 0.6876788 ]
INFO:root:Epoch 82    loss=0.1065 [306.5 s]	 dev=(HR@5:0.5461,NDCG@5:0.3943) test=(HR@5:0.5207,NDCG@5:0.3583) [35.1 s] 
INFO:root:all_losses: [0.10699779 0.6876384 ]
INFO:root:Epoch 83    loss=0.1070 [306.3 s]	 dev=(HR@5:0.5536,NDCG@5:0.3943) test=(HR@5:0.5090,NDCG@5:0.3558) [36.2 s] 
INFO:root:all_losses: [0.10555541 0.6875315 ]
INFO:root:Epoch 84    loss=0.1056 [298.6 s]	 dev=(HR@5:0.5589,NDCG@5:0.3972) test=(HR@5:0.5175,NDCG@5:0.3611) [36.7 s] 
INFO:root:all_losses: [0.1053946 0.6876975]
INFO:root:Epoch 85    loss=0.1054 [302.2 s]	 dev=(HR@5:0.5631,NDCG@5:0.3996) test=(HR@5:0.5239,NDCG@5:0.3577) [35.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.10460101 0.6875418 ]
INFO:root:Epoch 86    loss=0.1046 [314.1 s]	 dev=(HR@5:0.5673,NDCG@5:0.4020) test=(HR@5:0.5175,NDCG@5:0.3612) [33.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.10299779 0.68758434]
INFO:root:Epoch 87    loss=0.1030 [318.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.3996) test=(HR@5:0.5111,NDCG@5:0.3559) [33.9 s] 
INFO:root:all_losses: [0.10523165 0.6874977 ]
INFO:root:Epoch 88    loss=0.1052 [320.3 s]	 dev=(HR@5:0.5578,NDCG@5:0.3979) test=(HR@5:0.5101,NDCG@5:0.3575) [34.0 s] 
INFO:root:all_losses: [0.10305483 0.6874794 ]
INFO:root:Epoch 89    loss=0.1031 [315.7 s]	 dev=(HR@5:0.5599,NDCG@5:0.4006) test=(HR@5:0.5101,NDCG@5:0.3547) [33.8 s] 
INFO:root:all_losses: [0.10240896 0.6873661 ]
INFO:root:Epoch 90    loss=0.1024 [320.9 s]	 dev=(HR@5:0.5620,NDCG@5:0.4031) test=(HR@5:0.5133,NDCG@5:0.3572) [32.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.10209543 0.6873823 ]
INFO:root:Epoch 91    loss=0.1021 [323.5 s]	 dev=(HR@5:0.5642,NDCG@5:0.3991) test=(HR@5:0.5143,NDCG@5:0.3628) [32.9 s] 
INFO:root:all_losses: [0.10097481 0.68738174]
INFO:root:Epoch 92    loss=0.1010 [327.3 s]	 dev=(HR@5:0.5472,NDCG@5:0.3939) test=(HR@5:0.5154,NDCG@5:0.3525) [32.2 s] 
INFO:root:all_losses: [0.10117832 0.6873886 ]
INFO:root:Epoch 93    loss=0.1012 [327.3 s]	 dev=(HR@5:0.5589,NDCG@5:0.3978) test=(HR@5:0.5133,NDCG@5:0.3581) [31.8 s] 
INFO:root:all_losses: [0.09908886 0.68734896]
INFO:root:Epoch 94    loss=0.0991 [336.2 s]	 dev=(HR@5:0.5589,NDCG@5:0.3944) test=(HR@5:0.5154,NDCG@5:0.3570) [30.7 s] 
INFO:root:all_losses: [0.10003769 0.68714917]
INFO:root:Epoch 95    loss=0.1000 [339.7 s]	 dev=(HR@5:0.5589,NDCG@5:0.3979) test=(HR@5:0.5143,NDCG@5:0.3584) [31.1 s] 
INFO:root:all_losses: [0.10140557 0.68728274]
INFO:root:Epoch 96    loss=0.1014 [340.4 s]	 dev=(HR@5:0.5642,NDCG@5:0.4041) test=(HR@5:0.5260,NDCG@5:0.3651) [30.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.09973338 0.68713135]
INFO:root:Epoch 97    loss=0.0997 [345.2 s]	 dev=(HR@5:0.5536,NDCG@5:0.3955) test=(HR@5:0.5143,NDCG@5:0.3557) [30.3 s] 
INFO:root:all_losses: [0.1006617  0.68712294]
INFO:root:Epoch 98    loss=0.1007 [346.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.3983) test=(HR@5:0.5101,NDCG@5:0.3564) [30.7 s] 
INFO:root:all_losses: [0.09788137 0.6872215 ]
INFO:root:Epoch 99    loss=0.0979 [346.3 s]	 dev=(HR@5:0.5493,NDCG@5:0.3957) test=(HR@5:0.5111,NDCG@5:0.3571) [30.3 s] 
INFO:root:all_losses: [0.09835042 0.6869884 ]
INFO:root:Epoch 100   loss=0.0984 [344.0 s]	 dev=(HR@5:0.5546,NDCG@5:0.3958) test=(HR@5:0.5101,NDCG@5:0.3580) [29.5 s] 
INFO:root:all_losses: [0.09602007 0.6872393 ]
INFO:root:Epoch 101   loss=0.0960 [340.3 s]	 dev=(HR@5:0.5546,NDCG@5:0.3989) test=(HR@5:0.5260,NDCG@5:0.3668) [29.3 s] 
INFO:root:all_losses: [0.09685501 0.6869977 ]
INFO:root:Epoch 102   loss=0.0969 [336.9 s]	 dev=(HR@5:0.5557,NDCG@5:0.3962) test=(HR@5:0.5186,NDCG@5:0.3640) [29.4 s] 
INFO:root:all_losses: [0.0981614 0.6869439]
INFO:root:Epoch 103   loss=0.0982 [334.2 s]	 dev=(HR@5:0.5578,NDCG@5:0.3958) test=(HR@5:0.5239,NDCG@5:0.3669) [29.3 s] 
INFO:root:all_losses: [0.09781839 0.68682593]
INFO:root:Epoch 104   loss=0.0978 [322.5 s]	 dev=(HR@5:0.5578,NDCG@5:0.3985) test=(HR@5:0.5196,NDCG@5:0.3648) [28.6 s] 
INFO:root:all_losses: [0.09719244 0.68699855]
INFO:root:Epoch 105   loss=0.0972 [313.2 s]	 dev=(HR@5:0.5599,NDCG@5:0.4026) test=(HR@5:0.5122,NDCG@5:0.3619) [28.9 s] 
INFO:root:all_losses: [0.09475375 0.68680763]
INFO:root:Epoch 106   loss=0.0948 [292.7 s]	 dev=(HR@5:0.5536,NDCG@5:0.3949) test=(HR@5:0.5111,NDCG@5:0.3591) [31.2 s] 
INFO:root:all_losses: [0.0938217 0.6869787]
INFO:root:Epoch 107   loss=0.0938 [267.0 s]	 dev=(HR@5:0.5461,NDCG@5:0.3890) test=(HR@5:0.5048,NDCG@5:0.3506) [32.1 s] 
INFO:root:all_losses: [0.09455464 0.6867414 ]
INFO:root:Epoch 108   loss=0.0946 [248.0 s]	 dev=(HR@5:0.5483,NDCG@5:0.3950) test=(HR@5:0.5228,NDCG@5:0.3620) [31.2 s] 
INFO:root:all_losses: [0.0939393  0.68682635]
INFO:root:Epoch 109   loss=0.0939 [243.6 s]	 dev=(HR@5:0.5461,NDCG@5:0.3914) test=(HR@5:0.5122,NDCG@5:0.3573) [29.5 s] 
INFO:root:all_losses: [0.09390388 0.6868182 ]
INFO:root:Epoch 110   loss=0.0939 [244.1 s]	 dev=(HR@5:0.5567,NDCG@5:0.3980) test=(HR@5:0.5175,NDCG@5:0.3650) [29.5 s] 
INFO:root:all_losses: [0.0921101 0.686879 ]
INFO:root:Epoch 111   loss=0.0921 [237.7 s]	 dev=(HR@5:0.5525,NDCG@5:0.3981) test=(HR@5:0.5111,NDCG@5:0.3579) [32.8 s] 
INFO:root:all_losses: [0.09466617 0.68680465]
INFO:root:Epoch 112   loss=0.0947 [234.6 s]	 dev=(HR@5:0.5589,NDCG@5:0.3995) test=(HR@5:0.5143,NDCG@5:0.3638) [32.6 s] 
INFO:root:all_losses: [0.09244003 0.68674177]
INFO:root:Epoch 113   loss=0.0924 [235.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.4004) test=(HR@5:0.5334,NDCG@5:0.3678) [30.8 s] 
INFO:root:all_losses: [0.09267258 0.6866141 ]
INFO:root:Epoch 114   loss=0.0927 [229.3 s]	 dev=(HR@5:0.5525,NDCG@5:0.3948) test=(HR@5:0.5069,NDCG@5:0.3590) [31.4 s] 
INFO:root:all_losses: [0.09258194 0.6868157 ]
INFO:root:Epoch 115   loss=0.0926 [218.9 s]	 dev=(HR@5:0.5546,NDCG@5:0.4016) test=(HR@5:0.5154,NDCG@5:0.3626) [31.6 s] 
INFO:root:all_losses: [0.09203091 0.6867153 ]
INFO:root:Epoch 116   loss=0.0920 [213.2 s]	 dev=(HR@5:0.5525,NDCG@5:0.3968) test=(HR@5:0.5037,NDCG@5:0.3580) [30.5 s] 
INFO:root:Early stop at 116 based on dev result.
INFO:root:
Best Iter(dev)=   96	 dev=(HR@5:0.5642,NDCG@5:0.4041) test=(HR@5:0.5260,NDCG@5:0.3651) [36436.4 s] 
INFO:root:Load model from ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=5_num_heads=4.pt
INFO:root:
Test After Training: (HR@10:0.6829,HR@5:0.5260,HR@50:0.9438,NDCG@10:0.4164,NDCG@5:0.3651,NDCG@50:0.4761)
INFO:root:
--------------------------------------------- END: 2025-07-10 18:57:23 ---------------------------------------------
INFO:root:Namespace(model_name='RCF')
INFO:root:--------------------------------------------- BEGIN: 2025-07-10 19:48:33 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gamma           | 0.1          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 message         |              
 metric          | ["NDCG","HR"]
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\KGReader.pkl
INFO:root:#params: 173767
INFO:root:RCF(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.1007,HR@5:0.0530,HR@50:0.5154,NDCG@10:0.0460,NDCG@5:0.0307,NDCG@50:0.1322)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.62164944 0.69314665]
INFO:root:Epoch 1     loss=0.6216 [73.2 s]	 dev=(HR@5:0.2471,NDCG@5:0.1578) test=(HR@5:0.2153,NDCG@5:0.1442) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.48297083 0.69313353]
INFO:root:Epoch 2     loss=0.4830 [73.1 s]	 dev=(HR@5:0.3181,NDCG@5:0.2243) test=(HR@5:0.2969,NDCG@5:0.2034) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.41773403 0.69307244]
INFO:root:Epoch 3     loss=0.4177 [73.5 s]	 dev=(HR@5:0.3659,NDCG@5:0.2560) test=(HR@5:0.3213,NDCG@5:0.2188) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.3823322 0.6929487]
INFO:root:Epoch 4     loss=0.3823 [73.7 s]	 dev=(HR@5:0.3892,NDCG@5:0.2712) test=(HR@5:0.3372,NDCG@5:0.2263) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.35755098 0.6927691 ]
INFO:root:Epoch 5     loss=0.3576 [73.6 s]	 dev=(HR@5:0.3987,NDCG@5:0.2814) test=(HR@5:0.3648,NDCG@5:0.2454) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.33402264 0.6925086 ]
INFO:root:Epoch 6     loss=0.3340 [73.5 s]	 dev=(HR@5:0.4168,NDCG@5:0.2885) test=(HR@5:0.3669,NDCG@5:0.2473) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.3211672  0.69224423]
INFO:root:Epoch 7     loss=0.3212 [73.6 s]	 dev=(HR@5:0.4178,NDCG@5:0.2898) test=(HR@5:0.3637,NDCG@5:0.2483) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.30670518 0.69192004]
INFO:root:Epoch 8     loss=0.3067 [74.0 s]	 dev=(HR@5:0.4189,NDCG@5:0.2863) test=(HR@5:0.3701,NDCG@5:0.2496) [27.2 s] 
INFO:root:all_losses: [0.29807866 0.69153786]
INFO:root:Epoch 9     loss=0.2981 [79.6 s]	 dev=(HR@5:0.4136,NDCG@5:0.2908) test=(HR@5:0.3659,NDCG@5:0.2470) [27.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.29249266 0.6911396 ]
INFO:root:Epoch 10    loss=0.2925 [98.6 s]	 dev=(HR@5:0.4316,NDCG@5:0.2973) test=(HR@5:0.3733,NDCG@5:0.2518) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.28329217 0.6906612 ]
INFO:root:Epoch 11    loss=0.2833 [126.8 s]	 dev=(HR@5:0.4295,NDCG@5:0.2981) test=(HR@5:0.3754,NDCG@5:0.2533) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.2781501 0.6902599]
INFO:root:Epoch 12    loss=0.2782 [138.3 s]	 dev=(HR@5:0.4316,NDCG@5:0.2982) test=(HR@5:0.3849,NDCG@5:0.2581) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.27436644 0.689763  ]
INFO:root:Epoch 13    loss=0.2744 [133.9 s]	 dev=(HR@5:0.4305,NDCG@5:0.2982) test=(HR@5:0.3765,NDCG@5:0.2542) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.27016813 0.6892508 ]
INFO:root:Epoch 14    loss=0.2702 [119.5 s]	 dev=(HR@5:0.4369,NDCG@5:0.3041) test=(HR@5:0.3987,NDCG@5:0.2647) [28.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.2684716 0.6886805]
INFO:root:Epoch 15    loss=0.2685 [106.4 s]	 dev=(HR@5:0.4475,NDCG@5:0.3118) test=(HR@5:0.4008,NDCG@5:0.2651) [29.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.26223832 0.6881205 ]
INFO:root:Epoch 16    loss=0.2622 [96.8 s]	 dev=(HR@5:0.4496,NDCG@5:0.3115) test=(HR@5:0.4104,NDCG@5:0.2703) [30.6 s] 
INFO:root:all_losses: [0.25877622 0.6875977 ]
INFO:root:Epoch 17    loss=0.2588 [97.8 s]	 dev=(HR@5:0.4634,NDCG@5:0.3224) test=(HR@5:0.4157,NDCG@5:0.2781) [29.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.2558742  0.68695474]
INFO:root:Epoch 18    loss=0.2559 [109.2 s]	 dev=(HR@5:0.4719,NDCG@5:0.3264) test=(HR@5:0.4221,NDCG@5:0.2827) [27.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.2518222  0.68646103]
INFO:root:Epoch 19    loss=0.2518 [129.2 s]	 dev=(HR@5:0.4730,NDCG@5:0.3256) test=(HR@5:0.4242,NDCG@5:0.2827) [27.2 s] 
INFO:root:all_losses: [0.25003543 0.685711  ]
INFO:root:Epoch 20    loss=0.2500 [133.6 s]	 dev=(HR@5:0.4740,NDCG@5:0.3273) test=(HR@5:0.4231,NDCG@5:0.2822) [27.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.24571007 0.68495005]
INFO:root:Epoch 21    loss=0.2457 [102.8 s]	 dev=(HR@5:0.4772,NDCG@5:0.3292) test=(HR@5:0.4337,NDCG@5:0.2923) [26.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.24182554 0.6844879 ]
INFO:root:Epoch 22    loss=0.2418 [98.3 s]	 dev=(HR@5:0.4931,NDCG@5:0.3399) test=(HR@5:0.4401,NDCG@5:0.2980) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.2402278 0.6837522]
INFO:root:Epoch 23    loss=0.2402 [100.8 s]	 dev=(HR@5:0.4899,NDCG@5:0.3391) test=(HR@5:0.4348,NDCG@5:0.2967) [27.3 s] 
INFO:root:all_losses: [0.23786348 0.6830286 ]
INFO:root:Epoch 24    loss=0.2379 [100.8 s]	 dev=(HR@5:0.4920,NDCG@5:0.3365) test=(HR@5:0.4454,NDCG@5:0.3026) [27.2 s] 
INFO:root:all_losses: [0.23452567 0.68205446]
INFO:root:Epoch 25    loss=0.2345 [101.2 s]	 dev=(HR@5:0.4952,NDCG@5:0.3416) test=(HR@5:0.4433,NDCG@5:0.2970) [27.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.23257713 0.6815168 ]
INFO:root:Epoch 26    loss=0.2326 [101.2 s]	 dev=(HR@5:0.5080,NDCG@5:0.3493) test=(HR@5:0.4517,NDCG@5:0.3020) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.22928785 0.6807687 ]
INFO:root:Epoch 27    loss=0.2293 [100.7 s]	 dev=(HR@5:0.5027,NDCG@5:0.3474) test=(HR@5:0.4645,NDCG@5:0.3111) [27.2 s] 
INFO:root:all_losses: [0.22824945 0.6800871 ]
INFO:root:Epoch 28    loss=0.2282 [101.5 s]	 dev=(HR@5:0.5143,NDCG@5:0.3513) test=(HR@5:0.4624,NDCG@5:0.3113) [27.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.22541918 0.6795144 ]
INFO:root:Epoch 29    loss=0.2254 [101.2 s]	 dev=(HR@5:0.5111,NDCG@5:0.3518) test=(HR@5:0.4624,NDCG@5:0.3131) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.22253911 0.6787163 ]
INFO:root:Epoch 30    loss=0.2225 [101.6 s]	 dev=(HR@5:0.5154,NDCG@5:0.3524) test=(HR@5:0.4581,NDCG@5:0.3087) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.21965393 0.6781155 ]
INFO:root:Epoch 31    loss=0.2197 [101.4 s]	 dev=(HR@5:0.5111,NDCG@5:0.3573) test=(HR@5:0.4571,NDCG@5:0.3094) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.21985385 0.67743415]
INFO:root:Epoch 32    loss=0.2199 [101.3 s]	 dev=(HR@5:0.5164,NDCG@5:0.3605) test=(HR@5:0.4571,NDCG@5:0.3138) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.21916579 0.6766037 ]
INFO:root:Epoch 33    loss=0.2192 [101.1 s]	 dev=(HR@5:0.4973,NDCG@5:0.3487) test=(HR@5:0.4517,NDCG@5:0.3046) [27.2 s] 
INFO:root:all_losses: [0.21569489 0.67612875]
INFO:root:Epoch 34    loss=0.2157 [101.5 s]	 dev=(HR@5:0.5143,NDCG@5:0.3576) test=(HR@5:0.4645,NDCG@5:0.3169) [27.3 s] 
INFO:root:all_losses: [0.21513794 0.67530715]
INFO:root:Epoch 35    loss=0.2151 [101.4 s]	 dev=(HR@5:0.5186,NDCG@5:0.3607) test=(HR@5:0.4677,NDCG@5:0.3194) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.2138157 0.6750345]
INFO:root:Epoch 36    loss=0.2138 [101.3 s]	 dev=(HR@5:0.5260,NDCG@5:0.3647) test=(HR@5:0.4783,NDCG@5:0.3235) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.21037321 0.6742277 ]
INFO:root:Epoch 37    loss=0.2104 [101.5 s]	 dev=(HR@5:0.5355,NDCG@5:0.3693) test=(HR@5:0.4804,NDCG@5:0.3243) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.21068862 0.6735593 ]
INFO:root:Epoch 38    loss=0.2107 [103.1 s]	 dev=(HR@5:0.5292,NDCG@5:0.3674) test=(HR@5:0.4772,NDCG@5:0.3225) [27.7 s] 
INFO:root:all_losses: [0.21051896 0.6732781 ]
INFO:root:Epoch 39    loss=0.2105 [103.0 s]	 dev=(HR@5:0.5345,NDCG@5:0.3710) test=(HR@5:0.4772,NDCG@5:0.3267) [27.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.2063529 0.6724472]
INFO:root:Epoch 40    loss=0.2064 [102.5 s]	 dev=(HR@5:0.5313,NDCG@5:0.3682) test=(HR@5:0.4825,NDCG@5:0.3282) [27.6 s] 
INFO:root:all_losses: [0.2061614  0.67173576]
INFO:root:Epoch 41    loss=0.2062 [108.8 s]	 dev=(HR@5:0.5355,NDCG@5:0.3684) test=(HR@5:0.4857,NDCG@5:0.3308) [28.7 s] 
INFO:root:all_losses: [0.20406094 0.6710298 ]
INFO:root:Epoch 42    loss=0.2041 [113.5 s]	 dev=(HR@5:0.5355,NDCG@5:0.3713) test=(HR@5:0.4846,NDCG@5:0.3324) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.20463116 0.67038274]
INFO:root:Epoch 43    loss=0.2046 [113.2 s]	 dev=(HR@5:0.5323,NDCG@5:0.3703) test=(HR@5:0.4899,NDCG@5:0.3327) [29.0 s] 
INFO:root:all_losses: [0.20150904 0.6702493 ]
INFO:root:Epoch 44    loss=0.2015 [113.9 s]	 dev=(HR@5:0.5366,NDCG@5:0.3731) test=(HR@5:0.4846,NDCG@5:0.3368) [28.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.20025088 0.6691455 ]
INFO:root:Epoch 45    loss=0.2003 [113.1 s]	 dev=(HR@5:0.5440,NDCG@5:0.3740) test=(HR@5:0.4920,NDCG@5:0.3378) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.1988275  0.66816664]
INFO:root:Epoch 46    loss=0.1988 [114.2 s]	 dev=(HR@5:0.5387,NDCG@5:0.3763) test=(HR@5:0.4878,NDCG@5:0.3379) [28.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.20024265 0.66819376]
INFO:root:Epoch 47    loss=0.2002 [113.5 s]	 dev=(HR@5:0.5398,NDCG@5:0.3766) test=(HR@5:0.5090,NDCG@5:0.3466) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.19896555 0.66773736]
INFO:root:Epoch 48    loss=0.1990 [113.0 s]	 dev=(HR@5:0.5483,NDCG@5:0.3820) test=(HR@5:0.4963,NDCG@5:0.3409) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.19577909 0.6670372 ]
INFO:root:Epoch 49    loss=0.1958 [113.9 s]	 dev=(HR@5:0.5408,NDCG@5:0.3799) test=(HR@5:0.4836,NDCG@5:0.3364) [28.7 s] 
INFO:root:all_losses: [0.19648714 0.6661853 ]
INFO:root:Epoch 50    loss=0.1965 [113.4 s]	 dev=(HR@5:0.5451,NDCG@5:0.3803) test=(HR@5:0.4846,NDCG@5:0.3353) [28.7 s] 
INFO:root:all_losses: [0.19544171 0.6655085 ]
INFO:root:Epoch 51    loss=0.1954 [113.4 s]	 dev=(HR@5:0.5514,NDCG@5:0.3834) test=(HR@5:0.4942,NDCG@5:0.3416) [28.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.1930386 0.6653   ]
INFO:root:Epoch 52    loss=0.1930 [113.7 s]	 dev=(HR@5:0.5504,NDCG@5:0.3834) test=(HR@5:0.4931,NDCG@5:0.3443) [28.7 s] 
INFO:root:all_losses: [0.19273002 0.66499245]
INFO:root:Epoch 53    loss=0.1927 [113.2 s]	 dev=(HR@5:0.5461,NDCG@5:0.3849) test=(HR@5:0.4889,NDCG@5:0.3416) [28.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.19207788 0.6636102 ]
INFO:root:Epoch 54    loss=0.1921 [113.8 s]	 dev=(HR@5:0.5525,NDCG@5:0.3871) test=(HR@5:0.4910,NDCG@5:0.3415) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18903816 0.66331816]
INFO:root:Epoch 55    loss=0.1890 [113.4 s]	 dev=(HR@5:0.5504,NDCG@5:0.3822) test=(HR@5:0.4899,NDCG@5:0.3437) [28.7 s] 
INFO:root:all_losses: [0.18831949 0.66272014]
INFO:root:Epoch 56    loss=0.1883 [113.0 s]	 dev=(HR@5:0.5525,NDCG@5:0.3861) test=(HR@5:0.4952,NDCG@5:0.3456) [28.8 s] 
INFO:root:all_losses: [0.18848379 0.6620161 ]
INFO:root:Epoch 57    loss=0.1885 [114.3 s]	 dev=(HR@5:0.5451,NDCG@5:0.3811) test=(HR@5:0.4931,NDCG@5:0.3450) [28.6 s] 
INFO:root:all_losses: [0.18681917 0.661254  ]
INFO:root:Epoch 58    loss=0.1868 [113.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.3865) test=(HR@5:0.4899,NDCG@5:0.3396) [28.7 s] 
INFO:root:all_losses: [0.18727699 0.660467  ]
INFO:root:Epoch 59    loss=0.1873 [113.3 s]	 dev=(HR@5:0.5578,NDCG@5:0.3906) test=(HR@5:0.4973,NDCG@5:0.3503) [28.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18693581 0.66088194]
INFO:root:Epoch 60    loss=0.1869 [114.1 s]	 dev=(HR@5:0.5567,NDCG@5:0.3907) test=(HR@5:0.4942,NDCG@5:0.3456) [28.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18458427 0.65942085]
INFO:root:Epoch 61    loss=0.1846 [112.9 s]	 dev=(HR@5:0.5620,NDCG@5:0.3917) test=(HR@5:0.5037,NDCG@5:0.3515) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.1852816 0.6586018]
INFO:root:Epoch 62    loss=0.1853 [113.2 s]	 dev=(HR@5:0.5493,NDCG@5:0.3871) test=(HR@5:0.5048,NDCG@5:0.3509) [28.7 s] 
INFO:root:all_losses: [0.18368593 0.65819144]
INFO:root:Epoch 63    loss=0.1837 [114.2 s]	 dev=(HR@5:0.5557,NDCG@5:0.3922) test=(HR@5:0.5058,NDCG@5:0.3522) [28.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18306443 0.65722597]
INFO:root:Epoch 64    loss=0.1831 [113.7 s]	 dev=(HR@5:0.5514,NDCG@5:0.3906) test=(HR@5:0.5090,NDCG@5:0.3531) [28.8 s] 
INFO:root:all_losses: [0.18144937 0.6571061 ]
INFO:root:Epoch 65    loss=0.1814 [113.8 s]	 dev=(HR@5:0.5483,NDCG@5:0.3899) test=(HR@5:0.5058,NDCG@5:0.3510) [29.1 s] 
INFO:root:all_losses: [0.18301132 0.65649974]
INFO:root:Epoch 66    loss=0.1830 [113.5 s]	 dev=(HR@5:0.5567,NDCG@5:0.3900) test=(HR@5:0.5090,NDCG@5:0.3510) [28.5 s] 
INFO:root:all_losses: [0.18256016 0.65602326]
INFO:root:Epoch 67    loss=0.1826 [113.4 s]	 dev=(HR@5:0.5578,NDCG@5:0.3922) test=(HR@5:0.5101,NDCG@5:0.3499) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.18167205 0.65524524]
INFO:root:Epoch 68    loss=0.1817 [114.4 s]	 dev=(HR@5:0.5536,NDCG@5:0.3884) test=(HR@5:0.5027,NDCG@5:0.3476) [28.9 s] 
INFO:root:all_losses: [0.17955098 0.6547262 ]
INFO:root:Epoch 69    loss=0.1796 [113.3 s]	 dev=(HR@5:0.5599,NDCG@5:0.3930) test=(HR@5:0.5069,NDCG@5:0.3537) [28.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.1797822 0.6540398]
INFO:root:Epoch 70    loss=0.1798 [113.6 s]	 dev=(HR@5:0.5567,NDCG@5:0.3897) test=(HR@5:0.5016,NDCG@5:0.3468) [28.9 s] 
INFO:root:all_losses: [0.17611481 0.6533224 ]
INFO:root:Epoch 71    loss=0.1761 [114.1 s]	 dev=(HR@5:0.5514,NDCG@5:0.3855) test=(HR@5:0.5037,NDCG@5:0.3491) [28.7 s] 
INFO:root:all_losses: [0.17671594 0.6532316 ]
INFO:root:Epoch 72    loss=0.1767 [113.8 s]	 dev=(HR@5:0.5589,NDCG@5:0.3895) test=(HR@5:0.4984,NDCG@5:0.3494) [28.9 s] 
INFO:root:all_losses: [0.17598328 0.65226734]
INFO:root:Epoch 73    loss=0.1760 [114.0 s]	 dev=(HR@5:0.5514,NDCG@5:0.3901) test=(HR@5:0.5069,NDCG@5:0.3509) [28.8 s] 
INFO:root:all_losses: [0.17607412 0.6510006 ]
INFO:root:Epoch 74    loss=0.1761 [114.3 s]	 dev=(HR@5:0.5695,NDCG@5:0.3967) test=(HR@5:0.5090,NDCG@5:0.3507) [28.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.17541197 0.6509714 ]
INFO:root:Epoch 75    loss=0.1754 [114.1 s]	 dev=(HR@5:0.5642,NDCG@5:0.3964) test=(HR@5:0.5143,NDCG@5:0.3548) [28.9 s] 
INFO:root:all_losses: [0.17485538 0.6494873 ]
INFO:root:Epoch 76    loss=0.1749 [114.1 s]	 dev=(HR@5:0.5578,NDCG@5:0.3919) test=(HR@5:0.5164,NDCG@5:0.3540) [28.9 s] 
INFO:root:all_losses: [0.17490219 0.6485082 ]
INFO:root:Epoch 77    loss=0.1749 [114.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.3972) test=(HR@5:0.5249,NDCG@5:0.3603) [28.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.17340092 0.649128  ]
INFO:root:Epoch 78    loss=0.1734 [114.8 s]	 dev=(HR@5:0.5493,NDCG@5:0.3907) test=(HR@5:0.5090,NDCG@5:0.3520) [28.8 s] 
INFO:root:all_losses: [0.17247045 0.6485576 ]
INFO:root:Epoch 79    loss=0.1725 [114.2 s]	 dev=(HR@5:0.5620,NDCG@5:0.3946) test=(HR@5:0.5111,NDCG@5:0.3538) [28.8 s] 
INFO:root:all_losses: [0.17368649 0.6474854 ]
INFO:root:Epoch 80    loss=0.1737 [114.0 s]	 dev=(HR@5:0.5642,NDCG@5:0.4013) test=(HR@5:0.5196,NDCG@5:0.3610) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.17098574 0.64691377]
INFO:root:Epoch 81    loss=0.1710 [114.6 s]	 dev=(HR@5:0.5631,NDCG@5:0.3973) test=(HR@5:0.5122,NDCG@5:0.3529) [28.9 s] 
INFO:root:all_losses: [0.17090899 0.64612967]
INFO:root:Epoch 82    loss=0.1709 [113.9 s]	 dev=(HR@5:0.5610,NDCG@5:0.3976) test=(HR@5:0.5196,NDCG@5:0.3607) [28.6 s] 
INFO:root:all_losses: [0.17161389 0.6451003 ]
INFO:root:Epoch 83    loss=0.1716 [114.6 s]	 dev=(HR@5:0.5642,NDCG@5:0.4015) test=(HR@5:0.5154,NDCG@5:0.3593) [29.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.16993321 0.64473873]
INFO:root:Epoch 84    loss=0.1699 [114.3 s]	 dev=(HR@5:0.5748,NDCG@5:0.4016) test=(HR@5:0.5270,NDCG@5:0.3673) [28.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.16965158 0.64468205]
INFO:root:Epoch 85    loss=0.1697 [114.2 s]	 dev=(HR@5:0.5705,NDCG@5:0.4008) test=(HR@5:0.5228,NDCG@5:0.3603) [28.8 s] 
INFO:root:all_losses: [0.16874108 0.6431031 ]
INFO:root:Epoch 86    loss=0.1687 [114.7 s]	 dev=(HR@5:0.5779,NDCG@5:0.4057) test=(HR@5:0.5260,NDCG@5:0.3672) [28.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.16722028 0.6428742 ]
INFO:root:Epoch 87    loss=0.1672 [114.4 s]	 dev=(HR@5:0.5673,NDCG@5:0.3999) test=(HR@5:0.5249,NDCG@5:0.3636) [28.8 s] 
INFO:root:all_losses: [0.16934074 0.64243776]
INFO:root:Epoch 88    loss=0.1693 [114.9 s]	 dev=(HR@5:0.5631,NDCG@5:0.3988) test=(HR@5:0.5154,NDCG@5:0.3581) [28.8 s] 
INFO:root:all_losses: [0.16723786 0.6416273 ]
INFO:root:Epoch 89    loss=0.1672 [113.9 s]	 dev=(HR@5:0.5599,NDCG@5:0.3982) test=(HR@5:0.5175,NDCG@5:0.3584) [28.7 s] 
INFO:root:all_losses: [0.16649126 0.640627  ]
INFO:root:Epoch 90    loss=0.1665 [114.4 s]	 dev=(HR@5:0.5652,NDCG@5:0.4013) test=(HR@5:0.5164,NDCG@5:0.3590) [28.8 s] 
INFO:root:all_losses: [0.16567081 0.6395339 ]
INFO:root:Epoch 91    loss=0.1657 [115.2 s]	 dev=(HR@5:0.5716,NDCG@5:0.4010) test=(HR@5:0.5239,NDCG@5:0.3671) [29.1 s] 
INFO:root:all_losses: [0.16466253 0.6391842 ]
INFO:root:Epoch 92    loss=0.1647 [114.4 s]	 dev=(HR@5:0.5557,NDCG@5:0.3967) test=(HR@5:0.5175,NDCG@5:0.3580) [29.0 s] 
INFO:root:all_losses: [0.16496716 0.63872856]
INFO:root:Epoch 93    loss=0.1650 [114.3 s]	 dev=(HR@5:0.5726,NDCG@5:0.4017) test=(HR@5:0.5196,NDCG@5:0.3648) [28.9 s] 
INFO:root:all_losses: [0.16282937 0.63853323]
INFO:root:Epoch 94    loss=0.1628 [113.6 s]	 dev=(HR@5:0.5726,NDCG@5:0.3993) test=(HR@5:0.5228,NDCG@5:0.3658) [29.2 s] 
INFO:root:all_losses: [0.16344035 0.6370405 ]
INFO:root:Epoch 95    loss=0.1634 [115.2 s]	 dev=(HR@5:0.5631,NDCG@5:0.3997) test=(HR@5:0.5217,NDCG@5:0.3623) [28.9 s] 
INFO:root:all_losses: [0.16480419 0.636523  ]
INFO:root:Epoch 96    loss=0.1648 [114.1 s]	 dev=(HR@5:0.5631,NDCG@5:0.4013) test=(HR@5:0.5249,NDCG@5:0.3666) [28.5 s] 
INFO:root:all_losses: [0.16325983 0.6351073 ]
INFO:root:Epoch 97    loss=0.1633 [114.3 s]	 dev=(HR@5:0.5610,NDCG@5:0.3976) test=(HR@5:0.5058,NDCG@5:0.3536) [28.7 s] 
INFO:root:all_losses: [0.16406164 0.63451   ]
INFO:root:Epoch 98    loss=0.1641 [114.5 s]	 dev=(HR@5:0.5652,NDCG@5:0.4003) test=(HR@5:0.5143,NDCG@5:0.3579) [28.8 s] 
INFO:root:all_losses: [0.16109532 0.63409066]
INFO:root:Epoch 99    loss=0.1611 [114.2 s]	 dev=(HR@5:0.5652,NDCG@5:0.4002) test=(HR@5:0.5111,NDCG@5:0.3583) [28.9 s] 
INFO:root:all_losses: [0.16148138 0.63328743]
INFO:root:Epoch 100   loss=0.1615 [114.7 s]	 dev=(HR@5:0.5599,NDCG@5:0.3943) test=(HR@5:0.5186,NDCG@5:0.3630) [29.1 s] 
INFO:root:all_losses: [0.1590576  0.63366354]
INFO:root:Epoch 101   loss=0.1591 [114.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.4033) test=(HR@5:0.5111,NDCG@5:0.3617) [28.8 s] 
INFO:root:all_losses: [0.15994158 0.6322712 ]
INFO:root:Epoch 102   loss=0.1599 [114.6 s]	 dev=(HR@5:0.5737,NDCG@5:0.4037) test=(HR@5:0.5270,NDCG@5:0.3693) [28.6 s] 
INFO:root:all_losses: [0.16081905 0.63118374]
INFO:root:Epoch 103   loss=0.1608 [114.5 s]	 dev=(HR@5:0.5705,NDCG@5:0.3994) test=(HR@5:0.5207,NDCG@5:0.3643) [28.6 s] 
INFO:root:all_losses: [0.16054824 0.63038915]
INFO:root:Epoch 104   loss=0.1605 [114.1 s]	 dev=(HR@5:0.5631,NDCG@5:0.3996) test=(HR@5:0.5101,NDCG@5:0.3617) [28.7 s] 
INFO:root:all_losses: [0.15991272 0.62994224]
INFO:root:Epoch 105   loss=0.1599 [114.8 s]	 dev=(HR@5:0.5673,NDCG@5:0.4055) test=(HR@5:0.5217,NDCG@5:0.3661) [28.8 s] 
INFO:root:all_losses: [0.15730435 0.6290584 ]
INFO:root:Epoch 106   loss=0.1573 [114.2 s]	 dev=(HR@5:0.5620,NDCG@5:0.3983) test=(HR@5:0.5111,NDCG@5:0.3578) [28.8 s] 
INFO:root:Early stop at 106 based on dev result.
INFO:root:
Best Iter(dev)=   86	 dev=(HR@5:0.5779,NDCG@5:0.4057) test=(HR@5:0.5260,NDCG@5:0.3672) [14505.9 s] 
INFO:root:Load model from ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=5_num_heads=4.pt
INFO:root:
Test After Training: (HR@10:0.6893,HR@5:0.5260,HR@50:0.9533,NDCG@10:0.4204,NDCG@5:0.3672,NDCG@50:0.4803)
INFO:root:
--------------------------------------------- END: 2025-07-10 23:50:47 ---------------------------------------------
INFO:root:Namespace(model_name='RCF')
INFO:root:--------------------------------------------- BEGIN: 2025-07-11 09:14:05 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gamma           | 1.0          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 message         |              
 metric          | ["NDCG","HR"]
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\KGReader.pkl
INFO:root:#params: 173767
INFO:root:RCF(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.1007,HR@5:0.0530,HR@50:0.5154,NDCG@10:0.0460,NDCG@5:0.0307,NDCG@50:0.1322)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [1.2454807 0.6931466]
INFO:root:Epoch 1     loss=1.2455 [72.7 s]	 dev=(HR@5:0.2471,NDCG@5:0.1576) test=(HR@5:0.2153,NDCG@5:0.1442) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.1066984 0.6931313]
INFO:root:Epoch 2     loss=1.1067 [73.3 s]	 dev=(HR@5:0.3203,NDCG@5:0.2249) test=(HR@5:0.2980,NDCG@5:0.2033) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.0412962 0.6930639]
INFO:root:Epoch 3     loss=1.0413 [73.6 s]	 dev=(HR@5:0.3701,NDCG@5:0.2568) test=(HR@5:0.3224,NDCG@5:0.2195) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.0056068  0.69292945]
INFO:root:Epoch 4     loss=1.0056 [73.2 s]	 dev=(HR@5:0.3860,NDCG@5:0.2705) test=(HR@5:0.3362,NDCG@5:0.2254) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.980488  0.6927359]
INFO:root:Epoch 5     loss=0.9805 [73.1 s]	 dev=(HR@5:0.3987,NDCG@5:0.2801) test=(HR@5:0.3595,NDCG@5:0.2444) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.9571203  0.69245154]
INFO:root:Epoch 6     loss=0.9571 [73.6 s]	 dev=(HR@5:0.4157,NDCG@5:0.2853) test=(HR@5:0.3690,NDCG@5:0.2474) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.9440351 0.6921617]
INFO:root:Epoch 7     loss=0.9440 [73.4 s]	 dev=(HR@5:0.4189,NDCG@5:0.2890) test=(HR@5:0.3659,NDCG@5:0.2484) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.9291692 0.6918048]
INFO:root:Epoch 8     loss=0.9292 [74.2 s]	 dev=(HR@5:0.4178,NDCG@5:0.2873) test=(HR@5:0.3701,NDCG@5:0.2495) [26.9 s] 
INFO:root:all_losses: [0.919898  0.6913714]
INFO:root:Epoch 9     loss=0.9199 [77.9 s]	 dev=(HR@5:0.4210,NDCG@5:0.2937) test=(HR@5:0.3659,NDCG@5:0.2469) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.91363686 0.6909136 ]
INFO:root:Epoch 10    loss=0.9136 [93.3 s]	 dev=(HR@5:0.4295,NDCG@5:0.2989) test=(HR@5:0.3743,NDCG@5:0.2526) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.90367043 0.6903561 ]
INFO:root:Epoch 11    loss=0.9037 [116.9 s]	 dev=(HR@5:0.4337,NDCG@5:0.3006) test=(HR@5:0.3765,NDCG@5:0.2545) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8977828 0.689859 ]
INFO:root:Epoch 12    loss=0.8978 [454.1 s]	 dev=(HR@5:0.4337,NDCG@5:0.3011) test=(HR@5:0.3839,NDCG@5:0.2582) [35.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8929704  0.68922824]
INFO:root:Epoch 13    loss=0.8930 [557.8 s]	 dev=(HR@5:0.4327,NDCG@5:0.3014) test=(HR@5:0.3860,NDCG@5:0.2586) [35.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8878723 0.6885713]
INFO:root:Epoch 14    loss=0.8879 [560.3 s]	 dev=(HR@5:0.4422,NDCG@5:0.3068) test=(HR@5:0.3977,NDCG@5:0.2680) [35.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8849222 0.687817 ]
INFO:root:Epoch 15    loss=0.8849 [497.7 s]	 dev=(HR@5:0.4528,NDCG@5:0.3130) test=(HR@5:0.4083,NDCG@5:0.2742) [37.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8777118  0.68704784]
INFO:root:Epoch 16    loss=0.8777 [370.1 s]	 dev=(HR@5:0.4581,NDCG@5:0.3178) test=(HR@5:0.4104,NDCG@5:0.2732) [35.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8732818  0.68627006]
INFO:root:Epoch 17    loss=0.8733 [147.6 s]	 dev=(HR@5:0.4751,NDCG@5:0.3261) test=(HR@5:0.4231,NDCG@5:0.2823) [35.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8693223 0.6853161]
INFO:root:Epoch 18    loss=0.8693 [105.2 s]	 dev=(HR@5:0.4708,NDCG@5:0.3298) test=(HR@5:0.4348,NDCG@5:0.2906) [35.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.86413264 0.6845056 ]
INFO:root:Epoch 19    loss=0.8641 [112.4 s]	 dev=(HR@5:0.4719,NDCG@5:0.3280) test=(HR@5:0.4274,NDCG@5:0.2867) [35.6 s] 
INFO:root:all_losses: [0.86119497 0.6833258 ]
INFO:root:Epoch 20    loss=0.8612 [139.8 s]	 dev=(HR@5:0.4804,NDCG@5:0.3308) test=(HR@5:0.4295,NDCG@5:0.2881) [35.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8557479 0.6820896]
INFO:root:Epoch 21    loss=0.8557 [184.9 s]	 dev=(HR@5:0.4783,NDCG@5:0.3321) test=(HR@5:0.4454,NDCG@5:0.2995) [35.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.850829  0.6811415]
INFO:root:Epoch 22    loss=0.8508 [219.8 s]	 dev=(HR@5:0.4942,NDCG@5:0.3423) test=(HR@5:0.4549,NDCG@5:0.3048) [36.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8478983 0.6797974]
INFO:root:Epoch 23    loss=0.8479 [234.6 s]	 dev=(HR@5:0.5016,NDCG@5:0.3471) test=(HR@5:0.4528,NDCG@5:0.3057) [36.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8443931  0.67843723]
INFO:root:Epoch 24    loss=0.8444 [236.0 s]	 dev=(HR@5:0.4899,NDCG@5:0.3354) test=(HR@5:0.4507,NDCG@5:0.3036) [36.4 s] 
INFO:root:all_losses: [0.8394665 0.6766881]
INFO:root:Epoch 25    loss=0.8395 [236.1 s]	 dev=(HR@5:0.4984,NDCG@5:0.3429) test=(HR@5:0.4549,NDCG@5:0.3036) [36.5 s] 
INFO:root:all_losses: [0.83629286 0.67536706]
INFO:root:Epoch 26    loss=0.8363 [236.0 s]	 dev=(HR@5:0.5101,NDCG@5:0.3514) test=(HR@5:0.4560,NDCG@5:0.3074) [36.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8311431  0.67362905]
INFO:root:Epoch 27    loss=0.8311 [237.4 s]	 dev=(HR@5:0.5090,NDCG@5:0.3502) test=(HR@5:0.4719,NDCG@5:0.3168) [36.3 s] 
INFO:root:all_losses: [0.8288061 0.6720158]
INFO:root:Epoch 28    loss=0.8288 [241.0 s]	 dev=(HR@5:0.5249,NDCG@5:0.3572) test=(HR@5:0.4666,NDCG@5:0.3125) [36.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.82425946 0.67027533]
INFO:root:Epoch 29    loss=0.8243 [245.4 s]	 dev=(HR@5:0.5239,NDCG@5:0.3570) test=(HR@5:0.4634,NDCG@5:0.3149) [36.5 s] 
INFO:root:all_losses: [0.8193272 0.6680873]
INFO:root:Epoch 30    loss=0.8193 [246.7 s]	 dev=(HR@5:0.5207,NDCG@5:0.3576) test=(HR@5:0.4655,NDCG@5:0.3140) [36.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.814535  0.6662092]
INFO:root:Epoch 31    loss=0.8145 [247.1 s]	 dev=(HR@5:0.5217,NDCG@5:0.3605) test=(HR@5:0.4624,NDCG@5:0.3141) [36.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8126356  0.66400665]
INFO:root:Epoch 32    loss=0.8126 [247.1 s]	 dev=(HR@5:0.5175,NDCG@5:0.3639) test=(HR@5:0.4666,NDCG@5:0.3167) [36.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8097204 0.6615401]
INFO:root:Epoch 33    loss=0.8097 [247.0 s]	 dev=(HR@5:0.4995,NDCG@5:0.3486) test=(HR@5:0.4549,NDCG@5:0.3077) [36.3 s] 
INFO:root:all_losses: [0.8043467  0.65947896]
INFO:root:Epoch 34    loss=0.8043 [247.2 s]	 dev=(HR@5:0.5249,NDCG@5:0.3651) test=(HR@5:0.4804,NDCG@5:0.3261) [36.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.8010798 0.6565777]
INFO:root:Epoch 35    loss=0.8011 [245.1 s]	 dev=(HR@5:0.5313,NDCG@5:0.3650) test=(HR@5:0.4708,NDCG@5:0.3225) [36.2 s] 
INFO:root:all_losses: [0.79784703 0.65463465]
INFO:root:Epoch 36    loss=0.7978 [247.3 s]	 dev=(HR@5:0.5366,NDCG@5:0.3721) test=(HR@5:0.4857,NDCG@5:0.3291) [36.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.7918084  0.65182626]
INFO:root:Epoch 37    loss=0.7918 [247.1 s]	 dev=(HR@5:0.5451,NDCG@5:0.3777) test=(HR@5:0.4899,NDCG@5:0.3326) [36.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.78940606 0.64886653]
INFO:root:Epoch 38    loss=0.7894 [245.4 s]	 dev=(HR@5:0.5408,NDCG@5:0.3716) test=(HR@5:0.4793,NDCG@5:0.3291) [36.5 s] 
INFO:root:all_losses: [0.7869986  0.64631706]
INFO:root:Epoch 39    loss=0.7870 [247.1 s]	 dev=(HR@5:0.5398,NDCG@5:0.3759) test=(HR@5:0.4942,NDCG@5:0.3388) [36.3 s] 
INFO:root:all_losses: [0.7793793  0.64280343]
INFO:root:Epoch 40    loss=0.7794 [247.3 s]	 dev=(HR@5:0.5429,NDCG@5:0.3750) test=(HR@5:0.4804,NDCG@5:0.3280) [36.5 s] 
INFO:root:all_losses: [0.77626735 0.639703  ]
INFO:root:Epoch 41    loss=0.7763 [247.3 s]	 dev=(HR@5:0.5440,NDCG@5:0.3743) test=(HR@5:0.4920,NDCG@5:0.3359) [36.6 s] 
INFO:root:all_losses: [0.7702006 0.6358677]
INFO:root:Epoch 42    loss=0.7702 [247.3 s]	 dev=(HR@5:0.5557,NDCG@5:0.3837) test=(HR@5:0.4973,NDCG@5:0.3383) [36.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.7679766  0.63258344]
INFO:root:Epoch 43    loss=0.7680 [247.1 s]	 dev=(HR@5:0.5429,NDCG@5:0.3735) test=(HR@5:0.4931,NDCG@5:0.3355) [36.5 s] 
INFO:root:all_losses: [0.7626722 0.6297385]
INFO:root:Epoch 44    loss=0.7627 [247.1 s]	 dev=(HR@5:0.5483,NDCG@5:0.3782) test=(HR@5:0.5027,NDCG@5:0.3455) [36.4 s] 
INFO:root:all_losses: [0.75623786 0.6249447 ]
INFO:root:Epoch 45    loss=0.7562 [245.2 s]	 dev=(HR@5:0.5493,NDCG@5:0.3765) test=(HR@5:0.4995,NDCG@5:0.3448) [36.6 s] 
INFO:root:all_losses: [0.7508879  0.62020385]
INFO:root:Epoch 46    loss=0.7509 [247.3 s]	 dev=(HR@5:0.5387,NDCG@5:0.3740) test=(HR@5:0.4952,NDCG@5:0.3453) [36.3 s] 
INFO:root:all_losses: [0.74930125 0.6172497 ]
INFO:root:Epoch 47    loss=0.7493 [247.3 s]	 dev=(HR@5:0.5483,NDCG@5:0.3847) test=(HR@5:0.5111,NDCG@5:0.3523) [36.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.74440354 0.61321926]
INFO:root:Epoch 48    loss=0.7444 [245.3 s]	 dev=(HR@5:0.5483,NDCG@5:0.3827) test=(HR@5:0.4952,NDCG@5:0.3392) [36.5 s] 
INFO:root:all_losses: [0.736796  0.6083291]
INFO:root:Epoch 49    loss=0.7368 [246.9 s]	 dev=(HR@5:0.5408,NDCG@5:0.3812) test=(HR@5:0.4995,NDCG@5:0.3461) [36.3 s] 
INFO:root:all_losses: [0.7328458 0.6033217]
INFO:root:Epoch 50    loss=0.7328 [247.2 s]	 dev=(HR@5:0.5557,NDCG@5:0.3899) test=(HR@5:0.4995,NDCG@5:0.3467) [36.5 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.7269828 0.5979766]
INFO:root:Epoch 51    loss=0.7270 [247.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3834) test=(HR@5:0.5069,NDCG@5:0.3523) [36.4 s] 
INFO:root:all_losses: [0.7208828 0.593932 ]
INFO:root:Epoch 52    loss=0.7209 [247.0 s]	 dev=(HR@5:0.5557,NDCG@5:0.3861) test=(HR@5:0.5027,NDCG@5:0.3481) [36.2 s] 
INFO:root:all_losses: [0.7161488 0.5891787]
INFO:root:Epoch 53    loss=0.7161 [247.2 s]	 dev=(HR@5:0.5610,NDCG@5:0.3899) test=(HR@5:0.4952,NDCG@5:0.3474) [36.4 s] 
INFO:root:all_losses: [0.7085728  0.58225363]
INFO:root:Epoch 54    loss=0.7086 [245.1 s]	 dev=(HR@5:0.5472,NDCG@5:0.3824) test=(HR@5:0.5027,NDCG@5:0.3429) [36.4 s] 
INFO:root:all_losses: [0.7005473  0.57706636]
INFO:root:Epoch 55    loss=0.7005 [247.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3828) test=(HR@5:0.5101,NDCG@5:0.3540) [36.4 s] 
INFO:root:all_losses: [0.69399667 0.5706824 ]
INFO:root:Epoch 56    loss=0.6940 [247.0 s]	 dev=(HR@5:0.5514,NDCG@5:0.3810) test=(HR@5:0.5048,NDCG@5:0.3479) [36.3 s] 
INFO:root:all_losses: [0.68917274 0.565162  ]
INFO:root:Epoch 57    loss=0.6892 [245.1 s]	 dev=(HR@5:0.5493,NDCG@5:0.3804) test=(HR@5:0.4963,NDCG@5:0.3478) [36.3 s] 
INFO:root:all_losses: [0.6808981  0.55783254]
INFO:root:Epoch 58    loss=0.6809 [245.2 s]	 dev=(HR@5:0.5589,NDCG@5:0.3834) test=(HR@5:0.4942,NDCG@5:0.3436) [36.1 s] 
INFO:root:all_losses: [0.67537904 0.5516439 ]
INFO:root:Epoch 59    loss=0.6754 [247.0 s]	 dev=(HR@5:0.5631,NDCG@5:0.3891) test=(HR@5:0.5133,NDCG@5:0.3600) [36.4 s] 
INFO:root:all_losses: [0.6708664 0.5469554]
INFO:root:Epoch 60    loss=0.6709 [247.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3827) test=(HR@5:0.5069,NDCG@5:0.3524) [36.3 s] 
INFO:root:all_losses: [0.6611656  0.53966117]
INFO:root:Epoch 61    loss=0.6612 [247.2 s]	 dev=(HR@5:0.5483,NDCG@5:0.3825) test=(HR@5:0.5058,NDCG@5:0.3507) [36.5 s] 
INFO:root:all_losses: [0.6547814 0.5313987]
INFO:root:Epoch 62    loss=0.6548 [245.2 s]	 dev=(HR@5:0.5589,NDCG@5:0.3835) test=(HR@5:0.5048,NDCG@5:0.3519) [36.4 s] 
INFO:root:all_losses: [0.6474038  0.52525574]
INFO:root:Epoch 63    loss=0.6474 [247.1 s]	 dev=(HR@5:0.5493,NDCG@5:0.3855) test=(HR@5:0.5122,NDCG@5:0.3549) [36.0 s] 
INFO:root:all_losses: [0.63949674 0.5177416 ]
INFO:root:Epoch 64    loss=0.6395 [247.1 s]	 dev=(HR@5:0.5589,NDCG@5:0.3897) test=(HR@5:0.5027,NDCG@5:0.3486) [36.3 s] 
INFO:root:all_losses: [0.6316935 0.5117315]
INFO:root:Epoch 65    loss=0.6317 [248.5 s]	 dev=(HR@5:0.5599,NDCG@5:0.3840) test=(HR@5:0.5101,NDCG@5:0.3481) [36.2 s] 
INFO:root:all_losses: [0.62737864 0.5052782 ]
INFO:root:Epoch 66    loss=0.6274 [247.1 s]	 dev=(HR@5:0.5483,NDCG@5:0.3791) test=(HR@5:0.5016,NDCG@5:0.3448) [36.3 s] 
INFO:root:all_losses: [0.6187342  0.49684617]
INFO:root:Epoch 67    loss=0.6187 [246.9 s]	 dev=(HR@5:0.5642,NDCG@5:0.3904) test=(HR@5:0.5133,NDCG@5:0.3537) [36.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.6135138 0.491606 ]
INFO:root:Epoch 68    loss=0.6135 [246.9 s]	 dev=(HR@5:0.5610,NDCG@5:0.3826) test=(HR@5:0.5058,NDCG@5:0.3508) [36.3 s] 
INFO:root:all_losses: [0.6031062 0.4829894]
INFO:root:Epoch 69    loss=0.6031 [244.8 s]	 dev=(HR@5:0.5557,NDCG@5:0.3853) test=(HR@5:0.5154,NDCG@5:0.3532) [36.3 s] 
INFO:root:all_losses: [0.59627163 0.47640723]
INFO:root:Epoch 70    loss=0.5963 [247.0 s]	 dev=(HR@5:0.5504,NDCG@5:0.3829) test=(HR@5:0.5090,NDCG@5:0.3499) [36.3 s] 
INFO:root:all_losses: [0.5862844  0.46885854]
INFO:root:Epoch 71    loss=0.5863 [246.9 s]	 dev=(HR@5:0.5504,NDCG@5:0.3821) test=(HR@5:0.5111,NDCG@5:0.3504) [36.2 s] 
INFO:root:all_losses: [0.58097285 0.46280563]
INFO:root:Epoch 72    loss=0.5810 [246.7 s]	 dev=(HR@5:0.5610,NDCG@5:0.3857) test=(HR@5:0.5133,NDCG@5:0.3507) [36.3 s] 
INFO:root:all_losses: [0.5744031 0.4566804]
INFO:root:Epoch 73    loss=0.5744 [246.8 s]	 dev=(HR@5:0.5589,NDCG@5:0.3859) test=(HR@5:0.5080,NDCG@5:0.3510) [36.3 s] 
INFO:root:all_losses: [0.5676096 0.4494378]
INFO:root:Epoch 74    loss=0.5676 [245.2 s]	 dev=(HR@5:0.5610,NDCG@5:0.3835) test=(HR@5:0.5122,NDCG@5:0.3517) [36.2 s] 
INFO:root:all_losses: [0.56257474 0.44426304]
INFO:root:Epoch 75    loss=0.5626 [245.0 s]	 dev=(HR@5:0.5557,NDCG@5:0.3821) test=(HR@5:0.5154,NDCG@5:0.3573) [36.1 s] 
INFO:root:all_losses: [0.5530104  0.43526715]
INFO:root:Epoch 76    loss=0.5530 [247.0 s]	 dev=(HR@5:0.5567,NDCG@5:0.3879) test=(HR@5:0.5080,NDCG@5:0.3550) [36.1 s] 
INFO:root:all_losses: [0.54706055 0.4292088 ]
INFO:root:Epoch 77    loss=0.5471 [247.2 s]	 dev=(HR@5:0.5546,NDCG@5:0.3858) test=(HR@5:0.5175,NDCG@5:0.3578) [36.0 s] 
INFO:root:all_losses: [0.5389847  0.42297468]
INFO:root:Epoch 78    loss=0.5390 [246.9 s]	 dev=(HR@5:0.5557,NDCG@5:0.3874) test=(HR@5:0.5016,NDCG@5:0.3499) [36.2 s] 
INFO:root:all_losses: [0.536194   0.41933993]
INFO:root:Epoch 79    loss=0.5362 [247.0 s]	 dev=(HR@5:0.5525,NDCG@5:0.3852) test=(HR@5:0.5133,NDCG@5:0.3552) [36.2 s] 
INFO:root:all_losses: [0.53036296 0.41270223]
INFO:root:Epoch 80    loss=0.5304 [247.1 s]	 dev=(HR@5:0.5525,NDCG@5:0.3852) test=(HR@5:0.5037,NDCG@5:0.3516) [36.4 s] 
INFO:root:all_losses: [0.52024823 0.40469098]
INFO:root:Epoch 81    loss=0.5202 [246.9 s]	 dev=(HR@5:0.5546,NDCG@5:0.3899) test=(HR@5:0.5080,NDCG@5:0.3531) [36.3 s] 
INFO:root:all_losses: [0.514836   0.39911535]
INFO:root:Epoch 82    loss=0.5148 [247.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.3999) test=(HR@5:0.5175,NDCG@5:0.3597) [36.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [0.50927913 0.39204812]
INFO:root:Epoch 83    loss=0.5093 [246.9 s]	 dev=(HR@5:0.5642,NDCG@5:0.3907) test=(HR@5:0.5111,NDCG@5:0.3543) [36.1 s] 
INFO:root:all_losses: [0.5028058  0.38746142]
INFO:root:Epoch 84    loss=0.5028 [247.1 s]	 dev=(HR@5:0.5578,NDCG@5:0.3892) test=(HR@5:0.5101,NDCG@5:0.3578) [36.1 s] 
INFO:root:all_losses: [0.49709767 0.3819597 ]
INFO:root:Epoch 85    loss=0.4971 [246.9 s]	 dev=(HR@5:0.5663,NDCG@5:0.3950) test=(HR@5:0.5005,NDCG@5:0.3500) [36.3 s] 
INFO:root:all_losses: [0.4898779  0.37570605]
INFO:root:Epoch 86    loss=0.4899 [245.1 s]	 dev=(HR@5:0.5663,NDCG@5:0.3953) test=(HR@5:0.5186,NDCG@5:0.3609) [36.2 s] 
INFO:root:all_losses: [0.48335263 0.37069306]
INFO:root:Epoch 87    loss=0.4834 [247.1 s]	 dev=(HR@5:0.5631,NDCG@5:0.3930) test=(HR@5:0.5196,NDCG@5:0.3571) [36.9 s] 
INFO:root:all_losses: [0.4820084  0.36567047]
INFO:root:Epoch 88    loss=0.4820 [246.9 s]	 dev=(HR@5:0.5599,NDCG@5:0.3926) test=(HR@5:0.5154,NDCG@5:0.3529) [36.1 s] 
INFO:root:all_losses: [0.4738903 0.3603179]
INFO:root:Epoch 89    loss=0.4739 [246.9 s]	 dev=(HR@5:0.5567,NDCG@5:0.3898) test=(HR@5:0.5037,NDCG@5:0.3508) [36.1 s] 
INFO:root:all_losses: [0.4681711 0.3549658]
INFO:root:Epoch 90    loss=0.4682 [247.0 s]	 dev=(HR@5:0.5493,NDCG@5:0.3877) test=(HR@5:0.4952,NDCG@5:0.3448) [36.0 s] 
INFO:root:Early stop at 90 based on dev result.
INFO:root:
Best Iter(dev)=   82	 dev=(HR@5:0.5663,NDCG@5:0.3999) test=(HR@5:0.5175,NDCG@5:0.3597) [24100.8 s] 
INFO:root:Load model from ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=5_num_heads=4.pt
INFO:root:
Test After Training: (HR@10:0.6999,HR@5:0.5175,HR@50:0.9597,NDCG@10:0.4188,NDCG@5:0.3597,NDCG@50:0.4775)
INFO:root:
--------------------------------------------- END: 2025-07-11 15:56:18 ---------------------------------------------
INFO:root:Namespace(model_name='RCF')
INFO:root:--------------------------------------------- BEGIN: 2025-07-11 21:12:11 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gamma           | 5.0          
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 message         |              
 metric          | ["NDCG","HR"]
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\KGReader.pkl
INFO:root:#params: 173767
INFO:root:RCF(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.1007,HR@5:0.0530,HR@50:0.5154,NDCG@10:0.0460,NDCG@5:0.0307,NDCG@50:0.1322)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [4.018069  0.6931466]
INFO:root:Epoch 1     loss=4.0181 [72.9 s]	 dev=(HR@5:0.2471,NDCG@5:0.1578) test=(HR@5:0.2153,NDCG@5:0.1442) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.8792176 0.6931311]
INFO:root:Epoch 2     loss=3.8792 [73.0 s]	 dev=(HR@5:0.3203,NDCG@5:0.2250) test=(HR@5:0.2980,NDCG@5:0.2033) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.8134177 0.6930621]
INFO:root:Epoch 3     loss=3.8134 [73.3 s]	 dev=(HR@5:0.3680,NDCG@5:0.2570) test=(HR@5:0.3245,NDCG@5:0.2203) [26.8 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.7768798  0.69292307]
INFO:root:Epoch 4     loss=3.7769 [73.3 s]	 dev=(HR@5:0.3902,NDCG@5:0.2720) test=(HR@5:0.3383,NDCG@5:0.2259) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.7509801 0.692718 ]
INFO:root:Epoch 5     loss=3.7510 [72.8 s]	 dev=(HR@5:0.3977,NDCG@5:0.2815) test=(HR@5:0.3627,NDCG@5:0.2461) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.7264793 0.6924084]
INFO:root:Epoch 6     loss=3.7265 [73.1 s]	 dev=(HR@5:0.4199,NDCG@5:0.2886) test=(HR@5:0.3712,NDCG@5:0.2475) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.7116427 0.6920753]
INFO:root:Epoch 7     loss=3.7116 [73.6 s]	 dev=(HR@5:0.4221,NDCG@5:0.2913) test=(HR@5:0.3648,NDCG@5:0.2485) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.6945438  0.69164044]
INFO:root:Epoch 8     loss=3.6945 [73.7 s]	 dev=(HR@5:0.4231,NDCG@5:0.2895) test=(HR@5:0.3722,NDCG@5:0.2503) [26.9 s] 
INFO:root:all_losses: [3.6824408  0.69108194]
INFO:root:Epoch 9     loss=3.6824 [77.0 s]	 dev=(HR@5:0.4231,NDCG@5:0.2950) test=(HR@5:0.3669,NDCG@5:0.2467) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.6730042 0.6904326]
INFO:root:Epoch 10    loss=3.6730 [89.9 s]	 dev=(HR@5:0.4348,NDCG@5:0.3031) test=(HR@5:0.3754,NDCG@5:0.2537) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.6589735 0.6895794]
INFO:root:Epoch 11    loss=3.6590 [111.3 s]	 dev=(HR@5:0.4305,NDCG@5:0.2993) test=(HR@5:0.3796,NDCG@5:0.2566) [27.1 s] 
INFO:root:all_losses: [3.6488533 0.6887037]
INFO:root:Epoch 12    loss=3.6489 [126.6 s]	 dev=(HR@5:0.4380,NDCG@5:0.3024) test=(HR@5:0.3828,NDCG@5:0.2599) [27.1 s] 
INFO:root:all_losses: [3.6384609 0.6875185]
INFO:root:Epoch 13    loss=3.6385 [131.2 s]	 dev=(HR@5:0.4369,NDCG@5:0.3041) test=(HR@5:0.3934,NDCG@5:0.2621) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.627032  0.6861306]
INFO:root:Epoch 14    loss=3.6270 [120.3 s]	 dev=(HR@5:0.4475,NDCG@5:0.3112) test=(HR@5:0.4051,NDCG@5:0.2727) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.616016  0.6844071]
INFO:root:Epoch 15    loss=3.6160 [83.4 s]	 dev=(HR@5:0.4592,NDCG@5:0.3173) test=(HR@5:0.4146,NDCG@5:0.2778) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.599282  0.6823886]
INFO:root:Epoch 16    loss=3.5993 [74.1 s]	 dev=(HR@5:0.4624,NDCG@5:0.3210) test=(HR@5:0.4104,NDCG@5:0.2753) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.5833657  0.67998457]
INFO:root:Epoch 17    loss=3.5834 [74.0 s]	 dev=(HR@5:0.4719,NDCG@5:0.3259) test=(HR@5:0.4337,NDCG@5:0.2913) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.5660818 0.6770811]
INFO:root:Epoch 18    loss=3.5661 [75.0 s]	 dev=(HR@5:0.4740,NDCG@5:0.3309) test=(HR@5:0.4263,NDCG@5:0.2901) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.5463734 0.6740107]
INFO:root:Epoch 19    loss=3.5464 [76.5 s]	 dev=(HR@5:0.4783,NDCG@5:0.3342) test=(HR@5:0.4274,NDCG@5:0.2881) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.5241022 0.6698971]
INFO:root:Epoch 20    loss=3.5241 [83.0 s]	 dev=(HR@5:0.4751,NDCG@5:0.3279) test=(HR@5:0.4358,NDCG@5:0.2923) [27.1 s] 
INFO:root:all_losses: [3.4971528  0.66525155]
INFO:root:Epoch 21    loss=3.4972 [92.3 s]	 dev=(HR@5:0.4814,NDCG@5:0.3330) test=(HR@5:0.4486,NDCG@5:0.3018) [27.2 s] 
INFO:root:all_losses: [3.4707568 0.6606669]
INFO:root:Epoch 22    loss=3.4708 [98.3 s]	 dev=(HR@5:0.4973,NDCG@5:0.3473) test=(HR@5:0.4613,NDCG@5:0.3116) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.4403448  0.65475386]
INFO:root:Epoch 23    loss=3.4403 [100.9 s]	 dev=(HR@5:0.4973,NDCG@5:0.3465) test=(HR@5:0.4581,NDCG@5:0.3047) [27.1 s] 
INFO:root:all_losses: [3.4074876  0.64853656]
INFO:root:Epoch 24    loss=3.4075 [100.7 s]	 dev=(HR@5:0.4846,NDCG@5:0.3365) test=(HR@5:0.4549,NDCG@5:0.3095) [27.3 s] 
INFO:root:all_losses: [3.3663747  0.64073247]
INFO:root:Epoch 25    loss=3.3664 [101.0 s]	 dev=(HR@5:0.4910,NDCG@5:0.3352) test=(HR@5:0.4517,NDCG@5:0.3037) [27.2 s] 
INFO:root:all_losses: [3.328504  0.6332829]
INFO:root:Epoch 26    loss=3.3285 [100.4 s]	 dev=(HR@5:0.4963,NDCG@5:0.3446) test=(HR@5:0.4560,NDCG@5:0.3088) [27.1 s] 
INFO:root:all_losses: [3.2791433  0.62399477]
INFO:root:Epoch 27    loss=3.2791 [101.4 s]	 dev=(HR@5:0.4973,NDCG@5:0.3448) test=(HR@5:0.4719,NDCG@5:0.3171) [27.0 s] 
INFO:root:all_losses: [3.234468  0.6149424]
INFO:root:Epoch 28    loss=3.2345 [101.3 s]	 dev=(HR@5:0.5037,NDCG@5:0.3492) test=(HR@5:0.4677,NDCG@5:0.3168) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.1807446  0.60441065]
INFO:root:Epoch 29    loss=3.1807 [101.3 s]	 dev=(HR@5:0.4995,NDCG@5:0.3455) test=(HR@5:0.4666,NDCG@5:0.3132) [27.3 s] 
INFO:root:all_losses: [3.119546  0.5924074]
INFO:root:Epoch 30    loss=3.1195 [101.0 s]	 dev=(HR@5:0.5016,NDCG@5:0.3483) test=(HR@5:0.4592,NDCG@5:0.3122) [27.2 s] 
INFO:root:all_losses: [3.0600064  0.58098024]
INFO:root:Epoch 31    loss=3.0600 [101.4 s]	 dev=(HR@5:0.5090,NDCG@5:0.3497) test=(HR@5:0.4560,NDCG@5:0.3082) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.9982474  0.56826425]
INFO:root:Epoch 32    loss=2.9982 [101.1 s]	 dev=(HR@5:0.5080,NDCG@5:0.3517) test=(HR@5:0.4581,NDCG@5:0.3134) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.9350462 0.5553336]
INFO:root:Epoch 33    loss=2.9350 [101.2 s]	 dev=(HR@5:0.4910,NDCG@5:0.3396) test=(HR@5:0.4486,NDCG@5:0.2997) [27.2 s] 
INFO:root:all_losses: [2.8694048 0.5428642]
INFO:root:Epoch 34    loss=2.8694 [101.3 s]	 dev=(HR@5:0.5048,NDCG@5:0.3515) test=(HR@5:0.4592,NDCG@5:0.3128) [27.0 s] 
INFO:root:all_losses: [2.7937503  0.52759135]
INFO:root:Epoch 35    loss=2.7938 [101.5 s]	 dev=(HR@5:0.5069,NDCG@5:0.3456) test=(HR@5:0.4571,NDCG@5:0.3121) [27.1 s] 
INFO:root:all_losses: [2.735943  0.5159812]
INFO:root:Epoch 36    loss=2.7359 [101.4 s]	 dev=(HR@5:0.5090,NDCG@5:0.3540) test=(HR@5:0.4645,NDCG@5:0.3149) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.6698375 0.5031512]
INFO:root:Epoch 37    loss=2.6698 [101.4 s]	 dev=(HR@5:0.5154,NDCG@5:0.3566) test=(HR@5:0.4655,NDCG@5:0.3172) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.6085992  0.49068952]
INFO:root:Epoch 38    loss=2.6086 [101.2 s]	 dev=(HR@5:0.5101,NDCG@5:0.3560) test=(HR@5:0.4666,NDCG@5:0.3147) [27.0 s] 
INFO:root:all_losses: [2.5462487 0.4779272]
INFO:root:Epoch 39    loss=2.5462 [101.3 s]	 dev=(HR@5:0.5048,NDCG@5:0.3528) test=(HR@5:0.4571,NDCG@5:0.3110) [27.2 s] 
INFO:root:all_losses: [2.4829009  0.46601775]
INFO:root:Epoch 40    loss=2.4829 [101.6 s]	 dev=(HR@5:0.5058,NDCG@5:0.3543) test=(HR@5:0.4602,NDCG@5:0.3136) [27.0 s] 
INFO:root:all_losses: [2.4280949 0.4547387]
INFO:root:Epoch 41    loss=2.4281 [101.2 s]	 dev=(HR@5:0.5005,NDCG@5:0.3512) test=(HR@5:0.4496,NDCG@5:0.3087) [27.1 s] 
INFO:root:all_losses: [2.3596613  0.44140953]
INFO:root:Epoch 42    loss=2.3597 [101.9 s]	 dev=(HR@5:0.5133,NDCG@5:0.3592) test=(HR@5:0.4677,NDCG@5:0.3189) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.3157957  0.43243936]
INFO:root:Epoch 43    loss=2.3158 [100.9 s]	 dev=(HR@5:0.5048,NDCG@5:0.3515) test=(HR@5:0.4613,NDCG@5:0.3161) [27.2 s] 
INFO:root:all_losses: [2.2667098  0.42279717]
INFO:root:Epoch 44    loss=2.2667 [101.4 s]	 dev=(HR@5:0.5058,NDCG@5:0.3542) test=(HR@5:0.4624,NDCG@5:0.3180) [27.1 s] 
INFO:root:all_losses: [2.2105813  0.41210032]
INFO:root:Epoch 45    loss=2.2106 [101.2 s]	 dev=(HR@5:0.5154,NDCG@5:0.3577) test=(HR@5:0.4677,NDCG@5:0.3179) [27.0 s] 
INFO:root:all_losses: [2.1540923  0.40058827]
INFO:root:Epoch 46    loss=2.1541 [101.1 s]	 dev=(HR@5:0.5249,NDCG@5:0.3620) test=(HR@5:0.4613,NDCG@5:0.3101) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.1196785 0.3933069]
INFO:root:Epoch 47    loss=2.1197 [101.4 s]	 dev=(HR@5:0.5111,NDCG@5:0.3586) test=(HR@5:0.4677,NDCG@5:0.3162) [27.3 s] 
INFO:root:all_losses: [2.0742843 0.3844711]
INFO:root:Epoch 48    loss=2.0743 [101.3 s]	 dev=(HR@5:0.5080,NDCG@5:0.3543) test=(HR@5:0.4486,NDCG@5:0.3061) [27.1 s] 
INFO:root:all_losses: [2.030634   0.37604558]
INFO:root:Epoch 49    loss=2.0306 [101.3 s]	 dev=(HR@5:0.5207,NDCG@5:0.3638) test=(HR@5:0.4645,NDCG@5:0.3120) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.9835932  0.36644724]
INFO:root:Epoch 50    loss=1.9836 [101.5 s]	 dev=(HR@5:0.5175,NDCG@5:0.3634) test=(HR@5:0.4624,NDCG@5:0.3167) [27.0 s] 
INFO:root:all_losses: [1.9421153  0.35828972]
INFO:root:Epoch 51    loss=1.9421 [101.4 s]	 dev=(HR@5:0.5217,NDCG@5:0.3622) test=(HR@5:0.4677,NDCG@5:0.3164) [27.1 s] 
INFO:root:all_losses: [1.9118606 0.3524847]
INFO:root:Epoch 52    loss=1.9119 [101.4 s]	 dev=(HR@5:0.5228,NDCG@5:0.3617) test=(HR@5:0.4687,NDCG@5:0.3172) [27.2 s] 
INFO:root:all_losses: [1.8728701  0.34461817]
INFO:root:Epoch 53    loss=1.8729 [101.4 s]	 dev=(HR@5:0.5143,NDCG@5:0.3653) test=(HR@5:0.4645,NDCG@5:0.3152) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.841839   0.33842233]
INFO:root:Epoch 54    loss=1.8418 [101.3 s]	 dev=(HR@5:0.5122,NDCG@5:0.3607) test=(HR@5:0.4571,NDCG@5:0.3119) [27.1 s] 
INFO:root:all_losses: [1.8010157  0.33101833]
INFO:root:Epoch 55    loss=1.8010 [102.1 s]	 dev=(HR@5:0.5175,NDCG@5:0.3589) test=(HR@5:0.4687,NDCG@5:0.3182) [27.3 s] 
INFO:root:all_losses: [1.7592113  0.32261086]
INFO:root:Epoch 56    loss=1.7592 [101.3 s]	 dev=(HR@5:0.5133,NDCG@5:0.3604) test=(HR@5:0.4666,NDCG@5:0.3167) [27.2 s] 
INFO:root:all_losses: [1.7391523  0.31837064]
INFO:root:Epoch 57    loss=1.7392 [100.8 s]	 dev=(HR@5:0.5207,NDCG@5:0.3645) test=(HR@5:0.4698,NDCG@5:0.3190) [27.0 s] 
INFO:root:all_losses: [1.6926804 0.3091245]
INFO:root:Epoch 58    loss=1.6927 [101.3 s]	 dev=(HR@5:0.5143,NDCG@5:0.3622) test=(HR@5:0.4634,NDCG@5:0.3169) [27.2 s] 
INFO:root:all_losses: [1.6694019  0.30462012]
INFO:root:Epoch 59    loss=1.6694 [101.4 s]	 dev=(HR@5:0.5239,NDCG@5:0.3674) test=(HR@5:0.4634,NDCG@5:0.3199) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.6486619  0.30023062]
INFO:root:Epoch 60    loss=1.6487 [101.2 s]	 dev=(HR@5:0.5217,NDCG@5:0.3655) test=(HR@5:0.4571,NDCG@5:0.3128) [27.0 s] 
INFO:root:all_losses: [1.6097076  0.29295227]
INFO:root:Epoch 61    loss=1.6097 [101.5 s]	 dev=(HR@5:0.5101,NDCG@5:0.3620) test=(HR@5:0.4677,NDCG@5:0.3160) [27.0 s] 
INFO:root:all_losses: [1.5775894  0.28593233]
INFO:root:Epoch 62    loss=1.5776 [101.7 s]	 dev=(HR@5:0.5133,NDCG@5:0.3655) test=(HR@5:0.4655,NDCG@5:0.3151) [27.0 s] 
INFO:root:all_losses: [1.5458764  0.28015962]
INFO:root:Epoch 63    loss=1.5459 [100.9 s]	 dev=(HR@5:0.5186,NDCG@5:0.3679) test=(HR@5:0.4624,NDCG@5:0.3165) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.5212623  0.27544364]
INFO:root:Epoch 64    loss=1.5213 [101.4 s]	 dev=(HR@5:0.5207,NDCG@5:0.3617) test=(HR@5:0.4719,NDCG@5:0.3198) [27.1 s] 
INFO:root:all_losses: [1.496659  0.2707509]
INFO:root:Epoch 65    loss=1.4967 [101.4 s]	 dev=(HR@5:0.5217,NDCG@5:0.3632) test=(HR@5:0.4634,NDCG@5:0.3135) [27.2 s] 
INFO:root:all_losses: [1.475481  0.2661303]
INFO:root:Epoch 66    loss=1.4755 [101.5 s]	 dev=(HR@5:0.5058,NDCG@5:0.3571) test=(HR@5:0.4645,NDCG@5:0.3130) [27.1 s] 
INFO:root:all_losses: [1.4497373  0.26098996]
INFO:root:Epoch 67    loss=1.4497 [101.4 s]	 dev=(HR@5:0.5207,NDCG@5:0.3653) test=(HR@5:0.4708,NDCG@5:0.3195) [27.0 s] 
INFO:root:all_losses: [1.4382753  0.25856277]
INFO:root:Epoch 68    loss=1.4383 [101.8 s]	 dev=(HR@5:0.5207,NDCG@5:0.3646) test=(HR@5:0.4645,NDCG@5:0.3138) [27.2 s] 
INFO:root:all_losses: [1.3920157  0.24975066]
INFO:root:Epoch 69    loss=1.3920 [100.8 s]	 dev=(HR@5:0.5260,NDCG@5:0.3698) test=(HR@5:0.4751,NDCG@5:0.3199) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.381897   0.24781324]
INFO:root:Epoch 70    loss=1.3819 [101.8 s]	 dev=(HR@5:0.5292,NDCG@5:0.3692) test=(HR@5:0.4602,NDCG@5:0.3161) [27.3 s] 
INFO:root:all_losses: [1.3515295  0.24216914]
INFO:root:Epoch 71    loss=1.3515 [101.5 s]	 dev=(HR@5:0.5239,NDCG@5:0.3637) test=(HR@5:0.4592,NDCG@5:0.3177) [27.2 s] 
INFO:root:all_losses: [1.3327026  0.23829441]
INFO:root:Epoch 72    loss=1.3327 [101.2 s]	 dev=(HR@5:0.5292,NDCG@5:0.3709) test=(HR@5:0.4666,NDCG@5:0.3187) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.3098124  0.23407565]
INFO:root:Epoch 73    loss=1.3098 [101.1 s]	 dev=(HR@5:0.5228,NDCG@5:0.3643) test=(HR@5:0.4592,NDCG@5:0.3138) [27.2 s] 
INFO:root:all_losses: [1.292629   0.23039998]
INFO:root:Epoch 74    loss=1.2926 [101.4 s]	 dev=(HR@5:0.5186,NDCG@5:0.3641) test=(HR@5:0.4677,NDCG@5:0.3201) [27.1 s] 
INFO:root:all_losses: [1.279579   0.22788759]
INFO:root:Epoch 75    loss=1.2796 [101.5 s]	 dev=(HR@5:0.5239,NDCG@5:0.3684) test=(HR@5:0.4772,NDCG@5:0.3223) [27.1 s] 
INFO:root:all_losses: [1.2511685  0.22218803]
INFO:root:Epoch 76    loss=1.2512 [101.2 s]	 dev=(HR@5:0.5154,NDCG@5:0.3670) test=(HR@5:0.4719,NDCG@5:0.3174) [27.1 s] 
INFO:root:all_losses: [1.2414446 0.2203399]
INFO:root:Epoch 77    loss=1.2414 [101.7 s]	 dev=(HR@5:0.5239,NDCG@5:0.3666) test=(HR@5:0.4719,NDCG@5:0.3207) [26.9 s] 
INFO:root:all_losses: [1.2163907  0.21573119]
INFO:root:Epoch 78    loss=1.2164 [101.4 s]	 dev=(HR@5:0.5260,NDCG@5:0.3698) test=(HR@5:0.4634,NDCG@5:0.3164) [27.1 s] 
INFO:root:all_losses: [1.2157564  0.21533215]
INFO:root:Epoch 79    loss=1.2158 [101.2 s]	 dev=(HR@5:0.5207,NDCG@5:0.3682) test=(HR@5:0.4719,NDCG@5:0.3223) [27.0 s] 
INFO:root:all_losses: [1.1942778  0.21105024]
INFO:root:Epoch 80    loss=1.1943 [101.3 s]	 dev=(HR@5:0.5239,NDCG@5:0.3705) test=(HR@5:0.4751,NDCG@5:0.3203) [27.2 s] 
INFO:root:all_losses: [1.1751854 0.2075949]
INFO:root:Epoch 81    loss=1.1752 [101.9 s]	 dev=(HR@5:0.5313,NDCG@5:0.3713) test=(HR@5:0.4793,NDCG@5:0.3247) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.1653903  0.20555271]
INFO:root:Epoch 82    loss=1.1654 [101.4 s]	 dev=(HR@5:0.5292,NDCG@5:0.3735) test=(HR@5:0.4836,NDCG@5:0.3300) [26.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.149641   0.20209712]
INFO:root:Epoch 83    loss=1.1496 [101.4 s]	 dev=(HR@5:0.5355,NDCG@5:0.3761) test=(HR@5:0.4677,NDCG@5:0.3179) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.1334015 0.1991142]
INFO:root:Epoch 84    loss=1.1334 [102.0 s]	 dev=(HR@5:0.5207,NDCG@5:0.3669) test=(HR@5:0.4793,NDCG@5:0.3240) [27.2 s] 
INFO:root:all_losses: [1.1270903  0.19803025]
INFO:root:Epoch 85    loss=1.1271 [101.2 s]	 dev=(HR@5:0.5313,NDCG@5:0.3742) test=(HR@5:0.4740,NDCG@5:0.3216) [27.0 s] 
INFO:root:all_losses: [1.1176924  0.19643854]
INFO:root:Epoch 86    loss=1.1177 [100.6 s]	 dev=(HR@5:0.5366,NDCG@5:0.3774) test=(HR@5:0.4920,NDCG@5:0.3367) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [1.1016103  0.19355656]
INFO:root:Epoch 87    loss=1.1016 [100.8 s]	 dev=(HR@5:0.5292,NDCG@5:0.3766) test=(HR@5:0.4825,NDCG@5:0.3258) [27.2 s] 
INFO:root:all_losses: [1.0915664  0.19073462]
INFO:root:Epoch 88    loss=1.0916 [101.3 s]	 dev=(HR@5:0.5334,NDCG@5:0.3760) test=(HR@5:0.4878,NDCG@5:0.3254) [27.2 s] 
INFO:root:all_losses: [1.077601   0.18860406]
INFO:root:Epoch 89    loss=1.0776 [101.0 s]	 dev=(HR@5:0.5270,NDCG@5:0.3723) test=(HR@5:0.4836,NDCG@5:0.3278) [27.2 s] 
INFO:root:all_losses: [1.0691559  0.18697278]
INFO:root:Epoch 90    loss=1.0692 [100.8 s]	 dev=(HR@5:0.5281,NDCG@5:0.3701) test=(HR@5:0.4719,NDCG@5:0.3208) [27.2 s] 
INFO:root:Early stop at 90 based on dev result.
INFO:root:
Best Iter(dev)=   86	 dev=(HR@5:0.5366,NDCG@5:0.3774) test=(HR@5:0.4920,NDCG@5:0.3367) [11227.2 s] 
INFO:root:Load model from ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=5_num_heads=4.pt
INFO:root:
Test After Training: (HR@10:0.6702,HR@5:0.4920,HR@50:0.9533,NDCG@10:0.3944,NDCG@5:0.3367,NDCG@50:0.4592)
INFO:root:
--------------------------------------------- END: 2025-07-12 00:19:45 ---------------------------------------------
INFO:root:Namespace(model_name='RCF')
INFO:root:--------------------------------------------- BEGIN: 2025-07-12 12:52:26 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gamma           | 10.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.0001       
 message         |              
 metric          | ["NDCG","HR"]
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\KGReader.pkl
INFO:root:#params: 173767
INFO:root:RCF(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.1007,HR@5:0.0530,HR@50:0.5154,NDCG@10:0.0460,NDCG@5:0.0307,NDCG@50:0.1322)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [7.4838    0.6931466]
INFO:root:Epoch 1     loss=7.4838 [73.5 s]	 dev=(HR@5:0.2471,NDCG@5:0.1576) test=(HR@5:0.2153,NDCG@5:0.1442) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.345001  0.6931311]
INFO:root:Epoch 2     loss=7.3450 [73.4 s]	 dev=(HR@5:0.3213,NDCG@5:0.2253) test=(HR@5:0.2969,NDCG@5:0.2030) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.2790976 0.6930617]
INFO:root:Epoch 3     loss=7.2791 [73.7 s]	 dev=(HR@5:0.3648,NDCG@5:0.2554) test=(HR@5:0.3224,NDCG@5:0.2202) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.241661   0.69291884]
INFO:root:Epoch 4     loss=7.2417 [73.5 s]	 dev=(HR@5:0.3902,NDCG@5:0.2729) test=(HR@5:0.3393,NDCG@5:0.2262) [26.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.2137675 0.6927017]
INFO:root:Epoch 5     loss=7.2138 [73.5 s]	 dev=(HR@5:0.4019,NDCG@5:0.2826) test=(HR@5:0.3637,NDCG@5:0.2448) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.1861777  0.69235903]
INFO:root:Epoch 6     loss=7.1862 [72.9 s]	 dev=(HR@5:0.4199,NDCG@5:0.2882) test=(HR@5:0.3712,NDCG@5:0.2497) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.169137  0.6919652]
INFO:root:Epoch 7     loss=7.1691 [73.6 s]	 dev=(HR@5:0.4231,NDCG@5:0.2905) test=(HR@5:0.3659,NDCG@5:0.2490) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.1487103 0.6914166]
INFO:root:Epoch 8     loss=7.1487 [73.5 s]	 dev=(HR@5:0.4221,NDCG@5:0.2878) test=(HR@5:0.3701,NDCG@5:0.2493) [27.0 s] 
INFO:root:all_losses: [7.1321235  0.69066757]
INFO:root:Epoch 9     loss=7.1321 [77.1 s]	 dev=(HR@5:0.4210,NDCG@5:0.2924) test=(HR@5:0.3722,NDCG@5:0.2509) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.1164103 0.6897059]
INFO:root:Epoch 10    loss=7.1164 [89.5 s]	 dev=(HR@5:0.4358,NDCG@5:0.3009) test=(HR@5:0.3807,NDCG@5:0.2584) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.0933228 0.6883524]
INFO:root:Epoch 11    loss=7.0933 [106.9 s]	 dev=(HR@5:0.4284,NDCG@5:0.2985) test=(HR@5:0.3828,NDCG@5:0.2577) [27.0 s] 
INFO:root:all_losses: [7.072336   0.68679905]
INFO:root:Epoch 12    loss=7.0723 [106.0 s]	 dev=(HR@5:0.4401,NDCG@5:0.3061) test=(HR@5:0.3881,NDCG@5:0.2598) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [7.0461197  0.68460256]
INFO:root:Epoch 13    loss=7.0461 [90.9 s]	 dev=(HR@5:0.4390,NDCG@5:0.3022) test=(HR@5:0.4008,NDCG@5:0.2650) [27.0 s] 
INFO:root:all_losses: [7.0144386 0.6818393]
INFO:root:Epoch 14    loss=7.0144 [80.8 s]	 dev=(HR@5:0.4517,NDCG@5:0.3145) test=(HR@5:0.4051,NDCG@5:0.2722) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [6.9770403 0.6782709]
INFO:root:Epoch 15    loss=6.9770 [73.5 s]	 dev=(HR@5:0.4581,NDCG@5:0.3162) test=(HR@5:0.4083,NDCG@5:0.2764) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [6.92716   0.6738824]
INFO:root:Epoch 16    loss=6.9272 [74.0 s]	 dev=(HR@5:0.4539,NDCG@5:0.3185) test=(HR@5:0.4093,NDCG@5:0.2761) [27.1 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [6.870186   0.66846466]
INFO:root:Epoch 17    loss=6.8702 [74.2 s]	 dev=(HR@5:0.4708,NDCG@5:0.3241) test=(HR@5:0.4263,NDCG@5:0.2866) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [6.802781  0.6618741]
INFO:root:Epoch 18    loss=6.8028 [74.7 s]	 dev=(HR@5:0.4698,NDCG@5:0.3266) test=(HR@5:0.4093,NDCG@5:0.2823) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [6.727122   0.65461445]
INFO:root:Epoch 19    loss=6.7271 [76.7 s]	 dev=(HR@5:0.4719,NDCG@5:0.3264) test=(HR@5:0.4242,NDCG@5:0.2877) [27.0 s] 
INFO:root:all_losses: [6.6350536 0.6454791]
INFO:root:Epoch 20    loss=6.6351 [81.9 s]	 dev=(HR@5:0.4645,NDCG@5:0.3192) test=(HR@5:0.4295,NDCG@5:0.2891) [27.1 s] 
INFO:root:all_losses: [6.526443  0.6348599]
INFO:root:Epoch 21    loss=6.5264 [90.9 s]	 dev=(HR@5:0.4602,NDCG@5:0.3201) test=(HR@5:0.4411,NDCG@5:0.2971) [27.1 s] 
INFO:root:all_losses: [6.4184875  0.62425816]
INFO:root:Epoch 22    loss=6.4185 [98.1 s]	 dev=(HR@5:0.4804,NDCG@5:0.3318) test=(HR@5:0.4464,NDCG@5:0.3010) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [6.2876287 0.6111374]
INFO:root:Epoch 23    loss=6.2876 [100.2 s]	 dev=(HR@5:0.4889,NDCG@5:0.3356) test=(HR@5:0.4337,NDCG@5:0.2929) [26.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [6.151476 0.597678]
INFO:root:Epoch 24    loss=6.1515 [100.4 s]	 dev=(HR@5:0.4698,NDCG@5:0.3297) test=(HR@5:0.4305,NDCG@5:0.2978) [27.2 s] 
INFO:root:all_losses: [5.9952116 0.5821961]
INFO:root:Epoch 25    loss=5.9952 [100.8 s]	 dev=(HR@5:0.4719,NDCG@5:0.3292) test=(HR@5:0.4358,NDCG@5:0.2976) [27.3 s] 
INFO:root:all_losses: [5.8507338  0.56769246]
INFO:root:Epoch 26    loss=5.8507 [100.8 s]	 dev=(HR@5:0.4952,NDCG@5:0.3378) test=(HR@5:0.4411,NDCG@5:0.2997) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [5.6853566 0.551464 ]
INFO:root:Epoch 27    loss=5.6854 [100.5 s]	 dev=(HR@5:0.4899,NDCG@5:0.3372) test=(HR@5:0.4528,NDCG@5:0.3033) [27.2 s] 
INFO:root:all_losses: [5.5376625  0.53664124]
INFO:root:Epoch 28    loss=5.5377 [100.9 s]	 dev=(HR@5:0.4910,NDCG@5:0.3390) test=(HR@5:0.4433,NDCG@5:0.2989) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [5.3810368 0.5210148]
INFO:root:Epoch 29    loss=5.3810 [100.8 s]	 dev=(HR@5:0.5005,NDCG@5:0.3422) test=(HR@5:0.4464,NDCG@5:0.3011) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [5.2228627 0.5053323]
INFO:root:Epoch 30    loss=5.2229 [101.2 s]	 dev=(HR@5:0.4751,NDCG@5:0.3308) test=(HR@5:0.4337,NDCG@5:0.2956) [26.9 s] 
INFO:root:all_losses: [5.079806   0.49121884]
INFO:root:Epoch 31    loss=5.0798 [101.2 s]	 dev=(HR@5:0.4889,NDCG@5:0.3390) test=(HR@5:0.4221,NDCG@5:0.2915) [27.3 s] 
INFO:root:all_losses: [4.9454513  0.47762462]
INFO:root:Epoch 32    loss=4.9455 [101.1 s]	 dev=(HR@5:0.4952,NDCG@5:0.3401) test=(HR@5:0.4390,NDCG@5:0.2960) [27.0 s] 
INFO:root:all_losses: [4.8142037 0.4643957]
INFO:root:Epoch 33    loss=4.8142 [101.0 s]	 dev=(HR@5:0.4867,NDCG@5:0.3355) test=(HR@5:0.4348,NDCG@5:0.2916) [27.1 s] 
INFO:root:all_losses: [4.691897  0.4524164]
INFO:root:Epoch 34    loss=4.6919 [101.3 s]	 dev=(HR@5:0.4889,NDCG@5:0.3374) test=(HR@5:0.4348,NDCG@5:0.2972) [27.0 s] 
INFO:root:all_losses: [4.5498624  0.43827096]
INFO:root:Epoch 35    loss=4.5499 [101.0 s]	 dev=(HR@5:0.4867,NDCG@5:0.3337) test=(HR@5:0.4369,NDCG@5:0.2976) [27.1 s] 
INFO:root:all_losses: [4.451354 0.428346]
INFO:root:Epoch 36    loss=4.4514 [101.2 s]	 dev=(HR@5:0.4931,NDCG@5:0.3429) test=(HR@5:0.4464,NDCG@5:0.3016) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [4.347861  0.4182043]
INFO:root:Epoch 37    loss=4.3479 [100.9 s]	 dev=(HR@5:0.4899,NDCG@5:0.3428) test=(HR@5:0.4358,NDCG@5:0.2996) [27.2 s] 
INFO:root:all_losses: [4.2544327  0.40877956]
INFO:root:Epoch 38    loss=4.2544 [101.3 s]	 dev=(HR@5:0.4889,NDCG@5:0.3383) test=(HR@5:0.4443,NDCG@5:0.3000) [27.1 s] 
INFO:root:all_losses: [4.1476994  0.39789325]
INFO:root:Epoch 39    loss=4.1477 [101.0 s]	 dev=(HR@5:0.4931,NDCG@5:0.3412) test=(HR@5:0.4528,NDCG@5:0.3067) [27.2 s] 
INFO:root:all_losses: [4.0609064  0.38963315]
INFO:root:Epoch 40    loss=4.0609 [100.9 s]	 dev=(HR@5:0.4963,NDCG@5:0.3386) test=(HR@5:0.4390,NDCG@5:0.2972) [27.1 s] 
INFO:root:all_losses: [3.970467   0.38046557]
INFO:root:Epoch 41    loss=3.9705 [101.2 s]	 dev=(HR@5:0.4963,NDCG@5:0.3389) test=(HR@5:0.4380,NDCG@5:0.2977) [27.0 s] 
INFO:root:all_losses: [3.8630795  0.36985126]
INFO:root:Epoch 42    loss=3.8631 [101.1 s]	 dev=(HR@5:0.5027,NDCG@5:0.3456) test=(HR@5:0.4401,NDCG@5:0.2990) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.798858   0.36332744]
INFO:root:Epoch 43    loss=3.7989 [101.3 s]	 dev=(HR@5:0.4963,NDCG@5:0.3395) test=(HR@5:0.4517,NDCG@5:0.3043) [27.2 s] 
INFO:root:all_losses: [3.7245672  0.35601848]
INFO:root:Epoch 44    loss=3.7246 [100.9 s]	 dev=(HR@5:0.5005,NDCG@5:0.3453) test=(HR@5:0.4486,NDCG@5:0.3045) [27.0 s] 
INFO:root:all_losses: [3.637604   0.34757915]
INFO:root:Epoch 45    loss=3.6376 [101.6 s]	 dev=(HR@5:0.4899,NDCG@5:0.3389) test=(HR@5:0.4517,NDCG@5:0.3052) [26.9 s] 
INFO:root:all_losses: [3.5409145  0.33783248]
INFO:root:Epoch 46    loss=3.5409 [100.9 s]	 dev=(HR@5:0.4984,NDCG@5:0.3438) test=(HR@5:0.4475,NDCG@5:0.3003) [27.2 s] 
INFO:root:all_losses: [3.4890862  0.33244908]
INFO:root:Epoch 47    loss=3.4891 [101.6 s]	 dev=(HR@5:0.4963,NDCG@5:0.3439) test=(HR@5:0.4496,NDCG@5:0.3029) [27.1 s] 
INFO:root:all_losses: [3.4212003  0.32581705]
INFO:root:Epoch 48    loss=3.4212 [101.1 s]	 dev=(HR@5:0.4867,NDCG@5:0.3332) test=(HR@5:0.4348,NDCG@5:0.2960) [27.1 s] 
INFO:root:all_losses: [3.354777   0.31932336]
INFO:root:Epoch 49    loss=3.3548 [101.5 s]	 dev=(HR@5:0.4942,NDCG@5:0.3429) test=(HR@5:0.4348,NDCG@5:0.2985) [27.0 s] 
INFO:root:all_losses: [3.2743733  0.31117892]
INFO:root:Epoch 50    loss=3.2744 [101.4 s]	 dev=(HR@5:0.5058,NDCG@5:0.3478) test=(HR@5:0.4295,NDCG@5:0.2971) [27.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [3.2102957 0.3048859]
INFO:root:Epoch 51    loss=3.2103 [101.7 s]	 dev=(HR@5:0.5069,NDCG@5:0.3476) test=(HR@5:0.4358,NDCG@5:0.3032) [27.3 s] 
INFO:root:all_losses: [3.1687553 0.3008235]
INFO:root:Epoch 52    loss=3.1688 [101.2 s]	 dev=(HR@5:0.4963,NDCG@5:0.3404) test=(HR@5:0.4496,NDCG@5:0.3019) [27.1 s] 
INFO:root:all_losses: [3.1051836  0.29447025]
INFO:root:Epoch 53    loss=3.1052 [101.3 s]	 dev=(HR@5:0.5016,NDCG@5:0.3452) test=(HR@5:0.4422,NDCG@5:0.2993) [27.1 s] 
INFO:root:all_losses: [3.060374   0.28997874]
INFO:root:Epoch 54    loss=3.0604 [101.1 s]	 dev=(HR@5:0.4995,NDCG@5:0.3447) test=(HR@5:0.4411,NDCG@5:0.2987) [27.1 s] 
INFO:root:all_losses: [3.0006049 0.2844306]
INFO:root:Epoch 55    loss=3.0006 [101.5 s]	 dev=(HR@5:0.4952,NDCG@5:0.3407) test=(HR@5:0.4380,NDCG@5:0.2992) [27.2 s] 
INFO:root:all_losses: [2.9318926 0.2775107]
INFO:root:Epoch 56    loss=2.9319 [101.1 s]	 dev=(HR@5:0.5005,NDCG@5:0.3460) test=(HR@5:0.4507,NDCG@5:0.3066) [27.1 s] 
INFO:root:all_losses: [2.8993776  0.27418023]
INFO:root:Epoch 57    loss=2.8994 [101.2 s]	 dev=(HR@5:0.5069,NDCG@5:0.3458) test=(HR@5:0.4507,NDCG@5:0.3070) [27.0 s] 
INFO:root:all_losses: [2.8222468  0.26647732]
INFO:root:Epoch 58    loss=2.8222 [101.4 s]	 dev=(HR@5:0.4963,NDCG@5:0.3462) test=(HR@5:0.4454,NDCG@5:0.3037) [27.1 s] 
INFO:root:all_losses: [2.7911863  0.26348716]
INFO:root:Epoch 59    loss=2.7912 [101.1 s]	 dev=(HR@5:0.5080,NDCG@5:0.3513) test=(HR@5:0.4496,NDCG@5:0.3074) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.7608192  0.26031932]
INFO:root:Epoch 60    loss=2.7608 [101.6 s]	 dev=(HR@5:0.5037,NDCG@5:0.3483) test=(HR@5:0.4433,NDCG@5:0.2997) [27.0 s] 
INFO:root:all_losses: [2.6971762  0.25420597]
INFO:root:Epoch 61    loss=2.6972 [101.2 s]	 dev=(HR@5:0.5058,NDCG@5:0.3470) test=(HR@5:0.4433,NDCG@5:0.3030) [27.0 s] 
INFO:root:all_losses: [2.648953   0.24906203]
INFO:root:Epoch 62    loss=2.6490 [101.7 s]	 dev=(HR@5:0.5058,NDCG@5:0.3511) test=(HR@5:0.4486,NDCG@5:0.3049) [27.0 s] 
INFO:root:all_losses: [2.595074   0.24402834]
INFO:root:Epoch 63    loss=2.5951 [101.3 s]	 dev=(HR@5:0.5016,NDCG@5:0.3475) test=(HR@5:0.4422,NDCG@5:0.3051) [27.2 s] 
INFO:root:all_losses: [2.5615828 0.2407896]
INFO:root:Epoch 64    loss=2.5616 [101.1 s]	 dev=(HR@5:0.4963,NDCG@5:0.3471) test=(HR@5:0.4401,NDCG@5:0.3003) [27.1 s] 
INFO:root:all_losses: [2.5251698  0.23726049]
INFO:root:Epoch 65    loss=2.5252 [101.3 s]	 dev=(HR@5:0.5048,NDCG@5:0.3475) test=(HR@5:0.4433,NDCG@5:0.3029) [27.2 s] 
INFO:root:all_losses: [2.492614   0.23376025]
INFO:root:Epoch 66    loss=2.4926 [101.8 s]	 dev=(HR@5:0.5037,NDCG@5:0.3514) test=(HR@5:0.4486,NDCG@5:0.3032) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.460641   0.23061332]
INFO:root:Epoch 67    loss=2.4606 [101.6 s]	 dev=(HR@5:0.5069,NDCG@5:0.3518) test=(HR@5:0.4571,NDCG@5:0.3073) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.440599   0.22860503]
INFO:root:Epoch 68    loss=2.4406 [101.4 s]	 dev=(HR@5:0.4963,NDCG@5:0.3424) test=(HR@5:0.4507,NDCG@5:0.3047) [27.2 s] 
INFO:root:all_losses: [2.3610077  0.22084847]
INFO:root:Epoch 69    loss=2.3610 [101.3 s]	 dev=(HR@5:0.5069,NDCG@5:0.3511) test=(HR@5:0.4475,NDCG@5:0.3016) [27.0 s] 
INFO:root:all_losses: [2.3553934  0.22030053]
INFO:root:Epoch 70    loss=2.3554 [101.6 s]	 dev=(HR@5:0.5186,NDCG@5:0.3573) test=(HR@5:0.4443,NDCG@5:0.3041) [27.0 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_n...
INFO:root:all_losses: [2.3054187  0.21555169]
INFO:root:Epoch 71    loss=2.3054 [101.3 s]	 dev=(HR@5:0.5048,NDCG@5:0.3443) test=(HR@5:0.4422,NDCG@5:0.3042) [27.1 s] 
INFO:root:all_losses: [2.2744803  0.21239895]
INFO:root:Epoch 72    loss=2.2745 [101.4 s]	 dev=(HR@5:0.5080,NDCG@5:0.3536) test=(HR@5:0.4475,NDCG@5:0.3035) [27.1 s] 
INFO:root:all_losses: [2.2394369 0.2090905]
INFO:root:Epoch 73    loss=2.2394 [101.6 s]	 dev=(HR@5:0.5048,NDCG@5:0.3476) test=(HR@5:0.4454,NDCG@5:0.3032) [27.1 s] 
INFO:root:all_losses: [2.21211   0.2062262]
INFO:root:Epoch 74    loss=2.2121 [101.5 s]	 dev=(HR@5:0.5090,NDCG@5:0.3538) test=(HR@5:0.4454,NDCG@5:0.3066) [27.1 s] 
INFO:root:all_losses: [2.1945357  0.20455006]
INFO:root:Epoch 75    loss=2.1945 [101.7 s]	 dev=(HR@5:0.5058,NDCG@5:0.3523) test=(HR@5:0.4592,NDCG@5:0.3111) [27.2 s] 
INFO:root:all_losses: [2.1495717  0.20000581]
INFO:root:Epoch 76    loss=2.1496 [101.4 s]	 dev=(HR@5:0.5058,NDCG@5:0.3505) test=(HR@5:0.4517,NDCG@5:0.3018) [27.1 s] 
INFO:root:all_losses: [2.1343398  0.19854781]
INFO:root:Epoch 77    loss=2.1343 [101.8 s]	 dev=(HR@5:0.5069,NDCG@5:0.3504) test=(HR@5:0.4581,NDCG@5:0.3074) [27.0 s] 
INFO:root:all_losses: [2.0931222 0.194625 ]
INFO:root:Epoch 78    loss=2.0931 [101.4 s]	 dev=(HR@5:0.5005,NDCG@5:0.3486) test=(HR@5:0.4464,NDCG@5:0.3027) [27.1 s] 
INFO:root:Early stop at 78 based on dev result.
INFO:root:
Best Iter(dev)=   70	 dev=(HR@5:0.5186,NDCG@5:0.3573) test=(HR@5:0.4443,NDCG@5:0.3041) [9565.3 s] 
INFO:root:Load model from ../model/RCF/RCF_ml-100k_2019_lr=0.0001_l2=1e-06_num_layers=5_num_heads=4.pt
INFO:root:
Test After Training: (HR@10:0.6288,HR@5:0.4443,HR@50:0.9470,NDCG@10:0.3644,NDCG@5:0.3041,NDCG@50:0.4373)
INFO:root:
--------------------------------------------- END: 2025-07-12 15:32:19 ---------------------------------------------
