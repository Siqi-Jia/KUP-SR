INFO:root:Namespace(model_name='RCF')
INFO:root:--------------------------------------------- BEGIN: 2025-02-28 17:12:53 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 attention_size  | 10           
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gamma           | -1.0         
 gpu             | 0            
 history_max     | 20           
 include_attr    | 1            
 include_kge     | 1            
 include_val     | 1            
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 message         |              
 metric          | ["NDCG","HR"]
 neg_head_p      | 0.5          
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 pooling         | average      
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Reading data from "../data/", dataset = "ml-100k" 
INFO:root:Counting dataset statistics...
INFO:root:"# user": 944, "# item": 1350, "# entry": 99287
INFO:root:Appending history info...
INFO:root:Constructing relation triplets...
INFO:root:Item-item relations:[]
INFO:root:Attribute-based relations:['i_year', 'i_Action', 'i_Adventure', 'i_Animation', "i_Children's", 'i_Comedy', 'i_Crime', 'i_Documentary', 'i_Drama', 'i_Fantasy', 'i_Film-Noir', 'i_Horror', 'i_Musical', 'i_Mystery', 'i_Romance', 'i_Sci-Fi', 'i_Thriller', 'i_War', 'i_Western', 'i_Other']
INFO:root:"# relation": 21, "# triplet": 3789
INFO:root:Save corpus to ../data/ml-100k\KGReader.pkl
INFO:root:#params: 173767
INFO:root:RCF(
  (user_embeddings): Embedding(944, 64)
  (entity_embeddings): Embedding(1405, 64)
  (relation_embeddings): Embedding(21, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(21, 64)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(1351, 1)
)
INFO:root:Test Before Training: (HR@10:0.1007,HR@5:0.0530,HR@50:0.5154,NDCG@10:0.0460,NDCG@5:0.0307,NDCG@50:0.1322)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.3542506 0.6924344]
INFO:root:Epoch 1     loss=0.3543 [73.8 s]	 dev=(HR@5:0.4316,NDCG@5:0.2926) test=(HR@5:0.3690,NDCG@5:0.2405) [27.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.2457629 0.688211 ]
INFO:root:Epoch 2     loss=0.2458 [121.1 s]	 dev=(HR@5:0.4496,NDCG@5:0.3055) test=(HR@5:0.3871,NDCG@5:0.2622) [27.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.21937884 0.6821924 ]
INFO:root:Epoch 3     loss=0.2194 [102.6 s]	 dev=(HR@5:0.4942,NDCG@5:0.3408) test=(HR@5:0.4284,NDCG@5:0.2889) [27.4 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.20084931 0.6753973 ]
INFO:root:Epoch 4     loss=0.2008 [89.8 s]	 dev=(HR@5:0.4942,NDCG@5:0.3508) test=(HR@5:0.4348,NDCG@5:0.2970) [29.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.18857847 0.66914374]
INFO:root:Epoch 5     loss=0.1886 [100.4 s]	 dev=(HR@5:0.5090,NDCG@5:0.3509) test=(HR@5:0.4475,NDCG@5:0.3053) [29.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1771537 0.6634265]
INFO:root:Epoch 6     loss=0.1772 [101.4 s]	 dev=(HR@5:0.5154,NDCG@5:0.3617) test=(HR@5:0.4677,NDCG@5:0.3201) [29.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.17261444 0.66002357]
INFO:root:Epoch 7     loss=0.1726 [101.5 s]	 dev=(HR@5:0.5005,NDCG@5:0.3561) test=(HR@5:0.4645,NDCG@5:0.3199) [29.5 s] 
INFO:root:all_losses: [0.16250408 0.65604615]
INFO:root:Epoch 8     loss=0.1625 [101.8 s]	 dev=(HR@5:0.5101,NDCG@5:0.3596) test=(HR@5:0.4963,NDCG@5:0.3341) [30.0 s] 
INFO:root:all_losses: [0.15816703 0.652607  ]
INFO:root:Epoch 9     loss=0.1582 [101.3 s]	 dev=(HR@5:0.5419,NDCG@5:0.3766) test=(HR@5:0.4931,NDCG@5:0.3388) [29.7 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.1559053  0.64921033]
INFO:root:Epoch 10    loss=0.1559 [102.4 s]	 dev=(HR@5:0.5270,NDCG@5:0.3662) test=(HR@5:0.4931,NDCG@5:0.3307) [29.8 s] 
INFO:root:all_losses: [0.14735968 0.6456344 ]
INFO:root:Epoch 11    loss=0.1474 [101.9 s]	 dev=(HR@5:0.5281,NDCG@5:0.3672) test=(HR@5:0.4878,NDCG@5:0.3316) [29.2 s] 
INFO:root:all_losses: [0.14289178 0.64344716]
INFO:root:Epoch 12    loss=0.1429 [102.9 s]	 dev=(HR@5:0.5270,NDCG@5:0.3661) test=(HR@5:0.4910,NDCG@5:0.3393) [30.0 s] 
INFO:root:all_losses: [0.14016499 0.63997155]
INFO:root:Epoch 13    loss=0.1402 [101.9 s]	 dev=(HR@5:0.5376,NDCG@5:0.3760) test=(HR@5:0.4910,NDCG@5:0.3324) [29.5 s] 
INFO:root:all_losses: [0.13730402 0.6377392 ]
INFO:root:Epoch 14    loss=0.1373 [101.8 s]	 dev=(HR@5:0.5217,NDCG@5:0.3686) test=(HR@5:0.4846,NDCG@5:0.3369) [29.6 s] 
INFO:root:all_losses: [0.13354525 0.6343234 ]
INFO:root:Epoch 15    loss=0.1335 [102.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3901) test=(HR@5:0.5027,NDCG@5:0.3462) [29.9 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.13006788 0.63196725]
INFO:root:Epoch 16    loss=0.1301 [101.8 s]	 dev=(HR@5:0.5408,NDCG@5:0.3798) test=(HR@5:0.4963,NDCG@5:0.3423) [29.2 s] 
INFO:root:all_losses: [0.12924173 0.629456  ]
INFO:root:Epoch 17    loss=0.1292 [101.3 s]	 dev=(HR@5:0.5408,NDCG@5:0.3823) test=(HR@5:0.5164,NDCG@5:0.3579) [29.4 s] 
INFO:root:all_losses: [0.12567094 0.6262829 ]
INFO:root:Epoch 18    loss=0.1257 [101.5 s]	 dev=(HR@5:0.5281,NDCG@5:0.3766) test=(HR@5:0.4889,NDCG@5:0.3399) [29.7 s] 
INFO:root:all_losses: [0.12152922 0.6252946 ]
INFO:root:Epoch 19    loss=0.1215 [102.0 s]	 dev=(HR@5:0.5334,NDCG@5:0.3764) test=(HR@5:0.5048,NDCG@5:0.3496) [29.1 s] 
INFO:root:all_losses: [0.12008131 0.62161565]
INFO:root:Epoch 20    loss=0.1201 [101.3 s]	 dev=(HR@5:0.5345,NDCG@5:0.3747) test=(HR@5:0.5186,NDCG@5:0.3625) [29.4 s] 
INFO:root:all_losses: [0.11885656 0.61794114]
INFO:root:Epoch 21    loss=0.1189 [102.1 s]	 dev=(HR@5:0.5546,NDCG@5:0.3835) test=(HR@5:0.5069,NDCG@5:0.3544) [29.2 s] 
INFO:root:all_losses: [0.11496729 0.6163187 ]
INFO:root:Epoch 22    loss=0.1150 [101.2 s]	 dev=(HR@5:0.5546,NDCG@5:0.3903) test=(HR@5:0.5292,NDCG@5:0.3708) [29.6 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.11281823 0.61321735]
INFO:root:Epoch 23    loss=0.1128 [101.9 s]	 dev=(HR@5:0.5355,NDCG@5:0.3853) test=(HR@5:0.5228,NDCG@5:0.3615) [29.3 s] 
INFO:root:all_losses: [0.11221968 0.61093044]
INFO:root:Epoch 24    loss=0.1122 [101.6 s]	 dev=(HR@5:0.5292,NDCG@5:0.3652) test=(HR@5:0.5249,NDCG@5:0.3601) [29.2 s] 
INFO:root:all_losses: [0.10729988 0.6061612 ]
INFO:root:Epoch 25    loss=0.1073 [101.6 s]	 dev=(HR@5:0.5345,NDCG@5:0.3765) test=(HR@5:0.5186,NDCG@5:0.3584) [29.5 s] 
INFO:root:all_losses: [0.10720853 0.60349286]
INFO:root:Epoch 26    loss=0.1072 [101.5 s]	 dev=(HR@5:0.5355,NDCG@5:0.3802) test=(HR@5:0.5069,NDCG@5:0.3459) [29.6 s] 
INFO:root:all_losses: [0.10565595 0.6001496 ]
INFO:root:Epoch 27    loss=0.1057 [101.6 s]	 dev=(HR@5:0.5493,NDCG@5:0.3916) test=(HR@5:0.5451,NDCG@5:0.3796) [29.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.10666013 0.5974032 ]
INFO:root:Epoch 28    loss=0.1067 [101.8 s]	 dev=(HR@5:0.5345,NDCG@5:0.3829) test=(HR@5:0.5069,NDCG@5:0.3530) [29.4 s] 
INFO:root:all_losses: [0.10373811 0.5943707 ]
INFO:root:Epoch 29    loss=0.1037 [101.7 s]	 dev=(HR@5:0.5313,NDCG@5:0.3774) test=(HR@5:0.5058,NDCG@5:0.3532) [29.2 s] 
INFO:root:all_losses: [0.10269511 0.5910011 ]
INFO:root:Epoch 30    loss=0.1027 [101.7 s]	 dev=(HR@5:0.5186,NDCG@5:0.3667) test=(HR@5:0.4963,NDCG@5:0.3478) [29.1 s] 
INFO:root:all_losses: [0.09828236 0.58721274]
INFO:root:Epoch 31    loss=0.0983 [102.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.4022) test=(HR@5:0.5207,NDCG@5:0.3646) [29.3 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.09909021 0.58381265]
INFO:root:Epoch 32    loss=0.0991 [101.0 s]	 dev=(HR@5:0.5440,NDCG@5:0.3869) test=(HR@5:0.5143,NDCG@5:0.3598) [29.1 s] 
INFO:root:all_losses: [0.0989918 0.5799425]
INFO:root:Epoch 33    loss=0.0990 [101.0 s]	 dev=(HR@5:0.5472,NDCG@5:0.3928) test=(HR@5:0.5005,NDCG@5:0.3522) [29.0 s] 
INFO:root:all_losses: [0.09700254 0.5753874 ]
INFO:root:Epoch 34    loss=0.0970 [101.9 s]	 dev=(HR@5:0.5345,NDCG@5:0.3807) test=(HR@5:0.5027,NDCG@5:0.3616) [29.2 s] 
INFO:root:all_losses: [0.0960044 0.5704847]
INFO:root:Epoch 35    loss=0.0960 [100.9 s]	 dev=(HR@5:0.5133,NDCG@5:0.3601) test=(HR@5:0.4645,NDCG@5:0.3284) [29.0 s] 
INFO:root:all_losses: [0.0962027 0.5686839]
INFO:root:Epoch 36    loss=0.0962 [101.8 s]	 dev=(HR@5:0.5525,NDCG@5:0.3924) test=(HR@5:0.5058,NDCG@5:0.3534) [29.1 s] 
INFO:root:all_losses: [0.09257612 0.56427884]
INFO:root:Epoch 37    loss=0.0926 [101.8 s]	 dev=(HR@5:0.5514,NDCG@5:0.3925) test=(HR@5:0.4942,NDCG@5:0.3564) [29.3 s] 
INFO:root:all_losses: [0.09372616 0.5595245 ]
INFO:root:Epoch 38    loss=0.0937 [101.0 s]	 dev=(HR@5:0.5281,NDCG@5:0.3816) test=(HR@5:0.5005,NDCG@5:0.3543) [29.0 s] 
INFO:root:all_losses: [0.0949789 0.5556355]
INFO:root:Epoch 39    loss=0.0950 [101.6 s]	 dev=(HR@5:0.5440,NDCG@5:0.4000) test=(HR@5:0.5228,NDCG@5:0.3694) [29.2 s] 
INFO:root:all_losses: [0.09062876 0.55243874]
INFO:root:Epoch 40    loss=0.0906 [101.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.4069) test=(HR@5:0.5323,NDCG@5:0.3822) [29.2 s] 
INFO:root:Save model to ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_nu...
INFO:root:all_losses: [0.08983127 0.54738086]
INFO:root:Epoch 41    loss=0.0898 [101.5 s]	 dev=(HR@5:0.5249,NDCG@5:0.3751) test=(HR@5:0.5217,NDCG@5:0.3660) [29.2 s] 
INFO:root:all_losses: [0.08923119 0.5431204 ]
INFO:root:Epoch 42    loss=0.0892 [101.1 s]	 dev=(HR@5:0.5493,NDCG@5:0.3963) test=(HR@5:0.5122,NDCG@5:0.3631) [29.1 s] 
INFO:root:all_losses: [0.08829346 0.53930867]
INFO:root:Epoch 43    loss=0.0883 [101.7 s]	 dev=(HR@5:0.5260,NDCG@5:0.3772) test=(HR@5:0.5005,NDCG@5:0.3522) [29.3 s] 
INFO:root:all_losses: [0.08596876 0.53632504]
INFO:root:Epoch 44    loss=0.0860 [100.8 s]	 dev=(HR@5:0.5504,NDCG@5:0.3880) test=(HR@5:0.5175,NDCG@5:0.3644) [29.1 s] 
INFO:root:all_losses: [0.08574196 0.53005534]
INFO:root:Epoch 45    loss=0.0857 [101.6 s]	 dev=(HR@5:0.5419,NDCG@5:0.3852) test=(HR@5:0.5016,NDCG@5:0.3528) [29.3 s] 
INFO:root:all_losses: [0.08439322 0.5250405 ]
INFO:root:Epoch 46    loss=0.0844 [101.3 s]	 dev=(HR@5:0.5387,NDCG@5:0.3756) test=(HR@5:0.5207,NDCG@5:0.3663) [29.0 s] 
INFO:root:all_losses: [0.08520471 0.52116567]
INFO:root:Epoch 47    loss=0.0852 [101.2 s]	 dev=(HR@5:0.5398,NDCG@5:0.3845) test=(HR@5:0.5313,NDCG@5:0.3692) [29.4 s] 
INFO:root:all_losses: [0.08405264 0.51786983]
INFO:root:Epoch 48    loss=0.0841 [101.0 s]	 dev=(HR@5:0.5016,NDCG@5:0.3636) test=(HR@5:0.5058,NDCG@5:0.3551) [29.0 s] 
INFO:root:all_losses: [0.08322409 0.51261574]
INFO:root:Epoch 49    loss=0.0832 [101.3 s]	 dev=(HR@5:0.5408,NDCG@5:0.3885) test=(HR@5:0.5186,NDCG@5:0.3649) [29.1 s] 
INFO:root:all_losses: [0.08198598 0.5068113 ]
INFO:root:Epoch 50    loss=0.0820 [101.2 s]	 dev=(HR@5:0.5408,NDCG@5:0.3837) test=(HR@5:0.5164,NDCG@5:0.3653) [29.4 s] 
INFO:root:all_losses: [0.08198039 0.50330585]
INFO:root:Epoch 51    loss=0.0820 [101.2 s]	 dev=(HR@5:0.5578,NDCG@5:0.3965) test=(HR@5:0.5090,NDCG@5:0.3593) [29.2 s] 
INFO:root:all_losses: [0.08069666 0.5010339 ]
INFO:root:Epoch 52    loss=0.0807 [101.6 s]	 dev=(HR@5:0.5642,NDCG@5:0.3965) test=(HR@5:0.5196,NDCG@5:0.3685) [29.1 s] 
INFO:root:all_losses: [0.08044037 0.49751455]
INFO:root:Epoch 53    loss=0.0804 [100.4 s]	 dev=(HR@5:0.5451,NDCG@5:0.3928) test=(HR@5:0.5175,NDCG@5:0.3688) [29.3 s] 
INFO:root:all_losses: [0.08055072 0.49249926]
INFO:root:Epoch 54    loss=0.0806 [101.5 s]	 dev=(HR@5:0.5514,NDCG@5:0.3931) test=(HR@5:0.5217,NDCG@5:0.3659) [28.9 s] 
INFO:root:all_losses: [0.07810396 0.48648998]
INFO:root:Epoch 55    loss=0.0781 [101.1 s]	 dev=(HR@5:0.5504,NDCG@5:0.3900) test=(HR@5:0.5186,NDCG@5:0.3617) [29.0 s] 
INFO:root:all_losses: [0.07681239 0.48237404]
INFO:root:Epoch 56    loss=0.0768 [100.7 s]	 dev=(HR@5:0.5472,NDCG@5:0.3907) test=(HR@5:0.5217,NDCG@5:0.3727) [29.0 s] 
INFO:root:all_losses: [0.07697979 0.47906253]
INFO:root:Epoch 57    loss=0.0770 [100.8 s]	 dev=(HR@5:0.5536,NDCG@5:0.3928) test=(HR@5:0.5292,NDCG@5:0.3763) [29.0 s] 
INFO:root:all_losses: [0.07597758 0.47450292]
INFO:root:Epoch 58    loss=0.0760 [101.0 s]	 dev=(HR@5:0.5599,NDCG@5:0.4021) test=(HR@5:0.5101,NDCG@5:0.3630) [29.2 s] 
INFO:root:all_losses: [0.07509748 0.46972415]
INFO:root:Epoch 59    loss=0.0751 [100.9 s]	 dev=(HR@5:0.5514,NDCG@5:0.3944) test=(HR@5:0.5101,NDCG@5:0.3686) [28.9 s] 
INFO:root:all_losses: [0.07497919 0.46846393]
INFO:root:Epoch 60    loss=0.0750 [101.7 s]	 dev=(HR@5:0.5546,NDCG@5:0.3992) test=(HR@5:0.5080,NDCG@5:0.3605) [28.8 s] 
INFO:root:Early stop at 60 based on dev result.
INFO:root:
Best Iter(dev)=   40	 dev=(HR@5:0.5695,NDCG@5:0.4069) test=(HR@5:0.5323,NDCG@5:0.3822) [7821.2 s] 
INFO:root:Load model from ../model/RCF/RCF_ml-100k_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4.pt
INFO:root:
Test After Training: (HR@10:0.6872,HR@5:0.5323,HR@50:0.9438,NDCG@10:0.4323,NDCG@5:0.3822,NDCG@50:0.4910)
INFO:root:
--------------------------------------------- END: 2025-02-28 19:23:45 ---------------------------------------------
