INFO:root:Namespace(model_name='KDAPlus')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 10:30:05 ---------------------------------------------
INFO:root:
=====================================
 Arguments           | Values        
=====================================
 alpha               | 0.1          
 attention_size      | 10           
 batch_size          | 256          
 buffer              | 1            
 dataset             | Office       
 dropout             | 0            
 early_stop          | 5            
 emb_size            | 64           
 epoch               | 200          
 eval_batch_size     | 256          
 freq_rand           | 1            
 gamma               | -1.0         
 gpu                 | 0            
 history_max         | 20           
 include_attr        | 1            
 include_kge         | 1            
 include_lrd         | 1            
 include_val         | 1            
 l2                  | 1e-06        
 lamda               | 10           
 latent_relation_num | 8            
 leave_one_latent    | 1            
 load                | 0            
 lr                  | 0.001        
 message             |              
 metric              | ["NDCG","HR"]
 n_dft               | 64           
 neg_head_p          | 0.5          
 num_heads           | 4            
 num_layers          | 5            
 num_neg             | 1            
 num_workers         | 5            
 only_predict        | 0            
 optimizer           | Adam         
 plm_name            | feat.GPT     
 plm_size            | 1536         
 pooling             | average      
 random_seed         | 2019         
 t_scalar            | 60           
 topk                | [5,10,50]    
=====================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Reading data from "../data/", dataset = "Office" 
INFO:root:Counting dataset statistics...
INFO:root:"# user": 4906, "# item": 2421, "# entry": 53258
INFO:root:Appending history info...
INFO:root:Constructing relation triplets...
INFO:root:Item-item relations:['r_complement', 'r_substitute']
INFO:root:Attribute-based relations:['i_category', 'i_brand']
INFO:root:"# relation": 13, "# triplet": 60706
INFO:root:Save corpus to ../data/Office\DFTReader_8.pkl
INFO:root:#params: 4336925
INFO:root:KDAPlus(
  (user_embeddings): Embedding(4906, 64)
  (item_embeddings): Embedding(2421, 1536, padding_idx=0)
  (project_layer_1): Linear(in_features=1536, out_features=64, bias=True)
  (project_layer_2): Linear(in_features=128, out_features=13, bias=True)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(13, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(13, 64)
    (freq_real): Embedding(13, 33)
    (freq_imag): Embedding(13, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0889,HR@5:0.0389,HR@50:0.5148,NDCG@10:0.0377,NDCG@5:0.0218,NDCG@50:0.1283)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [8.246949  0.6951763 0.6931283]
INFO:root:Namespace(model_name='KDAPlus')
INFO:root:--------------------------------------------- BEGIN: 2024-12-31 20:42:59 ---------------------------------------------
INFO:root:
=====================================
 Arguments           | Values        
=====================================
 alpha               | 0.1          
 attention_size      | 10           
 batch_size          | 256          
 buffer              | 1            
 dataset             | Office       
 dropout             | 0            
 early_stop          | 5            
 emb_size            | 64           
 epoch               | 200          
 eval_batch_size     | 256          
 freq_rand           | 1            
 gamma               | -1.0         
 gpu                 | 0            
 history_max         | 20           
 include_attr        | 1            
 include_kge         | 1            
 include_lrd         | 1            
 include_val         | 1            
 l2                  | 1e-06        
 lamda               | 10           
 latent_relation_num | 8            
 leave_one_latent    | 1            
 load                | 0            
 lr                  | 0.001        
 message             |              
 metric              | ["NDCG","HR"]
 n_dft               | 64           
 neg_head_p          | 0.5          
 num_heads           | 4            
 num_layers          | 5            
 num_neg             | 1            
 num_workers         | 5            
 only_predict        | 0            
 optimizer           | Adam         
 plm_name            | feat.GPT     
 plm_size            | 1536         
 pooling             | average      
 random_seed         | 2019         
 t_scalar            | 60           
 topk                | [5,10,50]    
=====================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader_8.pkl
INFO:root:#params: 4336925
INFO:root:KDAPlus(
  (user_embeddings): Embedding(4906, 64)
  (item_embeddings): Embedding(2421, 1536, padding_idx=0)
  (project_layer_1): Linear(in_features=1536, out_features=64, bias=True)
  (project_layer_2): Linear(in_features=128, out_features=13, bias=True)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(13, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(13, 64)
    (freq_real): Embedding(13, 33)
    (freq_imag): Embedding(13, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0895,HR@5:0.0387,HR@50:0.5146,NDCG@10:0.0378,NDCG@5:0.0217,NDCG@50:0.1282)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [8.246826   0.69518006 0.69312835]
INFO:root:Epoch 1     loss=8.2468 [57.7 s]	 dev=(HR@5:0.1013,NDCG@5:0.0588) test=(HR@5:0.0632,NDCG@5:0.0364) [145.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.9826093 0.674856  0.6928994]
INFO:root:Epoch 2     loss=7.9826 [54.3 s]	 dev=(HR@5:0.1719,NDCG@5:0.1055) test=(HR@5:0.1346,NDCG@5:0.0844) [146.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.8342485  0.66677684 0.6914378 ]
INFO:root:Epoch 3     loss=7.8342 [57.1 s]	 dev=(HR@5:0.2512,NDCG@5:0.1585) test=(HR@5:0.1878,NDCG@5:0.1167) [143.0 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.7460065  0.663516   0.68774605]
INFO:root:Epoch 4     loss=7.7460 [53.3 s]	 dev=(HR@5:0.2995,NDCG@5:0.1913) test=(HR@5:0.2279,NDCG@5:0.1483) [141.8 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.695581   0.6623915  0.67874104]
INFO:root:Epoch 5     loss=7.6956 [51.8 s]	 dev=(HR@5:0.3264,NDCG@5:0.2055) test=(HR@5:0.2434,NDCG@5:0.1556) [141.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.6395464  0.66176075 0.65710634]
INFO:root:Epoch 6     loss=7.6395 [51.9 s]	 dev=(HR@5:0.3399,NDCG@5:0.2165) test=(HR@5:0.2552,NDCG@5:0.1668) [141.5 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.5650597  0.6611251  0.61410534]
INFO:root:Epoch 7     loss=7.5651 [51.7 s]	 dev=(HR@5:0.3741,NDCG@5:0.2426) test=(HR@5:0.2885,NDCG@5:0.1891) [141.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.4901285 0.6611224 0.5577073]
INFO:root:Epoch 8     loss=7.4901 [51.9 s]	 dev=(HR@5:0.3878,NDCG@5:0.2557) test=(HR@5:0.3091,NDCG@5:0.2045) [141.5 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.4019322  0.66032875 0.5008406 ]
INFO:root:Epoch 9     loss=7.4019 [55.2 s]	 dev=(HR@5:0.3900,NDCG@5:0.2560) test=(HR@5:0.3074,NDCG@5:0.2021) [141.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.3282804  0.65997225 0.44421917]
INFO:root:Epoch 10    loss=7.3283 [60.0 s]	 dev=(HR@5:0.3800,NDCG@5:0.2477) test=(HR@5:0.2879,NDCG@5:0.1876) [176.2 s] 
INFO:root:all_losses: [7.252589   0.6598377  0.38722876]
INFO:root:Epoch 11    loss=7.2526 [62.3 s]	 dev=(HR@5:0.4020,NDCG@5:0.2657) test=(HR@5:0.3178,NDCG@5:0.2068) [176.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.1853447  0.6596219  0.33690068]
INFO:root:Epoch 12    loss=7.1853 [62.6 s]	 dev=(HR@5:0.4204,NDCG@5:0.2792) test=(HR@5:0.3333,NDCG@5:0.2194) [177.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.129856   0.6595469  0.29841855]
INFO:root:Epoch 13    loss=7.1299 [62.5 s]	 dev=(HR@5:0.4222,NDCG@5:0.2779) test=(HR@5:0.3382,NDCG@5:0.2199) [176.9 s] 
INFO:root:all_losses: [7.083079   0.6590193  0.26886952]
INFO:root:Epoch 14    loss=7.0831 [62.6 s]	 dev=(HR@5:0.4177,NDCG@5:0.2840) test=(HR@5:0.3386,NDCG@5:0.2263) [175.9 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.0464773  0.6591371  0.23957123]
INFO:root:Epoch 15    loss=7.0465 [62.5 s]	 dev=(HR@5:0.4255,NDCG@5:0.2852) test=(HR@5:0.3354,NDCG@5:0.2238) [176.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.0161676  0.65866345 0.22265595]
INFO:root:Epoch 16    loss=7.0162 [62.6 s]	 dev=(HR@5:0.4359,NDCG@5:0.2916) test=(HR@5:0.3507,NDCG@5:0.2319) [175.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.9896903  0.6585923  0.20684247]
INFO:root:Epoch 17    loss=6.9897 [62.4 s]	 dev=(HR@5:0.4300,NDCG@5:0.2950) test=(HR@5:0.3521,NDCG@5:0.2387) [175.7 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.963694   0.6585409  0.18971361]
INFO:root:Epoch 18    loss=6.9637 [62.5 s]	 dev=(HR@5:0.4357,NDCG@5:0.2998) test=(HR@5:0.3633,NDCG@5:0.2457) [175.7 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.9468904  0.6583766  0.18059725]
INFO:root:Epoch 19    loss=6.9469 [62.6 s]	 dev=(HR@5:0.4504,NDCG@5:0.3034) test=(HR@5:0.3684,NDCG@5:0.2455) [176.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.9281983  0.65850925 0.16549912]
INFO:root:Epoch 20    loss=6.9282 [62.5 s]	 dev=(HR@5:0.4506,NDCG@5:0.3078) test=(HR@5:0.3796,NDCG@5:0.2555) [176.9 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.905885   0.6577467  0.15532619]
INFO:root:Epoch 21    loss=6.9059 [62.4 s]	 dev=(HR@5:0.4412,NDCG@5:0.2994) test=(HR@5:0.3678,NDCG@5:0.2486) [177.0 s] 
INFO:root:all_losses: [6.8945837  0.6579305  0.14919256]
INFO:root:Epoch 22    loss=6.8946 [62.6 s]	 dev=(HR@5:0.4709,NDCG@5:0.3243) test=(HR@5:0.4004,NDCG@5:0.2703) [177.0 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.8828115  0.6579198  0.14059535]
INFO:root:Epoch 23    loss=6.8828 [62.6 s]	 dev=(HR@5:0.4648,NDCG@5:0.3205) test=(HR@5:0.3843,NDCG@5:0.2631) [176.0 s] 
INFO:root:all_losses: [6.8651958  0.65758806 0.1307221 ]
INFO:root:Epoch 24    loss=6.8652 [62.4 s]	 dev=(HR@5:0.4665,NDCG@5:0.3214) test=(HR@5:0.3876,NDCG@5:0.2642) [176.0 s] 
INFO:root:all_losses: [6.857745   0.65784216 0.12457086]
INFO:root:Epoch 25    loss=6.8577 [62.5 s]	 dev=(HR@5:0.4732,NDCG@5:0.3271) test=(HR@5:0.4077,NDCG@5:0.2771) [175.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.844159   0.6574739  0.12090602]
INFO:root:Epoch 26    loss=6.8442 [62.7 s]	 dev=(HR@5:0.4793,NDCG@5:0.3317) test=(HR@5:0.4027,NDCG@5:0.2750) [176.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.8417954  0.657386   0.11896459]
INFO:root:Epoch 27    loss=6.8418 [62.7 s]	 dev=(HR@5:0.4720,NDCG@5:0.3269) test=(HR@5:0.4157,NDCG@5:0.2844) [175.0 s] 
INFO:root:all_losses: [6.8280015  0.65731454 0.11153157]
INFO:root:Epoch 28    loss=6.8280 [62.5 s]	 dev=(HR@5:0.4734,NDCG@5:0.3272) test=(HR@5:0.3910,NDCG@5:0.2699) [175.8 s] 
INFO:root:all_losses: [6.821082   0.65702754 0.10838496]
INFO:root:Epoch 29    loss=6.8211 [62.8 s]	 dev=(HR@5:0.4663,NDCG@5:0.3251) test=(HR@5:0.3902,NDCG@5:0.2668) [175.3 s] 
INFO:root:all_losses: [6.80715    0.6567396  0.10608999]
INFO:root:Epoch 30    loss=6.8071 [62.5 s]	 dev=(HR@5:0.4922,NDCG@5:0.3391) test=(HR@5:0.4151,NDCG@5:0.2828) [174.9 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.802973  0.6565053 0.1034809]
INFO:root:Epoch 31    loss=6.8030 [62.7 s]	 dev=(HR@5:0.4936,NDCG@5:0.3429) test=(HR@5:0.4273,NDCG@5:0.2885) [175.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7965612  0.6565709  0.09950596]
INFO:root:Epoch 32    loss=6.7966 [62.3 s]	 dev=(HR@5:0.4726,NDCG@5:0.3316) test=(HR@5:0.4022,NDCG@5:0.2761) [176.3 s] 
INFO:root:all_losses: [6.7918377  0.65650237 0.09908587]
INFO:root:Epoch 33    loss=6.7918 [62.5 s]	 dev=(HR@5:0.4879,NDCG@5:0.3459) test=(HR@5:0.4224,NDCG@5:0.2857) [175.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7844515  0.65626585 0.09667888]
INFO:root:Epoch 34    loss=6.7845 [62.5 s]	 dev=(HR@5:0.4740,NDCG@5:0.3273) test=(HR@5:0.3870,NDCG@5:0.2647) [175.2 s] 
INFO:root:all_losses: [6.7827077  0.6563778  0.09652267]
INFO:root:Epoch 35    loss=6.7827 [62.5 s]	 dev=(HR@5:0.4612,NDCG@5:0.3211) test=(HR@5:0.3847,NDCG@5:0.2656) [175.7 s] 
INFO:root:all_losses: [6.7735877  0.65593773 0.08998199]
INFO:root:Epoch 36    loss=6.7736 [62.3 s]	 dev=(HR@5:0.4822,NDCG@5:0.3407) test=(HR@5:0.4214,NDCG@5:0.2871) [174.1 s] 
INFO:root:all_losses: [6.7697716  0.655837   0.08971719]
INFO:root:Epoch 37    loss=6.7698 [62.4 s]	 dev=(HR@5:0.4891,NDCG@5:0.3429) test=(HR@5:0.4338,NDCG@5:0.2935) [174.9 s] 
INFO:root:all_losses: [6.7587943  0.6557232  0.08754537]
INFO:root:Epoch 38    loss=6.7588 [62.4 s]	 dev=(HR@5:0.4924,NDCG@5:0.3464) test=(HR@5:0.4318,NDCG@5:0.2938) [175.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7580867  0.6556245  0.08441886]
INFO:root:Epoch 39    loss=6.7581 [62.5 s]	 dev=(HR@5:0.4752,NDCG@5:0.3331) test=(HR@5:0.4192,NDCG@5:0.2877) [174.8 s] 
INFO:root:all_losses: [6.7538004  0.6555478  0.08303578]
INFO:root:Epoch 40    loss=6.7538 [62.3 s]	 dev=(HR@5:0.4842,NDCG@5:0.3395) test=(HR@5:0.4245,NDCG@5:0.2894) [173.5 s] 
INFO:root:all_losses: [6.749309   0.65537274 0.08288208]
INFO:root:Epoch 41    loss=6.7493 [62.3 s]	 dev=(HR@5:0.4724,NDCG@5:0.3330) test=(HR@5:0.4037,NDCG@5:0.2767) [174.6 s] 
INFO:root:all_losses: [6.7474504  0.6552198  0.08359766]
INFO:root:Epoch 42    loss=6.7474 [62.2 s]	 dev=(HR@5:0.4765,NDCG@5:0.3362) test=(HR@5:0.4055,NDCG@5:0.2788) [173.4 s] 
INFO:root:all_losses: [6.7398024  0.65503347 0.0798808 ]
INFO:root:Epoch 43    loss=6.7398 [62.3 s]	 dev=(HR@5:0.4862,NDCG@5:0.3446) test=(HR@5:0.4310,NDCG@5:0.2938) [174.1 s] 
INFO:root:all_losses: [6.7374578  0.65495986 0.08127349]
INFO:root:Epoch 44    loss=6.7375 [62.2 s]	 dev=(HR@5:0.4846,NDCG@5:0.3430) test=(HR@5:0.4098,NDCG@5:0.2818) [174.2 s] 
INFO:root:all_losses: [6.7297344  0.6547406  0.07656908]
INFO:root:Epoch 45    loss=6.7297 [62.3 s]	 dev=(HR@5:0.4754,NDCG@5:0.3351) test=(HR@5:0.4024,NDCG@5:0.2778) [173.6 s] 
INFO:root:all_losses: [6.722762   0.65454865 0.07639779]
INFO:root:Epoch 46    loss=6.7228 [62.3 s]	 dev=(HR@5:0.4703,NDCG@5:0.3298) test=(HR@5:0.4022,NDCG@5:0.2750) [173.8 s] 
INFO:root:all_losses: [6.719098   0.6544344  0.07482744]
INFO:root:Epoch 47    loss=6.7191 [62.3 s]	 dev=(HR@5:0.4968,NDCG@5:0.3515) test=(HR@5:0.4373,NDCG@5:0.2990) [173.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7224064  0.6543625  0.07685301]
INFO:root:Epoch 48    loss=6.7224 [62.3 s]	 dev=(HR@5:0.5046,NDCG@5:0.3550) test=(HR@5:0.4493,NDCG@5:0.3074) [174.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7145653  0.6539261  0.07539909]
INFO:root:Epoch 49    loss=6.7146 [62.4 s]	 dev=(HR@5:0.4858,NDCG@5:0.3425) test=(HR@5:0.4077,NDCG@5:0.2807) [173.5 s] 
INFO:root:all_losses: [6.7133684  0.65389323 0.07519715]
INFO:root:Epoch 50    loss=6.7134 [62.4 s]	 dev=(HR@5:0.5056,NDCG@5:0.3581) test=(HR@5:0.4340,NDCG@5:0.2963) [173.8 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7021112  0.65370554 0.07067048]
INFO:root:Epoch 51    loss=6.7021 [62.5 s]	 dev=(HR@5:0.5093,NDCG@5:0.3594) test=(HR@5:0.4510,NDCG@5:0.3123) [174.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.704263   0.6535763  0.07144956]
INFO:root:Epoch 52    loss=6.7043 [62.5 s]	 dev=(HR@5:0.4950,NDCG@5:0.3536) test=(HR@5:0.4444,NDCG@5:0.3055) [174.5 s] 
INFO:root:all_losses: [6.6977572  0.65325755 0.07157537]
INFO:root:Epoch 53    loss=6.6978 [62.6 s]	 dev=(HR@5:0.4909,NDCG@5:0.3503) test=(HR@5:0.4104,NDCG@5:0.2842) [173.7 s] 
INFO:root:all_losses: [6.6939473  0.65328515 0.07068714]
INFO:root:Epoch 54    loss=6.6939 [62.5 s]	 dev=(HR@5:0.4991,NDCG@5:0.3508) test=(HR@5:0.4285,NDCG@5:0.2954) [173.9 s] 
INFO:root:all_losses: [6.6890635  0.6529031  0.07054572]
INFO:root:Epoch 55    loss=6.6891 [62.5 s]	 dev=(HR@5:0.4844,NDCG@5:0.3415) test=(HR@5:0.4285,NDCG@5:0.2939) [173.7 s] 
INFO:root:all_losses: [6.68561    0.65284    0.06769951]
INFO:root:Epoch 56    loss=6.6856 [62.6 s]	 dev=(HR@5:0.5048,NDCG@5:0.3569) test=(HR@5:0.4497,NDCG@5:0.3103) [174.0 s] 
INFO:root:all_losses: [6.6864705  0.6526453  0.06889957]
INFO:root:Epoch 57    loss=6.6865 [62.5 s]	 dev=(HR@5:0.4571,NDCG@5:0.3246) test=(HR@5:0.4051,NDCG@5:0.2774) [173.4 s] 
INFO:root:all_losses: [6.6832576  0.65248686 0.06791825]
INFO:root:Epoch 58    loss=6.6833 [62.5 s]	 dev=(HR@5:0.4966,NDCG@5:0.3546) test=(HR@5:0.4467,NDCG@5:0.3050) [173.6 s] 
INFO:root:all_losses: [6.6748915  0.65245736 0.06632791]
INFO:root:Epoch 59    loss=6.6749 [62.4 s]	 dev=(HR@5:0.4791,NDCG@5:0.3418) test=(HR@5:0.4210,NDCG@5:0.2911) [173.6 s] 
INFO:root:all_losses: [6.675282   0.65242356 0.06646193]
INFO:root:Epoch 60    loss=6.6753 [62.6 s]	 dev=(HR@5:0.4919,NDCG@5:0.3474) test=(HR@5:0.4332,NDCG@5:0.2976) [174.5 s] 
INFO:root:all_losses: [6.6698794  0.6521013  0.06629568]
INFO:root:Epoch 61    loss=6.6699 [62.4 s]	 dev=(HR@5:0.4858,NDCG@5:0.3462) test=(HR@5:0.4290,NDCG@5:0.2993) [174.4 s] 
INFO:root:all_losses: [6.667342   0.6518873  0.06382971]
INFO:root:Epoch 62    loss=6.6673 [62.6 s]	 dev=(HR@5:0.4805,NDCG@5:0.3394) test=(HR@5:0.4145,NDCG@5:0.2841) [174.4 s] 
INFO:root:all_losses: [6.6615057  0.65162647 0.06395282]
INFO:root:Epoch 63    loss=6.6615 [62.5 s]	 dev=(HR@5:0.4907,NDCG@5:0.3463) test=(HR@5:0.4275,NDCG@5:0.2920) [173.8 s] 
INFO:root:all_losses: [6.6673245  0.6516776  0.06529155]
INFO:root:Epoch 64    loss=6.6673 [62.6 s]	 dev=(HR@5:0.4903,NDCG@5:0.3496) test=(HR@5:0.4192,NDCG@5:0.2892) [173.9 s] 
INFO:root:all_losses: [6.662811   0.65160394 0.06236592]
INFO:root:Epoch 65    loss=6.6628 [62.4 s]	 dev=(HR@5:0.4803,NDCG@5:0.3412) test=(HR@5:0.4149,NDCG@5:0.2850) [173.9 s] 
INFO:root:all_losses: [6.6568904  0.6514307  0.06306688]
INFO:root:Epoch 66    loss=6.6569 [62.6 s]	 dev=(HR@5:0.4922,NDCG@5:0.3528) test=(HR@5:0.4226,NDCG@5:0.2900) [174.2 s] 
INFO:root:all_losses: [6.654015   0.6511975  0.06136668]
INFO:root:Epoch 67    loss=6.6540 [62.6 s]	 dev=(HR@5:0.4738,NDCG@5:0.3365) test=(HR@5:0.3978,NDCG@5:0.2756) [173.5 s] 
INFO:root:all_losses: [6.6604214  0.651265   0.06432996]
INFO:root:Epoch 68    loss=6.6604 [62.5 s]	 dev=(HR@5:0.4730,NDCG@5:0.3343) test=(HR@5:0.4151,NDCG@5:0.2853) [173.3 s] 
INFO:root:all_losses: [6.6552324  0.65134996 0.06414229]
INFO:root:Epoch 69    loss=6.6552 [62.4 s]	 dev=(HR@5:0.4934,NDCG@5:0.3510) test=(HR@5:0.4285,NDCG@5:0.2958) [173.4 s] 
INFO:root:all_losses: [6.6495695  0.6509866  0.06110323]
INFO:root:Epoch 70    loss=6.6496 [62.7 s]	 dev=(HR@5:0.4720,NDCG@5:0.3334) test=(HR@5:0.4002,NDCG@5:0.2784) [173.9 s] 
INFO:root:all_losses: [6.64868    0.65102273 0.05994796]
INFO:root:Epoch 71    loss=6.6487 [62.5 s]	 dev=(HR@5:0.4807,NDCG@5:0.3440) test=(HR@5:0.4175,NDCG@5:0.2886) [173.8 s] 
INFO:root:Early stop at 71 based on dev result.
INFO:root:
Best Iter(dev)=   51	 dev=(HR@5:0.5093,NDCG@5:0.3594) test=(HR@5:0.4510,NDCG@5:0.3123) [16477.3 s] 
INFO:root:Load model from ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_freq_rand=1_alpha=0.1_lamda=10_latent_relation_num=8_leave_one_latent=1_include_lrd=1_message=.pt
INFO:root:
Test After Training: (HR@10:0.6122,HR@5:0.4512,HR@50:0.9013,NDCG@10:0.3643,NDCG@5:0.3124,NDCG@50:0.4290)
INFO:root:
--------------------------------------------- END: 2025-01-01 01:20:37 ---------------------------------------------
INFO:root:Namespace(model_name='KDAPlus')
INFO:root:--------------------------------------------- BEGIN: 2025-01-01 10:24:31 ---------------------------------------------
INFO:root:
=====================================
 Arguments           | Values        
=====================================
 alpha               | 0.1          
 attention_size      | 10           
 batch_size          | 256          
 buffer              | 1            
 dataset             | Office       
 dropout             | 0            
 early_stop          | 5            
 emb_size            | 64           
 epoch               | 200          
 eval_batch_size     | 256          
 freq_rand           | 1            
 gamma               | -1.0         
 gpu                 | 0            
 history_max         | 20           
 include_attr        | 1            
 include_kge         | 1            
 include_lrd         | 1            
 include_val         | 1            
 l2                  | 1e-06        
 lamda               | 10           
 latent_relation_num | 8            
 leave_one_latent    | 1            
 load                | 0            
 lr                  | 0.001        
 message             |              
 metric              | ["NDCG","HR"]
 n_dft               | 64           
 neg_head_p          | 0.5          
 num_heads           | 4            
 num_layers          | 5            
 num_neg             | 1            
 num_workers         | 5            
 only_predict        | 0            
 optimizer           | Adam         
 plm_name            | feat.GPT     
 plm_size            | 1536         
 pooling             | average      
 random_seed         | 2019         
 t_scalar            | 60           
 topk                | [5,10,50]    
=====================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader_8.pkl
INFO:root:#params: 4336925
INFO:root:KDAPlus(
  (user_embeddings): Embedding(4906, 64)
  (item_embeddings): Embedding(2421, 1536, padding_idx=0)
  (project_layer_1): Linear(in_features=1536, out_features=64, bias=True)
  (project_layer_2): Linear(in_features=128, out_features=13, bias=True)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(13, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(13, 64)
    (freq_real): Embedding(13, 33)
    (freq_imag): Embedding(13, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0889,HR@5:0.0389,HR@50:0.5148,NDCG@10:0.0377,NDCG@5:0.0218,NDCG@50:0.1283)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [8.246949  0.6951763 0.6931283]
INFO:root:Epoch 1     loss=8.2469 [35.9 s]	 dev=(HR@5:0.1007,NDCG@5:0.0584) test=(HR@5:0.0618,NDCG@5:0.0358) [72.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.984068   0.67484343 0.6929008 ]
INFO:root:Epoch 2     loss=7.9841 [35.3 s]	 dev=(HR@5:0.1350,NDCG@5:0.0811) test=(HR@5:0.0993,NDCG@5:0.0595) [73.0 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.8411274  0.66672325 0.6915962 ]
INFO:root:Epoch 3     loss=7.8411 [37.8 s]	 dev=(HR@5:0.2457,NDCG@5:0.1517) test=(HR@5:0.1817,NDCG@5:0.1104) [73.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.7454495 0.6635558 0.6881503]
INFO:root:Epoch 4     loss=7.7454 [37.7 s]	 dev=(HR@5:0.2993,NDCG@5:0.1897) test=(HR@5:0.2287,NDCG@5:0.1492) [73.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.68915   0.6624439 0.6794539]
INFO:root:Epoch 5     loss=7.6891 [36.7 s]	 dev=(HR@5:0.3286,NDCG@5:0.2109) test=(HR@5:0.2449,NDCG@5:0.1609) [72.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.631005   0.66176337 0.6588613 ]
INFO:root:Epoch 6     loss=7.6310 [35.3 s]	 dev=(HR@5:0.3635,NDCG@5:0.2318) test=(HR@5:0.2701,NDCG@5:0.1758) [72.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.560951   0.66113883 0.61934876]
INFO:root:Epoch 7     loss=7.5610 [35.4 s]	 dev=(HR@5:0.3625,NDCG@5:0.2369) test=(HR@5:0.2699,NDCG@5:0.1776) [72.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.4856715  0.6611383  0.56603456]
INFO:root:Epoch 8     loss=7.4857 [35.5 s]	 dev=(HR@5:0.3782,NDCG@5:0.2476) test=(HR@5:0.2889,NDCG@5:0.1911) [72.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.4004025  0.6603462  0.51081556]
INFO:root:Epoch 9     loss=7.4004 [38.9 s]	 dev=(HR@5:0.3880,NDCG@5:0.2548) test=(HR@5:0.3095,NDCG@5:0.2010) [72.9 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.3271728  0.65995485 0.45640194]
INFO:root:Epoch 10    loss=7.3272 [42.7 s]	 dev=(HR@5:0.3961,NDCG@5:0.2603) test=(HR@5:0.3121,NDCG@5:0.2047) [91.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.2474957  0.659769   0.39896342]
INFO:root:Epoch 11    loss=7.2475 [44.1 s]	 dev=(HR@5:0.4161,NDCG@5:0.2770) test=(HR@5:0.3313,NDCG@5:0.2166) [92.0 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.174376   0.65954185 0.34404272]
INFO:root:Epoch 12    loss=7.1744 [44.2 s]	 dev=(HR@5:0.4269,NDCG@5:0.2844) test=(HR@5:0.3405,NDCG@5:0.2251) [91.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.1115594  0.6594787  0.29892877]
INFO:root:Epoch 13    loss=7.1116 [46.4 s]	 dev=(HR@5:0.4302,NDCG@5:0.2893) test=(HR@5:0.3454,NDCG@5:0.2283) [91.7 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.0548773  0.6589785  0.26112044]
INFO:root:Epoch 14    loss=7.0549 [44.0 s]	 dev=(HR@5:0.4222,NDCG@5:0.2902) test=(HR@5:0.3582,NDCG@5:0.2374) [91.5 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.010895   0.6590942  0.22665678]
INFO:root:Epoch 15    loss=7.0109 [44.0 s]	 dev=(HR@5:0.4167,NDCG@5:0.2810) test=(HR@5:0.3248,NDCG@5:0.2168) [91.4 s] 
INFO:root:all_losses: [6.9784956  0.65861773 0.20816472]
INFO:root:Epoch 16    loss=6.9785 [44.1 s]	 dev=(HR@5:0.4298,NDCG@5:0.2886) test=(HR@5:0.3388,NDCG@5:0.2242) [91.3 s] 
INFO:root:all_losses: [6.949408  0.6585063 0.1901482]
INFO:root:Epoch 17    loss=6.9494 [44.1 s]	 dev=(HR@5:0.4504,NDCG@5:0.3097) test=(HR@5:0.3764,NDCG@5:0.2523) [91.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.920095   0.6584604  0.17231192]
INFO:root:Epoch 18    loss=6.9201 [44.3 s]	 dev=(HR@5:0.4567,NDCG@5:0.3143) test=(HR@5:0.3849,NDCG@5:0.2565) [91.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.9055886  0.65832007 0.16433422]
INFO:root:Epoch 19    loss=6.9056 [44.2 s]	 dev=(HR@5:0.4589,NDCG@5:0.3141) test=(HR@5:0.3802,NDCG@5:0.2578) [91.4 s] 
INFO:root:all_losses: [6.886541   0.65844077 0.15087715]
INFO:root:Epoch 20    loss=6.8865 [44.0 s]	 dev=(HR@5:0.4522,NDCG@5:0.3128) test=(HR@5:0.3684,NDCG@5:0.2510) [91.5 s] 
INFO:root:all_losses: [6.86559   0.657646  0.1415552]
INFO:root:Epoch 21    loss=6.8656 [44.0 s]	 dev=(HR@5:0.4534,NDCG@5:0.3111) test=(HR@5:0.3823,NDCG@5:0.2587) [91.0 s] 
INFO:root:all_losses: [6.8560953  0.65785974 0.13715565]
INFO:root:Epoch 22    loss=6.8561 [44.0 s]	 dev=(HR@5:0.4754,NDCG@5:0.3284) test=(HR@5:0.3953,NDCG@5:0.2723) [91.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.8434095  0.6578308  0.12917414]
INFO:root:Epoch 23    loss=6.8434 [44.1 s]	 dev=(HR@5:0.4734,NDCG@5:0.3293) test=(HR@5:0.3951,NDCG@5:0.2717) [90.5 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.82628    0.657505   0.12061308]
INFO:root:Epoch 24    loss=6.8263 [44.0 s]	 dev=(HR@5:0.4801,NDCG@5:0.3298) test=(HR@5:0.4024,NDCG@5:0.2740) [90.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.8195     0.6577327  0.11511111]
INFO:root:Epoch 25    loss=6.8195 [44.0 s]	 dev=(HR@5:0.4789,NDCG@5:0.3338) test=(HR@5:0.4082,NDCG@5:0.2829) [90.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.8069277  0.6573592  0.11165932]
INFO:root:Epoch 26    loss=6.8069 [43.9 s]	 dev=(HR@5:0.4840,NDCG@5:0.3362) test=(HR@5:0.4135,NDCG@5:0.2815) [164.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.802459   0.6572491  0.11074771]
INFO:root:Epoch 27    loss=6.8025 [122.2 s]	 dev=(HR@5:0.4903,NDCG@5:0.3407) test=(HR@5:0.4232,NDCG@5:0.2915) [231.5 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7888775  0.65717334 0.10272452]
INFO:root:Epoch 28    loss=6.7889 [118.5 s]	 dev=(HR@5:0.4656,NDCG@5:0.3257) test=(HR@5:0.3833,NDCG@5:0.2678) [230.1 s] 
INFO:root:all_losses: [6.7829685  0.6568832  0.10049501]
INFO:root:Epoch 29    loss=6.7830 [117.9 s]	 dev=(HR@5:0.4795,NDCG@5:0.3349) test=(HR@5:0.4031,NDCG@5:0.2802) [229.7 s] 
INFO:root:all_losses: [6.770295   0.65658313 0.0980217 ]
INFO:root:Epoch 30    loss=6.7703 [118.1 s]	 dev=(HR@5:0.4899,NDCG@5:0.3440) test=(HR@5:0.4294,NDCG@5:0.2936) [226.8 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.764554   0.6563354  0.09585894]
INFO:root:Epoch 31    loss=6.7646 [112.7 s]	 dev=(HR@5:0.4818,NDCG@5:0.3394) test=(HR@5:0.4149,NDCG@5:0.2879) [226.0 s] 
INFO:root:all_losses: [6.757876   0.65641385 0.09245322]
INFO:root:Epoch 32    loss=6.7579 [115.3 s]	 dev=(HR@5:0.4818,NDCG@5:0.3375) test=(HR@5:0.4200,NDCG@5:0.2906) [225.8 s] 
INFO:root:all_losses: [6.7552757  0.656345   0.09239842]
INFO:root:Epoch 33    loss=6.7553 [112.1 s]	 dev=(HR@5:0.4991,NDCG@5:0.3530) test=(HR@5:0.4420,NDCG@5:0.3052) [221.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.746073   0.65608597 0.08864403]
INFO:root:Epoch 34    loss=6.7461 [112.9 s]	 dev=(HR@5:0.4610,NDCG@5:0.3224) test=(HR@5:0.3880,NDCG@5:0.2654) [221.9 s] 
INFO:root:all_losses: [6.745153   0.6561717  0.08917823]
INFO:root:Epoch 35    loss=6.7452 [111.8 s]	 dev=(HR@5:0.4640,NDCG@5:0.3250) test=(HR@5:0.3865,NDCG@5:0.2675) [221.5 s] 
INFO:root:all_losses: [6.735426   0.6557002  0.08298218]
INFO:root:Epoch 36    loss=6.7354 [111.8 s]	 dev=(HR@5:0.4997,NDCG@5:0.3544) test=(HR@5:0.4430,NDCG@5:0.3033) [221.0 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.732072   0.6556116  0.08383975]
INFO:root:Epoch 37    loss=6.7321 [112.0 s]	 dev=(HR@5:0.4877,NDCG@5:0.3417) test=(HR@5:0.4198,NDCG@5:0.2888) [219.1 s] 
INFO:root:all_losses: [6.7215204  0.65551037 0.0807126 ]
INFO:root:Epoch 38    loss=6.7215 [111.8 s]	 dev=(HR@5:0.5011,NDCG@5:0.3551) test=(HR@5:0.4387,NDCG@5:0.3009) [219.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7197304  0.6553827  0.07818957]
INFO:root:Epoch 39    loss=6.7197 [111.8 s]	 dev=(HR@5:0.4744,NDCG@5:0.3322) test=(HR@5:0.4000,NDCG@5:0.2768) [219.0 s] 
INFO:root:all_losses: [6.7149854  0.6552779  0.07775835]
INFO:root:Epoch 40    loss=6.7150 [111.7 s]	 dev=(HR@5:0.4970,NDCG@5:0.3524) test=(HR@5:0.4351,NDCG@5:0.2986) [217.8 s] 
INFO:root:all_losses: [6.7109947  0.6551147  0.07575387]
INFO:root:Epoch 41    loss=6.7110 [111.9 s]	 dev=(HR@5:0.4724,NDCG@5:0.3339) test=(HR@5:0.4002,NDCG@5:0.2787) [218.2 s] 
INFO:root:all_losses: [6.708787   0.6549139  0.07732773]
INFO:root:Epoch 42    loss=6.7088 [110.3 s]	 dev=(HR@5:0.4909,NDCG@5:0.3480) test=(HR@5:0.4230,NDCG@5:0.2921) [217.4 s] 
INFO:root:all_losses: [6.700157   0.6547322  0.07320759]
INFO:root:Epoch 43    loss=6.7002 [111.5 s]	 dev=(HR@5:0.4956,NDCG@5:0.3549) test=(HR@5:0.4357,NDCG@5:0.3013) [217.8 s] 
INFO:root:all_losses: [6.6980658  0.65461814 0.07427155]
INFO:root:Epoch 44    loss=6.6981 [111.9 s]	 dev=(HR@5:0.4934,NDCG@5:0.3508) test=(HR@5:0.4230,NDCG@5:0.2940) [217.7 s] 
INFO:root:all_losses: [6.6927524  0.6543774  0.07042369]
INFO:root:Epoch 45    loss=6.6928 [111.7 s]	 dev=(HR@5:0.4742,NDCG@5:0.3354) test=(HR@5:0.4018,NDCG@5:0.2795) [217.8 s] 
INFO:root:all_losses: [6.6868024  0.6542417  0.06891161]
INFO:root:Epoch 46    loss=6.6868 [111.6 s]	 dev=(HR@5:0.4681,NDCG@5:0.3293) test=(HR@5:0.4104,NDCG@5:0.2855) [216.4 s] 
INFO:root:all_losses: [6.683803   0.65410507 0.07028592]
INFO:root:Epoch 47    loss=6.6838 [111.4 s]	 dev=(HR@5:0.4954,NDCG@5:0.3514) test=(HR@5:0.4326,NDCG@5:0.3009) [216.2 s] 
INFO:root:all_losses: [6.684362   0.6540366  0.07057615]
INFO:root:Epoch 48    loss=6.6844 [109.9 s]	 dev=(HR@5:0.5056,NDCG@5:0.3560) test=(HR@5:0.4457,NDCG@5:0.3089) [217.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.674985   0.65354717 0.06904909]
INFO:root:Epoch 49    loss=6.6750 [111.8 s]	 dev=(HR@5:0.4777,NDCG@5:0.3384) test=(HR@5:0.4086,NDCG@5:0.2839) [215.8 s] 
INFO:root:all_losses: [6.6747956  0.6535175  0.06917881]
INFO:root:Epoch 50    loss=6.6748 [111.6 s]	 dev=(HR@5:0.5005,NDCG@5:0.3592) test=(HR@5:0.4343,NDCG@5:0.3013) [215.7 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.668128   0.65334624 0.06658983]
INFO:root:Epoch 51    loss=6.6681 [112.0 s]	 dev=(HR@5:0.5032,NDCG@5:0.3598) test=(HR@5:0.4389,NDCG@5:0.3094) [214.8 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.6688     0.65322495 0.06604887]
INFO:root:Epoch 52    loss=6.6688 [111.8 s]	 dev=(HR@5:0.5081,NDCG@5:0.3635) test=(HR@5:0.4442,NDCG@5:0.3114) [215.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.660492   0.6528378  0.06537791]
INFO:root:Epoch 53    loss=6.6605 [111.7 s]	 dev=(HR@5:0.4901,NDCG@5:0.3444) test=(HR@5:0.4190,NDCG@5:0.2911) [215.6 s] 
INFO:root:all_losses: [6.6592216  0.65291405 0.06579456]
INFO:root:Epoch 54    loss=6.6592 [111.4 s]	 dev=(HR@5:0.4928,NDCG@5:0.3485) test=(HR@5:0.4277,NDCG@5:0.2994) [216.2 s] 
INFO:root:all_losses: [6.654781   0.6524998  0.06496855]
INFO:root:Epoch 55    loss=6.6548 [111.3 s]	 dev=(HR@5:0.4720,NDCG@5:0.3324) test=(HR@5:0.4096,NDCG@5:0.2852) [213.1 s] 
INFO:root:all_losses: [6.6530657  0.6524718  0.06337281]
INFO:root:Epoch 56    loss=6.6531 [111.0 s]	 dev=(HR@5:0.5152,NDCG@5:0.3662) test=(HR@5:0.4502,NDCG@5:0.3141) [213.9 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.6500044 0.6522508 0.0632524]
INFO:root:Epoch 57    loss=6.6500 [111.3 s]	 dev=(HR@5:0.4738,NDCG@5:0.3326) test=(HR@5:0.4126,NDCG@5:0.2876) [212.4 s] 
INFO:root:all_losses: [6.6477284  0.6521034  0.06282496]
INFO:root:Epoch 58    loss=6.6477 [111.3 s]	 dev=(HR@5:0.4946,NDCG@5:0.3539) test=(HR@5:0.4296,NDCG@5:0.2992) [213.0 s] 
INFO:root:all_losses: [6.640746  0.6521068 0.0608735]
INFO:root:Epoch 59    loss=6.6407 [111.0 s]	 dev=(HR@5:0.4915,NDCG@5:0.3517) test=(HR@5:0.4330,NDCG@5:0.3031) [212.4 s] 
INFO:root:all_losses: [6.642727   0.6520366  0.06164379]
INFO:root:Epoch 60    loss=6.6427 [108.8 s]	 dev=(HR@5:0.4979,NDCG@5:0.3534) test=(HR@5:0.4294,NDCG@5:0.2994) [212.5 s] 
INFO:root:all_losses: [6.636347   0.6517703  0.05994654]
INFO:root:Epoch 61    loss=6.6363 [111.0 s]	 dev=(HR@5:0.5036,NDCG@5:0.3565) test=(HR@5:0.4351,NDCG@5:0.3022) [213.5 s] 
INFO:root:all_losses: [6.6311874  0.65148014 0.05835024]
INFO:root:Epoch 62    loss=6.6312 [117.1 s]	 dev=(HR@5:0.4803,NDCG@5:0.3445) test=(HR@5:0.4141,NDCG@5:0.2875) [215.8 s] 
INFO:root:all_losses: [6.627124   0.65128696 0.05837603]
INFO:root:Epoch 63    loss=6.6271 [113.0 s]	 dev=(HR@5:0.4858,NDCG@5:0.3428) test=(HR@5:0.4153,NDCG@5:0.2877) [212.2 s] 
INFO:root:all_losses: [6.6309714  0.6513192  0.05967506]
INFO:root:Epoch 64    loss=6.6310 [110.8 s]	 dev=(HR@5:0.4879,NDCG@5:0.3470) test=(HR@5:0.4122,NDCG@5:0.2880) [211.8 s] 
INFO:root:all_losses: [6.629454   0.6512743  0.05789792]
INFO:root:Epoch 65    loss=6.6295 [110.5 s]	 dev=(HR@5:0.4883,NDCG@5:0.3468) test=(HR@5:0.4216,NDCG@5:0.2925) [211.8 s] 
INFO:root:all_losses: [6.6252975  0.6511209  0.05851036]
INFO:root:Epoch 66    loss=6.6253 [110.2 s]	 dev=(HR@5:0.4981,NDCG@5:0.3601) test=(HR@5:0.4353,NDCG@5:0.3029) [211.2 s] 
INFO:root:all_losses: [6.619976   0.6508528  0.05601669]
INFO:root:Epoch 67    loss=6.6200 [110.5 s]	 dev=(HR@5:0.4614,NDCG@5:0.3280) test=(HR@5:0.3839,NDCG@5:0.2662) [213.9 s] 
INFO:root:all_losses: [6.6273584  0.6509507  0.06048254]
INFO:root:Epoch 68    loss=6.6274 [111.9 s]	 dev=(HR@5:0.4922,NDCG@5:0.3512) test=(HR@5:0.4318,NDCG@5:0.2987) [217.1 s] 
INFO:root:all_losses: [6.6240096  0.65101075 0.05946285]
INFO:root:Epoch 69    loss=6.6240 [119.4 s]	 dev=(HR@5:0.5017,NDCG@5:0.3599) test=(HR@5:0.4324,NDCG@5:0.3018) [231.7 s] 
INFO:root:all_losses: [6.6166425 0.6506778 0.056366 ]
INFO:root:Epoch 70    loss=6.6166 [124.1 s]	 dev=(HR@5:0.4905,NDCG@5:0.3473) test=(HR@5:0.4194,NDCG@5:0.2908) [229.3 s] 
INFO:root:all_losses: [6.616125   0.6506779  0.05644175]
INFO:root:Epoch 71    loss=6.6161 [122.6 s]	 dev=(HR@5:0.4958,NDCG@5:0.3548) test=(HR@5:0.4332,NDCG@5:0.3035) [229.6 s] 
INFO:root:all_losses: [6.616096   0.65057474 0.05596418]
INFO:root:Epoch 72    loss=6.6161 [122.2 s]	 dev=(HR@5:0.5138,NDCG@5:0.3664) test=(HR@5:0.4502,NDCG@5:0.3135) [228.6 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.6095414  0.6502946  0.05473877]
INFO:root:Epoch 73    loss=6.6095 [124.1 s]	 dev=(HR@5:0.5064,NDCG@5:0.3591) test=(HR@5:0.4463,NDCG@5:0.3109) [229.3 s] 
INFO:root:all_losses: [6.6127567  0.65040916 0.05671795]
INFO:root:Epoch 74    loss=6.6128 [123.6 s]	 dev=(HR@5:0.5113,NDCG@5:0.3657) test=(HR@5:0.4493,NDCG@5:0.3143) [227.8 s] 
INFO:root:all_losses: [6.605776   0.6501865  0.05417245]
INFO:root:Epoch 75    loss=6.6058 [123.5 s]	 dev=(HR@5:0.4740,NDCG@5:0.3364) test=(HR@5:0.4031,NDCG@5:0.2805) [231.4 s] 
INFO:root:all_losses: [6.6033683 0.6500305 0.0538751]
INFO:root:Epoch 76    loss=6.6034 [125.5 s]	 dev=(HR@5:0.5034,NDCG@5:0.3593) test=(HR@5:0.4451,NDCG@5:0.3099) [232.3 s] 
INFO:root:all_losses: [6.6022196  0.649935   0.05371386]
INFO:root:Epoch 77    loss=6.6022 [125.2 s]	 dev=(HR@5:0.4891,NDCG@5:0.3457) test=(HR@5:0.4200,NDCG@5:0.2916) [232.0 s] 
INFO:root:all_losses: [6.6007943  0.6498519  0.05187957]
INFO:root:Epoch 78    loss=6.6008 [126.1 s]	 dev=(HR@5:0.4854,NDCG@5:0.3454) test=(HR@5:0.4183,NDCG@5:0.2903) [230.1 s] 
INFO:root:all_losses: [6.598532   0.64975953 0.05269228]
INFO:root:Epoch 79    loss=6.5985 [121.0 s]	 dev=(HR@5:0.5062,NDCG@5:0.3589) test=(HR@5:0.4467,NDCG@5:0.3135) [228.8 s] 
INFO:root:all_losses: [6.599982   0.649899   0.05344184]
INFO:root:Epoch 80    loss=6.6000 [125.3 s]	 dev=(HR@5:0.4997,NDCG@5:0.3569) test=(HR@5:0.4473,NDCG@5:0.3156) [226.3 s] 
INFO:root:all_losses: [6.595682   0.6494956  0.05285725]
INFO:root:Epoch 81    loss=6.5957 [124.8 s]	 dev=(HR@5:0.4966,NDCG@5:0.3539) test=(HR@5:0.4298,NDCG@5:0.3020) [230.9 s] 
INFO:root:all_losses: [6.592228  0.6495389 0.0508494]
INFO:root:Epoch 82    loss=6.5922 [123.6 s]	 dev=(HR@5:0.4944,NDCG@5:0.3544) test=(HR@5:0.4383,NDCG@5:0.3059) [226.6 s] 
INFO:root:all_losses: [6.0382586  0.59377503 0.05291665]
INFO:root:Epoch 83    loss=6.0383 [127.2 s]	 dev=(HR@5:0.4930,NDCG@5:0.3519) test=(HR@5:0.4204,NDCG@5:0.2938) [226.6 s] 
INFO:root:all_losses: [5.659061   0.55582947 0.05381609]
INFO:root:Epoch 84    loss=5.6591 [125.1 s]	 dev=(HR@5:0.4968,NDCG@5:0.3565) test=(HR@5:0.4324,NDCG@5:0.3065) [223.8 s] 
INFO:root:all_losses: [5.593348   0.5489351  0.05594893]
INFO:root:Epoch 85    loss=5.5933 [121.7 s]	 dev=(HR@5:0.4977,NDCG@5:0.3579) test=(HR@5:0.4432,NDCG@5:0.3108) [224.3 s] 
INFO:root:all_losses: [5.5739017  0.54645    0.06010386]
INFO:root:Epoch 86    loss=5.5739 [122.5 s]	 dev=(HR@5:0.4911,NDCG@5:0.3514) test=(HR@5:0.4196,NDCG@5:0.2956) [224.3 s] 
INFO:root:all_losses: [5.556199   0.5448633  0.05957711]
INFO:root:Epoch 87    loss=5.5562 [121.4 s]	 dev=(HR@5:0.4866,NDCG@5:0.3459) test=(HR@5:0.4192,NDCG@5:0.2972) [221.6 s] 
INFO:root:all_losses: [5.5445333  0.54418653 0.05650403]
INFO:root:Epoch 88    loss=5.5445 [122.1 s]	 dev=(HR@5:0.4962,NDCG@5:0.3568) test=(HR@5:0.4377,NDCG@5:0.3066) [221.5 s] 
INFO:root:all_losses: [5.529078   0.5421718  0.06014293]
INFO:root:Epoch 89    loss=5.5291 [122.1 s]	 dev=(HR@5:0.4968,NDCG@5:0.3548) test=(HR@5:0.4294,NDCG@5:0.2990) [223.3 s] 
INFO:root:all_losses: [5.5259614  0.5420228  0.05784322]
INFO:root:Epoch 90    loss=5.5260 [121.9 s]	 dev=(HR@5:0.4683,NDCG@5:0.3337) test=(HR@5:0.3941,NDCG@5:0.2760) [222.3 s] 
INFO:root:all_losses: [5.5097084  0.5404396  0.05929859]
INFO:root:Epoch 91    loss=5.5097 [123.3 s]	 dev=(HR@5:0.5107,NDCG@5:0.3634) test=(HR@5:0.4516,NDCG@5:0.3139) [222.5 s] 
INFO:root:all_losses: [5.5114174  0.540291   0.06176664]
INFO:root:Epoch 92    loss=5.5114 [123.1 s]	 dev=(HR@5:0.4826,NDCG@5:0.3436) test=(HR@5:0.4053,NDCG@5:0.2842) [223.0 s] 
INFO:root:Early stop at 92 based on dev result.
INFO:root:
Best Iter(dev)=   72	 dev=(HR@5:0.5138,NDCG@5:0.3664) test=(HR@5:0.4502,NDCG@5:0.3135) [25634.8 s] 
INFO:root:Load model from ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_freq_rand=1_alpha=0.1_lamda=10_latent_relation_num=8_leave_one_latent=1_include_lrd=1_message=.pt
INFO:root:
Test After Training: (HR@10:0.6080,HR@5:0.4502,HR@50:0.8932,NDCG@10:0.3645,NDCG@5:0.3135,NDCG@50:0.4285)
INFO:root:
--------------------------------------------- END: 2025-01-01 17:34:20 ---------------------------------------------
INFO:root:Namespace(model_name='KDAPlus')
INFO:root:--------------------------------------------- BEGIN: 2025-01-05 14:19:16 ---------------------------------------------
INFO:root:
=====================================
 Arguments           | Values        
=====================================
 alpha               | 0.1          
 attention_size      | 10           
 batch_size          | 256          
 buffer              | 1            
 dataset             | Office       
 dropout             | 0            
 early_stop          | 5            
 emb_size            | 64           
 epoch               | 200          
 eval_batch_size     | 256          
 freq_rand           | 1            
 gamma               | -1.0         
 gpu                 | 0            
 history_max         | 20           
 include_attr        | 1            
 include_kge         | 1            
 include_lrd         | 1            
 include_val         | 1            
 l2                  | 1e-06        
 lamda               | 10           
 latent_relation_num | 8            
 leave_one_latent    | 1            
 load                | 0            
 lr                  | 0.001        
 message             |              
 metric              | ["NDCG","HR"]
 n_dft               | 64           
 neg_head_p          | 0.5          
 num_heads           | 4            
 num_layers          | 5            
 num_neg             | 1            
 num_workers         | 5            
 only_predict        | 0            
 optimizer           | Adam         
 plm_name            | feat.GPT     
 plm_size            | 1536         
 pooling             | average      
 random_seed         | 2019         
 t_scalar            | 60           
 topk                | [5,10,50]    
=====================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/Office\DFTReader_8.pkl
INFO:root:#params: 4336925
INFO:root:KDAPlus(
  (user_embeddings): Embedding(4906, 64)
  (item_embeddings): Embedding(2421, 1536, padding_idx=0)
  (project_layer_1): Linear(in_features=1536, out_features=64, bias=True)
  (project_layer_2): Linear(in_features=128, out_features=13, bias=True)
  (entity_embeddings): Embedding(2803, 64)
  (relation_embeddings): Embedding(13, 64)
  (relational_dynamic_aggregation): RelationalDynamicAggregation(
    (relation_embeddings): Embedding(13, 64)
    (freq_real): Embedding(13, 33)
    (freq_imag): Embedding(13, 33)
  )
  (attn_head): MultiHeadAttention(
    (q_linear): Linear(in_features=64, out_features=64, bias=False)
    (k_linear): Linear(in_features=64, out_features=64, bias=False)
    (v_linear): Linear(in_features=64, out_features=64, bias=False)
  )
  (W1): Linear(in_features=64, out_features=64, bias=True)
  (W2): Linear(in_features=64, out_features=64, bias=True)
  (dropout_layer): Dropout(p=0, inplace=False)
  (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (item_bias): Embedding(2422, 1)
)
INFO:root:Test Before Training: (HR@10:0.0887,HR@5:0.0387,HR@50:0.5148,NDCG@10:0.0376,NDCG@5:0.0217,NDCG@50:0.1282)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [8.246797  0.6951779 0.6931283]
INFO:root:Epoch 1     loss=8.2468 [59.1 s]	 dev=(HR@5:0.1011,NDCG@5:0.0586) test=(HR@5:0.0628,NDCG@5:0.0363) [157.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.9835997  0.6748306  0.69290036]
INFO:root:Epoch 2     loss=7.9836 [59.0 s]	 dev=(HR@5:0.1397,NDCG@5:0.0841) test=(HR@5:0.0999,NDCG@5:0.0600) [157.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.840683   0.66675305 0.69158137]
INFO:root:Epoch 3     loss=7.8407 [57.7 s]	 dev=(HR@5:0.2371,NDCG@5:0.1465) test=(HR@5:0.1710,NDCG@5:0.1051) [157.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.749979  0.6635431 0.6880095]
INFO:root:Epoch 4     loss=7.7500 [57.7 s]	 dev=(HR@5:0.2871,NDCG@5:0.1825) test=(HR@5:0.2214,NDCG@5:0.1425) [158.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.6982307  0.6624362  0.67920744]
INFO:root:Epoch 5     loss=7.6982 [58.5 s]	 dev=(HR@5:0.3025,NDCG@5:0.1912) test=(HR@5:0.2277,NDCG@5:0.1469) [157.8 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.636083   0.66173935 0.65771323]
INFO:root:Epoch 6     loss=7.6361 [58.4 s]	 dev=(HR@5:0.3627,NDCG@5:0.2339) test=(HR@5:0.2712,NDCG@5:0.1794) [157.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.563238   0.6610762  0.61536515]
INFO:root:Epoch 7     loss=7.5632 [58.6 s]	 dev=(HR@5:0.3839,NDCG@5:0.2507) test=(HR@5:0.2911,NDCG@5:0.1913) [157.5 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.4850235  0.66104025 0.5597973 ]
INFO:root:Epoch 8     loss=7.4850 [58.9 s]	 dev=(HR@5:0.3768,NDCG@5:0.2469) test=(HR@5:0.2885,NDCG@5:0.1908) [157.2 s] 
INFO:root:all_losses: [7.3990917  0.66025853 0.5049815 ]
INFO:root:Epoch 9     loss=7.3991 [60.9 s]	 dev=(HR@5:0.3812,NDCG@5:0.2507) test=(HR@5:0.3076,NDCG@5:0.2003) [159.5 s] 
INFO:root:all_losses: [7.3318357 0.6599073 0.4531634]
INFO:root:Epoch 10    loss=7.3318 [74.7 s]	 dev=(HR@5:0.3957,NDCG@5:0.2584) test=(HR@5:0.3089,NDCG@5:0.2037) [193.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.2584076  0.65975606 0.399221  ]
INFO:root:Epoch 11    loss=7.2584 [74.4 s]	 dev=(HR@5:0.4063,NDCG@5:0.2670) test=(HR@5:0.3160,NDCG@5:0.2077) [192.9 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.1885767 0.659552  0.3467338]
INFO:root:Epoch 12    loss=7.1886 [73.7 s]	 dev=(HR@5:0.4075,NDCG@5:0.2706) test=(HR@5:0.3268,NDCG@5:0.2149) [194.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.1269855  0.6594596  0.30212444]
INFO:root:Epoch 13    loss=7.1270 [71.1 s]	 dev=(HR@5:0.4314,NDCG@5:0.2851) test=(HR@5:0.3399,NDCG@5:0.2226) [193.2 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [7.072011  0.6589475 0.264759 ]
INFO:root:Epoch 14    loss=7.0720 [74.9 s]	 dev=(HR@5:0.4045,NDCG@5:0.2759) test=(HR@5:0.3262,NDCG@5:0.2154) [195.6 s] 
INFO:root:all_losses: [7.0279393  0.6590497  0.23063885]
INFO:root:Epoch 15    loss=7.0279 [81.0 s]	 dev=(HR@5:0.4004,NDCG@5:0.2680) test=(HR@5:0.3042,NDCG@5:0.2011) [197.2 s] 
INFO:root:all_losses: [6.998393   0.6585844  0.21152031]
INFO:root:Epoch 16    loss=6.9984 [75.1 s]	 dev=(HR@5:0.4145,NDCG@5:0.2803) test=(HR@5:0.3309,NDCG@5:0.2179) [196.7 s] 
INFO:root:all_losses: [6.969716   0.6584769  0.19327506]
INFO:root:Epoch 17    loss=6.9697 [81.6 s]	 dev=(HR@5:0.4359,NDCG@5:0.2930) test=(HR@5:0.3474,NDCG@5:0.2336) [200.0 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.9411182 0.6584185 0.1756477]
INFO:root:Epoch 18    loss=6.9411 [74.4 s]	 dev=(HR@5:0.4451,NDCG@5:0.3030) test=(HR@5:0.3668,NDCG@5:0.2451) [196.5 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.9277854  0.65830576 0.16719154]
INFO:root:Epoch 19    loss=6.9278 [77.2 s]	 dev=(HR@5:0.4459,NDCG@5:0.3013) test=(HR@5:0.3694,NDCG@5:0.2473) [195.4 s] 
INFO:root:all_losses: [6.910149  0.6584188 0.154065 ]
INFO:root:Epoch 20    loss=6.9101 [76.9 s]	 dev=(HR@5:0.4475,NDCG@5:0.3095) test=(HR@5:0.3662,NDCG@5:0.2484) [195.3 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.889358   0.65764844 0.14503413]
INFO:root:Epoch 21    loss=6.8894 [77.3 s]	 dev=(HR@5:0.4510,NDCG@5:0.3101) test=(HR@5:0.3841,NDCG@5:0.2584) [195.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.8822484  0.65785724 0.1400318 ]
INFO:root:Epoch 22    loss=6.8822 [77.1 s]	 dev=(HR@5:0.4616,NDCG@5:0.3196) test=(HR@5:0.3908,NDCG@5:0.2650) [196.7 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.869081   0.65783614 0.13202912]
INFO:root:Epoch 23    loss=6.8691 [77.6 s]	 dev=(HR@5:0.4624,NDCG@5:0.3181) test=(HR@5:0.3861,NDCG@5:0.2646) [195.0 s] 
INFO:root:all_losses: [6.853113   0.65750784 0.12313835]
INFO:root:Epoch 24    loss=6.8531 [76.6 s]	 dev=(HR@5:0.4644,NDCG@5:0.3188) test=(HR@5:0.3978,NDCG@5:0.2669) [195.1 s] 
INFO:root:all_losses: [6.84541    0.6577357  0.11767478]
INFO:root:Epoch 25    loss=6.8454 [77.7 s]	 dev=(HR@5:0.4648,NDCG@5:0.3223) test=(HR@5:0.3876,NDCG@5:0.2657) [195.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.8339777  0.6573806  0.11530559]
INFO:root:Epoch 26    loss=6.8340 [77.2 s]	 dev=(HR@5:0.4820,NDCG@5:0.3315) test=(HR@5:0.4027,NDCG@5:0.2735) [194.8 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.832738   0.6572795  0.11364851]
INFO:root:Epoch 27    loss=6.8327 [77.9 s]	 dev=(HR@5:0.4695,NDCG@5:0.3223) test=(HR@5:0.3933,NDCG@5:0.2701) [195.0 s] 
INFO:root:all_losses: [6.8179674  0.65721637 0.10600738]
INFO:root:Epoch 28    loss=6.8180 [76.9 s]	 dev=(HR@5:0.4601,NDCG@5:0.3176) test=(HR@5:0.3737,NDCG@5:0.2571) [194.8 s] 
INFO:root:all_losses: [6.813138   0.6569211  0.10384875]
INFO:root:Epoch 29    loss=6.8131 [77.8 s]	 dev=(HR@5:0.4760,NDCG@5:0.3277) test=(HR@5:0.3986,NDCG@5:0.2722) [195.0 s] 
INFO:root:all_losses: [6.80075    0.65662456 0.10257863]
INFO:root:Epoch 30    loss=6.8008 [77.7 s]	 dev=(HR@5:0.4818,NDCG@5:0.3321) test=(HR@5:0.4080,NDCG@5:0.2804) [195.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7941804  0.65638584 0.09907223]
INFO:root:Epoch 31    loss=6.7942 [77.6 s]	 dev=(HR@5:0.4738,NDCG@5:0.3294) test=(HR@5:0.4073,NDCG@5:0.2796) [194.4 s] 
INFO:root:all_losses: [6.7889357  0.6564523  0.09656806]
INFO:root:Epoch 32    loss=6.7889 [78.7 s]	 dev=(HR@5:0.4583,NDCG@5:0.3203) test=(HR@5:0.3920,NDCG@5:0.2694) [196.4 s] 
INFO:root:all_losses: [6.7862906  0.6564149  0.09570588]
INFO:root:Epoch 33    loss=6.7863 [77.2 s]	 dev=(HR@5:0.4907,NDCG@5:0.3439) test=(HR@5:0.4271,NDCG@5:0.2917) [194.1 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.776438   0.65612876 0.09189965]
INFO:root:Epoch 34    loss=6.7764 [77.1 s]	 dev=(HR@5:0.4585,NDCG@5:0.3151) test=(HR@5:0.3814,NDCG@5:0.2595) [193.0 s] 
INFO:root:all_losses: [6.77474    0.65626943 0.0921284 ]
INFO:root:Epoch 35    loss=6.7747 [77.0 s]	 dev=(HR@5:0.4748,NDCG@5:0.3301) test=(HR@5:0.3982,NDCG@5:0.2741) [194.2 s] 
INFO:root:all_losses: [6.767096   0.6557895  0.08645715]
INFO:root:Epoch 36    loss=6.7671 [77.3 s]	 dev=(HR@5:0.4756,NDCG@5:0.3325) test=(HR@5:0.4063,NDCG@5:0.2805) [194.5 s] 
INFO:root:all_losses: [6.7615156  0.6557015  0.08668475]
INFO:root:Epoch 37    loss=6.7615 [77.8 s]	 dev=(HR@5:0.4917,NDCG@5:0.3433) test=(HR@5:0.4241,NDCG@5:0.2903) [194.4 s] 
INFO:root:all_losses: [6.750596   0.65560365 0.08367134]
INFO:root:Epoch 38    loss=6.7506 [77.4 s]	 dev=(HR@5:0.4854,NDCG@5:0.3406) test=(HR@5:0.4165,NDCG@5:0.2864) [194.0 s] 
INFO:root:all_losses: [6.751382   0.6554802  0.08169394]
INFO:root:Epoch 39    loss=6.7514 [77.3 s]	 dev=(HR@5:0.4734,NDCG@5:0.3285) test=(HR@5:0.4069,NDCG@5:0.2795) [194.0 s] 
INFO:root:all_losses: [6.746945   0.65539235 0.08013213]
INFO:root:Epoch 40    loss=6.7469 [78.3 s]	 dev=(HR@5:0.4981,NDCG@5:0.3495) test=(HR@5:0.4336,NDCG@5:0.2945) [196.0 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.742316   0.6552232  0.07923505]
INFO:root:Epoch 41    loss=6.7423 [78.3 s]	 dev=(HR@5:0.4669,NDCG@5:0.3251) test=(HR@5:0.3957,NDCG@5:0.2691) [194.1 s] 
INFO:root:all_losses: [6.739879   0.65503424 0.08046155]
INFO:root:Epoch 42    loss=6.7399 [80.5 s]	 dev=(HR@5:0.4854,NDCG@5:0.3442) test=(HR@5:0.4234,NDCG@5:0.2914) [193.8 s] 
INFO:root:all_losses: [6.7331405  0.6548503  0.07625816]
INFO:root:Epoch 43    loss=6.7331 [77.4 s]	 dev=(HR@5:0.4873,NDCG@5:0.3464) test=(HR@5:0.4322,NDCG@5:0.2972) [192.7 s] 
INFO:root:all_losses: [6.7272906  0.65477747 0.07745134]
INFO:root:Epoch 44    loss=6.7273 [77.5 s]	 dev=(HR@5:0.4869,NDCG@5:0.3478) test=(HR@5:0.4283,NDCG@5:0.2939) [193.7 s] 
INFO:root:all_losses: [6.721259   0.6544859  0.07377952]
INFO:root:Epoch 45    loss=6.7213 [77.9 s]	 dev=(HR@5:0.4828,NDCG@5:0.3405) test=(HR@5:0.4226,NDCG@5:0.2912) [193.3 s] 
INFO:root:all_losses: [6.716955   0.6543603  0.07276537]
INFO:root:Epoch 46    loss=6.7170 [78.0 s]	 dev=(HR@5:0.4603,NDCG@5:0.3206) test=(HR@5:0.3955,NDCG@5:0.2728) [193.0 s] 
INFO:root:all_losses: [6.712879   0.6541992  0.07235022]
INFO:root:Epoch 47    loss=6.7129 [77.7 s]	 dev=(HR@5:0.4956,NDCG@5:0.3506) test=(HR@5:0.4365,NDCG@5:0.3001) [193.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.7159247  0.6541312  0.07413264]
INFO:root:Epoch 48    loss=6.7159 [78.3 s]	 dev=(HR@5:0.4907,NDCG@5:0.3462) test=(HR@5:0.4283,NDCG@5:0.2957) [193.0 s] 
INFO:root:all_losses: [6.7053275  0.6536965  0.07208333]
INFO:root:Epoch 49    loss=6.7053 [77.3 s]	 dev=(HR@5:0.4703,NDCG@5:0.3329) test=(HR@5:0.4049,NDCG@5:0.2805) [193.5 s] 
INFO:root:all_losses: [6.7043443  0.6536452  0.07221881]
INFO:root:Epoch 50    loss=6.7043 [78.0 s]	 dev=(HR@5:0.5021,NDCG@5:0.3588) test=(HR@5:0.4510,NDCG@5:0.3116) [192.4 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.6965213  0.6534435  0.06837569]
INFO:root:Epoch 51    loss=6.6965 [77.6 s]	 dev=(HR@5:0.4995,NDCG@5:0.3575) test=(HR@5:0.4487,NDCG@5:0.3126) [193.5 s] 
INFO:root:all_losses: [6.6961865  0.6533277  0.06841305]
INFO:root:Epoch 52    loss=6.6962 [78.4 s]	 dev=(HR@5:0.5036,NDCG@5:0.3579) test=(HR@5:0.4534,NDCG@5:0.3101) [193.6 s] 
INFO:root:all_losses: [6.690654   0.6529733  0.06886528]
INFO:root:Epoch 53    loss=6.6907 [77.5 s]	 dev=(HR@5:0.4983,NDCG@5:0.3524) test=(HR@5:0.4308,NDCG@5:0.2990) [193.9 s] 
INFO:root:all_losses: [6.68655    0.6530192  0.06882244]
INFO:root:Epoch 54    loss=6.6866 [78.7 s]	 dev=(HR@5:0.4948,NDCG@5:0.3499) test=(HR@5:0.4379,NDCG@5:0.3018) [194.4 s] 
INFO:root:all_losses: [6.6822023  0.65257275 0.06854911]
INFO:root:Epoch 55    loss=6.6822 [77.7 s]	 dev=(HR@5:0.4826,NDCG@5:0.3419) test=(HR@5:0.4165,NDCG@5:0.2909) [193.6 s] 
INFO:root:all_losses: [6.679182   0.65255743 0.0656243 ]
INFO:root:Epoch 56    loss=6.6792 [76.6 s]	 dev=(HR@5:0.5076,NDCG@5:0.3596) test=(HR@5:0.4536,NDCG@5:0.3169) [193.7 s] 
INFO:root:Save model to ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1...
INFO:root:all_losses: [6.6787844  0.6523671  0.06636222]
INFO:root:Epoch 57    loss=6.6788 [78.1 s]	 dev=(HR@5:0.4681,NDCG@5:0.3314) test=(HR@5:0.4222,NDCG@5:0.2932) [193.3 s] 
INFO:root:all_losses: [6.6747603  0.65216416 0.06518207]
INFO:root:Epoch 58    loss=6.6748 [77.7 s]	 dev=(HR@5:0.4977,NDCG@5:0.3531) test=(HR@5:0.4506,NDCG@5:0.3098) [193.2 s] 
INFO:root:all_losses: [6.6669683  0.65215933 0.06323192]
INFO:root:Epoch 59    loss=6.6670 [78.3 s]	 dev=(HR@5:0.4862,NDCG@5:0.3450) test=(HR@5:0.4361,NDCG@5:0.3013) [192.9 s] 
INFO:root:all_losses: [6.668291   0.6521055  0.06441588]
INFO:root:Epoch 60    loss=6.6683 [78.0 s]	 dev=(HR@5:0.4881,NDCG@5:0.3472) test=(HR@5:0.4296,NDCG@5:0.2967) [192.7 s] 
INFO:root:all_losses: [6.664042   0.6518308  0.06315293]
INFO:root:Epoch 61    loss=6.6640 [77.5 s]	 dev=(HR@5:0.4844,NDCG@5:0.3465) test=(HR@5:0.4292,NDCG@5:0.2979) [192.8 s] 
INFO:root:all_losses: [6.659616   0.6515937  0.06150084]
INFO:root:Epoch 62    loss=6.6596 [77.9 s]	 dev=(HR@5:0.4714,NDCG@5:0.3358) test=(HR@5:0.4139,NDCG@5:0.2869) [192.5 s] 
INFO:root:all_losses: [6.6548877  0.651364   0.06112844]
INFO:root:Epoch 63    loss=6.6549 [78.0 s]	 dev=(HR@5:0.4771,NDCG@5:0.3376) test=(HR@5:0.4247,NDCG@5:0.2918) [192.5 s] 
INFO:root:all_losses: [6.6593857  0.65142506 0.06247552]
INFO:root:Epoch 64    loss=6.6594 [76.9 s]	 dev=(HR@5:0.4838,NDCG@5:0.3432) test=(HR@5:0.4143,NDCG@5:0.2830) [194.0 s] 
INFO:root:all_losses: [6.654056   0.65134555 0.0600747 ]
INFO:root:Epoch 65    loss=6.6541 [77.9 s]	 dev=(HR@5:0.4742,NDCG@5:0.3377) test=(HR@5:0.4171,NDCG@5:0.2860) [193.9 s] 
INFO:root:all_losses: [6.6489687  0.65122676 0.06008376]
INFO:root:Epoch 66    loss=6.6490 [77.8 s]	 dev=(HR@5:0.4862,NDCG@5:0.3478) test=(HR@5:0.4188,NDCG@5:0.2883) [193.9 s] 
INFO:root:all_losses: [6.6472974  0.65093845 0.05913723]
INFO:root:Epoch 67    loss=6.6473 [78.2 s]	 dev=(HR@5:0.4599,NDCG@5:0.3305) test=(HR@5:0.3988,NDCG@5:0.2746) [195.0 s] 
INFO:root:all_losses: [6.6539273  0.6509764  0.06348904]
INFO:root:Epoch 68    loss=6.6539 [78.6 s]	 dev=(HR@5:0.4787,NDCG@5:0.3400) test=(HR@5:0.4147,NDCG@5:0.2845) [195.3 s] 
INFO:root:all_losses: [6.6491885  0.65115947 0.0607972 ]
INFO:root:Epoch 69    loss=6.6492 [77.0 s]	 dev=(HR@5:0.4891,NDCG@5:0.3488) test=(HR@5:0.4298,NDCG@5:0.2974) [192.3 s] 
INFO:root:all_losses: [6.641825   0.65075314 0.05929113]
INFO:root:Epoch 70    loss=6.6418 [79.0 s]	 dev=(HR@5:0.4899,NDCG@5:0.3500) test=(HR@5:0.4271,NDCG@5:0.2941) [194.3 s] 
INFO:root:all_losses: [6.642613   0.6507895  0.05896267]
INFO:root:Epoch 71    loss=6.6426 [78.0 s]	 dev=(HR@5:0.4767,NDCG@5:0.3401) test=(HR@5:0.4145,NDCG@5:0.2882) [194.6 s] 
INFO:root:all_losses: [6.642112   0.6506068  0.05909438]
INFO:root:Epoch 72    loss=6.6421 [78.8 s]	 dev=(HR@5:0.4972,NDCG@5:0.3533) test=(HR@5:0.4330,NDCG@5:0.3024) [194.7 s] 
INFO:root:all_losses: [6.6389985  0.6504522  0.05768226]
INFO:root:Epoch 73    loss=6.6390 [78.1 s]	 dev=(HR@5:0.4934,NDCG@5:0.3486) test=(HR@5:0.4412,NDCG@5:0.3044) [198.0 s] 
INFO:root:all_losses: [6.6406913  0.6505596  0.05911161]
INFO:root:Epoch 74    loss=6.6407 [80.4 s]	 dev=(HR@5:0.4930,NDCG@5:0.3543) test=(HR@5:0.4387,NDCG@5:0.3032) [194.6 s] 
INFO:root:all_losses: [6.6309695  0.65033245 0.05738921]
INFO:root:Epoch 75    loss=6.6310 [78.2 s]	 dev=(HR@5:0.4834,NDCG@5:0.3427) test=(HR@5:0.4167,NDCG@5:0.2825) [195.0 s] 
INFO:root:all_losses: [6.6298656  0.65014994 0.05758826]
INFO:root:Epoch 76    loss=6.6299 [78.8 s]	 dev=(HR@5:0.5007,NDCG@5:0.3518) test=(HR@5:0.4548,NDCG@5:0.3148) [196.8 s] 
INFO:root:Early stop at 76 based on dev result.
INFO:root:
Best Iter(dev)=   56	 dev=(HR@5:0.5076,NDCG@5:0.3596) test=(HR@5:0.4536,NDCG@5:0.3169) [20168.5 s] 
INFO:root:Load model from ../model/KDAPlus/KDAPlus_Office_2019_lr=0.001_l2=1e-06_num_layers=5_num_heads=4_freq_rand=1_alpha=0.1_lamda=10_latent_relation_num=8_leave_one_latent=1_include_lrd=1_message=.pt
INFO:root:
Test After Training: (HR@10:0.6208,HR@5:0.4536,HR@50:0.8964,NDCG@10:0.3709,NDCG@5:0.3169,NDCG@50:0.4325)
INFO:root:
--------------------------------------------- END: 2025-01-05 19:58:23 ---------------------------------------------
