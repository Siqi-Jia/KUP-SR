INFO:root:Namespace(model_name='KSR')
INFO:root:--------------------------------------------- BEGIN: 2025-03-16 21:56:06 ---------------------------------------------
INFO:root:
=================================
 Arguments       | Values        
=================================
 batch_size      | 256          
 buffer          | 1            
 dataset         | ml-100k      
 dropout         | 0            
 early_stop      | 5            
 emb_size        | 64           
 epoch           | 200          
 eval_batch_size | 256          
 gpu             | 0            
 history_max     | 20           
 l2              | 1e-06        
 load            | 0            
 lr              | 0.001        
 metric          | ["NDCG","HR"]
 num_heads       | 4            
 num_layers      | 5            
 num_neg         | 1            
 num_workers     | 5            
 only_predict    | 0            
 optimizer       | Adam         
 random_seed     | 2019         
 topk            | [5,10,50]    
=================================
INFO:root:cuda available: False
INFO:root:# cuda devices: 0
INFO:root:Load corpus from ../data/ml-100k\BaseReader.pkl
INFO:root:#params: 193024
INFO:root:KSR(
  (i_embeddings): Embedding(1350, 64)
  (p_embeddings): Embedding(21, 64)
  (knowledge_spreading_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (1): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (2): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (3): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
    (4): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.1060,HR@5:0.0520,HR@50:0.5164,NDCG@10:0.0472,NDCG@5:0.0299,NDCG@50:0.1338)
INFO:root:Optimizer: Adam
INFO:root:all_losses: [0.34665966]
INFO:root:Epoch 1     loss=0.3467 [45.8 s]	 dev=(HR@5:0.4761,NDCG@5:0.3241) test=(HR@5:0.4327,NDCG@5:0.2894) [11.0 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.2080498]
INFO:root:Epoch 2     loss=0.2080 [46.7 s]	 dev=(HR@5:0.4931,NDCG@5:0.3348) test=(HR@5:0.4549,NDCG@5:0.3028) [10.9 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.18823445]
INFO:root:Epoch 3     loss=0.1882 [45.1 s]	 dev=(HR@5:0.5080,NDCG@5:0.3507) test=(HR@5:0.4634,NDCG@5:0.3159) [10.7 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.18039888]
INFO:root:Epoch 4     loss=0.1804 [45.0 s]	 dev=(HR@5:0.5133,NDCG@5:0.3538) test=(HR@5:0.4740,NDCG@5:0.3139) [10.6 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.1716648]
INFO:root:Epoch 5     loss=0.1717 [45.0 s]	 dev=(HR@5:0.5122,NDCG@5:0.3520) test=(HR@5:0.4783,NDCG@5:0.3307) [10.6 s] 
INFO:root:all_losses: [0.16723146]
INFO:root:Epoch 6     loss=0.1672 [45.2 s]	 dev=(HR@5:0.5408,NDCG@5:0.3749) test=(HR@5:0.4952,NDCG@5:0.3420) [10.6 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.16038181]
INFO:root:Epoch 7     loss=0.1604 [45.0 s]	 dev=(HR@5:0.5302,NDCG@5:0.3671) test=(HR@5:0.4751,NDCG@5:0.3292) [10.5 s] 
INFO:root:all_losses: [0.15260358]
INFO:root:Epoch 8     loss=0.1526 [45.0 s]	 dev=(HR@5:0.5429,NDCG@5:0.3803) test=(HR@5:0.4846,NDCG@5:0.3379) [10.5 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.14808469]
INFO:root:Epoch 9     loss=0.1481 [45.0 s]	 dev=(HR@5:0.5440,NDCG@5:0.3901) test=(HR@5:0.4910,NDCG@5:0.3278) [10.5 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.14516933]
INFO:root:Epoch 10    loss=0.1452 [45.5 s]	 dev=(HR@5:0.5440,NDCG@5:0.3888) test=(HR@5:0.5037,NDCG@5:0.3464) [10.6 s] 
INFO:root:all_losses: [0.14035113]
INFO:root:Epoch 11    loss=0.1404 [45.4 s]	 dev=(HR@5:0.5536,NDCG@5:0.3892) test=(HR@5:0.5058,NDCG@5:0.3569) [10.6 s] 
INFO:root:all_losses: [0.1369123]
INFO:root:Epoch 12    loss=0.1369 [45.4 s]	 dev=(HR@5:0.5525,NDCG@5:0.3864) test=(HR@5:0.4920,NDCG@5:0.3400) [10.5 s] 
INFO:root:all_losses: [0.13237874]
INFO:root:Epoch 13    loss=0.1324 [45.4 s]	 dev=(HR@5:0.5429,NDCG@5:0.3776) test=(HR@5:0.5101,NDCG@5:0.3579) [10.5 s] 
INFO:root:all_losses: [0.13126118]
INFO:root:Epoch 14    loss=0.1313 [45.4 s]	 dev=(HR@5:0.5567,NDCG@5:0.3886) test=(HR@5:0.5249,NDCG@5:0.3592) [10.5 s] 
INFO:root:all_losses: [0.12809332]
INFO:root:Epoch 15    loss=0.1281 [45.4 s]	 dev=(HR@5:0.5620,NDCG@5:0.3948) test=(HR@5:0.5080,NDCG@5:0.3595) [10.5 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.12498136]
INFO:root:Epoch 16    loss=0.1250 [45.6 s]	 dev=(HR@5:0.5557,NDCG@5:0.3994) test=(HR@5:0.5260,NDCG@5:0.3612) [10.6 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.12259203]
INFO:root:Epoch 17    loss=0.1226 [45.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3884) test=(HR@5:0.5249,NDCG@5:0.3601) [10.6 s] 
INFO:root:all_losses: [0.1168774]
INFO:root:Epoch 18    loss=0.1169 [45.3 s]	 dev=(HR@5:0.5684,NDCG@5:0.3962) test=(HR@5:0.5164,NDCG@5:0.3646) [10.6 s] 
INFO:root:all_losses: [0.11459123]
INFO:root:Epoch 19    loss=0.1146 [45.4 s]	 dev=(HR@5:0.5642,NDCG@5:0.3995) test=(HR@5:0.5302,NDCG@5:0.3713) [10.6 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.11561041]
INFO:root:Epoch 20    loss=0.1156 [45.6 s]	 dev=(HR@5:0.5567,NDCG@5:0.3934) test=(HR@5:0.5016,NDCG@5:0.3530) [10.6 s] 
INFO:root:all_losses: [0.11173208]
INFO:root:Epoch 21    loss=0.1117 [45.4 s]	 dev=(HR@5:0.5652,NDCG@5:0.3915) test=(HR@5:0.5249,NDCG@5:0.3691) [10.6 s] 
INFO:root:all_losses: [0.11160679]
INFO:root:Epoch 22    loss=0.1116 [45.5 s]	 dev=(HR@5:0.5663,NDCG@5:0.4000) test=(HR@5:0.5217,NDCG@5:0.3616) [10.7 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.11140871]
INFO:root:Epoch 23    loss=0.1114 [45.6 s]	 dev=(HR@5:0.5610,NDCG@5:0.3933) test=(HR@5:0.5408,NDCG@5:0.3776) [10.6 s] 
INFO:root:all_losses: [0.10932801]
INFO:root:Epoch 24    loss=0.1093 [45.6 s]	 dev=(HR@5:0.5663,NDCG@5:0.4030) test=(HR@5:0.5260,NDCG@5:0.3651) [10.7 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.10647675]
INFO:root:Epoch 25    loss=0.1065 [45.9 s]	 dev=(HR@5:0.5705,NDCG@5:0.3933) test=(HR@5:0.5101,NDCG@5:0.3614) [10.6 s] 
INFO:root:all_losses: [0.10608445]
INFO:root:Epoch 26    loss=0.1061 [45.8 s]	 dev=(HR@5:0.5663,NDCG@5:0.3963) test=(HR@5:0.5345,NDCG@5:0.3851) [10.6 s] 
INFO:root:all_losses: [0.10498981]
INFO:root:Epoch 27    loss=0.1050 [45.7 s]	 dev=(HR@5:0.5642,NDCG@5:0.3963) test=(HR@5:0.5366,NDCG@5:0.3848) [10.7 s] 
INFO:root:all_losses: [0.1050771]
INFO:root:Epoch 28    loss=0.1051 [46.0 s]	 dev=(HR@5:0.5652,NDCG@5:0.3950) test=(HR@5:0.5323,NDCG@5:0.3781) [10.6 s] 
INFO:root:all_losses: [0.10255602]
INFO:root:Epoch 29    loss=0.1026 [45.9 s]	 dev=(HR@5:0.5758,NDCG@5:0.4088) test=(HR@5:0.5260,NDCG@5:0.3681) [10.6 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.09977213]
INFO:root:Epoch 30    loss=0.0998 [46.1 s]	 dev=(HR@5:0.5854,NDCG@5:0.4065) test=(HR@5:0.5345,NDCG@5:0.3705) [10.7 s] 
INFO:root:all_losses: [0.09903029]
INFO:root:Epoch 31    loss=0.0990 [46.1 s]	 dev=(HR@5:0.5822,NDCG@5:0.4115) test=(HR@5:0.5366,NDCG@5:0.3776) [10.8 s] 
INFO:root:Save model to ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt...
INFO:root:all_losses: [0.09815425]
INFO:root:Epoch 32    loss=0.0982 [46.2 s]	 dev=(HR@5:0.5673,NDCG@5:0.4011) test=(HR@5:0.5196,NDCG@5:0.3693) [10.7 s] 
INFO:root:all_losses: [0.09740517]
INFO:root:Epoch 33    loss=0.0974 [46.0 s]	 dev=(HR@5:0.5514,NDCG@5:0.3964) test=(HR@5:0.5217,NDCG@5:0.3644) [10.6 s] 
INFO:root:all_losses: [0.09513138]
INFO:root:Epoch 34    loss=0.0951 [46.0 s]	 dev=(HR@5:0.5620,NDCG@5:0.3981) test=(HR@5:0.5196,NDCG@5:0.3660) [10.7 s] 
INFO:root:all_losses: [0.09322061]
INFO:root:Epoch 35    loss=0.0932 [46.2 s]	 dev=(HR@5:0.5695,NDCG@5:0.3979) test=(HR@5:0.5228,NDCG@5:0.3692) [10.6 s] 
INFO:root:all_losses: [0.09600084]
INFO:root:Epoch 36    loss=0.0960 [45.8 s]	 dev=(HR@5:0.5525,NDCG@5:0.3934) test=(HR@5:0.5429,NDCG@5:0.3851) [10.6 s] 
INFO:root:all_losses: [0.09314422]
INFO:root:Epoch 37    loss=0.0931 [46.0 s]	 dev=(HR@5:0.5589,NDCG@5:0.3855) test=(HR@5:0.5376,NDCG@5:0.3718) [10.7 s] 
INFO:root:all_losses: [0.09250349]
INFO:root:Epoch 38    loss=0.0925 [45.9 s]	 dev=(HR@5:0.5536,NDCG@5:0.3901) test=(HR@5:0.5451,NDCG@5:0.3844) [10.8 s] 
INFO:root:all_losses: [0.09094557]
INFO:root:Epoch 39    loss=0.0909 [46.1 s]	 dev=(HR@5:0.5652,NDCG@5:0.3969) test=(HR@5:0.5366,NDCG@5:0.3777) [10.7 s] 
INFO:root:all_losses: [0.09266801]
INFO:root:Epoch 40    loss=0.0927 [46.0 s]	 dev=(HR@5:0.5546,NDCG@5:0.3973) test=(HR@5:0.5249,NDCG@5:0.3695) [10.5 s] 
INFO:root:all_losses: [0.09179722]
INFO:root:Epoch 41    loss=0.0918 [46.4 s]	 dev=(HR@5:0.5610,NDCG@5:0.3978) test=(HR@5:0.5514,NDCG@5:0.3864) [10.6 s] 
INFO:root:all_losses: [0.09072799]
INFO:root:Epoch 42    loss=0.0907 [46.3 s]	 dev=(HR@5:0.5567,NDCG@5:0.3981) test=(HR@5:0.5292,NDCG@5:0.3722) [10.6 s] 
INFO:root:all_losses: [0.08936353]
INFO:root:Epoch 43    loss=0.0894 [46.7 s]	 dev=(HR@5:0.5610,NDCG@5:0.3902) test=(HR@5:0.5292,NDCG@5:0.3703) [10.6 s] 
INFO:root:all_losses: [0.08609284]
INFO:root:Epoch 44    loss=0.0861 [46.8 s]	 dev=(HR@5:0.5334,NDCG@5:0.3784) test=(HR@5:0.5260,NDCG@5:0.3667) [10.6 s] 
INFO:root:all_losses: [0.08593426]
INFO:root:Epoch 45    loss=0.0859 [46.7 s]	 dev=(HR@5:0.5567,NDCG@5:0.3922) test=(HR@5:0.5122,NDCG@5:0.3526) [10.6 s] 
INFO:root:all_losses: [0.08812648]
INFO:root:Epoch 46    loss=0.0881 [46.9 s]	 dev=(HR@5:0.5546,NDCG@5:0.3866) test=(HR@5:0.5249,NDCG@5:0.3618) [10.6 s] 
INFO:root:all_losses: [0.085798]
INFO:root:Epoch 47    loss=0.0858 [46.9 s]	 dev=(HR@5:0.5536,NDCG@5:0.3960) test=(HR@5:0.5323,NDCG@5:0.3738) [10.6 s] 
INFO:root:all_losses: [0.08417124]
INFO:root:Epoch 48    loss=0.0842 [47.4 s]	 dev=(HR@5:0.5451,NDCG@5:0.3812) test=(HR@5:0.5196,NDCG@5:0.3626) [10.5 s] 
INFO:root:all_losses: [0.08612699]
INFO:root:Epoch 49    loss=0.0861 [48.0 s]	 dev=(HR@5:0.5557,NDCG@5:0.3833) test=(HR@5:0.5249,NDCG@5:0.3630) [10.6 s] 
INFO:root:all_losses: [0.08617102]
INFO:root:Epoch 50    loss=0.0862 [48.4 s]	 dev=(HR@5:0.5599,NDCG@5:0.4025) test=(HR@5:0.5260,NDCG@5:0.3659) [10.6 s] 
INFO:root:all_losses: [0.08424611]
INFO:root:Epoch 51    loss=0.0842 [48.5 s]	 dev=(HR@5:0.5673,NDCG@5:0.3976) test=(HR@5:0.5239,NDCG@5:0.3636) [10.6 s] 
INFO:root:Early stop at 51 based on dev result.
INFO:root:
Best Iter(dev)=   31	 dev=(HR@5:0.5822,NDCG@5:0.4115) test=(HR@5:0.5366,NDCG@5:0.3776) [2886.2 s] 
INFO:root:Load model from ../model/KSR/KSR_ml-100k_2019_lr=0.001_l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.7010,HR@5:0.5366,HR@50:0.9523,NDCG@10:0.4317,NDCG@5:0.3776,NDCG@50:0.4891)
INFO:root:
--------------------------------------------- END: 2025-03-16 22:44:23 ---------------------------------------------
